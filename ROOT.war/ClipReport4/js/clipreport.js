var report_version="1.0.0.167";var exe_print_version="1.0.0.1";var agt=navigator.userAgent.toLowerCase();var view_domain=document.domain;is_major=parseInt(navigator.appVersion);is_minor=parseFloat(navigator.appVersion);is_moz=((agt.indexOf("mozilla")!=-1)&&(agt.indexOf("spoofer")==-1)&&(agt.indexOf("compatible")==-1)&&(agt.indexOf("opera")==-1)&&(agt.indexOf("webtv")==-1)&&(agt.indexOf("hotjava")==-1));is_moz2=(is_moz&&(is_major==2));is_moz3=(is_moz&&(is_major==3));is_moz4=(is_moz&&(is_major==4));is_gecko=(agt.indexOf("gecko")!=-1);is_firefox=(agt.indexOf("firefox")!=-1);is_nav2=is_moz2;is_nav3=is_moz3;is_nav4=is_moz4;is_nav4up=(is_nav4||((is_major>=4)&&(agt.indexOf("netscape")!=-1)));is_nav=(is_nav2||is_nav3||is_nav4);is_mozilla=(is_moz&&is_gecko);is_mozilla1=(is_moz&&is_gecko&&(agt.indexOf("rv:1")!=-1));is_ie=((agt.indexOf("msie")!=-1)&&(agt.indexOf("opera")==-1));is_ieVersion=0;is_ie6=(is_ie&&(is_major==4)&&(agt.indexOf("msie 6.")!=-1));if(is_ie6){is_ieVersion=6;}is_ie7=(is_ie&&(is_major==4)&&(agt.indexOf("msie 7.")!=-1));if(is_ie7){is_ie6=false;is_ieVersion=7;}is_ie8=(is_ie&&(is_major==4)&&(agt.indexOf("msie 8.")!=-1));if(is_ie8){is_ie6=false;is_ie7=false;is_ieVersion=8;}is_ie9=(is_ie&&(is_major==5)&&(agt.indexOf("msie 9.")!=-1));if(is_ie9){is_ie6=false;is_ie7=false;is_ie8=false;is_ieVersion=9;}is_ie10=(is_ie&&(is_major==5)&&(agt.indexOf("msie 10.")!=-1));if(is_ie10){is_ie6=false;is_ie7=false;is_ie8=false;is_ie9=false;is_ieVersion=10;}is_ie11=(is_gecko&&!is_firefox&&(is_major==5)&&(agt.indexOf("rv:11.")!=-1));if(is_ie11){is_ie6=false;is_ie7=false;is_ie8=false;is_ie9=false;is_ie10=false;is_ie=true;is_ieVersion=11;}is_window=(agt.indexOf("windows")!=-1);is_chrome=!is_ie&&(agt.indexOf("chrome")!=-1)?true:false;is_chrome58=false;if(is_chrome){var tempVer=agt.match(/chrome\/([0-9]+)\./g);if(null!=tempVer){if(Number(tempVer[0].substring(7))>57){is_chrome58=true;}}}is_edge=is_chrome&&(agt.indexOf("edge")!=-1);is_opera=is_chrome&&(agt.indexOf("opr/")!=-1);is_safari=(agt.indexOf("safari")!=-1&&!is_chrome);is_window_safari=(is_safari&&agt.indexOf("windows")!=-1);is_crOs=is_chrome&&(agt.indexOf("csos")!=-1);is_chromeFrame=!is_ie&&is_chrome;is_webkit=is_safari||is_chrome;is_mozBrowser=is_firefox||is_opera;is_ipad=((is_safari||is_moz||(agt.indexOf("applewebkit")!=-1))&&(agt.indexOf("ipad")!=-1));is_iphone=((is_safari||is_moz||(agt.indexOf("applewebkit")!=-1))&&(agt.indexOf("iphone")!=-1));is_apple=(is_ipad||is_iphone);is_android=(agt.indexOf("android")!=-1);is_opera_mini=(agt.indexOf("opera mini")!=-1);is_android_mobile=(is_android&&agt.indexOf("mobile")!=-1);is_android_tablet=(is_android&&!is_android_mobile);is_android_mobile44=(is_android_mobile&&agt.indexOf("android 4.")!=-1);is_samsung_browser=(is_android&&(agt.indexOf("samsungbrowser")!=-1));is_mobile=(is_iphone||is_android_mobile);is_tablet=(is_ipad||is_android_tablet);is_smartphone=false;is_smartphone=(is_iphone||is_opera_mini||is_ipad||is_android);is_svg=true;if(typeof window.SVGAElement=="undefined"){is_svg=false;if(!is_ie6&&!is_ie7&&!is_ie8){is_ie7=true;}is_ie=true;is_ie9=false;is_ie10=false;is_ie11=false;is_ieVersion=7;}else{if(is_ie7||is_ie8){is_svg=false;}}is_appControl=false;is_exeControl=false;is_exeMirroring=false;if(is_svg){is_appControl=(typeof ClipHybrid!="undefined")&&(typeof ClipHybrid.callNativeControl!="undefined");is_exeControl=(window.external)&&("ClipSubWebBrowserCtrl_Invoke" in window.external);is_exeMirroring=is_exeControl&&((window.external)||("ClipMainWebBrowserCtrl_Invoke" in window.external));}var Re_zoom={isPop:false,rate:1};var mRe_pallet=null;is_PosiFix=true;var getAcrobatInfo=function(){var e=function(f){try{return new ActiveXObject(f);}catch(g){window.mRe_ccancels=g.message;}};var b=function(f){for(key in navigator.plugins){var g=navigator.plugins[key];if(g.name==f){return g;}}};var c=function(){return this.plugin=this.plugin||function(){if(is_ie||is_ie11){return e("AcroPDF.PDF")||e("PDF.PdfCtrl");}else{return b("Chromium PDF Viewer")||b("Chrome PDF Viewer")||b("Adobe Acrobat")||b("WebKit built-in PDF");}}();};var d=function(){return !!c();};var a=function(){try{var h=c();if(is_ie||is_ie11){var f=h.GetVersions().split(",");var g=f[0].split("=");return parseFloat(g[1]);}if(h.version){return parseInt(h.version);}return h.name;}catch(i){return null;}};return{acrobat:d()?true:false,acrobatVersion:a()};};m_report_printOption=getAcrobatInfo();is_win78_reader9=(((agt.indexOf("windows nt 6.1")!=-1)||(agt.indexOf("windows nt 6.2")!=-1)||(agt.indexOf("windows nt 10.")!=-1))&&(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<10));is_reader8=(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<9);is_winxp_reader10=((is_ie6||is_ie7||is_ie8)&&(null!=m_report_printOption.acrobatVersion)&&(m_report_printOption.acrobatVersion<11&&m_report_printOption.acrobatVersion>9));function HttpClient(){try{var b=new XMLHttpRequest();if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Msxml2.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){try{var b=new ActiveXObject("Microsoft.XMLHTTP");if(null!=b){this.m_objHttpRequest=b;}}catch(a){mRe_ReportWebLog("HttpRequest not supported");}}}}HttpClient.prototype.send=function(e,b,c,d){if(c){this.m_objHttpRequest.onreadystatechange=d;}else{this.m_objHttpRequest.onreadystatechange=null;}var a="";if(-1!=e.indexOf("?")){a=e+"&"+b;this.m_objHttpRequest.open("GET",a,c);this.m_objHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");this.m_objHttpRequest.send();}else{this.m_objHttpRequest.open("POST",e,c);this.m_objHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");this.m_objHttpRequest.send(b);}if(!c){if(4==this.m_objHttpRequest.readyState){if(200==this.m_objHttpRequest.status){return this.m_objHttpRequest.responseText;}else{mRe_ReportWebLog(this.m_objHttpRequest.status);}}return this._handleSyncHttpResponse();}};if(window.addEventListener){addEventListener("message",receiveMessage,false);}else{attachEvent("onmessage",receiveMessage);}var m_reportHashMap=function(){};function createReport(b,c,d){if(null==d){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,c,d);return a;}function createJSPReport(c,d,b,e){if(null==e){mRe_ReportEventHandler(20);}var a=new Report(c,d,b,null,e);return a;}function createImportJSPReport(b,d,c){if(null==c){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,null,c);a.m_reportKey=d;return a;}Report.prototype.createUserProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.showProgressbar();}else{if(null!=this.m_userProg){var a=document.createElement("div");a.className="user_progress";a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;background-repeat:no-repeat;z-index:500;";this.targetDiv.appendChild(a);this.m_userProg=a;}}};Report.prototype.removeUserProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.hideProgressbar();}else{if(null!=this.m_userProg){this.targetDiv.removeChild(this.m_userProg);this.m_userProg=null;}}};Report.prototype.removeHybridProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.hideProgressbar();}};Report.prototype.createProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.showProgressbar();}else{var a="";var b=this.is_eForm?"eform_progress":"report_progress";if(!this.m_directPrint){if(this.m_progress.URL==""){a="<div class='"+b+"' style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;' />";}else{a="<div style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";a+="background-position:"+this.m_progress.x+" "+this.m_progress.y+";";a+="background-repeat:no-repeat;background-image:url("+this.m_progress.URL+");'/>";}}this.paintDiv.innerHTML=a;}this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.createEditableProgress=function(){if(this.m_isHybridProgress&&typeof ClipHybrid!="undefined"){ClipHybrid.showProgressbar();}else{var a=document.createElement("div");var c=this.is_eForm?"eform_progress":"report_progress";if(this.m_progress.URL==""){a.setAttribute("class",c);a.style.cssText="position:absolute;left:"+this.paintDiv.scrollLeft+"px;width:"+this.paintDiv.offsetWidth+"px;top:"+this.paintDiv.scrollTop+"px;height:"+this.paintDiv.offsetHeight+"px;overflow:hidden;";}else{var b="position:absolute;left:"+this.paintDiv.scrollLeft+"px;width:"+this.paintDiv.offsetWidth+"px;top:"+this.paintDiv.scrollTop+"px;height:"+this.paintDiv.offsetHeight+"px;overflow:hidden;";b+="background-position:"+this.m_progress.x+" "+this.m_progress.y+";";b+="background-repeat:no-repeat;background-image:url("+this.m_progress.URL+");";a.style.cssText=b;}this.paintDiv.appendChild(a);}this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.createPageSyncProgress=function(){var a=this.paintDiv.lastChild;if(null!=a){var c=a.getAttribute("class");if(c=="report_progress"){return;}}var b=document.createElement("div");var e="report_progress";if(this.m_progress.URL==""){b.setAttribute("class",e);b.style.cssText="position:absolute;left:"+this.paintDiv.scrollLeft+"px;width:"+(this.paintDiv.offsetWidth-20)+"px;top:"+this.paintDiv.scrollTop+"px;height:"+this.paintDiv.offsetHeight+"px;overflow:hidden;";}else{var d="position:absolute;left:"+this.paintDiv.scrollLeft+"px;width:"+this.paintDiv.offsetWidth+"px;top:"+this.paintDiv.scrollTop+"px;height:"+this.paintDiv.offsetHeight+"px;overflow:hidden;";d+="background-position:"+this.m_progress.x+" "+this.m_progress.y+";";d+="background-repeat:no-repeat;background-image:url("+this.m_progress.URL+");";b.style.cssText=d;}this.paintDiv.appendChild(b);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.createPrintProgress=function(){this.disabledMenu(true);var a=document.createElement("div");this.m_printprogress.domDiv=a;var c=this.is_eForm?"eform_progress":"report_progress";if(this.m_printprogress.URL==""){strDiv="<div class='"+c+"' style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;' />";a.setAttribute("class",c);a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";}else{var b="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";b+="background-position:"+this.m_printprogress.x+" "+this.m_printprogress.y+";";b+="background-repeat:no-repeat;background-image:url("+this.m_printprogress.URL+");";a.style.cssText=b;}this.paintDiv.appendChild(a);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.removePrintProgress=function(){this.disabledMenu(false);try{this.paintDiv.removeChild(this.m_printprogress.domDiv);this.m_printprogress.domDiv=null;window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);this.isEnabledAdobeRead=true;this.debugMeg("report log :: 리포트 프로그래스 종료");if(null!=this.m_endPrintProgressEvent){this.m_endPrintProgressEvent();}}catch(a){}};Report.prototype.createHWPProgress=function(){this.disabledMenu(true);var a=document.createElement("div");this.m_hwpprogress.domDiv=a;var c=this.is_eForm?"eform_progress":"report_progress";if(this.m_hwpprogress.URL==""){strDiv="<div class='"+c+"' style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;' />";a.setAttribute("class",c);a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";}else{var b="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";b+="background-position:"+this.m_hwpprogress.x+" "+this.m_hwpprogress.y+";";b+="background-repeat:no-repeat;background-image:url("+this.m_hwpprogress.URL+");";a.style.cssText=b;}this.paintDiv.appendChild(a);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.removeHWPProgress=function(){this.disabledMenu(false);this.paintDiv.removeChild(this.m_hwpprogress.domDiv);this.m_hwpprogress.domDiv=null;window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endHWPButton!=null){this.m_buttonEvent.endHWPButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createEXCELProgress=function(){this.disabledMenu(true);var a=document.createElement("div");this.m_excelprogress.domDiv=a;var c=this.is_eForm?"eform_progress":"report_progress";if(this.m_excelprogress.URL==""){strDiv="<div class='"+c+"' style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;' />";a.setAttribute("class",c);a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";}else{var b="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";b+="background-position:"+this.m_excelprogress.x+" "+this.m_excelprogress.y+";";b+="background-repeat:no-repeat;background-image:url("+this.m_excelprogress.URL+");";a.style.cssText=b;}this.paintDiv.appendChild(a);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.removeEXCELProgress=function(){this.disabledMenu(false);this.paintDiv.removeChild(this.m_excelprogress.domDiv);this.m_excelprogress.domDiv=null;window.clearTimeout(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endExcelButton!=null){this.m_buttonEvent.endExcelButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createSAVEProgress=function(){this.disabledMenu(true);var b=document.getElementById("re_iframe"+this.m_uid);b.src="about:blank";var a=document.createElement("div");this.m_saveprogress.domDiv=a;var d=this.is_eForm?"eform_progress":"report_progress";if(this.m_saveprogress.URL==""){a.setAttribute("class",d);a.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";}else{var c="position:absolute;left:0px;right:0px;top:0px;bottom:0px;overflow:hidden;";c+="background-position:"+this.m_saveprogress.x+" "+this.m_saveprogress.y+";";c+="background-repeat:no-repeat;background-image:url("+this.m_saveprogress.URL+");";a.style.cssText=c;}this.paintDiv.appendChild(a);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.removeSAVEProgress=function(){this.disabledMenu(false);this.paintDiv.removeChild(this.m_saveprogress.domDiv);this.m_saveprogress.domDiv=null;window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endSaveButton!=null){this.m_buttonEvent.endSaveButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.removePDFProgress=function(){this.disabledMenu(false);this.paintDiv.removeChild(this.m_saveprogress.domDiv);this.m_saveprogress.domDiv=null;window.clearInterval(this.fileDownloadCheckTimer);clearListCookies(this.clientPath);if(this.m_buttonEvent.endPDFButton!=null){this.m_buttonEvent.endPDFButton();}this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.createEndReportProgress=function(){this.disabledMenu(true);var a=document.createElement("div");this.m_endreportprogress.domDiv=a;var c=this.is_eForm?"eform_progress":"report_progress";if(this.m_endreportprogress.URL==""){a.setAttribute("class",c);a.style.cssText="position:absolute;left:"+this.paintDiv.scrollLeft+"px;right:0px;top:"+this.paintDiv.scrollTop+"px;bottom:0px;overflow:hidden;";}else{var b="position:absolute;left:"+this.paintDiv.scrollLeft+"px;right:0px;top:"+this.paintDiv.scrollTop+"px;bottom:0px;overflow:hidden;";b+="background-position:"+this.m_endreportprogress.x+" "+this.m_endreportprogress.y+";";b+="background-repeat:no-repeat;background-image:url("+this.m_endreportprogress.URL+");";a.style.cssText=b;}this.paintDiv.appendChild(a);this.debugMeg("report log :: 리포트 프로그래스 동작....");};Report.prototype.removeEndReportProgress=function(){this.disabledMenu(false);this.m_endreportprogress.domDiv=null;this.debugMeg("report log :: 리포트 프로그래스 종료");};Report.prototype.view=function(){if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.connect();return;}}this.default_view();};Report.prototype.default_view=function(){this.m_isEndReportEvent=true;this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check :: "+agt);this.debugMeg("PDF check :: "+m_report_printOption.acrobatVersion);if(!is_svg){if(this.is_eForm){this.debugMeg("report log :: IE8 버전 이하로 체크되었습니다. 웹이폼에서는 지원하지 않는 버전입니다.");return;}if(!this.m_isPaintImage){this.debugMeg("report log :: IE8 버전 이하로 체크되었습니다. 접근성 뷰어 일 경우 화면 비율를 100%로 고정합니다.");this.m_ratio="100%";this.m_disControl.zoomIn=true;}}if(this.m_reportKey!=null){this.checkReportCreate();}else{if(this.userJsp==null){this.newReportCreate(this.servletPath,this.oof);}else{this.newReportCreate(this.userJsp,null);}}};Report.prototype.debugMeg=function(b,a){if(this.m_debug.isDebug){if(this.m_debug.isConsole){window.console.log(b);}else{this.m_debug.message.push(b);}if(null!=a){this.m_debug.isLock=a;}}};Report.prototype.endDebugMeg=function(a){if(this.m_debug.isDebug){if(!this.m_debug.isConsole){if(!a||(this.m_debug.isLock==a)){alert(this.m_debug.message.join("\n"));this.m_debug.message=new Array();this.m_debug.isLock=false;}}}};Report.prototype.setSlidePage=function(a){this.m_isSlidePage=a;};Report.prototype.mRe_DirectPrintCall=function(){if(this.m_directPrintOp.endReport){this.m_directPrintOp.endReport=false;window.clearInterval(this.m_directPrintOp.key);this.m_directPrintOp.key=null;this.printView();}};Report.prototype.createView=function(e,k){var j=new Array();var g="";var f,h;this.debugMeg("report log :: 리포트 뷰어를 생성합니다...");this.isMakePDFFrame=false;if(this.m_directPrint){var i=this;this.m_directPrintOp.key=window.setInterval(function(){i.mRe_DirectPrintCall();},300);e.style.cssText+="position:absolute !important;width:1px !important;height:1px !important;visibility:hidden !important;opacity:0 !important;filter:alpha(opacity=0) !important;";if(is_safari&&!is_smartphone){window.open("","report_SubWindow","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}}if(this.m_isFadeView){f=e.style.width;h=e.style.height;$(e).css({width:"0px",height:"0px",opacity:"0"});}j.push("<div style='position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;'>");if(this.is_eForm){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}this.eformCreateTag(j,k);}else{if(is_mobile){this.debugMeg("report log :: 모바일 환경으로 체크됨");this.mobileCreateTag(j,k);}else{if(is_tablet){this.debugMeg("report log :: 테블릿 pc 환경으로 체크됨");this.tabletCreateTag(j,k);}else{this.debugMeg("report log :: 데스트탑 pc 환경으로 체크됨");this.pcCreateTag(j,k);}}}j.push("<form id='re_form"+k+"' style='display:none;' encoding='application/x-www-form-urlencoded' method='post'>");j.push("<input type='text' id='re_form_clipid"+k+"' name='ClipID' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_uid"+k+"' name='uid' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_clipUID"+k+"' name='clipUID' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_print"+k+"' name='print' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_printImage"+k+"' name='isPDFPrintImage' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_path"+k+"' name='path' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_option"+k+"' name='optionValue' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_ChromeFitToPage"+k+"' name='isChromePrintFitToPage' value='false' style='visibility:hidden;'/>");j.push("<input type='text' id='re_form_s_time"+k+"' name='s_time' value='' style='visibility:hidden;'/>");j.push("</form>");j.push("<form id='re_saveform"+k+"' style='display:none;' encoding='application/x-www-form-urlencoded' method='post'>");j.push("<input type='text' id='re_saveform_clipid"+k+"' name='ClipID' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_uid"+k+"' name='uid' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_clipUID"+k+"' name='clipUID' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_path"+k+"' name='path' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_option"+k+"' name='optionValue' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_is_ie"+k+"' name='is_ie' value='"+((!is_firefox)&&(!is_safari)&&(!is_apple))+"' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_fileName"+k+"' name='exportN' style='visibility:hidden;'/>");j.push("<input type='text' id='re_saveform_fileType"+k+"' name='exportType' style='visibility:hidden;'/>");j.push("</form>");j.push("<iframe title='파일 저장용 프레임' id='re_iframe"+k+"' name='re_target"+k+"' style='display:none'></iframe>");j.push("<img id='re_deleteImg"+k+"' style='display:none'></img>");j.push("<iframe title='PDF 인쇄용 프레임' id='re_iframe2"+k+"' style='position:absolute;left:0px;top:0px;height:0px;width:0px;visibility:hidden'></iframe>");j.push("<iframe title='html 인쇄용 프레임' id='re_iframe3"+k+"' style='position:absolute;left:0px;top:0px;height:0px;width:0px;visibility:hidden'></iframe>");j.push("</div>");if(is_ie7||is_ie8){var d=document.createElement("div");d.innerHTML=j.join("");e.appendChild(d.firstChild);d=null;}else{e.innerHTML=j.join("");}this.debugMeg("report log :: 리포트 뷰어 완성....");this.paintDiv=document.getElementById("re_paintDiv"+k);this.menuDiv=document.getElementById("re_menu"+k);if(this.is_eForm){this.doodleDiv=document.getElementById("re_doodleDiv"+k);this.doodle_button=document.getElementById("re_doodle"+k);}this.input=document.getElementById("re_input"+k);this.totalCountSpan=document.getElementById("re_totalCount"+k);this.totalCountText=document.getElementById("re_totalCountNumber"+k);this.progressImg=document.getElementById("re_progressImg"+k);this.zoomCombo=document.getElementById("re_zoomSelect"+k);this.next_button=document.getElementById("re_next"+k);this.prev_button=document.getElementById("re_prev"+k);this.first_button=document.getElementById("re_first"+k);this.last_button=document.getElementById("re_last"+k);this.save_button=document.getElementById("re_save"+k);this.print_button=document.getElementById("re_print"+k);this.pdf_button=document.getElementById("re_pdf"+k);this.hwp_button=document.getElementById("re_hwp"+k);this.doc_button=document.getElementById("re_doc"+k);this.excel_button=document.getElementById("re_excel"+k);this.reportInfo_button=document.getElementById("re_reportInfo"+k);this.close_button=document.getElementById("re_close"+k);this.formTag=document.getElementById("re_form"+k);this.formTag_clipid=document.getElementById("re_form_clipid"+k);this.formTag_uid=document.getElementById("re_form_uid"+k);this.formTag_clipUID=document.getElementById("re_form_clipUID"+k);this.formTag_print=document.getElementById("re_form_print"+k);this.formTag_printImage=document.getElementById("re_form_printImage"+k);this.formTag_path=document.getElementById("re_form_path"+k);this.formTag_option=document.getElementById("re_form_option"+k);this.formTag_ChromeFitToPage=document.getElementById("re_form_ChromeFitToPage"+k);this.formTag_s_time=document.getElementById("re_form_s_time"+k);this.saveFormTag.form=document.getElementById("re_saveform"+k);this.saveFormTag.clipid=document.getElementById("re_saveform_clipid"+k);this.saveFormTag.uid=document.getElementById("re_saveform_uid"+k);this.saveFormTag.clipUID=document.getElementById("re_saveform_clipUID"+k);this.saveFormTag.path=document.getElementById("re_saveform_path"+k);this.saveFormTag.option=document.getElementById("re_saveform_option"+k);this.saveFormTag.filename=document.getElementById("re_saveform_fileName"+k);this.saveFormTag.filetype=document.getElementById("re_saveform_fileType"+k);this.deleteImgTag=document.getElementById("re_deleteImg"+k);var m=document.getElementById("re_iframe2"+k);var l=document.getElementById("re_iframe3"+k);m.src="about:blank";if(view_domain!=document.domain){l.src="javascript:'<script>window.onload=function(){document.write(\\'<script>document.domain=\\\""+document.domain+'\\";<\\\\/script>\\\');document.close();return \\"+url+\\";};<\/script>\'';}else{l.src="about:blank";}if(!is_ie){if(this.m_isCrossDomainPDF){var c="uid="+k+"&clipUID="+k+"&ClipID=R15&localSave="+this.m_is_serverSaveFile;var a=this.servletPath+"?"+c;if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&"+c;}m.src=a;this.isMakePDFFrame=true;}}if(!this.is_eForm&&!is_smartphone){var b={isArea:true,x1:0,x2:0,y1:0,y2:0};if(this.paintDiv.addEventListener){this.paintDiv.addEventListener("mousedown",function(n){if(this.offsetWidth-20<n.clientX||this.offsetHeight-20<n.clientY){b.isNotArea=false;}else{b.isNotArea=true;b.x1=n.clientX;b.y1=n.clientY;}},false);this.paintDiv.addEventListener("mouseup",function(n){if(b.isNotArea){b.x2=n.clientX;b.y2=n.clientY;this.scrollLeft+=(b.x1-b.x2);this.scrollTop+=(b.y1-b.y2);}},false);}}if(this.m_isFadeView){$(e).attr("uid",this.m_uid).animate({width:f,height:h,opacity:1},400,function(){$(this).removeAttr("uid");});}if(this.is_eForm){this.createEFormView();}};Report.prototype.pcCreateTag=function(b,a){var d=is_svg?"_svg":"_png";var c="";b.push("<div id='re_menu"+a+"' class='report_menu_div' style='"+((this.m_isMenu)?"":"height:0px;")+(null!=this.menuDiv?this.menuDiv:"")+"'>");b.push("<table class='report_menu_table' vertical-align='middle'><tr><td class='report_menu_table_td'>");b.push("<div class='report_menu_table_td_div'><nobr>");c=this.m_disControl.save?"_dis":"";b.push("<button title='"+this.m_languageMap.save+"' id='re_save"+a+"' onclick=\"m_reportHashMap['"+a+"'].exportView();return false;\" class='report_menu_button report_menu_save_button "+("report_menu_save_button"+d+c)+"' style='"+(null!=this.save_button?this.save_button:"")+"' "+(this.m_disControl.save?"disabled":"")+"></button>");c=this.m_disControl.pdf?"_dis":"";b.push("<button title='"+this.m_languageMap.pdf_save+"' id='re_pdf"+a+"' onclick=\"m_reportHashMap['"+a+"'].pdfDownLoad();return false;\" class='report_menu_button report_menu_pdf_button "+("report_menu_pdf_button"+d+c)+"' style='"+(null!=this.pdf_button?this.pdf_button:"")+"' "+(this.m_disControl.pdf?"disabled":"")+"></button>");c=this.m_disControl.excel?"_dis":"";b.push("<button title='"+this.m_languageMap.excel_save+"' id='re_excel"+a+"' onclick=\"m_reportHashMap['"+a+"'].excelDownLoad();return false;\" class='report_menu_button report_menu_excel_button "+("report_menu_excel_button"+d+c)+"' style='"+(null!=this.excel_button?this.excel_button:"")+"' "+(this.m_disControl.excel?"disabled":"")+"></button>");c=this.m_disControl.hwp?"_dis":"";b.push("<button title='"+this.m_languageMap.hwp_save+"' id='re_hwp"+a+"' onclick=\"m_reportHashMap['"+a+"'].hwpDownLoad();return false;\" class='report_menu_button report_menu_hwp_button "+("report_menu_hwp_button"+d+c)+"' style='"+(null!=this.hwp_button?this.hwp_button:"")+"' "+(this.m_disControl.hwp?"disabled":"")+"></button>");c=this.m_disControl.doc?"_dis":"";b.push("<button title='"+this.m_languageMap.doc_save+"' id='re_doc"+a+"' onclick=\"m_reportHashMap['"+a+"'].docDownLoad();return false;\" class='report_menu_button report_menu_doc_button "+("report_menu_doc_button"+d+c)+"' style='"+(null!=this.doc_button?this.doc_button:"")+"' "+(this.m_disControl.doc?"disabled":"")+"></button>");c=this.m_disControl.print?"_dis":"";b.push("<button title='"+this.m_languageMap.print+"' id='re_print"+a+"' onclick=\"m_reportHashMap['"+a+"'].printWindowView();return false;\" class='report_menu_button report_menu_print_button "+("report_menu_print_button"+d+c)+"' style='"+(null!=this.print_button?this.print_button:"")+"' "+(this.m_disControl.print?"disabled":"")+"></button>");c=this.m_disControl.first?"_dis":"";b.push("<button title='"+this.m_languageMap.first_page+"' id='re_first"+a+"' onclick=\"m_reportHashMap['"+a+"'].firstPage();return false;\" class='report_menu_button report_menu_leftEnd_button "+("report_menu_leftEnd_button"+d+c)+"' style='"+(null!=this.first_button?this.first_button:"")+"' "+(this.m_disControl.first?"disabled":"")+"></button>");c=this.m_disControl.prev?"_dis":"";b.push("<button title='"+this.m_languageMap.prv_page+"' id='re_prev"+a+"' onclick=\"m_reportHashMap['"+a+"'].previousPage();return false;\" class='report_menu_button report_menu_left_button "+("report_menu_left_button"+d+c)+"' style='"+(null!=this.prev_button?this.prev_button:"")+"' "+(this.m_disControl.prev?"disabled":"")+"></button>");b.push("<input title='"+this.m_languageMap.page+"' id='re_input"+a+"' type='text' value='1' class='report_menu_pageCount_input' onkeypress=\"enterEvent(event, m_reportHashMap['"+a+"'], this);\" onblur=\"m_reportHashMap['"+a+"'].selectPage(Number(this.value) - 1);return false;\" style='"+(null!=this.input?this.input:"")+"' "+(this.m_disControl.input?"disabled":"")+"/>");b.push("<input title='"+this.m_languageMap.total_page+"' id='re_totalCountNumber"+a+"' value='"+this.m_TPC.before+"0"+this.m_TPC.after+"' class='report_menu_pageCount_span' style='"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' readonly></input><span id='re_totalCount"+a+"' class='report_menu_pageCount_span' style='border:0px;"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' "+(this.m_disControl.caption?"disabled":"")+" onclick=\"m_reportHashMap['"+a+"'].mRe_pageCountLabelClick();return false;\">");b.push("<img id='re_progressImg"+a+"' class='report_menu_progress' src='"+progressImg()+"'/></span>");c=this.m_disControl.next?"_dis":"";b.push("<button title='"+this.m_languageMap.next_page+"' id='re_next"+a+"' onclick=\"m_reportHashMap['"+a+"'].nextPage();return false;\" class='report_menu_button report_menu_right_button "+("report_menu_right_button"+d+c)+"' style='"+(null!=this.next_button?this.next_button:"")+"' "+(this.m_disControl.next?"disabled":"")+"></button>");c=this.m_disControl.last?"_dis":"";b.push("<button title='"+this.m_languageMap.last_page+"' id='re_last"+a+"'onclick=\"m_reportHashMap['"+a+"'].lastPage();return false;\" class='report_menu_button report_menu_rightEnd_button "+("report_menu_rightEnd_button"+d+c)+"' style='"+(null!=this.last_button?this.last_button:"")+"' "+(this.m_disControl.last?"disabled":"")+"></button>");b.push("<select title='"+this.m_languageMap.zoomIn+"' onChange=\"m_reportHashMap['"+a+"'].zoomIn(this)\" name='zoomSelect' id='re_zoomSelect"+a+"' class='report_menu_zoom_combo'  style='"+((is_ie6||is_ie7)?"top:5px;":"")+(null!=this.zoomCombo?this.zoomCombo:"")+";' "+(this.m_disControl.zoomIn?"disabled":"")+">");this.comboOptionCreateTag(b);b.push("</select>");c=this.m_disControl.reportInfo?"_dis":"";b.push("<button title='"+this.m_languageMap.report_info+"' id='re_reportInfo"+a+"' onclick=\"m_reportHashMap['"+a+"'].reportInfo();return false;\" class='report_menu_button report_menu_reportInfo_button "+("report_menu_reportInfo_button"+d+c)+"' style='"+(null!=this.reportInfo_button?this.reportInfo_button:"")+"' "+(this.m_disControl.reportInfo?"disabled":"")+"></button>");c=this.m_disControl.close?"_dis":"";b.push("<button title='"+this.m_languageMap.close+"' id='re_close"+a+"' onclick=\"m_reportHashMap['"+a+"'].closeReport();return false;\" class='report_menu_button report_menu_close_button "+("report_menu_close_button"+d+c)+"' style='"+(null!=this.close_button?this.close_button:"")+"' "+(this.m_disControl.close?"disabled":"")+"></button>");b.push("</nobr></div>");b.push("</td></tr></table>");b.push("</div>");b.push("<div id='re_paintDiv"+a+"' class='report_paint_div' style='"+((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?this.paintDiv:"")+"' onscroll=\"m_reportHashMap['"+a+"'].pageScrollEvent(event)\" ");if(is_firefox){b.push("onwheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}else{b.push("onmousewheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}b.push("</div>");};Report.prototype.mobileCreateTag=function(b,a){b.push("<div id='re_menu"+a+"' class='mobile_menu_div' style='"+((this.m_isMenu)?"":"height:0px;")+(null!=this.menuDiv?this.menuDiv:"")+"'>");b.push("<table class='report_menu_table' vertical-align='middle'><tr><td class='report_menu_table_td'>");b.push("<div class='mobile_menu_table_td_div'><nobr>");b.push("<button  title='"+this.m_languageMap.pdf_save+"'  id='re_print"+a+"' onclick=\"m_reportHashMap['"+a+"'].printMobileView();return false;\" class='mobile_menu_button "+(this.m_disControl.save?"mobile_menu_dis_print_button":"mobile_menu_print_button")+"' style='"+(null!=this.print_button?this.print_button:"")+"' "+(this.m_disControl.save?"disabled":"")+"></button>");b.push("<button  title='"+this.m_languageMap.first_page+"'  id='re_first"+a+"' onclick=\"m_reportHashMap['"+a+"'].firstPage();return false;\" class='mobile_menu_button "+(this.m_disControl.first?"mobile_menu_dis_leftEnd_button":"mobile_menu_leftEnd_button")+"' style='"+(null!=this.first_button?this.first_button:"")+"' "+(this.m_disControl.first?"disabled":"")+"></button>");b.push("<button  title='"+this.m_languageMap.prv_page+"'  id='re_prev"+a+"' onclick=\"m_reportHashMap['"+a+"'].previousPage();return false;\" class='mobile_menu_button "+(this.m_disControl.prev?"mobile_menu_dis_left_button":"mobile_menu_left_button")+"' style='visibility:hidden;"+(null!=this.prev_button?this.prev_button:"")+"' "+(this.m_disControl.prev?"disabled":"")+"></button>");b.push("<table class='mobile_input_table' style='left:145px' vertical-align='middle'>");b.push("<tr>");b.push("<td class='mobile_input_table_td_input'>");b.push("<input  title='"+this.m_languageMap.page+"'  id='re_input"+a+"' type='text' value='1' class='mobile_menu_pageCount_input' onkeypress=\"enterEvent(event, m_reportHashMap['"+a+"'], this)\" onblur=\"m_reportHashMap['"+a+"'].selectPage(Number(this.value) - 1)\" style='"+(null!=this.input?this.input:"")+"' "+(this.m_disControl.input?"disabled":"")+"/>");b.push("</td>");b.push("<td class='mobile_input_table_td' ");b.push("onclick=\"m_reportHashMap['"+a+"'].mRe_pageCountLabelClick();return false;\">");b.push("<input  title='"+this.m_languageMap.total_page+"'  id='re_totalCountNumber"+a+"' value='"+this.m_TPC.before+"0"+this.m_TPC.after+"' class='mobile_menu_pageCount_span' style='"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' readonly></input><span id='re_totalCount"+a+"' class='mobile_menu_pageCount_span' style='border:0px;"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' "+(this.m_disControl.caption?"disabled":"")+"/>");b.push("<img id='re_progressImg"+a+"' class='report_menu_progress' src='"+progressImg()+"'/></span>");b.push("</td>");b.push("</tr></table>");b.push("<button  title='"+this.m_languageMap.next_page+"'  id='re_next"+a+"' onclick=\"m_reportHashMap['"+a+"'].nextPage();return false;\" class='mobile_menu_button "+(this.m_disControl.next?"mobile_menu_dis_right_button":"mobile_menu_right_button")+"' style='visibility:hidden;"+(null!=this.next_button?this.next_button:"")+"' "+(this.m_disControl.next?"disabled":"")+"></button>");b.push("<button  title='"+this.m_languageMap.last_page+"'  id='re_last"+a+"' onclick=\"m_reportHashMap['"+a+"'].lastPage();return false;\" class='mobile_menu_button "+(this.m_disControl.last?"mobile_menu_dis_rightEnd_button":"mobile_menu_rightEnd_button")+"' style='left:295px;"+(null!=this.last_button?this.last_button:"")+"' "+(this.m_disControl.last?"disabled":"")+"></button>");b.push("<select  title='"+this.m_languageMap.zoomIn+"'  onChange=\"m_reportHashMap['"+a+"'].zoomIn(this)\" name='zoomSelect' id='re_zoomSelect"+a+"' class='mobile_menu_zoom_combo'  style='visibility:hidden;"+(null!=this.zoomCombo?this.zoomCombo:"")+"' "+(this.m_disControl.zoomIn?"disabled":"")+">");this.comboOptionCreateTag(b);b.push("</select>");b.push("<button  title='"+this.m_languageMap.close+"'  id='re_close"+a+"' onclick=\"m_reportHashMap['"+a+"'].closeReport();return false;\" class='mobile_menu_button "+(this.m_disControl.last?"mobile_menu_dis_close_button":"mobile_menu_close_button")+"' style='"+(null!=this.close_button?this.close_button:"")+"' "+(this.m_disControl.close?"disabled":"")+"></button>");b.push("</nobr></div>");b.push("</td></tr></table>");b.push("</div>");b.push("<div id='re_paintDiv"+a+"' class='mobile_paint_div' style='"+((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?this.paintDiv:"")+"' onscroll=\"m_reportHashMap['"+a+"'].pageScrollEvent(event)\" ");if(is_firefox){b.push("onwheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}else{b.push("onmousewheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}b.push("</div>");};Report.prototype.tabletCreateTag=function(b,a){b.push("<div id='re_menu"+a+"' class='mobile_menu_div' style='"+((this.m_isMenu)?"":"height:0px;")+(null!=this.menuDiv?this.menuDiv:"")+"'>");b.push("<table class='report_menu_table' vertical-align='middle'><tr><td class='report_menu_table_td'>");b.push("<div class='mobile_menu_table_td_div'><nobr>");b.push("<button id='re_print"+a+"' onclick=\"m_reportHashMap['"+a+"'].printMobileView();return false;\" class='mobile_menu_button "+(this.m_disControl.save?"mobile_menu_dis_print_button":"mobile_menu_print_button")+"' style='"+(null!=this.print_button?this.print_button:"")+"' "+(this.m_disControl.input?"disabled":"")+"></button>");b.push("<button id='re_first"+a+"' onclick=\"m_reportHashMap['"+a+"'].firstPage();return false;\" class='mobile_menu_button "+(this.m_disControl.first?"mobile_menu_dis_leftEnd_button":"mobile_menu_leftEnd_button")+"' style='"+(null!=this.first_button?this.first_button:"")+"' "+(this.m_disControl.first?"disabled":"")+"></button>");b.push("<button id='re_prev"+a+"' onclick=\"m_reportHashMap['"+a+"'].previousPage();return false;\" class='mobile_menu_button "+(this.m_disControl.prev?"mobile_menu_dis_left_button":"mobile_menu_left_button")+"' style='"+(null!=this.prev_button?this.prev_button:"")+"' "+(this.m_disControl.prev?"disabled":"")+"></button>");b.push("<table class='mobile_input_table' vertical-align='middle'>");b.push("<tr>");b.push("<td class='mobile_input_table_td_input'>");b.push("<input id='re_input"+a+"' type='text' value='1' class='mobile_menu_pageCount_input' onkeypress=\"enterEvent(event, m_reportHashMap['"+a+"'], this)\" onblur=\"m_reportHashMap['"+a+"'].selectPage(Number(this.value) - 1)\" style='"+(null!=this.input?this.input:"")+"' "+(this.m_disControl.input?"disabled":"")+"/>");b.push("</td>");b.push("<td class='mobile_input_table_td' ");b.push("onclick=\"m_reportHashMap['"+a+"'].mRe_pageCountLabelClick();return false;\">");b.push("<input id='re_totalCountNumber"+a+"' value='"+this.m_TPC.before+"0"+this.m_TPC.after+"' class='mobile_menu_pageCount_span' style='"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' readonly></input><span id='re_totalCount"+a+"' class='mobile_menu_pageCount_span' style='border:0px;"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' "+(this.m_disControl.caption?"disabled":"")+"/>");b.push("<img id='re_progressImg"+a+"' class='report_menu_progress' src='"+progressImg()+"'/></span>");b.push("</td>");b.push("</tr></table>");b.push("<button id='re_next"+a+"' onclick=\"m_reportHashMap['"+a+"'].nextPage();return false;\" class='mobile_menu_button "+(this.m_disControl.next?"mobile_menu_dis_right_button":"mobile_menu_right_button")+"' style='"+(null!=this.next_button?this.next_button:"")+"' "+(this.m_disControl.next?"disabled":"")+"></button>");b.push("<button id='re_last"+a+"' onclick=\"m_reportHashMap['"+a+"'].lastPage();return false;\" class='mobile_menu_button "+(this.m_disControl.last?"mobile_menu_dis_rightEnd_button":"mobile_menu_rightEnd_button")+"' style='"+(null!=this.last_button?this.last_button:"")+"' "+(this.m_disControl.last?"disabled":"")+"></button>");b.push("<select onChange=\"m_reportHashMap['"+a+"'].zoomIn(this)\" name='zoomSelect' id='re_zoomSelect"+a+"' class='mobile_menu_zoom_combo'  style='"+(null!=this.zoomCombo?this.zoomCombo:"")+"' "+ +(this.m_disControl.zoomIn?"disabled>":">"));this.comboOptionCreateTag(b);b.push("</select>");b.push("<button id='re_close"+a+"' onclick=\"m_reportHashMap['"+a+"'].closeReport();return false;\" class='mobile_menu_button "+(this.m_disControl.next?"mobile_menu_dis_close_button":"mobile_menu_close_button")+"' style='"+(null!=this.close_button?this.close_button:"")+"' "+(this.m_disControl.close?"disabled":"")+"></button>");b.push("</nobr></div>");b.push("</td></tr></table>");b.push("</div>");b.push("<div id='re_paintDiv"+a+"' class='mobile_paint_div' style='"+((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?this.paintDiv:"")+"' onscroll=\"m_reportHashMap['"+a+"'].pageScrollEvent(event)\" ");if(is_firefox){b.push("onwheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}else{b.push("onmousewheel=\"m_reportHashMap['"+a+"'].pageMousewheelEvent(event)\">");}b.push("</div>");};Report.prototype.comboOptionCreateTag=function(a){if(this.m_comboNames.num50.visible){a.push("<option name='p50' value='0.5' class='report_menu_zoom_combo_option' "+("50%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num50.name+"</option>");}if(this.m_comboNames.num75.visible){a.push("<option name='p75' value='0.75' class='report_menu_zoom_combo_option'  "+("75%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num75.name+"</option>");}if(this.m_comboNames.num100.visible){a.push("<option name='p100' value='1' class='report_menu_zoom_combo_option'  "+("100%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num100.name+"</option>");}if(this.m_comboNames.num125.visible){a.push("<option name='p125' value='1.25' class='report_menu_zoom_combo_option'  "+("125%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num125.name+"</option>");}if(this.m_comboNames.num150.visible){a.push("<option name='p150' value='1.5' class='report_menu_zoom_combo_option'  "+("150%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num150.name+"</option>");}if(this.m_comboNames.num200.visible){a.push("<option name='p200' value='2' class='report_menu_zoom_combo_option'  "+("200%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num200.name+"</option>");}if(this.m_comboNames.num300.visible){a.push("<option name='p300' value='3' class='report_menu_zoom_combo_option'  "+("300%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num300.name+"</option>");}if(this.m_comboNames.num400.visible){a.push("<option name='p400' value='4' class='report_menu_zoom_combo_option'  "+("400%"==this.m_ratio?"selected":"")+">"+this.m_comboNames.num400.name+"</option>");}if(this.m_comboNames.pagewidth.visible){a.push("<option name='pWidth' value='PageWidth'class='report_menu_zoom_combo_option'  "+("PageWidth"==this.m_ratio?"selected":"")+">"+this.m_comboNames.pagewidth.name+"</option>");}if(this.m_comboNames.wholepage.visible){a.push("<option name='pWholePage' value='WholePage'class='report_menu_zoom_combo_option'  "+("WholePage"==this.m_ratio?"selected":"")+">"+this.m_comboNames.wholepage.name+"</option>");}};Report.prototype.setPaintDivEvent=function(c,a){if(is_smartphone){var b=this;c.style.zIndex="100";if(null!=this.m_PageMove&&!this.m_PageMove.ButtonDisabled){if(!this.is_eForm){this.paintDiv.ontouchstart=function(d){if(d.touches.length==1){b.createPageMoveButton("report");}};}}else{if(!this.is_eForm&&!this.m_isSwipe){$(c).bind("swipeleft",function(){if((b.paintDiv.clientWidth+b.paintDiv.scrollLeft+3)>=b.paintDiv.scrollWidth){b.nextPage();}});$(c).bind("swiperight",function(){if(b.paintDiv.scrollLeft==0){b.previousPage();}});}}}};Report.prototype.newReportCreate=function(f,a){var j=null;this.debugMeg("report log :: 리포트를 생성하기 위하여 통신 준비중....");if(a!=null){this.debugMeg("report log :: 사용할 OOF 문서 >>> "+a);if(this.m_isEncode){a=Base64.encode(a);}j="isEncoding="+this.m_isEncode+"&isBigData="+this.m_isBigData+"&isMemoryDump="+this.m_isMemoryDump+"&ClipID=R01&oof="+encodeURIComponent(a);}else{if(this.postData!=null){j=this.postData;}}j=mRe_onBeforeSend(j);this.debugMeg("report log :: 서버 통신 주소  >>> "+f);try{if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var d=new XDomainRequest();var b=f+"?"+j;if(d){d.onload=function(){g.resultNewReport(mRe_onAfterSend(d.responseText));};d.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);};d.open("GET",b);d.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(e){g.resultNewReport(mRe_onAfterSend(e));},error:function(e){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+e);mRe_ReportEventHandler(40);g.endDebugMeg(false);}});}}else{var c=new HttpClient();var i=c.send(f,j,false,null);this.resultNewReport(mRe_onAfterSend(i));}}catch(h){this.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+h.message);mRe_ReportEventHandler(40);this.endDebugMeg(false);}};Report.prototype.resultNewReport=function(a){this.debugMeg("report log :: 리포트 생성 통신 완료..!");var c=objectCall(ClipStrTrim(a));if(typeof c=="string"){c=objectCall(c);}this.m_versionInfo=c.version;this.debugMeg("report log :: 리포트 서버 버전 >>> "+c.version.build);if(typeof window.report_version!="undefined"){this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> "+report_version);}else{this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> 확인불가");}if(c.status){var b=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if(118>Number(b)){this.m_is_serverSaveFile=false;}this.m_uid=c.uid;this.debugMeg("report log :: 리포트 실행 및 키 발행 정상");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.createProgress();}this.checkPageCount();if(c.printerList!=null&&c.printerList.length>0){this.printOptionValue.isNetPrint=true;this.printOptionValue.netPrintList=c.printerList;}}else{this.debugMeg("report log :: 리포트 실행 실패");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.progressImg.style.display="none";}if(c.event>999){this.debugMeg("report log :: 리포트 라이센스 불일치 >>> LE0"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.lic_error+".!! (errorCode : LE0"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{if(c.event<13){this.debugMeg("report log :: 리포트 서버 인스톨 실패 >>> IE00"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.install_error+"!! (errorCode : IE00"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{this.debugMeg("report log :: 리포트 서버에서 리포트 생성중 오류 발생. 서버 로그 확인 필요!!");if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.report_error;}mRe_ReportEventHandler(30);this.endDebugMeg(false);}}}};Report.prototype.checkReportCreate=function(){try{var b=this.m_reportKey;var c=objectCall(ClipStrTrim(b));if(typeof c=="string"){c=objectCall(c);}this.m_versionInfo=c.version;this.debugMeg("report log :: 리포트 서버 버전 >>> "+c.version.build);if(typeof window.report_version!="undefined"){this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> "+report_version);}else{this.debugMeg("report log :: 리포트 웹뷰어 버전 >>> 확인불가");}if(c.status){var a=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if(118>Number(a)){this.m_is_serverSaveFile=false;}this.debugMeg("report log :: 리포트 실행 및 키 발행 정상");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(null!=c.pageNum){this.beforePageIndex=c.pageNum;}if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.createProgress();}this.checkPageCount();if(c.printerList!=null&&c.printerList.length>0){this.printOptionValue.isNetPrint=true;this.printOptionValue.netPrintList=c.printerList;}}else{this.debugMeg("report log :: 리포트 실행 실패");this.debugMeg("report log :: 리포트 키 >>> "+c.uid);this.m_uid=c.uid;m_reportHashMap[c.uid]=this;this.m_languageMap=mRe_report_language(this.m_language);if(this.m_isViewer){this.createView(this.targetDiv,c.uid);this.progressImg.style.display="none";}if(c.event>999){this.debugMeg("report log :: 리포트 라이센스 불일치 >>> LE0"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.lic_error+".!! (errorCode : LE0"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{if(c.event<13){this.debugMeg("report log :: 리포트 서버 인스톨 실패 >>> IE00"+c.event);if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.install_error+"!! (errorCode : IE00"+c.event+")";}mRe_ReportEventHandler(c.event);this.endDebugMeg(false);}else{this.debugMeg("report log :: 리포트 서버에서 리포트 생성중 오류 발생. 서버 로그 확인 필요!!");if(this.m_isViewer){this.paintDiv.innerHTML=this.m_languageMap.report_error;}mRe_ReportEventHandler(30);this.endDebugMeg(false);}}}}catch(d){this.debugMeg("report log :: 웹뷰어 화면을 구성 중 오류 발생 >> "+d.message);mRe_ReportEventHandler(30);this.endDebugMeg(false);}};Report.prototype.selectPage=function(a){if(this.is_eForm){this.EF_DoodlePageSave();}this.m_default_selectPage(a);if(this.is_eForm){if(this.multiView.isSocket){this.multiView.socket.sendPageMove(a);}}};Report.prototype.m_default_selectPage=function(a){var b=this;if(isNaN(a)){this.input.value=this.beforePageIndex+1;if(null!=this.m_PageMove&&is_smartphone){if(!this.m_PageMove.ButtonDisabled){this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}}return;}else{if(a<0||this.m_pageCount<=a||this.beforePageIndex==a){if(null!=this.m_PageMove&&is_smartphone){if(!this.m_PageMove.ButtonDisabled){if(null!=this.m_PageMove.eventKey){b.removePageMoveButton();}}}return;}}if(this.m_isSlidePage){this.m_tempPaintDiv=this.paintDiv;$(this.m_tempPaintDiv).attr("uid",this.m_uid);this.paintDiv=this.m_tempPaintDiv.cloneNode();if(this.beforePageIndex>a){this.paintDiv.style.left="-100%";$(this.m_tempPaintDiv).attr("next","right");}else{this.paintDiv.style.left="100%";$(this.m_tempPaintDiv).attr("next","left");}this.paintDiv.style.width="100%";this.targetDiv.firstChild.appendChild(this.paintDiv);if(this.is_eForm){this.paintDiv.appendChild(this.m_tempPaintDiv.lastChild.cloneNode());this.m_tempPaintDiv.lastChild.lastChild.style.display="block";this.m_tempPaintDiv.firstChild.innerHTML="";}}this.sendData(a);this.input.value=(a+1);this.beforePageIndex=a;};Report.prototype.checkPageCount=function(){var a=this;this.checkCountLoop=window.setTimeout(function(){a.sendToCount();},this.m_pageCountTime);};Report.prototype.mRe_pageCountLabelClick=function(){if(this.m_buttonEvent.startPageCountLabel!=null){this.m_buttonEvent.startPageCountLabel();}};Report.prototype.deleteToReport=function(){this.debugMeg("report log :: deleteToReport 함수 사용");this.debugMeg("report log :: 서버에 만들어진 리포트 파일을 삭제합니다.");window.clearTimeout(this.checkCountLoop);var a="ClipID=R04&uid="+this.m_uid+"&clipUID="+this.m_uid;a=mRe_onBeforeSend(a);var c=this.servletPath;var b;if(-1!=c.indexOf("?")){b=c+"&"+a;}else{b=c+"?"+a;}if(null!=this.deleteImgTag){this.deleteImgTag.src=b;}this.debugMeg("report log :: 삭제 URL >>> "+b);this.endDebugMeg(false);};Report.prototype.sendToCount=function(){this.debugMeg("report log :: 서버에 리포트가 얼만큼 생성중인지 체크....");this.debugMeg("report log :: 서버 통신 주소  >>>>> "+this.servletPath);var e=new Date().getTime();if(this.is_eForm){if(typeof window.onBrokenSendData!="undefined"){var c={type:"pageCheck",uid:this.m_uid,sTime:e};if(!onBrokenSendData(this,c)){return;}}}var c="ClipID=R03&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+e;c=mRe_onBeforeSend(c);var g=this.servletPath;if(this.m_isCrossDomain){var b=this;if(window.XDomainRequest){var a=new XDomainRequest();var d=g+"?"+c;if(-1!=g.indexOf("?")){d=g+"&"+c;}if(a){a.onload=function(){resultPageCountText(mRe_onAfterSend(a.responseText));};a.onerror=function(){b.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);b.endDebugMeg(false);};a.open("GET",d);a.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:c,success:function(h){resultPageCountText(mRe_onAfterSend(h));},error:function(h){b.debugMeg("report log :: 서버 통신 오류 발생 >>> "+h);mRe_ReportEventHandler(40);b.endDebugMeg(false);}});}}else{var f=new HttpClient();var b=this;f.send(g,c,true,function(){if(4==this.readyState){if(200==this.status){resultPageCountText(mRe_onAfterSend(this.responseText));}else{if(b.m_isViewer){b.paintDiv.innerHTML=b.m_languageMap.link_error;}b.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);b.pageSlideShow();mRe_ReportWebLog(this.status);}}});}};Report.prototype.sendData=function(c){this.debugMeg("report log :: 리포트 화면을 호출합니다. 페이지 번호 >>> "+(c+1));this.m_isButtonLock=true;if(this.m_directPrint){return;}if(null!=this.m_syncPageServletPath){this.createPageSyncProgress();}else{if(is_smartphone&&((!this.is_eForm)||(this.is_eForm&&!this.m_isSlidePage))){this.createEditableProgress();}}if(this.m_pageMoveEvent.start!=null){this.m_pageMoveEvent.start();}if(this.is_eForm){this.sendEFormData(c);return;}var j="true";if(is_ie6||is_ie7||is_ie8){if(this.m_isPaintImage){this.debugMeg("report log :: 리포트 화면을 이미지 모드로 사용합니다. (IE 7 ~ 8 전용)");j="false";var l="ClipID=R02&pageNumber="+c+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&html5="+j+"&DPI="+this.m_DPI+"&necessaryCheck="+this.m_necessaryCheck;l=mRe_onBeforeSend(l);if("{clip_enc}"==l){return;}var i=document.createElement("img");if(null!=this.paintDiv.lastChild){var h=this.paintDiv.childNodes.length;for(var b=h-1;b>=0;b--){this.paintDiv.removeChild(this.paintDiv.childNodes[b]);}}this.paintDiv.appendChild(i);i.alt=this.m_languageMap.img_alt;var k=this.m_uid;i.onload=function(){m_reportHashMap[k].onloadImage();};var a=this.servletPath+"?"+l;if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&"+l;}i.src=a;this.pageSlideShow();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);if(this.m_isReportEndFunction!=null){this.m_isReportEndFunction();}this.m_isEndReportEvent=false;}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.endDebugMeg(false);return;}else{this.m_isAccessibility=true;}}var l="ClipID=R02&pageNumber="+c+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&html5="+j+"&DPI="+this.m_DPI+"&Accessibility="+this.m_isAccessibility+"&UseOriginImage="+this.m_isUseOriginImage+"&isChartToImage="+this.m_isChartToImage+"&necessaryCheck="+this.m_necessaryCheck;if(this.m_isAccessibility){l+="&AHname="+encodeURIComponent(Base64.encode(this.servletPath));}l=mRe_onBeforeSend(l);if("{clip_enc}"==l){return;}var g=null!=this.m_syncPageServletPath?this.m_syncPageServletPath:this.servletPath;this.debugMeg("report log :: 리포트 화면을 가져오는 통신을 시도합니다 >>>> "+g);if(this.m_isCrossDomain){var f=this;if(window.XDomainRequest){var e=new XDomainRequest();var a=g+"?"+l;if(-1!=g.indexOf("?")){a=g+"&"+l;}if(e){e.onload=function(){paintReportText(mRe_onAfterSend(e.responseText));};e.onerror=function(){f.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);f.endDebugMeg(false);};e.open("GET",a);e.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:l,success:function(m){paintReportText(mRe_onAfterSend(m));},error:function(m){f.debugMeg("report log :: 서버 통신 오류 발생 >>> "+m);mRe_ReportEventHandler(40);f.endDebugMeg(false);}});}}else{var f=this;var d=new HttpClient();d.send(g,l,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText));}else{f.paintDiv.innerHTML=f.m_languageMap.link_error;f.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);f.endDebugMeg(false);f.pageSlideShow();mRe_ReportWebLog(this.status);}}});}};Report.prototype.sendDataEnc=function(l){var c=this.beforePageIndex;this.debugMeg("report log :: 리포트 화면을 호출합니다. 페이지 번호 >>> "+(c+1));this.m_isButtonLock=true;if(this.m_directPrint){return;}if(this.is_eForm){this.sendEFormData(c);return;}var j="true";if(is_ie6||is_ie7||is_ie8){if(this.m_isPaintImage){this.debugMeg("report log :: 리포트 화면을 이미지 모드로 사용합니다. (IE 7 ~ 8 전용)");j="false";var i=document.createElement("img");if(null!=this.paintDiv.lastChild){var h=this.paintDiv.childNodes.length;for(var b=h-1;b>=0;b--){this.paintDiv.removeChild(this.paintDiv.childNodes[b]);}}this.paintDiv.appendChild(i);i.alt=this.m_languageMap.img_alt;var k=this.m_uid;i.onload=function(){m_reportHashMap[k].onloadImage();};var a=this.servletPath+"?"+l;if(-1!=this.servletPath.indexOf("?")){a=this.servletPath+"&"+l;}i.src=a;this.pageSlideShow();if(this.m_isEndReport&&this.m_isEndReportEvent){if(this.m_endreportprogress.is_visible){this.m_endreportprogress.is_visible=false;this.removeEndReportProgress();}mRe_ReportEventHandler(200);if(this.m_isReportEndFunction!=null){this.m_isReportEndFunction();}this.m_isEndReportEvent=false;}else{if(!this.m_isEndReport){if(this.m_endreportprogress.is_visible){this.createEndReportProgress();}}}this.endDebugMeg(false);if(this.m_pageMoveEvent.end!=null){this.m_pageMoveEvent.end();}return;}else{this.m_isAccessibility=true;}}var g=this.servletPath;this.debugMeg("report log :: 리포트 화면을 가져오는 통신을 시도합니다 >>>> "+g);if(this.m_isCrossDomain){var f=this;if(window.XDomainRequest){var e=new XDomainRequest();var a=g+"?"+l;if(-1!=g.indexOf("?")){a=g+"&"+l;}if(e){e.onload=function(){paintReportText(mRe_onAfterSend(e.responseText));};e.onerror=function(){f.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);f.endDebugMeg(false);if(f.m_pageMoveEvent.end!=null){f.m_pageMoveEvent.end();}};e.open("GET",a);e.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:l,success:function(m){paintReportText(mRe_onAfterSend(m));},error:function(m){f.debugMeg("report log :: 서버 통신 오류 발생 >>> "+m);mRe_ReportEventHandler(40);f.endDebugMeg(false);if(f.m_pageMoveEvent.end!=null){f.m_pageMoveEvent.end();}}});}}else{var f=this;var d=new HttpClient();d.send(g,l,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText));}else{f.paintDiv.innerHTML=f.m_languageMap.link_error;f.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);f.endDebugMeg(false);f.pageSlideShow();if(f.m_pageMoveEvent.end!=null){f.m_pageMoveEvent.end();}mRe_ReportWebLog(this.status);}}});}};Report.prototype.editableControl=function(k){if(this.m_isButtonLock==false){var h=k.getAttribute("type");var i=k.value;var b=k.getAttribute("controlindex");if("text"!=h){i=k.checked+"";if(k.tagName=="SPAN"){var j=k.getAttribute("checkValue");if(j=="true"){i="false";}else{i="true";}}}i=encodeURIComponent(Base64.encode(i));var g=this.m_necessaryCheck;var m={necessaryPage:g,data:new Array()};m.data[Number(b)]=new Object();m.data[Number(b)].type=h;m.data[Number(b)].controlIndex=b;m.data[Number(b)].value=i;var c=new Date().getTime();var l="ClipID=R11&pageNumber="+this.beforePageIndex+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&Accessibility="+this.m_isAccessibility+"&data="+JSON.stringify(m)+"&s_time="+c;if(this.m_isAccessibility){l+="&AHname="+encodeURIComponent(Base64.encode(this.servletPath));}l=mRe_onBeforeSend(l);if(this.m_isCrossDomain){var f=this;if(window.XDomainRequest){var e=new XDomainRequest();var a=servletPath+"?"+l;if(e){e.onload=function(){paintReportText(mRe_onAfterSend(e.responseText));};e.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};e.open("GET",a);e.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:l,success:function(n){paintReportText(mRe_onAfterSend(n));},error:function(n){ReportWebLog(n);mRe_ReportEventHandler(40);}});}}else{var f=this;var d=new HttpClient();d.send(this.servletPath,l,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText));}else{f.paintDiv.innerHTML=f.m_languageMap.link_error;mRe_ReportEventHandler(40);f.pageSlideShow();mRe_ReportWebLog(this.status);}}});}this.createEditableProgress();k.style.zIndex="0";}};Report.prototype.webLinkControl=function(){if(arguments.length>1){var f=arguments[0];var b=arguments[1];var a=document.createElement("form");document.body.appendChild(a);var e=null;var h=f.split("?");switch(h.length){case 2:e=h[1];var l=e.split("&");for(var g=0;g<l.length;g++){var k=l[g].split("=");var d=document.createElement("input");d.type="hidden";d.name=k[0];d.value=k[1];a.appendChild(d);}f=h[0];a.method="post";a.action=f;break;case 1:f=h[0];a.method="post";a.action=f;break;default:break;}if("self"==b){a.target="_self";}else{if("blank"==b){a.target="_blank";}else{if("window"==b){if(is_ie11||is_edge){a.target="_blank";}else{var c=new Date().getTime();var j="report_SubWindow"+c;window.open("",j,"height="+arguments[3]+",width="+arguments[2]);a.target=j;window.setTimeout(function(){a.submit();document.body.removeChild(a);},1000);return;}}else{a.target=arguments[2];}}}a.submit();document.body.removeChild(a);}};Report.prototype.drilingControl=function(i){if(this.m_isButtonLock==false){var f=this.m_necessaryCheck;var g={necessaryPage:f,data:new Array()};g.data[0]=new Object();g.data[0].driling=true;g.data[0].value=i;this.m_drilingTop=this.paintDiv.scrollTop;var b=new Date().getTime();var h="ClipID=R11&pageNumber="+this.beforePageIndex+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&Accessibility="+this.m_isAccessibility+"&data="+JSON.stringify(g)+"&s_time="+b;h=mRe_onBeforeSend(h);if(this.m_isCrossDomain){var e=this;if(window.XDomainRequest){var d=new XDomainRequest();var a=servletPath+"?"+h;if(d){d.onload=function(){e.resultNewReport(mRe_onAfterSend(d.responseText));};d.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};d.open("GET",a);d.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:h,success:function(j){paintReportText(mRe_onAfterSend(j));},error:function(j){ReportWebLog(j);mRe_ReportEventHandler(40);}});}}else{var e=this;var c=new HttpClient();c.send(this.servletPath,h,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText));}else{e.paintDiv.innerHTML=e.m_languageMap.link_error;mRe_ReportEventHandler(40);e.pageSlideShow();mRe_ReportWebLog(this.status);}}});}this.createEditableProgress();}};Report.prototype.editableKeyEvent=function(a,c){if(c.keyCode==13){if(c.ctrlKey){var d=a.value;if(typeof a.selectionStart=="number"&&typeof a.selectionEnd=="number"){var e=a.selectionStart;a.value=d.slice(0,e)+"\n"+d.slice(a.selectionEnd);a.selectionStart=a.selectionEnd=e+1;}else{if(document.selection&&document.selection.createRange){a.focus();var b=document.selection.createRange();b.text="\r\n";b.collapse(false);b.select();}}return;}a.blur();if(c.preventDefault){c.preventDefault();}c.returnValue=false;}};Report.prototype.onloadImage=function(){this.zoomIn(this.zoomCombo);};Report.prototype.paintReport=function(){if(4==this.readyState){if(200==this.status){paintReportText(this.responseText);}else{this.paintDiv.innerHTML=this.m_languageMap.link_error;mRe_ReportEventHandler(40);this.pageSlideShow();mRe_ReportWebLog(this.status);}}};Report.prototype.resultDeleteReport=function(){if(4==this.readyState){if(200==this.status){var a=this.responseText;var b=objectCall(ClipStrTrim(a));if(typeof b=="string"){b=objectCall(b);}try{if(!b.status){mRe_ReportEventHandler(50);}}catch(c){mRe_ReportEventHandler(50);mRe_ReportWebLog(this.status);}}}};Report.prototype.selectPrintOption=function(a){mRe_setLocalStorage("mRe_print_report",a.value);this.printOptionValue.localStorage=a.value;this.mRe_selectPrintOption(a.value);};Report.prototype.zoomIn=function(e){if(this.m_buttonEvent.startZoomInSelect!=null){var q=this.m_buttonEvent.startZoomInSelect();if(q!=true){return;}}if(!is_svg&&this.m_isPaintImage&&null==this.pageWidth){var h=this.paintDiv.firstChild;if(null!=h&&"IMG"==h.tagName){if(40>h.offsetWidth||40>h.offsetHeight){var m=this;window.setTimeout(function(){m.zoomIn(e);},200);return;}this.pageWidth=h.offsetWidth;this.pageHeight=h.offsetHeight;}}var f=e.value;var k;if(is_ie){this.paintDiv.firstChild.style.visibility="hidden";}if("PageWidth"==f){if(!is_smartphone){this.paintDiv.style.overflowX="hidden";this.paintDiv.style.overflowY="auto";}var b=this.paintDiv.clientWidth;k=b/Number(this.pageWidth);if(is_android_mobile44&&k<0.5){k=0.55;}}else{if("WholePage"==f){if(!is_smartphone){this.paintDiv.scrollTop=0;if(!is_ie){this.paintDiv.style.overflowX="hidden";this.paintDiv.style.overflowY="hidden";}else{this.paintDiv.style.overflowX="visible";this.paintDiv.style.overflowY="visible";}}var b=this.paintDiv.clientWidth;var a=this.paintDiv.clientHeight;var p=b/Number(this.pageWidth);var d=a/Number(this.pageHeight);k=p>d?d:p;}else{this.paintDiv.style.overflowX="auto";this.paintDiv.style.overflowY="auto";k=f;}}this.eFormDoodleOption.zoomIn=Re_zoom.rate=Number(k);if(!is_svg&&this.m_isPaintImage){var h=this.paintDiv.firstChild;if(null!=h&&"IMG"==h.tagName){if("PageWidth"==f){h.setAttribute("width","100%");h.removeAttribute("height");}else{if("WholePage"==f){h.removeAttribute("width");h.setAttribute("height","100%");}else{if(k==1){h.removeAttribute("width");h.removeAttribute("height");}else{h.setAttribute("width",Number(this.pageWidth)*Number(k));h.setAttribute("height",Number(this.pageHeight)*Number(k));}}}}}else{if(this.m_isAccessibility&&!this.is_eForm){var c=this.paintDiv.firstChild;if(null!=c){c.style.zoom=k;if(is_firefox){var n=this.paintDiv.clientWidth;c.style.MozTransform="scale("+k+")";c.style.MozTransformOrigin="0 0 0";c.style.position="absolute";var j=c.clientWidth*Number(k);var i=0;if(n-j>0){i=(n-j)/2;}c.style.left=i+"px";}else{if(is_ie9){c.style.position="absolute";}}}}else{var g=this.paintDiv.firstChild.firstChild;if(null!=g){g.setAttribute("width",Number(this.pageWidth)*Number(k));g.setAttribute("height",Number(this.pageHeight)*Number(k));if(null!=g.lastChild){g.lastChild.setAttribute("transform","scale("+k+") translate(0,0)");}if(is_apple){if(1>Number(k)){g.setAttribute("text-rendering","geometricPrecision");}else{g.setAttribute("text-rendering","auto");}}if(is_edge){var r=this.targetDiv;if("hidden"!=r.style.visibility){window.setTimeout(function(){r.style.visibility="";window.setTimeout(function(){r.style.visibility="visible";},200);},200);}}}var l=this.paintDiv.firstChild.nextSibling;if(null!=l){l.style.zoom=k;if(is_smartphone){l.style.display="block";l.style.position="absolute";var s=l.offsetWidth*k;if((s)>this.paintDiv.offsetWidth){l.style.left="0px";}else{var o=((this.paintDiv.offsetWidth-s)/2)/k;l.style.left=o+"px";}}if(is_firefox){l.style.MozTransform="scale("+k+")";l.style.MozTransformOrigin="0 0 0";l.style.position="absolute";window.m_firefox_Rescale=k;var m=this;if(null==this.m_firefox_Reevent){this.m_firefox_Reevent=true;window.addEventListener("resize",function(){var t=m.paintDiv.clientWidth;var v=l.clientWidth*Number(m_firefox_Rescale);var u=0;if(t-v>0){u=(t-v)/2;}l.style.left=u+"px";},false);}var n=this.paintDiv.clientWidth;var j=l.clientWidth*Number(k);var i=0;if(n-j>0){i=(n-j)/2;}l.style.left=i+"px";}}}}if(is_ie){this.paintDiv.firstChild.style.visibility="visible";}if(this.is_eForm){this.zoomChangeEForm();}};Report.prototype.pageScrollEvent=function(a){if(this.is_eForm){this.pageScrollEFormEvent(a);}};Report.prototype.pageMousewheelEvent=function(f){if(this.is_eForm){var e=f.srcElement;if(e.tagName!="TEXTAREA"&&e.tagName!="INPUT"){if(this.m_isInputFocus){if(null!=this.m_focusInputDOM){this.m_focusInputDOM.blur();}}}}if(this.m_scrollEv.isScrollPaging){var d=this.paintDiv;if(null!=d){var a=d.clientHeight;var c=d.scrollHeight;var h=d.scrollTop;var b=d.style.overflowY;if(d.scrollTop==0){var g=0;if(is_firefox){g=f.deltaY;if(g>0){g=-1;}else{if(g<0){g=1;}}}else{g=f.wheelDelta;}if(g>0){this.previousPage();if(f.preventDefault){f.preventDefault();}f.returnValue=false;}}if(null!=a&&null!=c&&(b=="hidden"||((a+10)>c))){var g=0;if(is_firefox){g=f.deltaY;if(g>0){g=-1;}else{if(g<0){g=1;}}}else{g=f.wheelDelta;}if(g>0){this.previousPage();}else{if(g<0){this.nextPage();}}if(f.preventDefault){f.preventDefault();}f.returnValue=false;}else{if(null!=a&&null!=c&&(b=="auto"&&((h+a+5)>c))){var g=0;if(is_firefox){g=f.deltaY;if(g>0){g=-1;}else{if(g<0){g=1;}}}else{g=f.wheelDelta;}if(g<0){if(this.m_scrollEv.isBottomEvent==null){this.m_scrollEv.isBottomEvent=true;}else{if(this.m_scrollEv.isBottomEvent){this.m_scrollEv.isBottomEvent=null;this.nextPage();}}if(f.preventDefault){f.preventDefault();}f.returnValue=false;}}}}}};Report.prototype.pageSlideShow=function(){if(this.m_isSlidePage&&null!=this.m_tempPaintDiv){this.m_tempPaintDiv.style.overflow="hidden";var b=$(this.m_tempPaintDiv).attr("next");var a=this;if("right"==b){$(this.m_tempPaintDiv).animate({left:"100%",width:"100%"},700,function(){try{a.targetDiv.firstChild.removeChild(this);a.m_tempPaintDiv=null;}catch(c){mRe_ReportWebLog(c.message);}});}else{$(this.m_tempPaintDiv).animate({left:"-100%",width:"100%"},700,function(){try{a.targetDiv.firstChild.removeChild(this);a.m_tempPaintDiv=null;}catch(c){mRe_ReportWebLog(c.message);}});}$(this.paintDiv).animate({left:"0%",width:"100%",opacity:1},700,function(){a.m_isButtonLock=false;});}else{this.m_isButtonLock=false;}};Report.prototype.disabledMenu=function(a){if(!this.m_disControl.save&&null!=this.save_button){this.save_button.disabled=a;}if(!this.m_disControl.print&&null!=this.print_button){this.print_button.disabled=a;}if(!this.m_disControl.input&&null!=this.input){this.input.disabled=a;}if(!this.m_disControl.caption&&null!=this.totalCountText){this.totalCountText.disabled=a;}if(!this.m_disControl.zoomIn&&null!=this.zoomCombo){this.zoomCombo.disabled=a;}if(!this.m_disControl.first&&null!=this.first_button){this.first_button.disabled=a;}if(!this.m_disControl.prev&&null!=this.prev_button){this.prev_button.disabled=a;}if(!this.m_disControl.next&&null!=this.next_button){this.next_button.disabled=a;}if(!this.m_disControl.last&&null!=this.last_button){this.last_button.disabled=a;}if(!this.m_disControl.pdf&&null!=this.pdf_button){this.pdf_button.disabled=a;}if(!this.m_disControl.excel&&null!=this.excel_button){this.excel_button.disabled=a;}if(!this.m_disControl.hwp&&null!=this.hwp_button){this.hwp_button.disabled=a;}if(!this.m_disControl.doc&&null!=this.doc_button){this.doc_button.disabled=a;}if(!this.m_disControl.reportInfo&&null!=this.reportInfo_button){this.reportInfo_button.disabled=a;}if(!this.m_disControl.doodle&&null!=this.doodle_button){this.doodle_button.disabled=a;}if(!this.m_disControl.setting&&null!=this.setting_button){this.setting_button.disabled=a;}};Report.prototype.reportInfo=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var a=document.createElement("div");a.className="report_view_box report_info_view_position";var b=new Array();b.push("<div style='position:absolute;left:15px;right:15px;top:20px;bottom:40px;border:1px solid darkgray'>");b.push("<div class='report_view_cliplogo' style='position:absolute;left:8px;top:12px;height:30%;width:45%;background-color: white;border-style:double;'></div>");b.push("<div style='position:absolute;right:8px;top:18px;height:25%;width:45%;'>");b.push(this.m_languageMap.version+" : "+this.m_languageMap.clipReport+" 4.0("+this.m_versionInfo.build+")<br>");if(typeof window.report_version!="undefined"){b.push(this.m_languageMap.webversion+" : "+report_version+" <br>");}else{b.push(this.m_languageMap.webversion+" : unknown <br>");}b.push(this.m_languageMap.build+" : "+this.m_versionInfo.day);b.push("</div>");b.push("<div style='position:absolute;left:8px; right:8px;top:43%;height:50%;'>");b.push("Copyright (C) 2011 CLIPSOFT Co., Ltd. All Rights Reserved.<br>");b.push("http://www.clipsoft.co.kr<br><br>");b.push(this.m_languageMap.report_info_text);b.push("</div></div>");b.push("<span class='report_view_box' style='position:absolute;left:20px;top:13px;border:0;'>"+this.m_languageMap.report_info+"</span>");b.push("<button title='"+this.m_languageMap.ok+"' onclick=\"mRe_closeReportInfo('"+this.m_uid+"');return false;\" class='report_view_button' style='bottom:5px;right:15px;height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");a.innerHTML=b.join("");b=null;this.m_reportInfo_view=a;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(a);}};Report.prototype.checkPrintCount=function(){var a=this.printOptionValue.domList;if(null!=a){return(this.printOptionValue.endNum-this.printOptionValue.startNum)+1;}return this.m_pageCount;};Report.prototype.checkPrintHTMLView=function(){if(null==this.m_limitedPrint){this.m_limitedPrint=100;}if(this.m_pageCount>this.m_limitedPrint){this.printLimitedExportView("html");return;}this.mRe_printHTMLView();};Report.prototype.mRe_printHTMLFormSubmit=function(){var d={reportkey:this.m_uid};var a=document.createElement("form");var e=document.createElement("input");e.name="ClipID";e.value="R09S3";var c=document.createElement("input");c.name="ClipType";c.value="HTMLPrintDownload";var b=document.createElement("input");b.name="ClipData";b.value=JSON.stringify(d);a.appendChild(e);a.appendChild(c);a.appendChild(b);this.targetDiv.appendChild(a);a.method="post";a.encoding="application/x-www-form-urlencoded";a.action=this.servletPath;if(this.m_isPopupSaveDownload){a.target="_blank";}else{a.target="re_target"+this.m_uid;}a.style.display="none";a.submit();this.targetDiv.removeChild(a);};Report.prototype.mRe_printHTMLResult=function(a){var b=jQuery.parseJSON(a);if(null!=b){switch(b.id){case 6:if(b.resValue.status){this.fileCheckSend("htmlprint");}else{ReportWebLog("html print server error code>>"+b.resValue.event);this.removePrintProgress();mRe_ReportEventHandler(102);}break;}}else{ReportWebLog("html print error >>"+a);this.removePrintProgress();mRe_ReportEventHandler(102);}};Report.prototype.mRe_printHTMLView=function(){this.createPrintProgress();var c=1;var b=this.m_pageCount;if(this.printOptionValue.domList!=null){c=this.printOptionValue.startNum;b=this.printOptionValue.endNum;}try{var h="ClipID=R09S1&ClipType=HTMLPrint&ClipData=";var g={reportkey:this.m_uid,startNum:c,endNum:b,pageWidth:this.m_printPage.pageWidth,pageHeight:this.m_printPage.pageHeight,isIE:is_ie,isFirefox:is_firefox,isSafari:is_safari};var a=this;var d=this.servletPath;h=mRe_onBeforeSend(h+encodeURIComponent(JSON.stringify(g)));$.ajax({type:"POST",url:d,data:h,success:function(e){a.mRe_printHTMLResult(mRe_onAfterSend(e));},error:function(e){a.removePrintProgress();mRe_ReportEventHandler(102);}});}catch(f){this.removePrintProgress();mRe_ReportEventHandler(102);}};Report.prototype.mRe_printHTMLViewEnd=function(a){this.removePrintProgress();if(!a){mRe_ReportEventHandler(102);}};Report.prototype.mRe_printHWPView=function(){this.createPrintProgress();try{if(is_ie){if(null==this.hwp_object){var c=document.createElement("div");c.innerHTML=mRe_HWPFrame_Object();this.hwp_object=c.firstChild;this.targetDiv.appendChild(this.hwp_object);c=null;}var b="";if(-1!=this.servletPath.indexOf("?")){b=servletPath+"&";}else{b=this.servletPath+"?";}var a="ClipID=R07&uid="+this.m_uid+"&clipUID="+this.m_uid+"&fileName=report.hwp&print=print&path="+escape(this.clientPath)+"&optionValue="+this.checkPrintJsonOption();this.hwp_object.Open(b+a);this.hwp_object.printDocument();this.removePrintProgress();}else{this.formTag_clipid.value="R07";this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag.action=this.servletPath;this.formTag.target="_blank";this.formTag.submit();}}catch(d){this.removePrintProgress();mRe_ReportEventHandler(101);}};Report.prototype.mRe_printEXEView=function(){this.debugMeg("report log ::  EXE Print 인쇄를 시작합니다. >>>>>>>>>>>>>>>");if(this.m_isViewer){this.createPrintProgress();}try{var c=this.servletPath;if(!this.m_exePrintStatus.isSet){this.m_exePrintOption.startNumber=this.printOptionValue.startNum;this.m_exePrintOption.endNumber=this.printOptionValue.endNum;}if(is_chrome58||"http:"==location.protocol.toLocaleLowerCase()){this.m_exePrintStatus.url="http://127.0.0.1:";this.m_exePrintStatus.port=this.m_exePrintStatus.httpPort;}else{this.m_exePrintStatus.url="https://127.0.0.1:";this.m_exePrintStatus.port=this.m_exePrintStatus.httpsPort;}var h="";if(-1!=this.servletPath.indexOf("?")){h=this.servletPath+"&";}else{h=this.servletPath+"?";}this.debugMeg("report log :: EXE Print 인쇄하기 위하여 통신 준비중....");h+="ClipID=S01";this.debugMeg("report log :: 서버 통신 주소  >>> "+h);var j=new HttpClient();var n="";var a=true;if(typeof getExePrintUseCookie!="undefined"){a=getExePrintUseCookie();}if(a){h=mRe_onBeforeSend(h);n=j.send(h,"",false,null);n=ClipStrTrim(mRe_onAfterSend(n));}this.debugMeg("report log :: 리포트 생성 통신 완료..!");this.debugMeg("report log :: 쿠키정보 체크 >>> "+n);var m=this;if(typeof window.exe_print_version!="undefined"){this.debugMeg("report log :: exe Print version >>> "+exe_print_version);}else{this.debugMeg("report log :: exe Print version >>> 확인불가");exe_print_version="1.0.0.1";}var k=this.beforePageIndex+1;var i={cookie:encodeURIComponent(n),serverPath:encodeURIComponent(c),ClipID:"P01",uid:m.m_uid,version:exe_print_version,currentPage:k,totalPageCount:m.m_pageCount,printSet:m.m_exePrintOption};var g="option="+JSON.stringify(i);this.debugMeg("report log :: 프린트 설정 정보 >>> "+g);this.endDebugMeg(true);this.m_exePrintStatus.disConnectCount=0;this.m_exePrintStatus.intervalKey=window.setInterval(function(){if(3==m.m_exePrintStatus.disConnectCount){window.clearInterval(m.m_exePrintStatus.intervalKey);if(m.m_isViewer){m.removePrintProgress();}m.notFoundEXEService(false);mRe_ReportEventHandler(103);}},1500);if(window.XDomainRequest){var s=new XDomainRequest();if(s){try{s.onload=function(){m.startEXEPrintResponse(s.responseText);};s.onerror=function(){m.m_exePrintStatus.disConnectCount++;};s.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[0]+"?"+g);s.send();}catch(f){mRe_ReportWebLog(f.message);}}var r=new XDomainRequest();if(r){try{r.onload=function(){m.startEXEPrintResponse(r.responseText);};r.onerror=function(){m.m_exePrintStatus.disConnectCount++;};r.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[1]+"?"+g);r.send();}catch(f){mRe_ReportWebLog(f.message);}}var q=new XDomainRequest();if(q){try{q.onload=function(){m.startEXEPrintResponse(q.responseText);};q.onerror=function(){m.m_exePrintStatus.disConnectCount++;};q.open("GET",this.m_exePrintStatus.url+this.m_exePrintStatus.port[2]+"?"+g);q.send();}catch(f){mRe_ReportWebLog(f.message);}}}else{var l="POST";if(typeof getExePrintAjaxType!="undefined"){l=getExePrintAjaxType();}for(var d=0;d<this.m_exePrintStatus.port.length;d++){var b=this.m_exePrintStatus.port[d];var p=this.m_exePrintStatus.url+b;$.ajax({type:l,url:p,crossDomain:true,data:g,success:function(e){m.startEXEPrintResponse(e);},error:function(e){m.m_exePrintStatus.disConnectCount++;}});}}}catch(o){if(this.m_isViewer){this.removePrintProgress();}mRe_ReportEventHandler(104);}};Report.prototype.mRe_printView=function(){this.createPrintProgress();var b="R08";if(this.m_is_serverSaveFile){b="R09S1";}var a=new Date().getTime();var d="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isPDFPrintImage="+this.isPDFPrintImage+"&print=print&path="+escape(this.clientPath)+"&isChromePrintFitToPage="+this.isChromePrintFitToPage+"&optionValue="+encodeURIComponent(this.checkPrintJsonOption())+"&s_time="+a;if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(d)){this.mRe_print_progress_check();}else{this.debugMeg("report log :: 서버에 프린트 파일(pdf) 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var c=true;if(window.onSaveBeforeSend!=null){c=onSaveBeforeSend(this,d,"pdf");}if(c){this.mRe_printView_demon();}}};function onSaveBeforeSend(a,c,b){return true;}Report.prototype.mRe_printView_demon=function(){if(m_report_printOption.acrobat){if(is_firefox||is_window_safari){this.removePrintProgress();this.printFirefoxExportView();}else{if(is_chrome||is_opera){if("Chrome PDF Viewer"==m_report_printOption.acrobatVersion||"Chromium PDF Viewer"==m_report_printOption.acrobatVersion){var a="({'url':'"+this.servletPath+"','uid':'"+this.m_uid+"','isPDFPrintImage':'"+this.isPDFPrintImage+"','isChromePrintFitToPage':'"+this.isChromePrintFitToPage+"','clientPath':'"+this.clientPath+"','optionValue':";a+=this.checkPrintJsonOption()+"})";var c=document.getElementById("re_iframe2"+this.m_uid);var b=c.contentWindow;if(!this.isMakePDFFrame){b.document.write(getPDFPrintFrame(this.m_is_serverSaveFile));this.isMakePDFFrame=true;}b.postMessage(a,"*");}else{this.removePrintProgress();this.printFirefoxExportView();}}else{if(is_ie||is_ie11){if(is_win78_reader9&&this.adobe9Permission){this.printIEWindow();}else{if(is_win78_reader9||is_reader8){this.removePrintProgress();if(!this.m_directPrint){this.printIEExportView();}mRe_ReportEventHandler(150);}else{this.printIEWindow();}}}}}}else{if(this.m_isPrintPop&&this.m_ignorePDFObject){this.debugMeg("report log :: IE브라우져에서 추가기능에 adobe reader 사용을 확인 하셔야 합니다.");this.debugMeg("report log :: pdf 다운로드 팝업으로 변경되었습니다.");this.printIEWindow();}else{if(is_edge){this.removePrintProgress();this.printEdgeExportView();}else{if(is_mozBrowser||is_safari){this.removePrintProgress();this.printFirefoxExportView();}else{this.removePrintProgress();if(!this.m_directPrint){this.printNotExportView();}mRe_ReportEventHandler(100);}}}}};Report.prototype.printIEWindow=function(){var f="R08";if(this.m_is_serverSaveFile){f="R09S3";}if(this.m_isPrintPop){this.formTag_clipid.value=f;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value=new Date().getTime();if(null==this.formTag){var g=document.createElement("form");this.targetDiv.appendChild(g);g.appendChild(this.formTag_clipid);g.appendChild(this.formTag_uid);g.appendChild(this.formTag_clipUID);g.appendChild(this.formTag_print);g.appendChild(this.formTag_printImage);g.appendChild(this.formTag_path);g.appendChild(this.formTag_option);g.appendChild(this.formTag_ChromeFitToPage);g.appendChild(this.formTag_s_time);g.style.display="none";g.encoding="application/x-www-form-urlencoded";g.method="post";this.formTag=g;}this.formTag.action=this.servletPath;if(this.m_isPopupSaveDownload){this.formTag.target="_blank";}else{this.formTag.target="re_target"+this.m_uid;}this.formTag.submit();var a=this;if(!this.m_is_serverSaveFile){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}}else{var h=document.getElementById("re_object"+this.m_uid);if(null==h){var e=document.createElement("div");e.style.cssText="postion:absolute;left:0px;top:0px;width:1px;height:1px;border:0px solid transparent";var d="<object id='re_object"+this.m_uid+"' classid='CLSID:CA8A9780-280D-11CF-A24D-444553540000' type='application/pdf' style='position:absolute;left:0px;top:0px;width:1px;height:1px;display:none;'></object>";e.innerHTML=d;if(this.m_directPrint){document.body.appendChild(e);}else{this.targetDiv.appendChild(e);}h=e.firstChild;}var c=this.servletPath+"?";if(-1!=this.servletPath.indexOf("?")){c=this.servletPath+"&";}var b=new Date().getTime();h.src=c+"ClipID="+f+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isPDFPrintImage="+this.isPDFPrintImage+"&print=print&path="+escape(this.clientPath)+"&isChromePrintFitToPage="+this.isChromePrintFitToPage+"&optionValue="+encodeURIComponent(this.checkPrintJsonOption())+"&s_time="+b;h.style.display="block";CReportPrintPDf(this.m_uid);}};Report.prototype.next_printPdfDownLoad=function(){if(this.fileDownLoding){this.debugMeg("report log :: 다른 파일 저장중입니다..파일 저장을 종료합니다.");this.endDebugMeg(true);return;}var a="R09";var e="R09";if(this.m_is_serverSaveFile){a="R09S1";e="R09S3";}this.fileDownLoding=true;var c=this;var d=this.m_uid;this.debugMeg("report log :: PDF 파일 저장 시작..");if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=e;this.saveFormTag.uid.value=d;this.saveFormTag.clipUID.value=d;this.saveFormTag.path.value=this.clientPath;var h=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var g={exportType:2,name:h,pageType:1,startNum:this.printOptionValue.startNum,endNum:this.printOptionValue.endNum,option:{isSplite:false,spliteValue:1,fileNames:null,userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false}};var f=null;if(this.m_saveDirectPDFOp!=null){f=this.m_saveDirectPDFOp;}else{if((typeof window.getDirectSavePDFOption!="undefined")){f=getDirectSavePDFOption();}}if(f!=null){if("cmVwb3J0"==h){g.name=Base64.encode(f.fileName);}g.option.isSplite=f.isSplite;g.option.spliteValue=f.spliteValue;g.option.userpw=f.userpw;g.option.textToImage=f.textToImage;g.option.importOriginImage=f.importOriginImage;g.option.removeHyperlink=f.removeHyperlink;}this.saveFormTag.option.value=JSON.stringify(g);this.saveFormTag.filename.value=g.name;this.saveFormTag.filetype.value=g.exportType;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var i="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(g))+"&exportN="+g.name+"&exportType="+g.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(i)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,i,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_pdfDownLoad=function(){if(this.fileDownLoding){this.debugMeg("report log :: 다른 파일 저장중입니다..파일 저장을 종료합니다.");this.endDebugMeg(true);return;}var b="R09";var f="R09";if(this.m_is_serverSaveFile){b="R09S1";f="R09S3";}this.fileDownLoding=true;var d=this;var e=this.m_uid;this.debugMeg("report log :: PDF 파일 저장 시작..");if(this.m_isEndReport&&is_smartphone){this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=e;this.saveFormTag.clipUID.value=e;this.saveFormTag.path.value=this.clientPath;var i=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var h={exportType:2,name:i,pageType:1,startNum:1,endNum:this.m_pageCount,option:{isSplite:false,spliteValue:1,fileNames:null,userpw:""}};var a=JSON.stringify(h);this.saveFormTag.option.value=a;this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var c=true;if(window.onSaveBeforeSend!=null){c=onSaveBeforeSend(this,j,"mobile_pdf");}if(c){this.mRe_mobilePDF_demon();this.mRe_saveFile_progress_check();}}}else{if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=f;this.saveFormTag.uid.value=e;this.saveFormTag.clipUID.value=e;this.saveFormTag.path.value=this.clientPath;var i=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var h={exportType:2,name:i,pageType:1,startNum:1,endNum:this.m_pageCount,option:{isSplite:false,spliteValue:1,fileNames:null,userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false}};var g=null;if(this.m_saveDirectPDFOp!=null){g=this.m_saveDirectPDFOp;}else{if((typeof window.getDirectSavePDFOption!="undefined")){g=getDirectSavePDFOption();}}if(g!=null){if("cmVwb3J0"==i){h.name=Base64.encode(g.fileName);}h.option.isSplite=g.isSplite;h.option.spliteValue=g.spliteValue;h.option.userpw=g.userpw;h.option.textToImage=g.textToImage;h.option.importOriginImage=g.importOriginImage;h.option.removeHyperlink=g.removeHyperlink;}this.saveFormTag.option.value=JSON.stringify(h);this.saveFormTag.filename.value=h.name;this.saveFormTag.filetype.value=h.exportType;this.debugMeg("report log :: PDF 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var j="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(h))+"&exportN="+h.name+"&exportType="+h.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(j)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var c=true;if(window.onSaveBeforeSend!=null){c=onSaveBeforeSend(this,j,"save");}if(c){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}}window.setTimeout(function(){d.fileDownLoding=false;},2000);};Report.prototype.mRe_mobilePDF_demon=function(){if(-1!=this.servletPath.indexOf("?")){window.open(this.servletPath+"&"+m_getSaveFormTag(this.saveFormTag));}else{this.saveFormTag.form.action=this.servletPath;this.saveFormTag.form.target="blank";this.saveFormTag.form.submit();}optionValue=null;if(report.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){report.fileCheckSend("pdf");},1000);}};Report.prototype.next_hwpDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var e="R09";if(this.m_is_serverSaveFile){a="R09S1";e="R09S3";}var c=this;this.debugMeg("report log :: HWP 파일 저장 시작..");this.fileDownLoding=true;if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=e;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var h=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var g={exportType:3,name:h,pageType:1,startNum:1,endNum:this.m_pageCount,option:{fixSize:true,allowOverlay:true,setPageBottomMarginToZero:true,outputLikeWord:false,tableSplitMethod:2,defaultCharGap:-8,charRatio:100,putCheckboxIntoCell:false,splitTextByLine:true,mergeTable:false,lineSpaceRate:100,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100}};var f=null;if(this.m_saveDirectHWPOp!=null){f=this.m_saveDirectHWPOp;}else{if((typeof window.getDirectSaveHWPOption!="undefined")){f=getDirectSaveHWPOption();}}if(f!=null){if("cmVwb3J0"==h){g.name=Base64.encode(f.fileName);}g.option.splitPage=d;g.option.fixSize=f.fixSize;g.option.allowOverlay=f.allowOverlay;g.option.setPageBottomMarginToZero=f.setPageBottomMarginToZero;g.option.pageBottomMarginApplicationRate=f.pageBottomMarginApplicationRate;g.option.outputLikeWord=f.outputLikeWord;g.option.tableSplitMethod=f.tableSplitMethod;g.option.defaultCharGap=f.defaultCharGap;g.option.charRatio=f.charRatio;g.option.putCheckboxIntoCell=f.putCheckboxIntoCell;g.option.splitTextByLine=f.splitTextByLine;g.option.mergeTable=f.mergeTable;g.option.lineSpaceRate=f.lineSpaceRate;g.option.positionRelTo=f.positionRelTo;g.option.hwpExportMethod=f.hwpExportMethod;g.option.splitPageOnListTableOnly=f.splitPageOnListTableOnly;}this.saveFormTag.option.value=JSON.stringify(g);this.saveFormTag.filename.value=g.name;this.saveFormTag.filetype.value=g.exportType;this.debugMeg("report log :: HWP 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var i="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(g))+"&exportN="+g.name+"&exportType="+g.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(i)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,i,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_docDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var e="R09";if(this.m_is_serverSaveFile){a="R09S1";e="R09S3";}var c=this;this.debugMeg("report log :: DOC 파일 저장 시작..");this.fileDownLoding=true;if(this.m_isEndReport){this.createSAVEProgress();this.saveFormTag.clipid.value=e;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var h=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var g={exportType:9,name:h,pageType:1,startNum:1,endNum:this.m_pageCount,option:{type:"doc",splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false}};var f=null;if(this.m_saveDirectDOCOp!=null){f=this.m_saveDirectDOCOp;}else{if((typeof window.getDirectSaveDOCOption!="undefined")){f=getDirectSaveDOCOption();}}if(f!=null){if("cmVwb3J0"==h){g.name=Base64.encode(f.fileName);}g.option.splitPage=d;g.option.type=f.type;g.option.splitTextLine=f.splitTextLine;g.option.processAsUnicode=f.processAsUnicode;g.option.processEqualAlign=f.processEqualAlign;g.option.defaultCharSpace=f.defaultCharSpace;g.option.tableWrapperBottomGap=f.tableWrapperBottomGap;g.option.insertTableWrapper=f.insertTableWrapper;g.option.mergeTable=f.mergeTable;}this.saveFormTag.option.value=JSON.stringify(g);this.saveFormTag.filename.value=g.name;this.saveFormTag.filetype.value=g.exportType;this.debugMeg("report log :: DOC 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var i="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(g))+"&exportN="+g.name+"&exportType="+g.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(i)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,i,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.next_excelDownLoad=function(){if(this.fileDownLoding){return;}var a="R09";var e="R09";if(this.m_is_serverSaveFile){a="R09S1";e="R09S3";}var c=this;this.fileDownLoding=true;if(this.m_isEndReport){this.printOptionValue.domList=null;this.debugMeg("report log :: EXCEL 파일 저장 시작..");this.createSAVEProgress();this.saveFormTag.clipid.value=e;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;var h=Base64.encode(this.m_strFileName+this.m_strAppendFileName);var d=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;var g={exportType:1,name:h,pageType:1,startNum:1,endNum:this.m_pageCount,option:{exportMethod:"1",mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false,type:"xls"}};var f=null;if(this.m_saveDirectExcelOp!=null){f=this.m_saveDirectExcelOp;}else{if((typeof window.getDirectSaveEXCELOption!="undefined")){f=getDirectSaveEXCELOption();}}if(f!=null){if("cmVwb3J0"==h){g.name=Base64.encode(f.fileName);}g.option.splitPage=d;g.option.exportMethod=f.exportMethod;g.option.mergeCell=f.mergeCell;g.option.mergeEmptyCell=f.mergeEmptyCell;g.option.splitCellAtPageSize=f.splitCellAtPageSize;g.option.rightToLeft=f.rightToLeft;g.option.widthRate=f.widthRate;g.option.heightRate=f.heightRate;g.option.coordinateErrorLimit=f.coordinateErrorLimit;g.option.processGerenalFormat=f.processGerenalFormat;g.option.printingMagnification=f.printingMagnification;g.option.fitToPageWhenPrinting=f.fitToPageWhenPrinting;g.option.removeHyperlink=f.removeHyperlink;g.option.repeatPageSectionWhenAllSectionInOneSheet=f.repeatPageSectionWhenAllSectionInOneSheet;}this.saveFormTag.option.value=JSON.stringify(g);this.saveFormTag.filename.value=g.name;this.saveFormTag.filetype.value=g.exportType;this.debugMeg("report log :: EXCEL 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));var i="ClipID="+a+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(g))+"&exportN="+g.name+"&exportType="+g.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(i)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,i,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){c.fileDownLoding=false;},2000);};Report.prototype.fileCheckSendText=function(a,c){var b=this;var d=objectCall(ClipStrTrim(a));if(typeof d=="string"){d=objectCall(d);}if(d.status){if("xls"==c){this.removeEXCELProgress();}else{if("hwp"==c){this.removeHWPProgress();}else{if("save"==c){if(this.m_is_serverSaveFile){this.mRe_saveFile_demon();}window.setTimeout(function(){b.removeSAVEProgress();},1500);}else{if("pdf"==c){this.removePDFProgress();}else{if("print"==c){if(this.m_is_serverSaveFile){this.mRe_printView_demon();}window.setTimeout(function(){b.removePrintProgress();},1500);}else{if("htmlprint"==c){if(this.m_is_serverSaveFile){this.mRe_printHTMLFormSubmit();}window.setTimeout(function(){b.removePrintProgress();},1500);}}}}}}this.endDebugMeg(false);}else{this.fileDownloadCheckTimer=window.setTimeout(function(){b.fileCheckSend(c);},1000);}};Report.prototype.fileCheckSendErrorText=function(a){if("xls"==a){this.removeEXCELProgress();}else{if("hwp"==a){this.removeHWPProgress();}else{if("save"==a){this.removeSAVEProgress();}else{if("pdf"==a){this.removePDFProgress();}else{if("print"==a){this.removePrintProgress();}}}}}};Report.prototype.fileCheckSend=function(i){var b="R16";if(this.m_is_serverSaveFile||"htmlprint"==i){b="R09S2";}try{var c=new Date().getTime();var k="ClipID="+b+"&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+c;k=mRe_onBeforeSend(k);var g=this.servletPath;if(this.m_isCrossDomain){var h=this;if(window.XDomainRequest){var f=new XDomainRequest();var a=g+"?"+k;if(-1!=g.indexOf("?")){a=g+"&"+k;}if(f){f.onload=function(){h.fileCheckSendText(mRe_onAfterSend(f.responseText),i);};f.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};f.open("GET",a);f.send();}}else{$.ajax({type:"POST",url:g,crossDomain:true,data:k,success:function(e){h.fileCheckSendText(mRe_onAfterSend(e),i);},error:function(e){ReportWebLog(e);mRe_ReportEventHandler(40);}});}}else{var h=this;var d=new HttpClient();d.send(g,k,true,function(){if(4==this.readyState){if(200==this.status){h.fileCheckSendText(mRe_onAfterSend(this.responseText),i);}else{h.fileCheckSendErrorText(i);}}});}}catch(j){mRe_ReportWebLog(j.message);}};Report.prototype.reportCheckSendText=function(a,b){var d=objectCall(ClipStrTrim(a));if(typeof d=="string"){d=objectCall(d);}if(d.status){this.debugMeg("report log :: 서버연결 상태 정상...!");if(0==b){this.saveExportView();}else{if(1==b){this.next_pdfDownLoad();}else{if(2==b){this.next_excelDownLoad();}else{if(3==b){this.next_hwpDownLoad();}else{if(4==b){this.selectPrintView();}else{if(5==b){this.next_docDownLoad();}else{if(6==b){this.mRe_printView(true);}else{if(7==b){this.printHTMLView(true);}else{if(8==b){this.printEXEView(true);}else{if(9==b){this.printHWPView(true);}}}}}}}}}}}else{this.debugMeg("report log :: 서버에서 생성된 리포트 파일을 찾을 수 없습니다.");this.debugMeg("report log :: 이중화 서버로 인한 파일을 찾지 못하거나 세션이 종료되어 리포트파일이 삭제된 것 같습니다.");this.endDebugMeg(false);var c=this.m_languageMap.sesstion_error;this.paintDiv.innerHTML=c;mRe_ReportEventHandler(60);}};Report.prototype.reportCheckSend=function(i){try{this.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");var b=new Date().getTime();var j="ClipID=R16&aliveReport=true&uid="+this.m_uid+"&clipUID="+this.m_uid+"&s_time="+b;j=mRe_onBeforeSend(j);var f=this.servletPath;if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var d=new XDomainRequest();var a=f+"?"+j;if(-1!=f.indexOf("?")){a=f+"&"+j;}if(d){d.onload=function(){g.reportCheckSendText(mRe_onAfterSend(d.responseText),i);};d.onerror=function(){g.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");g.debugMeg("report log :: 시도한 연결 정보 >>> "+a);g.endDebugMeg(true);mRe_ReportEventHandler(40);};d.open("GET",a);d.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(e){g.reportCheckSendText(mRe_onAfterSend(e),i);},error:function(e){ReportWebLog(e);g.debugMeg("report log :: 서버와의 연결상태를 확인합니다....");g.debugMeg("report log :: 시도한 연결 정보 >>> "+a);g.endDebugMeg(true);mRe_ReportEventHandler(40);}});}}else{var g=this;var c=new HttpClient();c.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){g.reportCheckSendText(mRe_onAfterSend(this.responseText),i);}}});}}catch(h){this.debugMeg("report log :: 스크립트 오류 발생....");this.debugMeg(h.message);this.endDebugMeg(true);}};Report.prototype.createPageMoveButton=function(f){var b=this;if(this.m_PageMove.eventKey==null){var a=this.paintDiv.offsetHeight;var e=((a/2)-25)+this.menuDiv.offsetHeight;var c=document.createElement("div");var d=document.createElement("div");this.targetDiv.appendChild(c);this.targetDiv.appendChild(d);c.className=f+"_pageMoveLeft";d.className=f+"_pageMoveRight";if(c.offsetHeight!=null&&c.offsetHeight>0){e=((a/2)-(c.offsetHeight/2))+this.menuDiv.offsetHeight;}c.style.top=e+"px";c.onclick=function(){b.removePageMoveButton();b.previousPage();};d.style.top=e+"px";d.onclick=function(){b.removePageMoveButton();b.nextPage();};this.m_PageMove.leftDOM=c;this.m_PageMove.rightDOM=d;this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}else{window.clearTimeout(this.m_PageMove.eventKey);this.m_PageMove.eventKey=window.setTimeout(function(){b.removePageMoveButton();},2000);}if(this.beforePageIndex==0){if(null!=this.m_PageMove.leftDOM){this.m_PageMove.leftDOM.style.display="none";}}else{if(this.beforePageIndex+1>=this.m_pageCount){if(null!=this.m_PageMove.rightDOM){this.m_PageMove.rightDOM.style.display="none";}}else{if(null!=this.m_PageMove.leftDOM){this.m_PageMove.leftDOM.style.display="";this.m_PageMove.rightDOM.style.display="";}}}};Report.prototype.removePageMoveButton=function(){try{this.targetDiv.removeChild(this.m_PageMove.leftDOM);this.targetDiv.removeChild(this.m_PageMove.rightDOM);}catch(a){mRe_ReportWebLog(a.message);}if(null!=this.m_PageMove.eventKey){window.clearTimeout(this.m_PageMove.eventKey);this.m_PageMove.eventKey=null;}this.m_PageMove.leftDOM=null;this.m_PageMove.rightDOM=null;};function enterEvent(c,a,b){if(c.keyCode==13){a.selectPage(parseInt(b.value)-1);if(c.preventDefault){c.preventDefault();}c.returnValue=false;}}function CReportPrintPDf(b){var c=document.getElementById("re_object"+b);if(typeof c.print==="undefined"){setTimeout(function(){CReportPrintPDf(b);},1000);}else{var a=m_reportHashMap[b];if(a.isEnabledAdobeRead){a.isEnabledAdobeRead=false;if(!a.m_isMarkAny){c.printWithDialog();}if(!a.m_is_serverSaveFile){a.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}}}}function progressImg(){return"data:image/gif;base64,R0lGODlhFAAUAPf/AOXm5t7e39fY2dDS08rKzMDBxMDAw7y9v6eprP7+/vn5+f39/fr6+vf39/z8/M/Q0fv7+8PExvT19Y2Pk9XV19XW1/Hx8peZnKKkp5aYm4KFiYCDh/j4+O/v8Onp6uzs7d/f4O/w8Ofn6Pb29vT09O/v7/Pz9Ovs7PLy8tzc3ff4+NbX2OLj5K+ws5udobO1t+rq67q7vcXGyKSmqfDw8b/AwqOlqOLi46GjptfX2a2usa6vst7f4Ly+wISHiomLj8nJy3x/g7Gzta2vsoeJjfP09PX19pSWmenq6+3u7pGTl8vNzri6vLi5vPDx8aKjpomMj+Pj5d/g4cfJy9XX2KiqrKanqtvc3ZGUl8zNz3t+gubn6LCytJWXmsnJzOXl5tDQ0oqMj8bGyOTk5dPT1LS2uefo6d3e34+RlKqsr66vsenq6pmcntXV1v39/sjJyqOlqaWnqtfZ2tjY2sHCxdbW2OTl5oiLj4SHi5manpudoJ+go5KVmOzt7YCChvX19ejo6eHh4t3d3vn5+vT09fHx8eDg4ePj5Pn6+ubm5+Li5PHy8u7u7/j4+fDw8L6/we3t7fv7/MnKzOvr7Le4u/f3+MfJyuHh48HCxN7e4O3t7sjJy/r6+4iLjsfIyvj5+fz8/ebn58bHyd7d3+Pk5fPz8/r7+9DR09PU1c7P0OHi4ouNkdPT1d3d35WYm9vb3dvb3IqMkJaYmv39/MbHyt/f4dbX2cPDxejn6cTGyOjp6crLzcTFxpOVmOzs7NTV19rb27y9wNzd3dna2+bm6P7//rO1uP38/fz9/YGDiLW3uZOWmZaXmpmbnu7v74CCh4CDhuPj4+Tk5urr67a3uba3utHS1JqcoPr5+r+/woSGioWHi9DR0rK0t7O0trO0t42Qk9zc3tzd3s7Q0erq6tnZ29LT1eHg4vb29+Lh4/b39+np6cDCw7W2ue7v8Ojp6rm6vZibnp+gpN3f38vMzo6QlIOFiXx+gqqsrra4uuDh4drb3J6go+rr7P///////yH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OURCMjcyODkyMjkwMTFFNEI1ODFFNjRBODJEMDY0MzciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OURCMjcyODgyMjkwMTFFNEI1ODFFNjRBODJEMDY0MzciIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmRpZDpENTI4MTc0MDkwMjJFNDExQUNGQTg4Q0I2MjI3RDI4OSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpENTI4MTc0MDkwMjJFNDExQUNGQTg4Q0I2MjI3RDI4OSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQzMjEwLy4tLCsqKSgnJiUkIyIhIB8eHRwbGhkYFxYVFBMSERAPDg0MCwoJCAcGBQQDAgEAACH5BAUAAP8ALAAAAAAUABQAAAjlAP8JHDjQAQSCCAk6KJFAoD9/A+VISChQwShNDiH+CxVkDUWBjF4t+PeQZL0yCSH8cRhI0T8FDP7tguJAIIkGAqPAm1fTASSCLH4mSOGDicAE+h4VIPRRhZ4fdEYOZLAi1McPTSx83JqQwhAhCDJxPZGGy44HQHDEaVaBqx0XcJ5E4EpX4II2Wz6iIKOAoD8pFyaY+ViEz4QVGudoeGHkHwMPBGmMeDllQw+BEkQM3GPlH5Io/95gafgPhpOEPPzEZDPhX4IwMrZy0CBGoBoMAm9oKfGxQQ3SNi44jNCh7r8Hcz8GBAAh+QQFAAD/ACwBAAAADwALAAAIZgD/CRwosNAHggQhjBk4JtBABQ4GNmjHQiCgLwIj+RtEUJUygYpA/EvgL6ICCwMNEPhXSNM/B/4W/KNAZAmEfwpIEeTgT6CbLGgylEA4cIQLgQ1iXCEq8ATTpwOriIQ6ME8dqv8CAgAh+QQFAAD/ACwEAAAADwALAAAIYgD/CRQIoNXAg/8YVBhoqcDAEAwGStiASuADSQI5CCJ0EIy2BP8wxfjnr1YihP+O4PvnQdG/DqMGQnAg0IStgyjQCUTkT8G/ECgFJpjlL4G/oAMZJACJtKnTaQhaOBU4ZmBAACH5BAUAAP8ALAYAAAAOAA4AAAhmAP8JrCBJoMGD/gRiyGAQgIqDVAS2mCHwz7cQB/EI7BJG4KMBBwXq+Hfm1z8WTRwIVABBYI6DJ1AILAQiUciDC9KBEKHypsARiUb4HEpUICJ/SBcQZYDUn9KiUP89qBT1yKpTSgMCACH5BAUAAP8ALAoAAAAKABIAAAhiAL38G0iwIEE5EgwOTBLEQ0EoA5UYM0jh34NOBNUpIHio30BAlFgZhBAhxgqFi6wVUcjS4B8PHkR0MGjh0Jgxk1oqhGBqAUt/QBElKGjinwMG/hgUVEIQUaSCsXLpvOesYEAAIfkEBQAA/wAsCgACAAoAEQAACF8A/wkUuGagwX9lDg68M5BEg4Es+ghM4YPJQQ4uftSAcPBDvhAKQx608MBaqksHT/Da5GmYSIUcHDkIqeCcoQ7+BnJK8A/CCRC4/gX6lyCnwD8cDPoDJbIoA5GDOA4MCAAh+QQFAAD/ACwGAAYADgAOAAAIagD/CRwoUIWef3QWEFz4r4kFhhAjLpyUhsuOBxJJXbPxJILEjwONjIEAskG2HsQGviPYwME/BuGoVfgnD8e/QY3+wTA0kMaff88a/PPn79+CFB8WshNIVKAjQUIHuhxa9F8CciogLlAYMSAAIfkEBQAA/wAsBAAJAA8ACwAACGYA/wkcSPDfiYIIB9pxASehQ4GJHC4io2DgF4elek1Y8W/EP38VB5Jg8E+BpQ09BBZz8I8Ein/7Hg2E4eTfAn8L/t0AIZBSCoIO/IESCOjiP13dTAx0oCCBwDGBBPorR8Kho0kOAwIAIfkEBQAA/wAsAQAJABAACwAACGIA/wnkIbCgQYMzZJk7yLChQ4P+EnxyiKLgAn/+jjkswuffJ38MIPxzQMhgiBECpywYVDDaoX8dPvwThaVhKVgCbx0Q2EnGQQYBZP5L5UlgJi0lDEJYV3ATpoIROjxUBYxhQAAh+QQFAAD/ACwAAAYADgAOAAAIZQD/QRAF7sK/gwgTHvzjTZjChxATRvJHEUJEgRT9YbvIEWICSCYuJmAUyFCDiyVAfFEgMERCGgcZEEIoY9c/D4f+vXmI5AWyf/Em/EsQJqGCaoIO6sBw8IbRHP4O2jDY8UEEhAEBACH5BAUAAP8ALAAAAgALABEAAAhpAP8J/Eco2cCDA8dtQ7iA08BlCAf5a7TgXweECRr524hw4AJTDTqKHEgDECARhTp+GPPly8WRMAUuuJFEpIgCwRZ1/EKJW6V/Cjwc5OBuID8r/5BEQcgDGoN/bBBy0CBGoBqEDWokOBgQACH5BAUAAP8ALAAAAQALABAAAAhhAP8J/LdAwcCDAhn4S4DwIAR//v4xE+hAhcAEEP+J+/WPkSFfDv75a4Dwg6pLHBoKhOChhMqX/6SlOkXPQ0NBtCTJ+AKzp0BUW1QKcjXBTEMB9l4Y+ccAoQQRA/f09HMwIAA7";}function receiveMessage(b){var a=m_reportHashMap[b.data];if(null!=a){a.removePrintProgress();}}function mRe_closeReportInfo(b){var a=m_reportHashMap[b];a.targetDiv.removeChild(a.m_popupViewDiv);a.m_reportInfo_view=null;a.m_popupViewDiv=null;a.disabledMenu(false);}function mRe_ReportEventHandler(a){if(null!=typeof window.ReportEventHandler!="undefined"){ReportEventHandler(a);}else{if(typeof window.console!="undefined"){window.console.log("Report Code : "+a);}}}function mRe_getLocalStorage(a){if(is_svg){if(typeof(Storage)!=="undefined"){var b=null;try{if(null!=localStorage){b=localStorage.getItem(a);}}catch(c){ReportWebLog("Web Storage unavailable!!");}if(b==null){return"0";}return b;}else{return"0";}}return"0";}function mRe_setLocalStorage(a,b){if(is_svg){if(typeof(Storage)!=="undefined"){try{if(null!=localStorage){localStorage.setItem(a,b);}}catch(c){ReportWebLog("Web Storage unavailable!!");}}}}function mRe_HWPFrame_Object(){var a="<object id='re_hwp_object' classid='CLSID:BD9C32DE-3155-4691-8972-097D53B10052' style='position:absolute;left:0px;top:0px;width:0px;height:0px;display:none;'><PARAM NAME='_Version' VALUE='65536'><PARAM NAME='_ExtentX' VALUE='21167'><PARAM NAME='_ExtentY' VALUE='15875'><PARAM NAME='_StockProps' VALUE='0'><PARAM NAME='FILENAME' VALUE=''></object>";return a;}function clearListCookies(a){}function paintReportText(k){if("{clip_enc}"==k){return;}if(0==k.indexOf('"')){k=k.substring(1,k.length-1);}var d=k.split("{clipreport_separator}");var i=objectCall(ClipStrTrim(d[0]));if(typeof d=="string"){d=objectCall(d);}var c=m_reportHashMap[i.uid];c.debugMeg("report log :: 리포트 페이지 서버 수신 완료...");try{if(i.status){c.debugMeg("report log :: 리포트 페이지 서버 수신 완료 메시지 >>> "+d[0]);if(null!=i.event){if(18==i.event){c.debugMeg("report log :: 리포트 서버의 사용자가 많아서 화면 호출을 다시 시도 합니다.");window.setTimeout(function(){c.sendData(c.beforePageIndex);},300);return;}if(29==i.event){c.debugMeg("report log :: 리포트 페이지를 서버에서 로드하지 못했습니다. temp폴더에 리포트가 생성되었는지 확인이 필요합니다.");return;}}if(null!=i.pageWidth){c.m_printPage.pageWidth=i.pageWidth;c.m_printPage.pageHeight=i.pageHeight;}if(null!=i.reportName){var b=ClipStrTrim(i.reportName);if(""!=b){c.m_strFileName=b;}}if(!c.m_isAccessibility){c.debugMeg("report log :: 리포트 화면를 SVG로 표현!");c.paintDiv.innerHTML=unescape(d[1]);c.paintDiv.firstChild.firstChild.style.overflow="hidden";c.pageWidth=c.paintDiv.firstChild.firstChild.getAttribute("width");c.pageHeight=c.paintDiv.firstChild.firstChild.getAttribute("height");c.zoomIn(c.zoomCombo);c.setPaintDivEvent(c.paintDiv,i.uid);c.pageSlideShow();}else{c.debugMeg("report log :: 리포트 화면를 접근성 뷰어로 표현!");var m=d[1];var h=document.getElementsByTagName("head")[0];var a=h.lastChild;if(a.tagName!="STYLE"||a.getAttribute("id")!="report_css"){var j=document.createElement("style");j.setAttribute("type","text/css");j.setAttribute("id","report_css");h.appendChild(j);a=j;}if(a.styleSheet){a.styleSheet.cssText=m;}else{a.innerHTML="";var g=document.createTextNode(m);a.appendChild(g);}c.paintDiv.innerHTML=unescape(d[2]);c.pageWidth=c.paintDiv.firstChild.clientWidth;c.pageHeight=c.paintDiv.firstChild.clientHeight;c.zoomIn(c.zoomCombo);c.setPaintDivEvent(c.paintDiv,i.uid);c.pageSlideShow();}if(c.m_isEndReport&&c.m_isEndReportEvent){if(c.m_endreportprogress.is_visible){c.m_endreportprogress.is_visible=false;c.removeEndReportProgress();}mRe_ReportEventHandler(200);if(c.m_isReportEndFunction!=null){c.m_isReportEndFunction();}c.m_isEndReportEvent=false;c.debugMeg("report log :: 리포트 뷰어 종료!");c.endDebugMeg(false);}else{if(!c.m_isEndReport){if(c.m_endreportprogress.is_visible){c.createEndReportProgress();}}}if(null==c.m_drilingTop){if((is_smartphone&&c.m_mobile.scrollTop)||(!is_smartphone&&c.m_pcView.scrollTop)||c.m_scrollEv.isScrollPaging){c.paintDiv.scrollTop=1;}}else{c.paintDiv.scrollTop=c.m_drilingTop;c.m_drilingTop=null;}c.endDebugMeg(true);}else{c.debugMeg("report log :: 리포트 생성중 오류 발생(export) >>> 서버로그 확인 필요!");c.debugMeg("report log :: 리포트 페이지 서버 수신 메시지 >>> "+d[0]);var l=c.m_languageMap.report_error;if(i.event==11){c.debugMeg("report log :: EFORM 사용 권한이 없습니다 (라이센스)");if(c.m_isViewer){l=c.m_languageMap.lic_error+".!! (errorCode : LE0"+i.event+")";mRe_ReportEventHandler(11);}}else{mRe_ReportEventHandler(30);if(i.event==60){l=c.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);c.debugMeg("report log :: 리포트서버와의 세션 종료!");}}c.paintDiv.innerHTML=l;c.pageSlideShow();}}catch(f){c.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+k);c.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+f.message);c.paintDiv.innerHTML=c.m_languageMap.report_error;mRe_ReportEventHandler(30);c.pageSlideShow();}if(c.m_pageMoveEvent.end!=null){c.m_pageMoveEvent.end();}}function resultPageCountText(a){var f=objectCall(ClipStrTrim(a));if(typeof f=="string"){f=objectCall(f);}var b=m_reportHashMap[f.uid];b.debugMeg("report log :: 서버 수신 완료...");try{if(f.status){if(b.m_isViewer){var c=b.m_pageCount;if(b.m_pageCount<=f.count){c=f.count;}b.totalCountText.value=b.m_TPC.before+c+b.m_TPC.after;}if(f.endReport){b.debugMeg("report log :: 서버에서 리포트 생성은 완료..! ");b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);if(f.count>0){b.m_isEndReport=true;if(!b.m_isViewer){b.m_pageCount=f.count;b.m_disControl.print=false;b.printEXEView();return;}else{if(b.m_directPrint){b.m_pageCount=f.count;b.m_directPrintOp.endReport=true;return;}}if(b.m_isViewer){if(b.is_eForm){if(b.beforePageIndex<f.count){b.input.value=b.beforePageIndex+1;}else{b.beforePageIndex=0;}}b.sendData(b.beforePageIndex);b.progressImg.style.display="none";}}else{b.debugMeg("report log :: 보고서 양식이 잘못되었습니다.(페이지가 없습니다.)");if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=b.m_languageMap.report_error2;}mRe_ReportEventHandler(30);b.endDebugMeg(false);}b.m_pageCount=f.count;}else{if(null!=f.is_s){if(f.is_s){b.debugMeg("report log :: 리포트 생성중 (양호)");}else{b.debugMeg("report log :: 리포트 생성중 (경고) 서버에서 생성중인 리포트를 세션에서 찾지 못했습니다. 파일 탐색으로 변경되었습니다.");b.debugMeg("report log :: 계속해서 똑같은 결과가 내려온다면 이중화된 서버 가능성이 있습니다.");b.debugMeg("report log :: 리포트를 생성한 서버와 확인작업을 위해 통신으로 접속한 서버가 다를 수 있습니다.");b.debugMeg("report log :: 서버관리자에게 문의 하여 하나의 세션이 생성됐을 때 그 서버만 바라보도록 하거나 리포트 설정 폴더를 물리적으로 같은 폴더로 사용하도록 변경이 필요합니다.");}}else{b.debugMeg("report log :: 리포트 생성중 (양호)");}b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);if(b.m_isViewer){if(b.m_pageCount==0&&f.count!=0&&!b.is_eForm){b.sendData(0);}}if(b.m_pageCount<=f.count){b.m_pageCount=f.count;}b.checkPageCount();}}else{var d=b.m_languageMap.report_error;mRe_ReportEventHandler(30);b.debugMeg("report log :: 리포트 생성중 오류 발생(engine) >>> 서버로그 확인 필요!");if(f.event==60){d=b.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);b.debugMeg("report log :: 리포트서버와의 세션 종료!");}b.endDebugMeg(false);if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=d;}}}catch(g){b.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+a);b.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+g.message);if(b.m_isViewer){b.progressImg.style.display="none";b.paintDiv.innerHTML=b.m_languageMap.report_error;}mRe_ReportEventHandler(30);b.endDebugMeg(false);}}function m_getSaveFormTag(a){var b=a.clipid.name+"="+a.clipid.value+"&";b+=a.uid.name+"="+a.uid.value+"&";b+=a.clipUID.name+"="+a.clipUID.value+"&";b+=a.path.name+"="+escape(a.path.value)+"&";b+=a.option.name+"="+a.option.value+"&";b+="is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple))+"&";b+="exportN="+a.filename.value+"&";b+="exportType="+a.filetype.value+"&";return b;}function ClipStrTrim(a){return a.replace(/^\s+|\s+$/gm,"");}function mRe_onBeforeSend(a){if(typeof window.onBeforeSend!="undefined"){return onBeforeSend(a);}return a;}function mRe_onAfterSend(a){if(typeof window.onAfterSend!="undefined"){return onAfterSend(a);}return a;}function objectCall(b){if(b.charAt(0)=="("){b=b.substring(1,b.length-1);b=b.replace(/\'/g,'"');}var a=jQuery.parseJSON(b);return a;}function reportJsonDelete(c){if(null!=c){var a=m_reportHashMap[c];if(null!=a){for(var b in a){a[b]=null;delete a[b];}a=null;m_reportHashMap[c]=null;}}else{ReportWebLog("reportJsonDelete in strReportKey null!!");}}function mRe_ReportWebLog(a){if(typeof window.console!="undefined"){window.console.log(a);}}var mRe_blankImg="iVBORw0KGgoAAAANSUhEUgAAAKoAAACqCAYAAAA9dtSCAAADLElEQVR4Xu3SAQ0AAAjDMO7fNDqWFAXP6M4pECiwwEYTFThQIUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28yUhQGUgUADXxJiNBZSBRANTEm4wElYFEAVATbzISVAYSBUBNvMlIUBlIFAA18SYjQWUgUQDUxJuMBJWBRAFQE28yElQGEgVATbzJSFAZSBQANfEmI0FlIFEA1MSbjASVgUQBUBNvMhJUBhIFQE28ycgH1oEAq7aSdTsAAAAASUVORK5CYII=";var mRe_whiteImg="/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKAP/2Q==";Report.prototype.setIsPopUpSaveDownload=function(a){if(is_ie){this.m_isPopupSaveDownload=a;}};Report.prototype.setChangeTxtExtension=function(a){this.m_txtExtension=a;};Report.prototype.setSyncPageServerPath=function(a){this.m_syncPageServletPath=a;};Report.prototype.setIsRedBC=function(a){this.m_isRedBC=a;};Report.prototype.setSelectSavePageType=function(a){switch(a){case 1:this.m_selectPageType.save=1;break;case 2:this.m_selectPageType.save=2;break;case 3:this.m_selectPageType.save=3;break;default:break;}};Report.prototype.setSelectPrintPageType=function(a){switch(a){case 1:this.m_selectPageType.print=1;break;case 2:this.m_selectPageType.print=2;break;case 3:this.m_selectPageType.print=3;break;default:break;}};Report.prototype.setPDFPrintAlertCloseButtonEvent=function(a){this.m_buttonEvent.PDFPrintAlertCloseButton=a;};Report.prototype.setSavingFileOption=function(a){this.m_is_serverSaveFile=a;};Report.prototype.setSplitPage=function(a){this.m_splitPage=a;};Report.prototype.setIgnorePDFObject=function(a){this.m_ignorePDFObject=a;};Report.prototype.setHtmlPrintInfo=function(a){this.m_html_info=a;};Report.prototype.setCrossChromePDFPrint=function(a){this.m_isCrossDomainPDF=a;};Report.prototype.setPrintOkButtonEvent=function(a){this.m_buttonEvent.printOkButton=a;};Report.prototype.setPrintCancelButtonEvent=function(a){this.m_buttonEvent.printCancelButton=a;};Report.prototype.setEFormSignPositionFix=function(a){is_PosiFix=a;};Report.prototype.visiblePageMoveButton=function(a){this.removePageMoveButton();if(a){if(this.is_eForm){this.createPageMoveButton("eform");}else{this.createPageMoveButton("report");}}};Report.prototype.setPageCountLabelEvent=function(a){this.m_buttonEvent.startPageCountLabel=a;};Report.prototype.setReportMobilePageMoveButtonDisabled=function(a){this.m_PageMove.ButtonDisabled=a;};Report.prototype.setEndDrawPageEvent=function(a){this.m_pageMoveEvent.end=a;};Report.prototype.setStartDrawPageEvent=function(a){this.m_pageMoveEvent.start=a;};Report.prototype.setStartZoomInSelectEvent=function(a){this.m_buttonEvent.startZoomInSelect=a;};Report.prototype.setStartLastPageButtonEvent=function(a){this.m_buttonEvent.startLastButton=a;};Report.prototype.setStartNextPageButtonEvent=function(a){this.m_buttonEvent.startNextButton=a;};Report.prototype.setStartPreviousPageButtonEvent=function(a){this.m_buttonEvent.startPrevButton=a;};Report.prototype.setStartFirstPageButtonEvent=function(a){this.m_buttonEvent.startFirstButton=a;};Report.prototype.setSwipeDisiabled=function(a){this.m_isSwipe=a;};Report.prototype.setEndPrintProgressEvent=function(a){this.m_endPrintProgressEvent=a;};Report.prototype.getTotalPageCount=function(){return this.m_pageCount;};Report.prototype.getSelectPageNumber=function(){return this.beforePageIndex+1;};Report.prototype.setEFormDoodlePenColor=function(c,a,b){this.eFormDoodleOption.pens.width=c;this.eFormDoodleOption.pens.color=a;this.eFormDoodleOption.pens.op=b;this.eFormDoodleOption.tempPens.width=c;this.eFormDoodleOption.tempPens.color=a;this.eFormDoodleOption.tempPens.op=b;};Report.prototype.transFormREPORT=function(){alert("지원하지 않습니다.");};Report.prototype.transFormEFORM=function(){alert("지원하지 않습니다.");};Report.prototype.exePrintVersionInfo=function(a){exe_print_version=a;};Report.prototype.setExePrintFinishEvent=function(a){this.m_exePrintEvent.ok=a;};Report.prototype.setExePrintCancelEvent=function(a){this.m_exePrintEvent.cancel=a;};Report.prototype.setEXEPrintDownloadLink=function(a){this.m_exeLink=a;};Report.prototype.exePrint=function(d,e,c,f,a,g,b){this.m_exePrintStatus.isSet=true;this.m_exePrintOption.isPrintPopup=d;this.m_exePrintOption.printName=e;this.m_exePrintOption.tray=c;this.m_exePrintOption.startNumber=f;this.m_exePrintOption.endNumber=a;this.m_exePrintOption.copies=g;this.m_exePrintOption.option=b;this.printEXEView();};Report.prototype.exeDirectPrint=function(){var d,e,c,f,a,g,b;if(arguments.length==7){d=arguments[0];e=arguments[1];c=arguments[2];f=arguments[3];a=arguments[4];g=arguments[5];b=arguments[6];}else{d=false;e=arguments[0];c=arguments[1];f=arguments[2];a=arguments[3];g=arguments[4];b=arguments[5];}this.m_exePrintStatus.isSet=true;this.m_exePrintOption.isPrintPopup=d;this.m_exePrintOption.printName=e;this.m_exePrintOption.tray=c;this.m_exePrintOption.startNumber=f;this.m_exePrintOption.endNumber=a;this.m_exePrintOption.copies=g;this.m_exePrintOption.option=b;this.printEXEDirect();};Report.prototype.setPrintSelectNames=function(b,a){b=b.toLowerCase();if("pdf"==b){this.printNames.pdf=a;}else{if("html"==b){this.printNames.html=a;}else{if("hwp"==b){this.printNames.hwp=a;}else{if("exe"==b){this.printNames.exe=a;}}}}};Report.prototype.setAdobeInfoMessage=function(a){if(null!=a&&""!=a){this.adobeMessage.is_message=true;this.adobeMessage.message=a;}};Report.prototype.setPermissionAdobe9=function(a){this.adobe9Permission=a;};Report.prototype.buttonDisabled=function(a,c){switch(a){case"prev_button":if(this.m_disControl.prev!=c&&null!=this.prev_button){this.m_disControl.prev=c;this.prev_button.disabled=c;if(c){var b=this.prev_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.prev_button.className=b;}else{var b=this.prev_button.className;var d=/\_dis/g;b=b.replace(d,"");this.prev_button.className=b;}}break;case"next_button":if(this.m_disControl.next!=c&&null!=this.next_button){this.m_disControl.next=c;this.next_button.disabled=c;if(c){var b=this.next_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.next_button.className=b;}else{var b=this.next_button.className;var d=/\_dis/g;b=b.replace(d,"");this.next_button.className=b;}}break;case"firstPage_button":if(this.m_disControl.first!=c&&null!=this.first_button){this.m_disControl.first=c;this.first_button.disabled=c;if(c){var b=this.first_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.first_button.className=b;}else{var b=this.first_button.className;var d=/\_dis/g;b=b.replace(d,"");this.first_button.className=b;}}break;case"lastPage_button":if(this.m_disControl.last!=c&&null!=this.last_button){this.m_disControl.last=c;this.last_button.disabled=c;if(c){var b=this.last_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.last_button.className=b;}else{var b=this.last_button.className;var d=/\_dis/g;b=b.replace(d,"");this.last_button.className=b;}}break;case"save_button":if(this.m_disControl.save!=c&&null!=this.save_button){this.m_disControl.save=c;this.save_button.disabled=c;if(c){var b=this.save_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.save_button.className=b;}else{var b=this.save_button.className;var d=/\_dis/g;b=b.replace(d,"");this.save_button.className=b;}}break;case"print_button":if(this.m_disControl.print!=c&&null!=this.print_button){this.m_disControl.print=c;this.print_button.disabled=c;if(c){var b=this.print_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.print_button.className=b;}else{var b=this.print_button.className;var d=/\_dis/g;b=b.replace(d,"");this.print_button.className=b;}}break;case"close_button":if(this.m_disControl.close!=c&&null!=this.close_button){this.m_disControl.close=c;this.close_button.disabled=c;if(c){var b=this.close_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.close_button.className=b;}else{var b=this.close_button.className;var d=/\_dis/g;b=b.replace(d,"");this.close_button.className=b;}}break;case"pdf_button":if(this.m_disControl.pdf!=c&&null!=this.pdf_button){this.m_disControl.pdf=c;this.pdf_button.disabled=c;if(c){var b=this.pdf_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.pdf_button.className=b;}else{var b=this.pdf_button.className;var d=/\_dis/g;b=b.replace(d,"");this.pdf_button.className=b;}}break;case"hwp_button":if(this.m_disControl.hwp!=c&&null!=this.hwp_button){this.m_disControl.hwp=c;this.hwp_button.disabled=c;if(c){var b=this.hwp_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.hwp_button.className=b;}else{var b=this.hwp_button.className;var d=/\_dis/g;b=b.replace(d,"");this.hwp_button.className=b;}}break;case"doc_button":if(this.m_disControl.doc!=c&&null!=this.doc_button){this.m_disControl.doc=c;this.doc_button.disabled=c;if(c){var b=this.doc_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.doc_button.className=b;}else{var b=this.doc_button.className;var d=/\_dis/g;b=b.replace(d,"");this.doc_button.className=b;}}break;case"excel_button":if(this.m_disControl.excel!=c&&null!=this.excel_button){this.m_disControl.excel=c;this.excel_button.disabled=c;if(c){var b=this.excel_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.excel_button.className=b;}else{var b=this.excel_button.className;var d=/\_dis/g;b=b.replace(d,"");this.excel_button.className=b;}}break;case"reportInfo_button":if(this.m_disControl.reportInfo!=c&&null!=this.reportInfo_button){this.m_disControl.reportInfo=c;this.reportInfo_button.disabled=c;if(c){var b=this.reportInfo_button.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.reportInfo_button.className=b;}else{var b=this.reportInfo_button.className;var d=/\_dis/g;b=b.replace(d,"");this.reportInfo_button.className=b;}}break;case"zoomIn":if(this.m_disControl.zoomIn!=c&&null!=this.zoomCombo){this.m_disControl.zoomIn=c;this.zoomCombo.disabled=c;if(c){var b=this.zoomCombo.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.zoomCombo.className=b;}else{var b=this.zoomCombo.className;var d=/\_dis/g;b=b.replace(d,"");this.zoomCombo.className=b;}}break;case"input_box":if(this.m_disControl.input!=c&&null!=this.totalCountText){this.m_disControl.input=c;this.totalCountText.disabled=c;if(c){var b=this.totalCountText.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.totalCountText.className=b;}else{var b=this.totalCountText.className;var d=/\_dis/g;b=b.replace(d,"");this.totalCountText.className=b;}}break;case"totalCount_box":if(this.m_disControl.caption!=c&&null!=this.totalCountSpan){this.m_disControl.caption=c;this.totalCountSpan.disabled=c;if(c){var b=this.totalCountSpan.className;var d=/\_svg/g;b=b.replace(d,"_svg_dis");d=/\_png/g;b=b.replace(d,"_png_dis");this.totalCountSpan.className=b;}else{var b=this.totalCountSpan.className;var d=/\_dis/g;b=b.replace(d,"");this.totalCountSpan.className=b;}}break;default:break;}};Report.prototype.setDebug=function(a){if(a){this.m_debug.isDebug=a;if(typeof window.console!="undefined"){this.m_debug.isConsole=true;}else{this.m_debug.message=new Array();}}};Report.prototype.reportNecessaryCheck=function(){var b=new Date().getTime();var a="ClipID=R11&uid="+this.m_uid+"&clipUID="+this.m_uid+"&isNecessaryCheck=true&s_time="+b;a=mRe_onBeforeSend(a);var d=new HttpClient();var c=null;try{c=d.send(this.servletPath,a,false,null);var f=objectCall(ClipStrTrim(mRe_onAfterSend(c)));if(typeof f=="string"){f=objectCall(f);}if(f.status){if(f.event==102){ReportWebLog("Please check your server logs!");}return true;}else{this.m_NecessaryPopup(f.list);}}catch(g){ReportWebLog("report edit Necessary Check server connection error!");return false;}return false;};Report.prototype.setSignStaticPosition=function(b,a){this.m_signOption.staticPos=true;this.m_signOption.staticLeft=b;this.m_signOption.staticTop=a;};Report.prototype.setSignOffset=function(b,a){this.m_signOption.offsetLeft=b;this.m_signOption.offsetTop=a;};Report.prototype.setRatioComboNameVisible=function(b,a){switch(b.toLowerCase()){case"50%":this.m_comboNames.num50.visible=a;break;case"75%":this.m_comboNames.num75.visible=a;break;case"100%":this.m_comboNames.num100.visible=a;break;case"125%":this.m_comboNames.num125.visible=a;break;case"150%":this.m_comboNames.num150.visible=a;break;case"200%":this.m_comboNames.num200.visible=a;break;case"300%":this.m_comboNames.num300.visible=a;break;case"400%":this.m_comboNames.num400.visible=a;break;case"pagewidth":this.m_comboNames.pagewidth.visible=a;break;case"wholepage":this.m_comboNames.wholepage.visible=a;break;default:break;}};Report.prototype.setRatioComboNameChange=function(b,a){switch(b.toLowerCase()){case"50%":this.m_comboNames.num50.name=a;break;case"75%":this.m_comboNames.num75.name=a;break;case"100%":this.m_comboNames.num100.name=a;break;case"125%":this.m_comboNames.num125.name=a;break;case"150%":this.m_comboNames.num150.name=a;break;case"200%":this.m_comboNames.num200.name=a;break;case"300%":this.m_comboNames.num300.name=a;break;case"400%":this.m_comboNames.num400.name=a;break;case"pagewidth":this.m_comboNames.pagewidth.name=a;break;case"wholepage":this.m_comboNames.wholepage.name=a;break;default:break;}};Report.prototype.setRatioComboName=function(a,b){if(null!=a){this.m_comboNames.pagewidth.name=a;}if(null!=b){this.m_comboNames.wholepage.name=b;}};Report.prototype.saveFileDownLoad=function(){if(this.m_isEndReport){var f=arguments[0];var a=arguments[1];var e=arguments[2];var d=new Object();d.name=Base64.encode(f);if(e==1){d.pageType=1;d.startNum=1;d.endNum=this.m_pageCount;}else{if(e==2){d.pageType=2;d.startNum=this.beforePageIndex+1;d.endNum=this.beforePageIndex+1;}else{d.pageType=3;var c=1;var b=this.m_pageCount;if(arguments.length==5){if(arguments[4]<arguments[3]){if(arguments[4]>0){c=arguments[4];}if(arguments[3]<=b){b=arguments[3];}}else{if(arguments[3]>0){c=arguments[3];}if(arguments[4]<=b){b=arguments[4];}}}d.startNum=c;d.endNum=b;}}switch(a){case 1:d.exportType=1;d.option=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");break;case 2:d.exportType=10;d.option=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");break;case 3:d.exportType=2;d.option=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(d,this.splitPDFFileNames);break;case 4:d.exportType=3;d.option=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();break;case 5:d.exportType=4;d.option=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");break;case 6:d.exportType=5;d.option=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();break;case 7:d.exportType=7;d.option=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");break;case 8:d.exportType=8;d.option=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();break;case 9:d.exportType=9;d.option=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");break;case 10:d.exportType=11;d.option=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();break;case 11:d.exportType=13;d.option=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();break;case 12:d.exportType=14;d.option=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();break;case 13:d.exportType=15;d.option=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();break;case 14:d.exportType=12;d.option={splitPage:0};break;case 15:d.exportType=16;d.option=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");break;default:break;}this.m_saveInfo_view=new Object();this.m_saveInfo_view.json_data=d;d=null;this.submitSaveOption();this.m_saveInfo_view=null;this.mRe_closeReportSaveInfo();}else{mRe_ReportEventHandler(10);}};Report.prototype.setScrollPaging=function(a){this.m_scrollEv.isScrollPaging=a;};Report.prototype.setMobilePageScrollTop=function(a){this.m_mobile.scrollTop=a;};Report.prototype.setPageScrollTop=function(a){this.m_pcView.scrollTop=a;};Report.prototype.setFirefoxPopUpPrintWindow=function(b,c,a){this.m_firefoxPrint.isPopup=b;this.m_firefoxPrint.width=c;this.m_firefoxPrint.height=a;};Report.prototype.setPrintExceptionSaveButtonVisible=function(a){this.pESaveButtonVisible=a;};Report.prototype.setChartToImage=function(a){this.m_isChartToImage=a;};Report.prototype.setIsMarkAny=function(a){this.m_isMarkAny=a;};Report.prototype.setPDFFitToPage=function(a){this.isChromePrintFitToPage=a;};Report.prototype.setEndReportProgress=function(b,d,a,c){if(!is_mobile&&!is_tablet){this.m_endreportprogress.is_visible=b;this.m_endreportprogress.URL=d;this.m_endreportprogress.x=a;this.m_endreportprogress.y=c;}};Report.prototype.changeRatioCombo=function(a){switch(a.toLowerCase()){case"50%":this.zoomCombo.value="0.5";break;case"75%":this.zoomCombo.value="0.75";break;case"100%":this.zoomCombo.value="1";break;case"125%":this.zoomCombo.value="1.25";break;case"150%":this.zoomCombo.value="1.5";break;case"200%":this.zoomCombo.value="2";break;case"300%":this.zoomCombo.value="3";break;case"400%":this.zoomCombo.value="4";break;case"pagewidth":this.zoomCombo.value="PageWidth";break;case"wholepage":this.zoomCombo.value="WholePage";break;default:break;}this.zoomIn(this.zoomCombo);};Report.prototype.getReportKey=function(){return this.m_uid;};Report.prototype.setPrintImage=function(a){this.isPDFPrintImage=a;};Report.prototype.setPDFDownloadLink=function(a){this.m_pdfLink=a;};Report.prototype.setDisplayPrintOption=function(b,a){switch(b.toLocaleLowerCase()){case"pdf":this.m_printDisplay.pdf=a;break;case"html":this.m_printDisplay.html=a;break;case"hwp":this.m_printDisplay.hwp=a;break;case"exe":this.m_printDisplay.exe=a;break;default:break;}};Report.prototype.setUseHTMLPrint=function(a){this.setDisplayPrintOption("html",a);};Report.prototype.setUseOriginImage=function(a){this.m_isUseOriginImage=a;};Report.prototype.setEnabledCrossDomain=function(a){this.m_isCrossDomain=a;this.m_fileDownLoadServerCheck=a;};Report.prototype.setOOFEncoding=function(a){this.m_isEncode=a;};Report.prototype.setImageViewer=function(a){this.m_isPaintImage=a;};Report.prototype.setSaveFileName=function(a){this.m_strFileName=a;};Report.prototype.setAppendSaveFileName=function(a){this.m_strAppendFileName=a;};Report.prototype.setAccessibility=function(a){this.m_isAccessibility=a;};Report.prototype.setDisabled=function(a,b){switch(a){case"prev_button":this.m_disControl.prev=b;break;case"next_button":this.m_disControl.next=b;break;case"firstPage_button":this.m_disControl.first=b;break;case"lastPage_button":this.m_disControl.last=b;break;case"save_button":this.m_disControl.save=b;break;case"print_button":this.m_disControl.print=b;break;case"close_button":this.m_disControl.close=b;break;case"pdf_button":this.m_disControl.pdf=b;break;case"hwp_button":this.m_disControl.hwp=b;break;case"doc_button":this.m_disControl.doc=b;break;case"excel_button":this.m_disControl.excel=b;break;case"reportInfo_button":this.m_disControl.reportInfo=b;break;case"zoomIn":this.m_disControl.zoomIn=b;break;case"input_box":this.m_disControl.input=b;break;case"totalCount_box":this.m_disControl.caption=b;break;default:break;}};Report.prototype.setStartSaveButtonEvent=function(a){this.m_buttonEvent.startSaveButton=a;};Report.prototype.setStartPDFButtonEvent=function(a){this.m_buttonEvent.startPDFButton=a;};Report.prototype.setStartExcelButtonEvent=function(a){this.m_buttonEvent.startExcelButton=a;};Report.prototype.setStartHWPButtonEvent=function(a){this.m_buttonEvent.startHWPButton=a;};Report.prototype.setStartDOCButtonEvent=function(a){this.m_buttonEvent.startDOCButton=a;};Report.prototype.setStartPrintButtonEvent=function(a){this.m_buttonEvent.startPrintButton=a;};Report.prototype.setStartCloseButtonEvent=function(a){this.m_buttonEvent.startCloseButton=a;};Report.prototype.setEndSaveButtonEvent=function(a){this.m_buttonEvent.endSaveButton=a;};Report.prototype.setEndPDFButtonEvent=function(a){this.m_buttonEvent.endPDFButton=a;};Report.prototype.setEndExcelButtonEvent=function(a){this.m_buttonEvent.endExcelButton=a;};Report.prototype.setEndHWPButtonEvent=function(a){this.m_buttonEvent.endHWPButton=a;};Report.prototype.setEndDOCButtonEvent=function(a){this.m_buttonEvent.endDOCButton=a;};Report.prototype.setEndReportEvent=function(a){this.m_isReportEndFunction=a;};Report.prototype.setCloseReportEvent=function(a){this.m_isCloseFunction=a;};Report.prototype.setFileDownLoadCheck=function(a){this.m_fileDownLoadServerCheck=a;};Report.prototype.setLanguage=function(a){switch(a){case"en":this.m_language=1;break;case"jp":this.m_language=2;break;case"cn":this.m_language=3;break;default:break;}};Report.prototype.setSplitPDFFileNames=function(a){this.splitPDFFileNames=a;};Report.prototype.setDefaultSelectSaveOption=function(a){this.defaultSaveOption=a;};Report.prototype.setDefaultSaveExcelOption=function(h,l,a,d,j,c,b,k,f,m,i,g,e){if(null==this.m_defaultSaveExcelOp){this.m_defaultSaveExcelOp=mRe_getDefaultSaveExcelOption("xls");}this.m_defaultSaveExcelOp.exportMethod=""+h;if(h){this.m_defaultSaveExcelOp.mergeCell=l;}this.m_defaultSaveExcelOp.mergeEmptyCell=a;this.m_defaultSaveExcelOp.splitCellAtPageSize=d;this.m_defaultSaveExcelOp.rightToLeft=j;this.m_defaultSaveExcelOp.widthRate=c;this.m_defaultSaveExcelOp.heightRate=b;this.m_defaultSaveExcelOp.coordinateErrorLimit=k;this.m_defaultSaveExcelOp.processGerenalFormat=f;this.m_defaultSaveExcelOp.printingMagnification=m;i=null==i?false:i;this.m_defaultSaveExcelOp.fitToPageWhenPrinting=i;g=null==g?false:g;this.m_defaultSaveExcelOp.removeHyperlink=g;e=null==e?false:e;this.m_defaultSaveExcelOp.repeatPageSectionWhenAllSectionInOneSheet=e;};Report.prototype.setDefaultSaveExcelxOption=function(h,l,a,d,j,c,b,k,f,m,i,g,e){if(null==this.m_defaultSaveExcelxOp){this.m_defaultSaveExcelxOp=mRe_getDefaultSaveExcelOption("xlsx");}this.m_defaultSaveExcelxOp.exportMethod=""+h;if(h){this.m_defaultSaveExcelxOp.mergeCell=l;}this.m_defaultSaveExcelxOp.mergeEmptyCell=a;this.m_defaultSaveExcelxOp.splitCellAtPageSize=d;this.m_defaultSaveExcelxOp.rightToLeft=j;this.m_defaultSaveExcelxOp.widthRate=c;this.m_defaultSaveExcelxOp.heightRate=b;this.m_defaultSaveExcelxOp.coordinateErrorLimit=k;this.m_defaultSaveExcelxOp.processGerenalFormat=f;this.m_defaultSaveExcelxOp.printingMagnification=m;i=null==i?false:i;this.m_defaultSaveExcelxOp.fitToPageWhenPrinting=i;g=null==g?false:g;this.m_defaultSaveExcelxOp.removeHyperlink=g;e=null==e?false:e;this.m_defaultSaveExcelxOp.repeatPageSectionWhenAllSectionInOneSheet=e;};Report.prototype.setDefaultSaveHanCellOption=function(h,l,a,d,j,c,b,k,f,m,i,g,e){if(null==this.m_defaultSaveHanCellOp){this.m_defaultSaveHanCellOp=mRe_getDefaultSaveExcelOption("cell");}this.m_defaultSaveHanCellOp.exportMethod=""+h;if(h){this.m_defaultSaveHanCellOp.mergeCell=l;}this.m_defaultSaveHanCellOp.mergeEmptyCell=a;this.m_defaultSaveHanCellOp.splitCellAtPageSize=d;this.m_defaultSaveHanCellOp.rightToLeft=j;this.m_defaultSaveHanCellOp.widthRate=c;this.m_defaultSaveHanCellOp.heightRate=b;this.m_defaultSaveHanCellOp.coordinateErrorLimit=k;this.m_defaultSaveHanCellOp.processGerenalFormat=f;this.m_defaultSaveHanCellOp.printingMagnification=m;i=null==i?false:i;this.m_defaultSaveHanCellOp.fitToPageWhenPrinting=i;g=null==g?false:g;this.m_defaultSaveHanCellOp.removeHyperlink=g;e=null==e?false:e;this.m_defaultSaveHanCellOp.repeatPageSectionWhenAllSectionInOneSheet=e;};Report.prototype.setDefaultSavePDFOption=function(d,c,f,a,b,e){if(null==this.m_defaultSavePDFOp){this.m_defaultSavePDFOp=mRe_getDefaultSavePDFOption();}this.m_defaultSavePDFOp.isSplite=d;this.m_defaultSavePDFOp.spliteValue=c;this.m_defaultSavePDFOp.userpw=f;this.m_defaultSavePDFOp.textToImage=a;this.m_defaultSavePDFOp.importOriginImage=b;this.m_defaultSavePDFOp.removeHyperlink=e;};Report.prototype.setDefaultSaveHWPOption=function(f,g,m,d,k,j,c,o,l,i,e,b,n,a,h){if(null==this.m_defaultSaveHWPOp){this.m_defaultSaveHWPOp=mRe_getDefaultSaveHWPOption();}this.m_defaultSaveHWPOp.fixSize=f;this.m_defaultSaveHWPOp.allowOverlay=g;this.m_defaultSaveHWPOp.setPageBottomMarginToZero=m;this.m_defaultSaveHWPOp.outputLikeWord=d;if(null!=d){this.m_defaultSaveHWPOp.tableSplitMethod=k;}this.m_defaultSaveHWPOp.defaultCharGap=j;this.m_defaultSaveHWPOp.charRatio=c;if(null!=o){this.m_defaultSaveHWPOp.putCheckboxIntoCell=o;}if(null!=l){this.m_defaultSaveHWPOp.splitTextByLine=l;}if(null!=i){this.m_defaultSaveHWPOp.mergeTable=i;}else{this.m_defaultSaveHWPOp.mergeTable=false;}if(null!=e){this.m_defaultSaveHWPOp.lineSpaceRate=e;}if(null!=b){this.m_defaultSaveHWPOp.positionRelTo=b;}if(null!=n){this.m_defaultSaveHWPOp.hwpExportMethod=n;}else{this.m_defaultSaveHWPOp.hwpExportMethod=1;}if(null!=a){this.m_defaultSaveHWPOp.splitPageOnListTableOnly=a;}else{this.m_defaultSaveHWPOp.splitPageOnListTableOnly=true;}if(null!=h){this.m_defaultSaveHWPOp.pageBottomMarginApplicationRate=h;}else{this.m_defaultSaveHWPOp.pageBottomMarginApplicationRate=100;}};Report.prototype.setDefaultSaveRTFOption=function(g,c,d,b,h,i,e,f,a){if(null==this.m_defaultSaveRTFOp){this.m_defaultSaveRTFOp=mRe_getDefaultSaveRTFOption("rtf");}this.m_defaultSaveRTFOp.splitTextLine=g;this.m_defaultSaveRTFOp.processAsUnicode=c;this.m_defaultSaveRTFOp.processEqualAlign=d;this.m_defaultSaveRTFOp.defaultCharSpace=b;this.m_defaultSaveRTFOp.tableWrapperBottomGap=h;i=(null==i)?true:i;e=(null==e)?false:e;this.m_defaultSaveRTFOp.insertTableWrapper=i;this.m_defaultSaveRTFOp.mergeTable=e;f=(null==f)?false:f;a=(null==a)?1:a;this.m_defaultSaveRTFOp.fitShapeToText=f;this.m_defaultSaveRTFOp.TableRowHeightSort=a;};Report.prototype.setDefaultSaveDOCOption=function(g,c,d,b,h,i,e,f,a){if(null==this.m_defaultSaveDOCOp){this.m_defaultSaveDOCOp=mRe_getDefaultSaveRTFOption("doc");}this.m_defaultSaveDOCOp.splitTextLine=g;this.m_defaultSaveDOCOp.processAsUnicode=c;this.m_defaultSaveDOCOp.processEqualAlign=d;this.m_defaultSaveDOCOp.defaultCharSpace=b;this.m_defaultSaveDOCOp.tableWrapperBottomGap=h;i=(null==i)?true:i;e=(null==e)?false:e;this.m_defaultSaveDOCOp.insertTableWrapper=i;this.m_defaultSaveDOCOp.mergeTable=e;f=(null==f)?false:f;a=(null==a)?1:a;this.m_defaultSaveDOCOp.fitShapeToText=f;this.m_defaultSaveDOCOp.TableRowHeightSort=a;};Report.prototype.setDefaultSaveDOCXOption=function(f,d,e,a,c,b){if(null==this.m_defaultSaveDOCXOp){this.m_defaultSaveDOCXOp=mRe_getDefaultSaveRTFOption("docx");}this.m_defaultSaveDOCXOp.splitTextLine=f;this.m_defaultSaveDOCXOp.defaultCharSpace=d;this.m_defaultSaveDOCXOp.tableWrapperBottomGap=e;this.m_defaultSaveDOCXOp.insertTableWrapper=a;this.m_defaultSaveDOCXOp.mergeTable=c;this.m_defaultSaveDOCXOp.lineSpaceRate=b;};Report.prototype.setDefaultSaveJPGOption=function(b,a,d,c){if(null==this.m_defaultSaveJPGOp){this.m_defaultSaveJPGOp=mRe_getDefaultSaveJPGOption();}this.m_defaultSaveJPGOp.rotate90=b;this.m_defaultSaveJPGOp.dpiX=a;this.m_defaultSaveJPGOp.dpiY=d;this.m_defaultSaveJPGOp.quality=c;};Report.prototype.setDefaultSaveTIFOption=function(c,b,e,d,a){if(null==this.m_defaultSaveTIFOp){this.m_defaultSaveTIFOp=mRe_getDefaultSaveTIFOption();}this.m_defaultSaveTIFOp.rotate90=c;this.m_defaultSaveTIFOp.dpiX=b;this.m_defaultSaveTIFOp.dpiY=e;this.m_defaultSaveTIFOp.blackWhite=d;this.m_defaultSaveTIFOp.gray=a;};Report.prototype.setDefaultSaveMultiTIFOption=function(c,b,e,d,a){if(null==this.m_defaultSaveMultiTIFOp){this.m_defaultSaveMultiTIFOp=mRe_getDefaultSaveMultiTIFOption();}this.m_defaultSaveMultiTIFOp.rotate90=c;this.m_defaultSaveMultiTIFOp.dpiX=b;this.m_defaultSaveMultiTIFOp.dpiY=e;this.m_defaultSaveMultiTIFOp.blackWhite=d;this.m_defaultSaveMultiTIFOp.gray=a;};Report.prototype.setDefaultSaveExcelDataOption=function(a){if(null==this.m_defaultSaveExcelDataOp){this.m_defaultSaveExcelDataOp=mRe_getDefaultSaveExcelDataOption();}this.m_defaultSaveExcelDataOp.outputPageSectionMethod=a;};Report.prototype.setDefaultSavePPTOption=function(b,a,c){if(null==this.m_defaultSavePPTOp){this.m_defaultSavePPTOp=mRe_getDefaultSavePPTOption();}this.m_defaultSavePPTOp.mergeTable=b;this.m_defaultSavePPTOp.ignoreLineSpace=a;this.m_defaultSavePPTOp.removeHyperlink=c;};Report.prototype.setDefaultSaveHTMLOption=function(j,h,a,f,d,c,e,i,g,b){if(null==this.m_defaultSaveHTMLOp){this.m_defaultSaveHTMLOp=mRe_getDefaultSaveHTMLOption();}this.m_defaultSaveHTMLOp.processCellLikeShape=j;this.m_defaultSaveHTMLOp.displayPageLine=h;this.m_defaultSaveHTMLOp.keepPageHeight=a;this.m_defaultSaveHTMLOp.applyWordBreak=f;this.m_defaultSaveHTMLOp.setTextProperiesToEmptyCell=d;this.m_defaultSaveHTMLOp.putTagIntoEmptyCell=c;this.m_defaultSaveHTMLOp.textOverflowHidden=e;this.m_defaultSaveHTMLOp.coordinateRateForX=i;this.m_defaultSaveHTMLOp.coordinateRateForY=g;this.m_defaultSaveHTMLOp.encodingType=b;};Report.prototype.setDefaultSaveHTML5Option=function(b,a){if(null==this.m_defaultSaveHTML5Op){this.m_defaultSaveHTML5Op=mRe_getDefaultSaveHTML5Option();}this.m_defaultSaveHTML5Op.isSplite=b;this.m_defaultSaveHTML5Op.dpiValue=a;};Report.prototype.setSaveDirectExcelOption=function(e,i,m,a,d,k,c,b,l,g,n,j,h,f){this.m_saveDirectExcelOp={mergeCell:true};this.m_saveDirectExcelOp.fileName=e;this.m_saveDirectExcelOp.exportMethod=""+i;if(null!=i){this.m_saveDirectExcelOp.mergeCell=m;}this.m_saveDirectExcelOp.mergeEmptyCell=a;this.m_saveDirectExcelOp.splitCellAtPageSize=d;this.m_saveDirectExcelOp.rightToLeft=k;this.m_saveDirectExcelOp.widthRate=c;this.m_saveDirectExcelOp.heightRate=b;this.m_saveDirectExcelOp.coordinateErrorLimit=l;this.m_saveDirectExcelOp.processGerenalFormat=g;this.m_saveDirectExcelOp.printingMagnification=n;j=null==j?false:j;this.m_saveDirectExcelOp.fitToPageWhenPrinting=j;h=null==h?false:h;this.m_saveDirectExcelOp.removeHyperlink=h;f=null==f?false:f;this.m_saveDirectExcelOp.repeatPageSectionWhenAllSectionInOneSheet=f;};Report.prototype.setSaveDirectPDFOption=function(g,d,c,f,a,b,e){this.m_saveDirectPDFOp=new Object();this.m_saveDirectPDFOp.fileName=g;this.m_saveDirectPDFOp.isSplite=d;this.m_saveDirectPDFOp.spliteValue=c;this.m_saveDirectPDFOp.userpw=f;this.m_saveDirectPDFOp.textToImage=a;this.m_saveDirectPDFOp.importOriginImage=b;this.m_saveDirectPDFOp.removeHyperlink=e;};Report.prototype.setSaveDirectHWPOption=function(f,g,h,n,d,l,k,c,p,m,j,e,b,o,a,i){this.m_saveDirectHWPOp={tableSplitMethod:2,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100};this.m_saveDirectHWPOp.fileName=f;this.m_saveDirectHWPOp.fixSize=g;this.m_saveDirectHWPOp.allowOverlay=h;this.m_saveDirectHWPOp.setPageBottomMarginToZero=n;this.m_saveDirectHWPOp.outputLikeWord=d;if(null!=d){this.m_saveDirectHWPOp.tableSplitMethod=l;}this.m_saveDirectHWPOp.defaultCharGap=k;this.m_saveDirectHWPOp.charRatio=c;this.m_saveDirectHWPOp.putCheckboxIntoCell=p;this.m_saveDirectHWPOp.splitTextByLine=m;if(null!=j){this.m_saveDirectHWPOp.mergeTable=j;}else{this.m_saveDirectHWPOp.mergeTable=false;}if(null!=e){this.m_saveDirectHWPOp.lineSpaceRate=e;}if(null!=b){this.m_saveDirectHWPOp.positionRelTo=b;}if(null!=o){this.m_saveDirectHWPOp.hwpExportMethod=o;}if(null!=a){this.m_saveDirectHWPOp.splitPageOnListTableOnly=a;}if(null!=i){this.m_saveDirectHWPOp.pageBottomMarginApplicationRate=i;}};Report.prototype.setSaveDirectDOCOption=function(e,h,c,d,b,i,j,f,g,a){this.m_saveDirectDOCOp={type:"doc"};this.m_saveDirectDOCOp.fileName=e;this.m_saveDirectDOCOp.splitTextLine=h;this.m_saveDirectDOCOp.processAsUnicode=c;this.m_saveDirectDOCOp.processEqualAlign=d;this.m_saveDirectDOCOp.defaultCharSpace=b;this.m_saveDirectDOCOp.tableWrapperBottomGap=i;this.m_saveDirectDOCOp.insertTableWrapper=j;this.m_saveDirectDOCOp.mergeTable=f;g=(null==g)?false:g;a=(null==a)?1:a;this.m_saveDirectDOCOp.fitShapeToText=g;this.m_saveDirectDOCOp.TableRowHeightSort=a;};Report.prototype.setSaveOptionVisible=function(b,a){b=b.toLowerCase();if("excel"==b){this.saveOptionVisible.excel=a;}else{if("pdf"==b){this.saveOptionVisible.pdf=a;}else{if("hwp"==b){this.saveOptionVisible.hwp=a;}else{if("rtf"==b){this.saveOptionVisible.rtf=a;}else{if("doc"==b){this.saveOptionVisible.doc=a;}else{if("docx"==b){this.saveOptionVisible.docx=a;}else{if("ppt"==b){this.saveOptionVisible.ppt=a;}else{if("html"==b){this.saveOptionVisible.html=a;}else{if("html5"==b){this.saveOptionVisible.html5=a;}else{if("hancell"==b){this.saveOptionVisible.hancell=a;}else{if("excelx"==b){this.saveOptionVisible.excelx=a;}else{if("jpg"==b){this.saveOptionVisible.jpg=a;}else{if("txt"==b){this.saveOptionVisible.txt=a;}else{if("tif"==b){this.saveOptionVisible.tif=a;}else{if("multitif"==b){this.saveOptionVisible.multiTif=a;}else{if("exceldata"==b){this.saveOptionVisible.excelData=a;}}}}}}}}}}}}}}}}if(!a){this.changeDefaultSaveOption();}};Report.prototype.changeDefaultSaveOption=function(){if(this.saveOptionVisible.excel){this.defaultSaveOption="excel";}if(this.saveOptionVisible.excelx){this.defaultSaveOption="excelx";}else{if(this.saveOptionVisible.pdf){this.defaultSaveOption="pdf";}else{if(this.saveOptionVisible.hwp){this.defaultSaveOption="hwp";}else{if(this.saveOptionVisible.rtf){this.defaultSaveOption="rtf";}else{if(this.saveOptionVisible.doc){this.defaultSaveOption="doc";}else{if(this.saveOptionVisible.docx){this.defaultSaveOption="docx";}else{if(this.saveOptionVisible.ppt){this.defaultSaveOption="ppt";}else{if(this.saveOptionVisible.html){this.defaultSaveOption="html";}else{if(this.saveOptionVisible.html5){this.defaultSaveOption="html5";}else{if(this.saveOptionVisible.hancell){this.defaultSaveOption="hancell";}else{if(this.saveOptionVisible.jpg){this.defaultSaveOption="jpg";}else{if(this.saveOptionVisible.txt){this.defaultSaveOption="txt";}else{if(this.saveOptionVisible.tif){this.defaultSaveOption="tif";}else{if(this.saveOptionVisible.multiTif){this.defaultSaveOption="multiTif";}else{if(this.saveOptionVisible.excelData){this.defaultSaveOption="excelData";}}}}}}}}}}}}}}}};Report.prototype.setLimitedPrint=function(a){this.m_limitedPrint=a;};Report.prototype.setDirectPrint=function(a){this.m_directPrint=a;};Report.prototype.setPageCountTime=function(a){this.m_pageCountTime=a;};Report.prototype.setDPI=function(a){this.m_DPI=a;};Report.prototype.setProgress=function(c,a,b){this.m_progress.URL=c;this.m_progress.x=a;this.m_progress.y=b;};Report.prototype.setPrintProgress=function(c,a,b){this.m_printprogress.URL=c;this.m_printprogress.x=a;this.m_printprogress.y=b;};Report.prototype.setHWPProgress=function(c,a,b){this.m_hwpprogress.URL=c;this.m_hwpprogress.x=a;this.m_hwpprogress.y=b;};Report.prototype.setEXCELProgress=function(c,a,b){this.m_excelprogress.URL=c;this.m_excelprogress.x=a;this.m_excelprogress.y=b;};Report.prototype.setSAVEProgress=function(c,a,b){this.m_saveprogress.URL=c;this.m_saveprogress.x=a;this.m_saveprogress.y=b;};Report.prototype.nextPage=function(){this.debugMeg("report log :: 다음 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startNextButton!=null){var b=this.m_buttonEvent.startNextButton();if(b!=true){return;}}if(this.is_eForm){if(this.m_isSplitView){if(!this.m_splitView.isQuick){var a=this.m_splitView.pageInfo[this.beforePageIndex];if(typeof a=="undefined"){if(null!=this.m_splitView.event){this.m_splitView.event();}return;}}}}this.selectPage((this.beforePageIndex+1));}};Report.prototype.previousPage=function(){this.debugMeg("report log :: 이전 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startPrevButton!=null){var a=this.m_buttonEvent.startPrevButton();if(a!=true){return;}}this.selectPage((this.beforePageIndex-1));}};Report.prototype.firstPage=function(){this.debugMeg("report log :: 첫 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startFirstButton!=null){var a=this.m_buttonEvent.startFirstButton();if(a!=true){return;}}this.selectPage(0);}};Report.prototype.lastPage=function(){this.debugMeg("report log :: 마지막 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){if(this.m_buttonEvent.startLastButton!=null){var a=this.m_buttonEvent.startLastButton();if(a!=true){return;}}this.selectPage(this.m_pageCount-1);}};Report.prototype.exportView=function(){if(this.m_isButtonLock){return;}this.m_isButtonLock=true;if(this.m_isEndReport){if(this.m_buttonEvent.startSaveButton!=null){var a=this.m_buttonEvent.startSaveButton();if(a!=true){this.m_isButtonLock=false;return;}}this.reportCheckSend(0);}else{this.m_isButtonLock=false;mRe_ReportEventHandler(10);}};Report.prototype.printMobileView=function(){if(this.m_isEndReport){if(null!=this.m_limitedPrint&&this.m_pageCount>this.m_limitedPrint){this.printLimitedExportView("pdf");return;}this.pdfDownLoad();}else{mRe_ReportEventHandler(10);}};Report.prototype.printWindowView=function(){if(this.m_isButtonLock){return;}this.m_isButtonLock=true;if(this.m_isEndReport&&!this.m_disControl.print){this.reportCheckSend(4);}else{this.m_isButtonLock=false;mRe_ReportEventHandler(10);}};Report.prototype.printView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("pdf");return;}this.mRe_printView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(6);}};Report.prototype.printHWPView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("hwp");return;}this.mRe_printHWPView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(9);}};Report.prototype.printEXEView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&is_window&&!this.m_disControl.print){if(null!=this.m_limitedPrint&&this.checkPrintCount()>this.m_limitedPrint){this.printLimitedExportView("exe");return;}this.mRe_printEXEView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(8);}};Report.prototype.printHTMLView=function(a){if(typeof a=="undefined"){a=false;}if(a){if(this.m_isEndReport&&!this.m_disControl.print){if(!is_chrome){var b=mRe_getLocalStorage("mRe_htmlPopupCheck");if(b=="0"){this.printHtmlPopupCheckExportView();return;}}this.checkPrintHTMLView();}else{mRe_ReportEventHandler(10);}}else{this.reportCheckSend(7);}};Report.prototype.pdfDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startPDFButton!=null){var a=this.m_buttonEvent.startPDFButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(1);}else{mRe_ReportEventHandler(10);}};Report.prototype.htmlDownLoad=function(){if(this.fileDownLoding){return;}var a=this;this.fileDownLoding=true;if(this.m_isEndReport){this.formTag_clipid.value="R06";this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="html";this.formTag_path.value=this.clientPath;this.formTag.action=this.servletPath;this.formTag.target="re_target"+this.m_uid;this.formTag.submit();}else{mRe_ReportEventHandler(10);}window.setTimeout(function(){a.fileDownLoding=false;},2000);};Report.prototype.hwpDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startHWPButton!=null){var a=this.m_buttonEvent.startHWPButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(3);}else{mRe_ReportEventHandler(10);}};Report.prototype.excelDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startExcelButton!=null){var a=this.m_buttonEvent.startExcelButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(2);}else{mRe_ReportEventHandler(10);}};Report.prototype.docDownLoad=function(){if(this.m_isEndReport){if(this.m_buttonEvent.startDOCButton!=null){var a=this.m_buttonEvent.startDOCButton();if(a!=true){return;}}this.printOpReset();this.reportCheckSend(5);}else{mRe_ReportEventHandler(10);}};Report.prototype.closeReport=function(){if(this.m_buttonEvent.startCloseButton!=null){var a=this.m_buttonEvent.startCloseButton();if(a!=true){return;}}this.deleteToReport();window.clearInterval(this.checkCountLoop);if(this.m_isFadeView){$(this.targetDiv).fadeOut(400,function(){this.innerHTML="";$(this).show();});}else{this.targetDiv.innerHTML="";}if(this.m_isCloseFunction!=null){this.m_isCloseFunction();}m_reportHashMap[this.m_uid]=null;};Report.prototype.setStyle=function(b,a){switch(b){case"menu":if(null!=this.menuDiv&&(typeof this.menuDiv!=="string")){this.menuDiv.style.cssText=a;}else{this.menuDiv=a;}break;case"main":if(null!=this.paintDiv&&(typeof this.paintDiv!=="string")){this.paintDiv.style.cssText=a;}else{this.paintDiv=a;}break;case"doodle_button":if(null!=this.doodle_button&&(typeof this.doodle_button!=="string")){this.doodle_button.style.cssText=a;}else{this.doodle_button=a;}break;case"doodle_close_button":if(null!=this.doodle_close_button&&(typeof this.doodle_close_button!=="string")){this.doodle_close_button.style.cssText=a;}else{this.doodle_close_button=a;}break;case"prev_button":if(null!=this.prev_button&&(typeof this.prev_button!=="string")){this.prev_button.style.cssText=a;}else{this.prev_button=a;}break;case"next_button":if(null!=this.next_button&&(typeof this.next_button!=="string")){this.next_button.style.cssText=a;}else{this.next_button=a;}break;case"setting_button":if(null!=this.setting_button&&(typeof this.setting_button!=="string")){this.setting_button.style.cssText=a;}else{this.setting_button=a;}break;case"firstPage_button":if(null!=this.first_button&&(typeof this.first_button!=="string")){this.first_button.style.cssText=a;}else{this.first_button=a;}break;case"lastPage_button":if(null!=this.last_button&&(typeof this.last_button!=="string")){this.last_button.style.cssText=a;}else{this.last_button=a;}break;case"save_button":if(null!=this.save_button&&(typeof this.save_button!=="string")){this.save_button.style.cssText=a;}else{this.save_button=a;}break;case"print_button":if(null!=this.print_button&&(typeof this.print_button!=="string")){this.print_button.style.cssText=a;}else{this.print_button=a;}break;case"close_button":if(null!=this.close_button&&(typeof this.close_button!=="string")){this.close_button.style.cssText=a;}else{this.close_button=a;}break;case"pdf_button":if(null!=this.pdf_button&&(typeof this.pdf_button!=="string")){this.pdf_button.style.cssText=a;}else{this.pdf_button=a;}break;case"hwp_button":if(null!=this.hwp_button&&(typeof this.hwp_button!=="string")){this.hwp_button.style.cssText=a;}else{this.hwp_button=a;}break;case"doc_button":if(null!=this.doc_button&&(typeof this.doc_button!=="string")){this.doc_button.style.cssText=a;}else{this.doc_button=a;}break;case"excel_button":if(null!=this.excel_button&&(typeof this.excel_button!=="string")){this.excel_button.style.cssText=a;}else{this.excel_button=a;}break;case"reportInfo_button":if(null!=this.reportInfo_button&&(typeof this.reportInfo_button!=="string")){this.reportInfo_button.style.cssText=a;}else{this.reportInfo_button=a;}break;case"zoomIn":if(null!=this.zoomCombo&&(typeof this.zoomCombo!=="string")){this.zoomCombo.style.cssText=a;}else{this.zoomCombo=a;}break;case"input_box":if(null!=this.input&&(typeof this.input!=="string")){this.input.style.cssText=a;}else{this.input=a;}break;case"totalCount_box":if(null!=this.totalCountSpan&&(typeof this.totalCountSpan!=="string")){this.totalCountSpan.style.cssText=a;if(null!=this.totalCountText){this.totalCountText.style.cssText=a;}}else{this.totalCountSpan=a;}break;default:break;}};Report.prototype.setVisibleMenu=function(a){this.m_isMenu=a;};Report.prototype.setFadeView=function(a){this.m_isFadeView=a;};Report.prototype.setIsBigData=function(a){this.m_isBigData=a;};Report.prototype.setIsMemoryDump=function(a){this.m_isMemoryDump=a;};Report.prototype.reSize=function(){if(this.zoomCombo!=null){this.zoomIn(this.zoomCombo);}};Report.prototype.setDefaultRatio=function(a){switch(a.toLowerCase()){case"50%":case"75%":case"100%":case"125%":case"150%":case"200%":case"300%":case"400%":case"pagewidth":case"wholepage":this.m_ratio=a;break;default:this.m_ratio="100%";}};Report.prototype.setHWPPrint=function(a){this.m_isHWPPrint=a;};Report.prototype.setDisplayTotalPageCount=function(a,b){this.m_TPC.before=a;this.m_TPC.after=b;};function Report(d,f,b,e,g){this.servletPath=d;this.beforePageIndex=0;this.checkCountLoop=null;this.oof=e;this.userJsp=f;this.postData=b;this.m_reportKey=null;this.targetDiv=g;this.input=null;this.paintDiv=null;this.signPaintDiv=null;this.m_tempPaintDiv=null;this.menuDiv=null;this.totalCountSpan=null;this.totalCountText=null;this.progressImg=null;this.zoomCombo=null;this.next_button=null;this.prev_button=null;this.first_button=null;this.last_button=null;this.save_button=null;this.print_button=null;this.pdf_button=null;this.hwp_button=null;this.doc_button=null;this.excel_button=null;this.reportInfo_button=null;this.close_button=null;this.setting_button=null;this.hwp_object=null;this.doodleDiv=null;this.doodle_button=null;this.m_uid=null;this.m_pageCount=0;this.m_isEndReport=false;this.m_isEndReportEvent=true;this.pageWidth=null;this.pageHeight=null;this.m_language=0;this.m_languageMap=null;this.fileDownLoding=false;this.formTag=null;this.formTag_clipid=null;this.formTag_uid=null;this.formTag_print=null;this.formTag_path=null;this.formTag_option=null;this.formTag_ChromeFitToPage=null;this.formTag_s_time=null;this.fileDownloadCheckTimer=null;this.saveFormTag={form:null,clipid:null,uid:null,option:null};this.deleteImgTag=null;this.m_isMenu=true;this.m_isBigData=false;this.m_isMemoryDump=false;this.m_isEncode=false;this.m_isCrossDomain=false;this.m_isFadeView=false;this.m_isSlidePage=false;this.m_isButtonLock=false;this.m_printDisplay={pdf:true,html:true,hwp:true,exe:false};this.m_isHWPPrint=false;this.m_DPI=96;this.m_ratio="100%";this.m_directPrint=false;this.m_directPrintOp={endReport:false,key:null};this.m_pageCountTime=700;this.m_isCloseFunction=null;this.m_isReportEndFunction=null;this.m_progress={URL:"",x:0,y:0};this.m_printprogress={URL:"",x:0,y:0,domDiv:null};this.m_hwpprogress={URL:"",x:0,y:0,domDiv:null};this.m_excelprogress={URL:"",x:0,y:0,domDiv:null};this.m_saveprogress={URL:"",x:0,y:0,domDiv:null};this.m_endreportprogress={is_visible:false,URL:"",x:0,y:0,domDiv:null};this.m_endPrintProgressEvent=null;this.saveOptionVisible={excel:true,excelx:true,pdf:true,hwp:true,rtf:true,ppt:true,html:false,hancell:true,html5:true,doc:true,docx:true,jpg:false,txt:false,tif:false,multiTif:false,excelData:false};this.adobe9Permission=false;this.adobeMessage={is_message:false,message:""};this.defaultSaveOption=typeof window.getDefaultSaveOption!="undefined"?getDefaultSaveOption():"excel";this.m_defaultSaveExcelOp=null;this.m_defaultSaveExcelxOp=null;this.m_defaultSavePDFOp=null;this.m_defaultSaveHWPOp=null;this.m_defaultSaveRTFOp=null;this.m_defaultSavePPTOp=null;this.m_defaultSaveHTMLOp=null;this.m_defaultSaveHanCellOp=null;this.m_defaultSaveHTML5Op=null;this.m_defaultSaveDOCOp=null;this.m_defaultSaveDOCXOp=null;this.m_defaultSaveJPGOp=null;this.m_defaultSaveTIFOp=null;this.m_defaultSaveMultiTIFOp=null;this.m_defaultSaveExcelDataOp=null;this.m_saveDirectPDFOp=null;this.m_saveDirectHWPOp=null;this.m_saveDirectDOCOp=null;this.m_saveDirectExcelOp=null;this.printOptionValue={isNetPrint:false,localStorage:mRe_getLocalStorage("mRe_print_report"),pageCount:1,startNum:0,endNum:0,netPrintList:[]};this.splitPDFFileNames=null;var c=location.pathname.lastIndexOf("/");var a="/";if(0!=c){a=location.pathname.substring(0,c);}this.clientPath=a;this.m_versionInfo=null;this.m_webViewVersionInfo=null;this.m_reportInfo_view=null;this.m_saveInfo_view=null;this.m_printInfo_view=null;this.m_popupViewDiv=null;this.m_limitedPrint=null;this.m_isAccessibility=false;this.m_fileDownLoadServerCheck=true;this.m_buttonEvent={startSaveButton:null,startPDFButton:null,startExcelButton:null,startHWPButton:null,startDOCButton:null,startPrintButton:null,startCloseButton:null,startFirstButton:null,startPrevButton:null,startNextButton:null,startLastButton:null,startZoomInSelect:null,startPageCountLabel:null,endSaveButton:null,endPDFButton:null,endExcelButton:null,endHWPButton:null,endDOCButton:null,printOkButton:null,printCancelButton:null,closeDoodleButton:null,PDFPrintAlertCloseButton:null};this.m_pageMoveEvent={start:null,end:null};this.m_exePrintEvent={ok:null,cancel:null};this.m_disControl={save:false,prev:false,next:false,first:false,last:false,print:false,close:false,pdf:false,hwp:false,excel:false,reportInfo:false,zoomIn:false,input:false,caption:false,doodle:false,setting:false};this.m_strFileName="report";this.m_strAppendFileName="";this.m_isPaintImage=false;this.m_isUseOriginImage=false;this.m_pdfLink=null;this.m_exeLink=null;this.isPDFPrintImage=false;this.m_printPage={pageWidth:2100,pageHeight:2970};this.isChromePrintFitToPage=false;this.isEnabledAdobeRead=true;this.m_isMarkAny=false;this.m_isRedBC=false;this.m_isChartToImage=false;this.pESaveButtonVisible=true;this.m_isPrintPop=false;this.m_firefoxPrint={isPopup:true,width:750,height:600};this.m_mobile={scrollTop:true};this.m_pcView={scrollTop:true};this.m_scrollEv={isScrollPaging:false,isBottomEvent:null};this.m_drilingTop=null;this.m_comboNames={num50:{name:"50%",visible:true},num75:{name:"75%",visible:true},num100:{name:"100%",visible:true},num125:{name:"125%",visible:true},num150:{name:"150%",visible:true},num200:{name:"200%",visible:true},num300:{name:"300%",visible:true},num400:{name:"400%",visible:true},pagewidth:{name:"PageWidth",visible:true},wholepage:{name:"WholePage",visible:true}};this.m_signOption={offsetLeft:0,offsetTop:0,staticPos:false,staticLeft:null,staticTop:null};this.m_necessaryCheck=false;this.m_debug={isDebug:false,isConsole:false,isLock:false,message:null};this.m_editOp=true;this.is_eForm=false;this.is_eFormData=false;this.eForm_isNecessary={pageList:null,check:false,is_start:false};this.eFormData=null;this.eFormCheckImage=null;this.eFormRadioImage=null;this.eFormControlList=null;this.eFormControlGroupList=null;this.eFormDoodleOption={is_Ds:false,is_eraser:false,is_eraser_down:false,is_move:false,zoomIn:1,tos:null,path:null,pathArray:null,gesture:{isStart:false,pos:null,zoom:1,line:0,zoomUp:1},pens:{width:16,color:"rgb(237, 68, 61)",op:0.5},tempPens:{width:16,color:"rgb(237, 68, 61)",op:0.5,penList:[],opList:[],colorList:[]},pagePathSave:[],pageImgSave:[]};this.printNames={pdf:"PDF",hwp:"HWP",html:"HTML",exe:"EXE"};this.m_selectPageType={print:1,save:1};this.m_exePrintStatus={url:"http://127.0.0.1:",port:[22000,33000,11000],httpPort:[22000,33000,11000],httpsPort:[22443,33443,11443],intervalKey:null,disConnectCount:0,isSet:false,portNumber:null};this.m_exePrintOption={isPrintPopup:true,printName:"",tray:"",startNumber:1,endNumber:-1,copies:1,option:""};this.m_isViewer=true;this.m_TPC={before:"/ ",after:""};this.m_isTOCVisible=false;this.m_isSwipe=false;this.m_PageMove={ButtonDisabled:true,leftDOM:null,rightDOM:null,eventKey:null,doubleEventKey:null};this.m_firefox_Reevent=null;this.m_bodyWidth=document.body.offsetWidth;this.m_is_eform_nextPage=false;this.m_isCrossDomainPDF=false;this.m_html_info=null;this.m_ignorePDFObject=false;this.m_splitPage=0;this.m_is_serverSaveFile=true;this.m_syncPageServletPath=null;this.m_isHybridProgress=false;this.m_txtExtension="txt";this.m_isPopupSaveDownload=false;}Report.prototype.saveExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var d=document.createElement("div");d.className="report_save_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:15px;right:15px;top:5%;height:15%;border:1px solid darkgray'>");a.push("<select title='"+this.m_languageMap.fileType+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExportType(this)\" style='position:absolute;left:10px;top:15px;width:70%;height:50%;font-size:9pt;'>");var b=["excel","excelx","pdf","hwp","rtf","ppt","html5","hancell","doc","jpg","txt","tif","multiTif","excelData","docx"];if((typeof window.ReportSaveMenuOrder!="undefined")){b=ReportSaveMenuOrder();}for(var c=0;c<b.length;c++){if(this.saveOptionVisible.excel&&b[c]=="excel"){a.push("<option value='1' ");a.push((this.defaultSaveOption=="excel"?"selected":""));a.push(">"+this.m_languageMap.excel_save+"(*.xls)</option>");}if(this.saveOptionVisible.excelx&&b[c]=="excelx"){a.push("<option value='10' ");a.push((this.defaultSaveOption=="excelx"?"selected":""));a.push(">"+this.m_languageMap.excel_save+"(*.xlsx)</option>");}if(this.saveOptionVisible.pdf&&b[c]=="pdf"){a.push("<option value='2' ");a.push((this.defaultSaveOption=="pdf"?"selected":""));a.push(">"+this.m_languageMap.pdf_save+"(*.pdf)</option>");}if(this.saveOptionVisible.hwp&&b[c]=="hwp"){a.push("<option value='3' ");a.push((this.defaultSaveOption=="hwp"?"selected":""));a.push(">"+this.m_languageMap.hwp_save+"(*.hwp)</option>");}if(this.saveOptionVisible.rtf&&b[c]=="rtf"){a.push("<option value='4' ");a.push((this.defaultSaveOption=="rtf"?"selected":""));a.push(">"+this.m_languageMap.rtf_save+"(*.rtf)</option>");}if(this.saveOptionVisible.ppt&&b[c]=="ppt"){a.push("<option value='5' ");a.push((this.defaultSaveOption=="ppt"?"selected":""));a.push(">"+this.m_languageMap.ppt_save+"(*.ppt)</option>");}if(this.saveOptionVisible.html&&b[c]=="html"){a.push("<option value='6' ");a.push((this.defaultSaveOption=="html"?"selected":""));a.push(">"+this.m_languageMap.html_save+"(*.html)</option>");}if(this.saveOptionVisible.hancell&&b[c]=="hancell"){a.push("<option value='7' ");a.push((this.defaultSaveOption=="hancell"?"selected":""));a.push(">"+this.m_languageMap.hancell_save+"(*.cell)</option>");}if(this.saveOptionVisible.html5&&b[c]=="html5"){a.push("<option value='8' ");a.push((this.defaultSaveOption=="html5"?"selected":""));a.push(">"+this.m_languageMap.html5_save+"(*.html)</option>");}if(this.saveOptionVisible.doc&&b[c]=="doc"){a.push("<option value='9' ");a.push((this.defaultSaveOption=="doc"?"selected":""));a.push(">"+this.m_languageMap.doc_save+"(*.doc)</option>");}if(this.saveOptionVisible.jpg&&b[c]=="jpg"){a.push("<option value='11' ");a.push((this.defaultSaveOption=="jpg"?"selected":""));a.push(">"+this.m_languageMap.jpg_save+"(*.jpg)</option>");}if(this.saveOptionVisible.txt&&b[c]=="txt"){a.push("<option value='12' ");a.push((this.defaultSaveOption=="txt"?"selected":""));a.push(">"+this.m_languageMap.txt_save+"(*.txt)</option>");}if(this.saveOptionVisible.tif&&b[c]=="tif"){a.push("<option value='13' ");a.push((this.defaultSaveOption=="tif"?"selected":""));a.push(">"+this.m_languageMap.tif_save+"(*.tif)</option>");}if(this.saveOptionVisible.multiTif&&b[c]=="multiTif"){a.push("<option value='14' ");a.push((this.defaultSaveOption=="multiTif"?"selected":""));a.push(">Multi "+this.m_languageMap.tif_save+"(*.tif)</option>");}if(this.saveOptionVisible.excelData&&b[c]=="excelData"){a.push("<option value='15' ");a.push((this.defaultSaveOption=="excelData"?"selected":""));a.push("> "+this.m_languageMap.excelData_save+"(*.xls)</option>");}if(this.saveOptionVisible.docx&&b[c]=="docx"){a.push("<option value='16' ");a.push((this.defaultSaveOption=="docx"?"selected":""));a.push(">"+this.m_languageMap.docx_save+"(*.docx)</option>");}}a.push("</select>");a.push("<button title='"+this.m_languageMap.propertys+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_editOptionInfo();return false;\" class='report_view_button' style='position:absolute;right:10px;top:15px;width:20%;height:50%;font-size:8pt'><nobr>"+this.m_languageMap.propertys+"</nobr></button>");a.push("</div>");a.push("<div style='position:absolute;left:15px;right:15px;top:27%;height:15%;border:1px solid darkgray'>");a.push("<input title='"+this.m_languageMap.fileName+"' type='text' style='position:absolute;left:10px;top:12px;width:90%;height:45%;padding-left:5px' value='"+this.m_strFileName+"'/>");a.push("</div>");a.push("<div style='position:absolute;left:15px;right:15px;top:50%;height:34%;border:1px solid darkgray'>");a.push("<table style='position:absolute;top:15px'>");a.push("<tr><td aria-label='"+this.m_languageMap.total_page+"' title='"+this.m_languageMap.total_page+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(1);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',1); tabindex='0'>");a.push("<input title='"+this.m_languageMap.total_page+"' name='m_ReSelectRange' type='radio' value='1' tabindex='-1' "+(this.m_selectPageType.save==1?"checked":"")+"/>"+this.m_languageMap.total_page);if(this.m_pageCount>this.m_splitPage&&0!=this.m_splitPage){a.push("<font style='color:red'> ("+this.m_splitPage+" ");a.push(this.m_languageMap.splitPage);a.push(")</font>");}a.push("</td></tr>");a.push("<tr><td aria-label='"+this.m_languageMap.currentPage+"' title='"+this.m_languageMap.currentPage+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(2);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',2); tabindex='0'>");a.push("<input title='"+this.m_languageMap.currentPage+"' name='m_ReSelectRange' type='radio' tabindex='-1' value='2' "+(this.m_selectPageType.save==2?"checked":"")+"/>"+this.m_languageMap.currentPage+"</td></tr>");a.push("<tr><td aria-label='"+this.m_languageMap.page_designation+"' title='"+this.m_languageMap.page_designation+"' style='cursor:default' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectSaveRange(3);\" onkeypress=mKey_selectSaveRange(event,'"+this.m_uid+"',3); tabindex='0'>");a.push("<input title='"+this.m_languageMap.page_designation+"' name='m_ReSelectRange' type='radio' tabindex='-1' value='3' "+(this.m_selectPageType.save==3?"checked":"")+"/>"+this.m_languageMap.page_designation+"</td></tr>");a.push("<tr><td style='padding-left:25px;padding-top:5px'>");a.push("<input title='"+this.m_languageMap.from+"' type='text' style='width:40px' value='1' "+(this.m_selectPageType.save!=3?"disabled":"")+"/>"+this.m_languageMap.from+" &nbsp;&nbsp;&nbsp;");a.push("<input title='"+this.m_languageMap.to+"' type='text' style='width:40px' value='"+this.m_pageCount+"' "+(this.m_selectPageType.save!=3?"disabled":"")+"/>"+this.m_languageMap.to+"");a.push("</td></tr>");a.push("</table>");a.push("</div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:3%;border:0;'>"+this.m_languageMap.fileType+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:25%;border:0;'>"+this.m_languageMap.fileName+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:48%;border:0;'>"+this.m_languageMap.save_range+"</span>");a.push("<button onclick=\"m_reportHashMap['"+this.m_uid+"'].saveExportFileInfo();return false;\" title='"+this.m_languageMap.save+"' class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");a.push("<button onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeReportSaveInfo();return false;\" title='"+this.m_languageMap.cancel+"' class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:82%;font-size:8pt;color:red'></span>");d.innerHTML=a.join("");a=null;this.m_popupViewDiv.appendChild(d);this.mRe_setViewDomInfo(d);if(this.saveOptionVisible.excel&&this.defaultSaveOption=="excel"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");this.makeExcelSaveOptionWindow();}if(this.saveOptionVisible.excelx&&this.defaultSaveOption=="excelx"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");this.makeExcelSaveOptionWindow();}else{if(this.saveOptionVisible.pdf&&this.defaultSaveOption=="pdf"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(this.m_saveInfo_view.child_option.json_data,this.splitPDFFileNames);this.makePDFSaveOptionWindow();}else{if(this.saveOptionVisible.hwp&&this.defaultSaveOption=="hwp"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();this.makeHWPSaveOptionWindow();}else{if(this.saveOptionVisible.rtf&&this.defaultSaveOption=="rtf"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");this.makeRTFSaveOptionWindow(false);}else{if(this.saveOptionVisible.ppt&&this.defaultSaveOption=="ppt"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();this.makePPTSaveOptionWindow();}else{if(this.saveOptionVisible.html&&this.defaultSaveOption=="html"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHTMLOp!=null?this.m_defaultSaveHTMLOp:mRe_getDefaultSaveHTMLOption();this.makeHTMLSaveOptionWindow();}else{if(this.saveOptionVisible.hancell&&this.defaultSaveOption=="hancell"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");this.makeExcelSaveOptionWindow();}else{if(this.saveOptionVisible.html5&&this.defaultSaveOption=="html5"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();this.makeHTML5SaveOptionWindow();}else{if(this.saveOptionVisible.doc&&this.defaultSaveOption=="doc"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");this.makeRTFSaveOptionWindow(false);}else{if(this.saveOptionVisible.jpg&&this.defaultSaveOption=="jpg"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();this.makeJPGSaveOptionWindow();}else{if(this.saveOptionVisible.txt&&this.defaultSaveOption=="txt"){this.m_saveInfo_view.child_option.json_data={};}else{if(this.saveOptionVisible.tif&&this.defaultSaveOption=="tif"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();this.makeTIFSaveOptionWindow();}else{if(this.saveOptionVisible.multiTif&&this.defaultSaveOption=="multiTif"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();this.makeMultiTIFSaveOptionWindow();}else{if(this.saveOptionVisible.excelData&&this.defaultSaveOption=="excelData"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();this.makeExcelDataSaveOptionWindow();}else{if(this.saveOptionVisible.docx&&this.defaultSaveOption=="docx"){this.m_saveInfo_view.child_option.json_data=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");this.makeRTFSaveOptionWindow(true);}}}}}}}}}}}}}}}};Report.prototype.saveExportFileInfo=function(){this.m_isButtonLock=false;if(null!=this.m_saveInfo_view){if(this.saveViewValidationCheck()){this.makeExportSaveOption();this.submitSaveOption();this.mRe_closeReportSaveInfo();}}};Report.prototype.makeExportSaveOption=function(){var b=this.m_saveInfo_view;var a=new Object();a.exportType=Number(b.fileTypeDom.value);a.name=Base64.encode(b.fileNameDom.value+this.m_strAppendFileName);if(b.check1Dom.checked){a.pageType=1;a.startNum=1;a.endNum=this.m_pageCount;}else{if(b.check2Dom.checked){a.pageType=2;a.startNum=this.beforePageIndex+1;a.endNum=this.beforePageIndex+1;}else{a.pageType=3;a.startNum=Number(b.startInDom.value);a.endNum=Number(b.endInDom.value);}}a.option=b.child_option.json_data;if(null==a.option){a.option={};}this.m_saveInfo_view.json_data=a;b=null;a=null;};Report.prototype.submitSaveOption=function(){this.debugMeg("report log :: 파일 저장 시작..");this.createSAVEProgress();if(null!=this.m_saveInfo_view.json_data){var a=this.m_pageCount>this.m_splitPage?this.m_splitPage:0;if(null!=this.m_saveInfo_view.json_data.option){this.m_saveInfo_view.json_data.option.splitPage=a;}if(this.m_saveInfo_view.json_data.exportType==12){this.m_saveInfo_view.json_data.option.extension=this.m_txtExtension;}}var c="R09";var e="R09";if(this.m_is_serverSaveFile){c="R09S1";e="R09S3";}var d="ClipID="+c+"&clipUID="+this.m_uid+"&uid="+this.m_uid+"&path="+escape(this.clientPath)+"&optionValue="+encodeURIComponent(JSON.stringify(this.m_saveInfo_view.json_data))+"&exportN="+this.m_saveInfo_view.json_data.name+"&exportType="+this.m_saveInfo_view.json_data.exportType+"&is_ie="+((!is_firefox)&&(!is_safari)&&(!is_apple));this.saveFormTag.acceptCharset="UTF-8";this.saveFormTag.clipid.value=e;this.saveFormTag.uid.value=this.m_uid;this.saveFormTag.clipUID.value=this.m_uid;this.saveFormTag.path.value=this.clientPath;if(null!=this.m_saveInfo_view.json_data){this.saveFormTag.option.value=JSON.stringify(this.m_saveInfo_view.json_data);}else{this.saveFormTag.option.value="";}this.saveFormTag.filename.value=this.m_saveInfo_view.json_data.name;this.saveFormTag.filetype.value=this.m_saveInfo_view.json_data.exportType;this.debugMeg("report log :: 파일 저장 옵션 check >> "+m_getSaveFormTag(this.saveFormTag));if(this.m_is_serverSaveFile){if(this.mRe_serverSaveFileOption(d)){this.mRe_saveFile_progress_check();}else{this.debugMeg("report log :: 서버에 파일 저장에 문제가 발생하였습니다. 서버 로그를 확인하세요.");}}else{var b=true;if(window.onSaveBeforeSend!=null){b=onSaveBeforeSend(this,d,"save");}if(b){this.mRe_saveFile_demon();this.mRe_saveFile_progress_check();}}};Report.prototype.mRe_serverSaveFileOption=function(h){try{var a=mRe_onBeforeSend(h);var f=this.servletPath;var c=new HttpClient();var b=c.send(f,a,false,null);b=mRe_onAfterSend(b);var d=objectCall(ClipStrTrim(b));if(typeof d=="string"){d=objectCall(d);}return d.status;}catch(g){mRe_ReportWebLog(g.message);}return false;};Report.prototype.mRe_saveFile_progress_check=function(){var a=this;var b=this.m_uid;if(a.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("save");},1000);}};Report.prototype.mRe_saveFile_demon=function(){if(-1!=this.servletPath.indexOf("?")){if(is_smartphone){window.open(this.servletPath+"&"+m_getSaveFormTag(this.saveFormTag));}else{var a=document.getElementById("re_iframe"+this.m_uid);if(null!=a){a.src=this.servletPath+"&"+m_getSaveFormTag(this.saveFormTag);}}}else{this.saveFormTag.form.action=this.servletPath;if(is_smartphone||this.m_isPopupSaveDownload){this.saveFormTag.form.target="_blank";}else{this.saveFormTag.form.target="re_target"+this.m_uid;}this.saveFormTag.form.submit();}};Report.prototype.saveViewValidationCheck=function(){var c=this.m_saveInfo_view;var d=c.fileNameDom.value;d=d.replace(/(^\s*)|(\s*$)/gi,"");if(""==d){c.validationDom.innerHTML=this.m_languageMap.printName_validation;c=null;return false;}else{if(c.check3Dom.checked){var b=Number(c.startInDom.value);var a=Number(c.endInDom.value);if(isNaN(b)||isNaN(a)){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}else{if(b<=0.9||a<=0.9||b>a||b>this.m_pageCount||a>this.m_pageCount){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}}}}c=null;return true;};Report.prototype.mRe_setViewDomInfo=function(b){this.m_saveInfo_view=new Object();this.m_saveInfo_view.child_option=new Object();var c=this.m_saveInfo_view;c.viewDom=b;var a=b.firstChild;c.validationDom=b.lastChild;c.cancelButtonDom=c.validationDom.previousSibling;c.saveButtonDom=c.cancelButtonDom.previousSibling;c.fileTypeDom=a.firstChild;c.detailButtonDom=a.lastChild;a=a.nextSibling;c.fileNameDom=a.firstChild;a=a.nextSibling.firstChild.lastChild.firstChild;c.check1Dom=a.firstChild.firstChild;c.check1TdDom=a.firstChild;a=a.nextSibling;c.check2Dom=a.firstChild.firstChild;c.check2TdDom=a.firstChild;a=a.nextSibling;c.check3Dom=a.firstChild.firstChild;c.check3TdDom=a.firstChild;a=a.nextSibling.firstChild.firstChild;c.startInDom=a;a=a.nextSibling.nextSibling;c.endInDom=a;c.fileTypeDom.focus();a=null;c=null;};Report.prototype.mRe_disabledViewDomInfo=function(b){var a=this.m_saveInfo_view;a.cancelButtonDom.disabled=b;a.saveButtonDom.disabled=b;a.fileTypeDom.disabled=b;a.fileNameDom.disabled=b;a.check1Dom.disabled=b;a.check2Dom.disabled=b;a.check3Dom.disabled=b;if(b){a.check1TdDom.tabIndex=-1;a.check2TdDom.tabIndex=-1;a.check3TdDom.tabIndex=-1;a.startInDom.disabled=b;a.endInDom.disabled=b;}else{a.check1TdDom.tabIndex=0;a.check2TdDom.tabIndex=0;a.check3TdDom.tabIndex=0;if(a.check3Dom.checked){a.startInDom.disabled=b;a.endInDom.disabled=b;}a.fileTypeDom.focus();}};Report.prototype.mRe_editOptionInfo=function(){this.mRe_disabledViewDomInfo(true);this.editOptionInfo(this.m_saveInfo_view.fileTypeDom.value);};Report.prototype.editOptionInfo=function(a){this.m_editOp=true;var b=Number(a);switch(b){case 1:this.mRe_disabledExcelViewDomInfo(false);break;case 2:this.mRe_disabledPDFViewDomInfo(false);break;case 3:this.mRe_disabledHWPViewDomInfo(false);break;case 4:this.mRe_disabledRTFViewDomInfo(false);break;case 5:this.mRe_disabledPPTViewDomInfo(false);break;case 6:this.mRe_disabledHTMLViewDomInfo(false);break;case 7:this.mRe_disabledExcelViewDomInfo(false);break;case 8:this.mRe_disabledHTML5ViewDomInfo(false);break;case 9:this.mRe_disabledRTFViewDomInfo(false);break;case 10:this.mRe_disabledExcelViewDomInfo(false);break;case 11:this.mRe_disabledJPGViewDomInfo(false);break;case 13:this.mRe_disabledTIFViewDomInfo(false);break;case 14:this.mRe_disabledMultiTIFViewDomInfo(false);break;case 15:this.mRe_disabledExcelDataViewDomInfo(false);break;case 16:this.mRe_disabledRTFViewDomInfo(false);break;default:break;}};Report.prototype.mRe_selectSaveRange=function(a){if(this.m_saveInfo_view.check1Dom.disabled){return;}if(1==a){this.m_saveInfo_view.check1Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=true;this.m_saveInfo_view.endInDom.disabled=true;}else{if(2==a){this.m_saveInfo_view.check2Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=true;this.m_saveInfo_view.endInDom.disabled=true;}else{this.m_saveInfo_view.check3Dom.checked=true;this.m_saveInfo_view.startInDom.disabled=false;this.m_saveInfo_view.endInDom.disabled=false;}}};Report.prototype.mRe_selectExportType=function(a){var d=Number(a.value);var c=this.m_saveInfo_view.child_option;var b=this.m_saveInfo_view.detailButtonDom;if(null!=c.viewDom){this.m_popupViewDiv.removeChild(c.viewDom);}this.m_saveInfo_view.child_option=new Object();c=this.m_saveInfo_view.child_option;b.disabled=false;switch(d){case 1:c.json_data=this.m_defaultSaveExcelOp!=null?this.m_defaultSaveExcelOp:mRe_getDefaultSaveExcelOption("xls");this.makeExcelSaveOptionWindow();break;case 2:c.json_data=this.m_defaultSavePDFOp!=null?this.m_defaultSavePDFOp:mRe_getDefaultSavePDFOption();mRe_setPDFFileList(c.json_data,this.splitPDFFileNames);this.makePDFSaveOptionWindow();break;case 3:c.json_data=this.m_defaultSaveHWPOp!=null?this.m_defaultSaveHWPOp:mRe_getDefaultSaveHWPOption();this.makeHWPSaveOptionWindow();break;case 4:c.json_data=this.m_defaultSaveRTFOp!=null?this.m_defaultSaveRTFOp:mRe_getDefaultSaveRTFOption("rtf");this.makeRTFSaveOptionWindow(false);break;case 5:c.json_data=this.m_defaultSavePPTOp!=null?this.m_defaultSavePPTOp:mRe_getDefaultSavePPTOption();this.makePPTSaveOptionWindow();break;case 6:c.json_data=this.m_defaultSaveHTMLOp!=null?this.m_defaultSaveHTMLOp:mRe_getDefaultSaveHTMLOption();this.makeHTMLSaveOptionWindow();break;case 7:c.json_data=this.m_defaultSaveHanCellOp!=null?this.m_defaultSaveHanCellOp:mRe_getDefaultSaveExcelOption("cell");this.makeExcelSaveOptionWindow();break;case 8:c.json_data=this.m_defaultSaveHTML5Op!=null?this.m_defaultSaveHTML5Op:mRe_getDefaultSaveHTML5Option();this.makeHTML5SaveOptionWindow();break;case 9:c.json_data=this.m_defaultSaveDOCOp!=null?this.m_defaultSaveDOCOp:mRe_getDefaultSaveRTFOption("doc");this.makeRTFSaveOptionWindow(false);break;case 10:c.json_data=this.m_defaultSaveExcelxOp!=null?this.m_defaultSaveExcelxOp:mRe_getDefaultSaveExcelOption("xlsx");this.makeExcelSaveOptionWindow();break;case 11:c.json_data=this.m_defaultSaveJPGOp!=null?this.m_defaultSaveJPGOp:mRe_getDefaultSaveJPGOption();this.makeJPGSaveOptionWindow();break;case 12:c.json_data=null;b.disabled=true;break;case 13:c.json_data=this.m_defaultSaveTIFOp!=null?this.m_defaultSaveTIFOp:mRe_getDefaultSaveTIFOption();this.makeTIFSaveOptionWindow();break;case 14:c.json_data=this.m_defaultSaveMultiTIFOp!=null?this.m_defaultSaveMultiTIFOp:mRe_getDefaultSaveMultiTIFOption();this.makeMultiTIFSaveOptionWindow();break;case 15:c.json_data=this.m_defaultSaveExcelDataOp!=null?this.m_defaultSaveExcelDataOp:mRe_getDefaultSaveExcelDataOption();this.makeExcelDataSaveOptionWindow();break;case 16:c.json_data=this.m_defaultSaveDOCXOp!=null?this.m_defaultSaveDOCXOp:mRe_getDefaultSaveRTFOption("docx");this.makeRTFSaveOptionWindow(true);break;default:break;}};Report.prototype.mRe_closeReportSaveInfo=function(){this.m_isButtonLock=false;if(null!=this.m_popupViewDiv){this.targetDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;}this.m_saveInfo_view=null;this.disabledMenu(false);this.save_button.focus();if(this.m_buttonEvent.endSaveButton!=null){this.m_buttonEvent.endSaveButton();}};Report.prototype.makeExcelSaveOptionWindow=function(){this.m_editOp=false;var d=this.m_saveInfo_view.child_option.json_data;var c=document.createElement("div");c.className="report_saveExcel_view_position report_view_box";var b=new Array();b.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:30%;'>");b.push("<select onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExcelExportMethod(this)\" title='"+this.m_languageMap.sheet_type+"' style='position:absolute;right:0px;width:75%;height:25px;font-size:9pt;' disabled>");b.push("<option value='1' "+(d.exportMethod==1?"selected":"")+">"+this.m_languageMap.sheet_type1+"</option>");b.push("<option value='2' "+(d.exportMethod==2?"selected":"")+">"+this.m_languageMap.sheet_type2+"</option>");b.push("<option value='3' "+(d.exportMethod==3?"selected":"")+">"+this.m_languageMap.sheet_type3+"</option>");b.push("<option value='5' "+(d.exportMethod==5?"selected":"")+">"+this.m_languageMap.sheet_type5+"</option>");b.push("<option value='4' "+(d.exportMethod==4?"selected":"")+">"+this.m_languageMap.sheet_type4+"</option>");b.push("</select>");b.push("<table style='position:absolute;top:30px;cursor:default' cellpadding='0' cellspacing='0' border='0'>");b.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectExcelOpCheck();\"><input title='"+this.m_languageMap.merge_cell+"' type='checkbox' "+(d.mergeCell?"checked":"")+" disabled/>"+this.m_languageMap.merge_cell+"</td></tr>");b.push("<tr><td style='padding-left:15px' valign='middle'><input title='"+this.m_languageMap.merge_EmptyCell+"' type='checkbox' "+(d.mergeEmptyCell?"checked":"")+" disabled/>"+this.m_languageMap.merge_EmptyCell+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.cell_Separated+"' type='checkbox' "+(d.splitCellAtPageSize?"checked":"")+" disabled/>"+this.m_languageMap.cell_Separated+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.rightToLeft+"' type='checkbox' "+(d.rightToLeft?"checked":"")+" disabled/>"+this.m_languageMap.rightToLeft+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.fitToPageWhenPrinting+"' type='checkbox' "+(d.fitToPageWhenPrinting?"checked":"")+" disabled/>"+this.m_languageMap.fitToPageWhenPrinting+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' "+(d.removeHyperlink?"checked":"")+" disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");b.push("<tr><td valign='middle'><input title='"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"' type='checkbox' "+(d.repeatPageSectionWhenAllSectionInOneSheet?"checked":"")+" disabled/>"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"</td></tr>");b.push("</table>");b.push("<span style='position:absolute;top:5px;'>"+this.m_languageMap.sheet_type+" :</span>");b.push("</div>");b.push("<div style='position:absolute;left:15px;right:15px;top:40%;height:20%;border:1px solid darkgray'>");b.push("<table style='position:absolute;top:10px;left:5px'>");b.push("<tr><td style='cursor:default'>"+this.m_languageMap.cellWidth+" : <input id='re_excelwidthRate_"+this.m_uid+"' title='"+this.m_languageMap.cellWidth+"' type='text' value='"+d.widthRate+"' maxlength='3' style='width:150px;' disabled/> %</td></tr>");b.push("<tr><td style='cursor:default'>"+this.m_languageMap.cellHeight+" : <input id='re_excelheightRate_"+this.m_uid+"' title='"+this.m_languageMap.cellHeight+"' type='text' value='"+d.heightRate+"' maxlength='3' style='width:150px;' disabled/> %</td></tr>");b.push("</table>");b.push("</div>");b.push("<div style='position:absolute;left:13px;right:15px;top:65%;height:20%;'>");b.push("<input title='"+this.m_languageMap.rangeError+"' type='text' value='"+d.coordinateErrorLimit+"' style='position:absolute;right:0px;height:18px;width:170px' disabled/>");b.push("<select title='"+this.m_languageMap.displayFormat+"' style='position:absolute;right:0px;height:23px;width:150px;top:28px;font-size:9pt;' disabled>");b.push("<option value='1' "+(d.processGerenalFormat==1?"selected":"")+">"+this.m_languageMap.text+"</option>");b.push("<option value='2' "+(d.processGerenalFormat==2?"selected":"")+">"+this.m_languageMap.normal+"</option>");b.push("</select>");b.push("<input title='"+this.m_languageMap.printRate+"' type='text' value='"+d.printingMagnification+"' style='position:absolute;top:54px;right:0px;height:18px;width:145px' maxlength='3' disabled/>");var a=this.m_language==0?5:0;b.push("<span style='position:absolute;top:"+a+"px;left:0px;width:100px'>"+this.m_languageMap.rangeError+" : </span>");b.push("<span style='position:absolute;top:33px;left:0px;width:150px'>"+this.m_languageMap.displayFormat+" : </span>");b.push("<span style='position:absolute;top:58px;left:0px;width:150px'>"+this.m_languageMap.printRate+" : </span>");b.push("</div>");b.push("<span class='report_view_box' style='position:absolute;left:20px;top:38.5%;border:0;'>"+this.m_languageMap.cellSizeRatio+"</span>");b.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveExcelOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");b.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelExcelOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");b.push("<span style='position:absolute;left:16px;top:85%;font-size:8pt;color:red'></span>");c.innerHTML=b.join("");b=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(c);}this.mRe_setExcelViewDomInfo(c);};Report.prototype.mRe_setExcelViewDomInfo=function(a){var d=this.m_saveInfo_view.child_option;d.viewDom=a;var c=a.firstChild;d.validationDom=a.lastChild;d.cancelButtonDom=d.validationDom.previousSibling;d.saveButtonDom=d.cancelButtonDom.previousSibling;d.exportMethodDom=c.firstChild;var b=d.exportMethodDom.nextSibling.firstChild.firstChild;d.mergeCellDom=b.firstChild.firstChild;b=b.nextSibling;d.mergeEmptyCellDom=b.firstChild.firstChild;b=b.nextSibling;d.splitCellAtPageSizeDom=b.firstChild.firstChild;b=b.nextSibling;d.rightToLeftDom=b.firstChild.firstChild;b=b.nextSibling;d.fitToPageWhenPrintingDom=b.firstChild.firstChild;b=b.nextSibling;d.removeHyperlinkDom=b.firstChild.firstChild;b=b.nextSibling;d.repeatPageSectionWhenAllSectionInOneSheetDom=b.firstChild.firstChild;d.widthRateDom=document.getElementById("re_excelwidthRate_"+this.m_uid);d.heightRateDom=document.getElementById("re_excelheightRate_"+this.m_uid);c=c.nextSibling.nextSibling;d.coordinateErrorLimitDom=c.firstChild;d.processGerenalFormatDom=d.coordinateErrorLimitDom.nextSibling;d.printingMagnification=d.processGerenalFormatDom.nextSibling;b=null;c=null;d=null;};Report.prototype.mRe_disabledExcelViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.exportMethodDom.disabled=b;a.mergeCellDom.disabled=b;if(a.mergeCellDom.checked){a.mergeEmptyCellDom.disabled=b;}a.splitCellAtPageSizeDom.disabled=b;a.rightToLeftDom.disabled=b;a.fitToPageWhenPrintingDom.disabled=b;a.widthRateDom.disabled=b;a.heightRateDom.disabled=b;a.coordinateErrorLimitDom.disabled=b;a.processGerenalFormatDom.disabled=b;a.printingMagnification.disabled=b;a.removeHyperlinkDom.disabled=b;if(a.exportMethodDom.value=="3"||a.exportMethodDom.value=="4"){a.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=b;}};Report.prototype.mRe_selectExcelExportMethod=function(a){var b=this.m_saveInfo_view.child_option;if(a.value=="3"||a.value=="4"){b.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=false;}else{b.repeatPageSectionWhenAllSectionInOneSheetDom.disabled=true;}};Report.prototype.mRe_cancelExcelOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeExcelSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveExcelOptionInfo=function(){if(this.saveExcelOptionViewValidationCheck()){this.setExcelOptionValue();this.mRe_cancelExcelOptionInfo();}};Report.prototype.saveExcelOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.widthRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.widthError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.widthErrorValue;b=null;return false;}}a=Number(b.heightRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.heightError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.heightErrorValue;b=null;return false;}}a=Number(b.coordinateErrorLimitDom.value);if(isNaN(a)||a<=0){b.validationDom.innerHTML=this.m_languageMap.coordinateError;b=null;return false;}a=Number(b.printingMagnification.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.printError;b=null;return false;}else{if(a<10||a>400){b.validationDom.innerHTML=this.m_languageMap.printErrorValue;b=null;return false;}}b=null;return true;};Report.prototype.mRe_selectExcelOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.mergeCellDom.checked&&this.m_editOp){a.mergeEmptyCellDom.disabled=false;}else{a.mergeEmptyCellDom.checked=false;a.mergeEmptyCellDom.disabled=true;}a=null;};Report.prototype.setExcelOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.exportMethod=b.exportMethodDom.value;a.mergeCell=b.mergeCellDom.checked;a.mergeEmptyCell=b.mergeEmptyCellDom.checked;a.splitCellAtPageSize=b.splitCellAtPageSizeDom.checked;a.rightToLeft=b.rightToLeftDom.checked;a.widthRate=Number(b.widthRateDom.value);a.heightRate=Number(b.heightRateDom.value);a.coordinateErrorLimit=Number(b.coordinateErrorLimitDom.value);a.processGerenalFormat=Number(b.processGerenalFormatDom.value);a.printingMagnification=Number(b.printingMagnification.value);a.fitToPageWhenPrinting=b.fitToPageWhenPrintingDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;a.repeatPageSectionWhenAllSectionInOneSheet=b.repeatPageSectionWhenAllSectionInOneSheetDom.checked;b=null;a=null;};function mRe_getDefaultSaveExcelOption(a){var b=null;if(("xls"==a)&&(typeof window.getDefaultSaveExcelOption!="undefined")){b=getDefaultSaveExcelOption();b.type=a;}else{if(("xlsx"==a)&&(typeof window.getDefaultSaveExcelOption!="undefined")){b=getDefaultSaveExcelxOption();b.type=a;}else{if((typeof window.getDefaultSaveHanCellOption!="undefined")){b=getDefaultSaveHanCellOption();b.type=a;}else{b={type:a,exportMethod:"1",mergeCell:true,mergeEmptyCell:false,splitCellAtPageSize:true,rightToLeft:false,widthRate:100,heightRate:100,coordinateErrorLimit:10,processGerenalFormat:1,printingMagnification:100,fitToPageWhenPrinting:false,removeHyperlink:false,repeatPageSectionWhenAllSectionInOneSheet:false};}}}return b;}Report.prototype.makeHWPSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveHWP_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:10px;height:150px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'>");a.push("<span style='position:relative;left:10px;width:130px'>"+this.m_languageMap.hwpExportMethod+" : </span>");a.push("<select id='re_hwp13"+this.m_uid+"' title='"+this.m_languageMap.hwpExportMethod+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectHwpExportMethod(this)\" style='position:relative;left:23px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.hwpExportMethod==1?"selected":"")+">"+this.m_languageMap.normal+"</option>");a.push("<option value='2' "+(c.hwpExportMethod==2?"selected":"")+">"+this.m_languageMap.listTableOnly+"</option>");a.push("</select>");a.push("</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp14"+this.m_uid+"' title='"+this.m_languageMap.splitPageOnListTableOnly+"' type='checkbox' "+(c.splitPageOnListTableOnly?"checked":"")+" disabled/>"+this.m_languageMap.splitPageOnListTableOnly+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp1"+this.m_uid+"' title='"+this.m_languageMap.fixSize+"' type='checkbox' "+(c.fixSize?"checked":"")+" disabled/>"+this.m_languageMap.fixSize+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'>");a.push("<span style='position:relative;left:10px;width:130px'>"+this.m_languageMap.positionRelTo+" : </span>");a.push("<select id='re_hwp12"+this.m_uid+"' title='"+this.m_languageMap.positionRelTo+"' onChange=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPositionRelTo(this)\" style='position:relative;left:23px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.positionRelTo==1?"selected":"")+">"+this.m_languageMap.paper+"</option>");a.push("<option value='2' "+(c.positionRelTo==2?"selected":"")+">"+this.m_languageMap.paragraph+"</option>");a.push("</select>");a.push("</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp2"+this.m_uid+"' title='"+this.m_languageMap.allowOverlay+"' type='checkbox' "+(c.allowOverlay?"checked":"")+" disabled/>"+this.m_languageMap.allowOverlay+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp10"+this.m_uid+"' title='"+this.m_languageMap.mergeTable+"' type='checkbox' "+(c.mergeTable?"checked":"")+" disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:15px'><input id='re_hwp3"+this.m_uid+"' title='"+this.m_languageMap.setPageBottomMarginToZero+"' type='checkbox' "+(c.setPageBottomMarginToZero?"checked":"")+" disabled/>"+this.m_languageMap.setPageBottomMarginToZero+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:25px'>"+this.m_languageMap.pageBottomMarginApplicationRate+" : <input id='re_hwp15"+this.m_uid+"' title='"+this.m_languageMap.pageBottomMarginApplicationRate+"' value='"+c.pageBottomMarginApplicationRate+"' type='text' style='width:35px' maxlength='3' disabled/> %</td></tr>");a.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectHWPOpCheck()\" style='padding-left:15px'><input id='re_hwp4"+this.m_uid+"' title='"+this.m_languageMap.outputLikeWord+"' type='checkbox' "+(c.outputLikeWord?"checked":"")+" disabled/>"+this.m_languageMap.outputLikeWord+"</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:195px;height:40px;'>");a.push("<span style='position:absolute;top:3px;left:15px;width:130px'>"+this.m_languageMap.tableSplit+" : </span>");a.push("<select id='re_hwp5"+this.m_uid+"' title='"+this.m_languageMap.tableSplit+"' style='position:absolute;right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.tableSplitMethod==1?"selected":"")+">"+this.m_languageMap.Split+"</option>");a.push("<option value='2' "+(c.tableSplitMethod==2?"selected":"")+">"+this.m_languageMap.cellSplit+"</option>");a.push("<option value='3' "+(c.tableSplitMethod==3?"selected":"")+">"+this.m_languageMap.noneSplit+"</option>");a.push("</select></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:215px;height:90px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'>"+this.m_languageMap.defaultCharGap+" : <input id='re_hwp6"+this.m_uid+"' title='"+this.m_languageMap.defaultCharGap+"' value='"+c.defaultCharGap+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.charRatio+" : <input id='re_hwp7"+this.m_uid+"' title='"+this.m_languageMap.charRatio+"' value='"+c.charRatio+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'>"+this.m_languageMap.lineSpaceRate+" : <input id='re_hwp11"+this.m_uid+"' title='"+this.m_languageMap.lineSpaceRate+"' value='"+c.lineSpaceRate+"' type='text' style='width:70px' disabled/> %</td></tr>");a.push("<tr><td valign='middle'><input id='re_hwp8"+this.m_uid+"' title='"+this.m_languageMap.putCheckboxIntoCell+"' type='checkbox' "+(c.putCheckboxIntoCell?"checked":"")+" disabled/>"+this.m_languageMap.putCheckboxIntoCell+"</td></tr>");a.push("<tr><td valign='middle'><input id='re_hwp9"+this.m_uid+"' title='"+this.m_languageMap.splitTextByLine+"' type='checkbox' "+(c.splitTextByLine?"checked":"")+" disabled/>"+this.m_languageMap.splitTextByLine+"</td></tr>");a.push("</table></div>");a.push("<span style='position:absolute;left:10px;right:10px;bottom:65px;font-size:9pt;border:1px solid black;'>본 제품은 한글과컴퓨터의 한/글 문서 파일(.hwp) 공개 문서를 참고하여 개발하였습니다.</span>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHWPOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHWPOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:45px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHWPViewDomInfo(b);};Report.prototype.mRe_setHWPViewDomInfo=function(b){var a=this;var c=this.m_saveInfo_view.child_option;c.viewDom=b;c.validationDom=b.lastChild;c.cancelButtonDom=c.validationDom.previousSibling;c.saveButtonDom=c.cancelButtonDom.previousSibling;c.fixSizeDom=document.getElementById("re_hwp1"+this.m_uid);c.allowOverlayDom=document.getElementById("re_hwp2"+this.m_uid);c.setPageBottomMarginToZeroDom=document.getElementById("re_hwp3"+this.m_uid);c.setPageBottomMarginToZeroDom.onchange=function(){a.mRe_selectPageBottomMarginToZero();};c.outputLikeWordDom=document.getElementById("re_hwp4"+this.m_uid);c.tableSplitMethodDom=document.getElementById("re_hwp5"+this.m_uid);c.defaultCharGapDom=document.getElementById("re_hwp6"+this.m_uid);c.charRatioDom=document.getElementById("re_hwp7"+this.m_uid);c.putCheckboxIntoCellDom=document.getElementById("re_hwp8"+this.m_uid);c.splitTextByLineDom=document.getElementById("re_hwp9"+this.m_uid);c.mergeTableDom=document.getElementById("re_hwp10"+this.m_uid);c.lineSpaceRateDom=document.getElementById("re_hwp11"+this.m_uid);c.positionRelToDom=document.getElementById("re_hwp12"+this.m_uid);c.hwpExportMethodDom=document.getElementById("re_hwp13"+this.m_uid);c.splitPageOnListTableOnlyDom=document.getElementById("re_hwp14"+this.m_uid);c.pageBottomMarginApplicationRateDom=document.getElementById("re_hwp15"+this.m_uid);c=null;};Report.prototype.mRe_selectHWPOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.outputLikeWordDom.checked&&this.m_editOp){a.tableSplitMethodDom.disabled=false;}else{a.tableSplitMethodDom.disabled=true;}a=null;};Report.prototype.mRe_selectPageBottomMarginToZero=function(){var a=this.m_saveInfo_view.child_option;if(!a.setPageBottomMarginToZeroDom.checked&&this.m_editOp){a.pageBottomMarginApplicationRateDom.disabled=false;}else{a.pageBottomMarginApplicationRateDom.disabled=true;}a=null;};Report.prototype.mRe_selectHwpExportMethod=function(a){var b=this.m_saveInfo_view.child_option;var c=false;if(a.value=="2"){c=true;b.fixSizeDom.disabled=c;b.allowOverlayDom.disabled=c;b.positionRelToDom.disabled=c;b.setPageBottomMarginToZeroDom.disabled=c;b.outputLikeWordDom.disabled=c;b.tableSplitMethodDom.disabled=c;b.mergeTableDom.disabled=c;b.splitPageOnListTableOnlyDom.disabled=false;b.pageBottomMarginApplicationRateDom.disabled=false;}else{b.fixSizeDom.disabled=c;if(b.positionRelToDom.value=="2"){b.allowOverlayDom.disabled=c;}b.positionRelToDom.disabled=c;b.setPageBottomMarginToZeroDom.disabled=c;if(!b.setPageBottomMarginToZeroDom.checked){b.pageBottomMarginApplicationRateDom.disabled=c;}else{b.pageBottomMarginApplicationRateDom.disabled=true;}b.outputLikeWordDom.disabled=c;if(b.outputLikeWordDom.checked){b.tableSplitMethodDom.disabled=c;}b.mergeTableDom.disabled=c;b.splitPageOnListTableOnlyDom.disabled=true;}};Report.prototype.mRe_selectPositionRelTo=function(a){var b=this.m_saveInfo_view.child_option;if(a.value=="2"){b.allowOverlayDom.disabled=false;}else{b.allowOverlayDom.disabled=true;}};Report.prototype.mRe_disabledHWPViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.hwpExportMethodDom.disabled=b;if(a.hwpExportMethodDom.value=="1"){a.fixSizeDom.disabled=b;if(a.positionRelToDom.value=="2"){a.allowOverlayDom.disabled=b;}a.positionRelToDom.disabled=b;a.setPageBottomMarginToZeroDom.disabled=b;if(!a.setPageBottomMarginToZeroDom.checked){a.pageBottomMarginApplicationRateDom.disabled=b;}else{a.pageBottomMarginApplicationRateDom.disabled=true;}a.outputLikeWordDom.disabled=b;if(a.outputLikeWordDom.checked){a.tableSplitMethodDom.disabled=b;}a.mergeTableDom.disabled=b;}else{a.splitPageOnListTableOnlyDom.disabled=b;a.pageBottomMarginApplicationRateDom.disabled=false;}a.defaultCharGapDom.disabled=b;a.charRatioDom.disabled=b;a.putCheckboxIntoCellDom.disabled=b;a.splitTextByLineDom.disabled=b;a.lineSpaceRateDom.disabled=b;};Report.prototype.mRe_cancelHWPOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHWPSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHWPOptionInfo=function(){if(this.saveHWPOptionViewValidationCheck()){this.setHWPOptionValue();this.mRe_cancelHWPOptionInfo();}};Report.prototype.saveHWPOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.defaultCharGapDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapError;b=null;return false;}else{if(a<-50||a>50){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapValueError;b=null;return false;}}a=Number(b.charRatioDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.charRatioError;b=null;return false;}else{if(a<50||a>200){b.validationDom.innerHTML=this.m_languageMap.charRatioValueError;b=null;return false;}}a=Number(b.pageBottomMarginApplicationRateDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.bottomMarginError;b=null;return false;}else{if(a<1||a>100){b.validationDom.innerHTML=this.m_languageMap.bottomMarginValueError;b=null;return false;}}b=null;return true;};Report.prototype.setHWPOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.fixSize=b.fixSizeDom.checked;a.allowOverlay=b.allowOverlayDom.checked;a.setPageBottomMarginToZero=b.setPageBottomMarginToZeroDom.checked;a.outputLikeWord=b.outputLikeWordDom.checked;a.tableSplitMethod=Number(b.tableSplitMethodDom.value);a.defaultCharGap=Number(b.defaultCharGapDom.value);a.charRatio=Number(b.charRatioDom.value);a.putCheckboxIntoCell=b.putCheckboxIntoCellDom.checked;a.splitTextByLine=b.splitTextByLineDom.checked;a.mergeTable=b.mergeTableDom.checked;a.lineSpaceRate=Number(b.lineSpaceRateDom.value);a.positionRelTo=Number(b.positionRelToDom.value);a.hwpExportMethod=Number(b.hwpExportMethodDom.value);a.splitPageOnListTableOnly=b.splitPageOnListTableOnlyDom.checked;a.pageBottomMarginApplicationRate=Number(b.pageBottomMarginApplicationRateDom.value);b=null;a=null;};function mRe_getDefaultSaveHWPOption(){var a=null;if(typeof window.getDefaultSaveHWPOption!="undefined"){a=getDefaultSaveHWPOption();}else{a={fixSize:true,allowOverlay:true,setPageBottomMarginToZero:true,outputLikeWord:false,tableSplitMethod:2,defaultCharGap:-8,charRatio:100,putCheckboxIntoCell:true,splitTextByLine:true,mergeTable:false,lineSpaceRate:100,positionRelTo:1,hwpExportMethod:1,splitPageOnListTableOnly:true,pageBottomMarginApplicationRate:100};}return a;}Report.prototype.makeRTFSaveOptionWindow=function(d){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;this.m_saveInfo_view.child_option.isDocx=d;var b=document.createElement("div");b.className="report_saveRTF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:10px;height:50px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'><input id='re_rtf1"+this.m_uid+"' title='"+this.m_languageMap.splitTextLine+"' type='checkbox' "+(c.splitTextLine?"checked":"")+" disabled/>"+this.m_languageMap.splitTextLine+" </td></tr>");a.push("<tr style='display:none;'><td valign='middle'><input id='re_rtf2"+this.m_uid+"' title='"+this.m_languageMap.processAsUnicode+"' type='checkbox' "+(c.processAsUnicode?"checked":"")+" disabled/>"+this.m_languageMap.processAsUnicode+"</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:65px;height:30px;display:none;'>");a.push("<span style='position:absolute;top:3px;left:0px;width:130px'>"+this.m_languageMap.processEqualAlign+" : </span>");a.push("<select id='re_rtf3"+this.m_uid+"' title='"+this.m_languageMap.processEqualAlign+"' style='position:absolute;right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.processEqualAlign==1?"selected":"")+">"+this.m_languageMap.soLeft+"</option>");a.push("<option value='2' "+(c.processEqualAlign==2?"selected":"")+">"+this.m_languageMap.soCenter+"</option>");a.push("<option value='3' "+(c.processEqualAlign==3?"selected":"")+">"+this.m_languageMap.soRight+"</option>");a.push("<option value='4' "+(c.processEqualAlign==4?"selected":"")+">"+this.m_languageMap.soBoth+"</option>");a.push("</select></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:35px;height:140px;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr style='height:20px'><td valign='middle'>"+this.m_languageMap.defaultCharGap+" : <input id='re_rtf4"+this.m_uid+"' title='"+this.m_languageMap.defaultCharGap+"' type='text' value='"+c.defaultCharSpace+"' style='width:70px' disabled/> pt</td></tr>");a.push("<tr style='height:20px'><td valign='middle'><input id='re_rtf7"+this.m_uid+"' title='"+this.m_languageMap.mergeTable+"' type='checkbox' "+(c.mergeTable?"checked":"")+" disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr style='height:20px;"+(d?"display:none;":"")+"'><td valign='middle'><input id='re_rtf8"+this.m_uid+"' title='"+this.m_languageMap.fitShapeToText+"' type='checkbox' "+(c.fitShapeToText?"checked":"")+" disabled/>"+this.m_languageMap.fitShapeToText+"</td></tr>");a.push("<tr style='height:20px'><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectRTFOpCheck();\"><input id='re_rtf6"+this.m_uid+"' title='"+this.m_languageMap.insertTableWrapper+"' type='checkbox' "+(c.insertTableWrapper?"checked":"")+" disabled/>"+this.m_languageMap.insertTableWrapper+"</td></tr>");a.push("<tr style='height:20px'><td valign='middle'><span style='width:100px'>"+this.m_languageMap.tableWrapperBottomGap+" : </span>");a.push("<input id='re_rtf5"+this.m_uid+"' title='"+this.m_languageMap.tableWrapperBottomGap+"' type='text' value='"+c.tableWrapperBottomGap+"' style='width:70px;' disabled/></td></tr>");a.push("<tr style='height:20px; "+(d?"display:none;":"")+"'><td valign='middle'><span>"+this.m_languageMap.TableRowHeightSort+" : </span>");a.push("<select id='re_rtf9"+this.m_uid+"' title='"+this.m_languageMap.TableRowHeightSort+"' style='width:105px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.TableRowHeightSort==1?"selected":"")+">Fix</option>");a.push("<option value='2' "+(c.TableRowHeightSort==2?"selected":"")+">Minimum</option>");a.push("</select></td></tr>");a.push("<tr style='height:20px;"+(d?";":"display:none")+"'><td valign='middle'>"+this.m_languageMap.lineSpaceRate+" : <input id='re_rtf10"+this.m_uid+"' title='"+this.m_languageMap.lineSpaceRate+"' type='text' value='"+c.lineSpaceRate+"' style='width:70px' disabled/> %</td></tr>");a.push("</table></div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveRTFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelRTFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:74%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setRTFViewDomInfo(b);};Report.prototype.mRe_setRTFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.splitTextLineDom=document.getElementById("re_rtf1"+this.m_uid);b.processAsUnicodeDom=document.getElementById("re_rtf2"+this.m_uid);b.processEqualAlignDom=document.getElementById("re_rtf3"+this.m_uid);b.defaultCharSpaceDom=document.getElementById("re_rtf4"+this.m_uid);b.tableWrapperBottomGapDom=document.getElementById("re_rtf5"+this.m_uid);b.insertTableWrapperDom=document.getElementById("re_rtf6"+this.m_uid);b.mergeTableDom=document.getElementById("re_rtf7"+this.m_uid);b.fitShapeToTextDom=document.getElementById("re_rtf8"+this.m_uid);b.TableRowHeightSortDom=document.getElementById("re_rtf9"+this.m_uid);b.lineSpaceRateDom=document.getElementById("re_rtf10"+this.m_uid);b=null;};Report.prototype.mRe_disabledRTFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.splitTextLineDom.disabled=b;a.processAsUnicodeDom.disabled=b;a.processEqualAlignDom.disabled=b;a.defaultCharSpaceDom.disabled=b;a.insertTableWrapperDom.disabled=b;if(a.insertTableWrapperDom.checked){a.tableWrapperBottomGapDom.disabled=b;}a.mergeTableDom.disabled=b;a.fitShapeToTextDom.disabled=b;a.TableRowHeightSortDom.disabled=b;a.lineSpaceRateDom.disabled=b;};Report.prototype.mRe_cancelRTFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeRTFSaveOptionWindow(this.m_saveInfo_view.child_option.isDocx);this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveRTFOptionInfo=function(){if(this.saveRTFOptionViewValidationCheck()){this.setRTFOptionValue();this.mRe_cancelRTFOptionInfo();}};Report.prototype.saveRTFOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.defaultCharSpaceDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapError;b=null;return false;}else{if(a<-3||a>3){b.validationDom.innerHTML=this.m_languageMap.defaultCharGapValue2Error;b=null;return false;}}a=Number(b.tableWrapperBottomGapDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.tableWrapperBottomGapError;b=null;return false;}else{if(a<0||a>500){b.validationDom.innerHTML=this.m_languageMap.tableWrapperBottomGapValueError;b=null;return false;}}b=null;return true;};Report.prototype.setRTFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.splitTextLine=b.splitTextLineDom.checked;a.processAsUnicode=b.processAsUnicodeDom.checked;a.processEqualAlign=Number(b.processEqualAlignDom.value);a.defaultCharSpace=Number(b.defaultCharSpaceDom.value);a.tableWrapperBottomGap=Number(b.tableWrapperBottomGapDom.value);a.insertTableWrapper=b.insertTableWrapperDom.checked;a.mergeTable=b.mergeTableDom.checked;a.fitShapeToText=b.fitShapeToTextDom.checked;a.TableRowHeightSort=Number(b.TableRowHeightSortDom.value);a.lineSpaceRate=Number(b.lineSpaceRateDom.value);b=null;a=null;};Report.prototype.mRe_selectRTFOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.insertTableWrapperDom.checked&&this.m_editOp){a.tableWrapperBottomGapDom.disabled=false;}else{a.tableWrapperBottomGapDom.disabled=true;}a=null;};function mRe_getDefaultSaveRTFOption(a){var b=null;if(("rtf"==a)&&(typeof window.getDefaultSaveRTFOption!="undefined")){b=getDefaultSaveRTFOption();b.type=a;}else{if(("doc"==a)&&(typeof window.getDefaultSaveDOCOption!="undefined")){b=getDefaultSaveDOCOption();b.type=a;}else{if(("docx"==a)&&(typeof window.getDefaultSaveDOCXOption!="undefined")){b=getDefaultSaveDOCXOption();b.processAsUnicode=true;b.processEqualAlign=4;b.fitShapeToText=false;b.TableRowHeightSort=1;b.type=a;}else{b={type:a,splitTextLine:true,processAsUnicode:true,processEqualAlign:4,defaultCharSpace:-0.5,tableWrapperBottomGap:0,insertTableWrapper:true,mergeTable:false,fitShapeToText:false,TableRowHeightSort:1,lineSpaceRate:100};}}}return b;}Report.prototype.makeHTMLSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveHtml_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:30%;'>");a.push("<table style='position:absolute;top:0px;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle'><input id='re_html1"+this.m_uid+"' "+(c.processCellLikeShape?"checked":"")+" title='테이블 셀을 라벨처럼 저장' type='checkbox' disabled/>테이블 셀을 라벨처럼 저장 </td></tr>");a.push("<tr><td valign='middle'><input id='re_html2"+this.m_uid+"' "+(c.displayPageLine?"checked":"")+" title='페이지 분리선 표시' type='checkbox' disabled/>페이지 분리선 표시</td></tr>");a.push("<tr><td valign='middle'><input id='re_html3"+this.m_uid+"' "+(c.keepPageHeight?"checked":"")+" title='페이지 높이 유지' type='checkbox' disabled/>페이지 높이 유지</td></tr>");a.push("<tr><td valign='middle'><input id='re_html4"+this.m_uid+"' "+(c.applyWordBreak?"checked":"")+" title='글자 감싸기 적용' type='checkbox' disabled/>글자 감싸기 적용</td></tr>");a.push("<tr><td valign='middle'><input id='re_html5"+this.m_uid+"' "+(c.setTextProperiesToEmptyCell?"checked":"")+" title='빈 셀에 텍스트 속성 설정' type='checkbox' disabled/>빈 셀에 텍스트 속성 설정</td></tr>");a.push("<tr><td valign='middle'><input id='re_html6"+this.m_uid+"' "+(c.putTagIntoEmptyCell?"checked":"")+" title='열빈 셀에 &nbsp; 삽입' type='checkbox' disabled/>빈 셀에 & nbsp; 삽입</td></tr>");a.push("<tr><td valign='middle'><input id='re_html7"+this.m_uid+"' "+(c.textOverflowHidden?"checked":"")+" title='Overflow=flase 스타일 적용' type='checkbox' disabled/>Overflow=flase 스타일 적용</td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:15px;right:15px;top:47%;height:20%;border:1px solid darkgray'>");a.push("<table style='position:absolute;top:10px;left:5px'>");a.push("<tr><td style='cursor:default'>X축 비율 : <input id='re_html8"+this.m_uid+"' value='"+c.coordinateRateForX+"' title='X축 비율' type='text' value='100' maxlength='3' disabled/></td></tr>");a.push("<tr><td style='cursor:default'>Y축 비율 : <input id='re_html9"+this.m_uid+"' value='"+c.coordinateRateForY+"' title='Y축 비율' type='text' value='100' maxlength='3' disabled/></td></tr>");a.push("</table></div>");a.push("<div style='position:absolute;left:13px;right:15px;top:70%;height:20%;'>");a.push("<select id='re_html10"+this.m_uid+"' title='인코딩' style='position:absolute;right:0px;height:23px;width:200px;top:8px;font-size:9pt;' disabled>");a.push("<option value='1' "+(c.encodingType==1?"selected":"")+">UTF-8</option>");a.push("<option value='2' "+(c.encodingType==2?"selected":"")+">Unicode</option>");a.push("<option value='3' "+(c.encodingType==3?"selected":"")+">EUC-KR</option>");a.push("</select>");a.push("<span style='position:absolute;top:13px;left:0px;width:150px'>인코딩 : </span></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:45%;border:0;'>좌표 비율</span>");a.push("<button title='확인' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHTMLOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>확인</button>");a.push("<button title='취소' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHTMLOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>취소</button>");a.push("<span style='position:absolute;left:16px;top:82%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHTMLViewDomInfo(b);};Report.prototype.mRe_setHTMLViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.processCellLikeShapeDom=document.getElementById("re_html1"+this.m_uid);b.displayPageLineDom=document.getElementById("re_html2"+this.m_uid);b.keepPageHeightDom=document.getElementById("re_html3"+this.m_uid);b.applyWordBreakDom=document.getElementById("re_html4"+this.m_uid);b.setTextProperiesToEmptyCellDom=document.getElementById("re_html5"+this.m_uid);b.putTagIntoEmptyCellDom=document.getElementById("re_html6"+this.m_uid);b.textOverflowHiddenDom=document.getElementById("re_html7"+this.m_uid);b.coordinateRateForXDom=document.getElementById("re_html8"+this.m_uid);b.coordinateRateForYDom=document.getElementById("re_html9"+this.m_uid);b.encodingTypeDom=document.getElementById("re_html10"+this.m_uid);b=null;};Report.prototype.mRe_disabledHTMLViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.processCellLikeShapeDom.disabled=b;a.displayPageLineDom.disabled=b;a.keepPageHeightDom.disabled=b;a.applyWordBreakDom.disabled=b;a.setTextProperiesToEmptyCellDom.disabled=b;a.textOverflowHiddenDom.disabled=b;a.putTagIntoEmptyCellDom.disabled=b;a.coordinateRateForXDom.disabled=b;a.coordinateRateForYDom.disabled=b;a.encodingTypeDom.disabled=b;};Report.prototype.mRe_cancelHTMLOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHTMLSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHTMLOptionInfo=function(){if(this.saveHTMLOptionViewValidationCheck()){this.setHTMLOptionValue();this.mRe_cancelHTMLOptionInfo();}};Report.prototype.saveHTMLOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.coordinateRateForXDom.value);if(isNaN(a)){b.validationDom.innerHTML="X축 비율의 설정값이 올바르지 않습니다.";b=null;return false;}else{if(a<1||a>5){b.validationDom.innerHTML="X축 비율의 설정값은 (1.0 ~ 5.0) 가능합니다.";b=null;return false;}}a=Number(b.coordinateRateForYDom.value);if(isNaN(a)){b.validationDom.innerHTML="Y축 비율의 설정값이 올바르지 않습니다.";b=null;return false;}else{if(a<1||a>5){b.validationDom.innerHTML="Y축 비율의 설정값은 (1.0 ~ 5.0) 가능합니다.";b=null;return false;}}b=null;return true;};Report.prototype.setHTMLOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.processCellLikeShape=b.processCellLikeShapeDom.checked;a.displayPageLine=b.displayPageLineDom.checked;a.keepPageHeight=b.keepPageHeightDom.checked;a.applyWordBreak=b.applyWordBreakDom.checked;a.setTextProperiesToEmptyCell=b.setTextProperiesToEmptyCellDom.checked;a.putTagIntoEmptyCell=b.putTagIntoEmptyCellDom.checked;a.textOverflowHidden=b.textOverflowHiddenDom.checked;a.coordinateRateForX=Number(b.coordinateRateForXDom.value);a.coordinateRateForY=Number(b.coordinateRateForYDom.value);a.encodingType=Number(b.encodingTypeDom.value);b=null;a=null;};function mRe_getDefaultSaveHTMLOption(){var a=null;if(typeof window.getDefaultSaveHTMLOption!="undefined"){a=getDefaultSaveHTMLOption();}else{a={processCellLikeShape:false,displayPageLine:true,keepPageHeight:true,applyWordBreak:false,setTextProperiesToEmptyCell:false,putTagIntoEmptyCell:false,textOverflowHidden:false,coordinateRateForX:2.6,coordinateRateForY:2.6,encodingType:1};}return a;}Report.prototype.makePDFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePDF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPDFOpCheck();\"><input id='re_pdf1"+this.m_uid+"' "+(c.isSplite?"checked":"")+" title='"+this.m_languageMap.pageSplite+"' type='checkbox' disabled/>"+this.m_languageMap.pageSplite+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:25px;padding-top:5px;'>"+this.m_languageMap.pageSpliteCount+" : <input id='re_pdf2"+this.m_uid+"' value='"+c.spliteValue+"' title='"+this.m_languageMap.pageSpliteCount+"' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.password+" : <input id='re_pdf3"+this.m_uid+"' value='"+c.userpw+"' title='"+this.m_languageMap.password+"' type='password' style='width:120px;' disabled/></td></tr>");a.push("<tr><td valign='middle'><input id='re_pdf4"+this.m_uid+"' "+(c.textToImage?"checked":"")+" title='"+this.m_languageMap.textToImage+"' type='checkbox' disabled/>"+this.m_languageMap.textToImage+"</td></tr>");a.push("<tr><td valign='middle'><input id='re_pdf6"+this.m_uid+"' "+(c.removeHyperlink?"checked":"")+" title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");a.push("<tr><td valign='middle' style='visibility:hidden;'><input id='re_pdf5"+this.m_uid+"' "+(c.importOriginImage?"checked":"")+" title='"+this.m_languageMap.importOriginImage+"' type='checkbox' disabled/>"+this.m_languageMap.importOriginImage+"</td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_savePDFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelPDFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setPDFViewDomInfo(b);};Report.prototype.mRe_setPDFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.isSpliteDom=document.getElementById("re_pdf1"+this.m_uid);b.spliteValueDom=document.getElementById("re_pdf2"+this.m_uid);b.userpwDom=document.getElementById("re_pdf3"+this.m_uid);b.textToImageDom=document.getElementById("re_pdf4"+this.m_uid);b.importOriginImageDom=document.getElementById("re_pdf5"+this.m_uid);b.removeHyperlinkDom=document.getElementById("re_pdf6"+this.m_uid);b=null;};Report.prototype.mRe_disabledPDFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.isSpliteDom.disabled=b;if(a.isSpliteDom.checked){a.spliteValueDom.disabled=b;}a.userpwDom.disabled=b;a.textToImageDom.disabled=b;a.importOriginImageDom.disabled=b;a.removeHyperlinkDom.disabled=b;};Report.prototype.mRe_cancelPDFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makePDFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_savePDFOptionInfo=function(){if(this.savePDFOptionViewValidationCheck()){this.setPDFOptionValue();this.mRe_cancelPDFOptionInfo();}};Report.prototype.savePDFOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.spliteValueDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.pageSpliteCountError;b=null;return false;}b=null;return true;};Report.prototype.setPDFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.isSplite=b.isSpliteDom.checked;a.spliteValue=Number(b.spliteValueDom.value);a.userpw=b.userpwDom.value;a.textToImage=b.textToImageDom.checked;a.importOriginImage=b.importOriginImageDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;b=null;a=null;};Report.prototype.mRe_selectPDFOpCheck=function(){var a=this.m_saveInfo_view.child_option;if(a.isSpliteDom.checked&&this.m_editOp){a.spliteValueDom.disabled=false;}else{a.spliteValueDom.disabled=true;}a=null;};function mRe_getDefaultSavePDFOption(){var a=null;if(typeof window.getDefaultSavePDFOption!="undefined"){a=getDefaultSavePDFOption();a.fileNames=null;}else{a={isSplite:false,spliteValue:1,fileNames:null,userpw:"",textToImage:false,importOriginImage:false,removeHyperlink:false};}return a;}function mRe_setPDFFileList(d,b){if(null!=b){d.fileNames=new Array();var a=b.length;for(var c=0;c<a;c++){d.fileNames.push(Base64.encode(b[c]));}}}Report.prototype.makeHTML5SaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePDF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' ><input id='re_html51"+this.m_uid+"' "+(c.isSplite?"checked":"")+" title='"+this.m_languageMap.html5page+"' type='checkbox' disabled/>"+this.m_languageMap.html5page+"</td></tr>");a.push("<tr><td valign='middle' style='padding-left:10px;padding-top:5px;'>DPI : <input id='re_html52"+this.m_uid+"' value='"+c.dpiValue+"' title='DPI' type='text' style='width:40px;' value='96' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveHTML5OptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelHTML5OptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;top:50%;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setHTML5ViewDomInfo(b);};Report.prototype.mRe_setHTML5ViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.isSpliteDom=document.getElementById("re_html51"+this.m_uid);b.DPIDom=document.getElementById("re_html52"+this.m_uid);b=null;};Report.prototype.mRe_disabledHTML5ViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.isSpliteDom.disabled=b;a.DPIDom.disabled=b;};Report.prototype.mRe_cancelHTML5OptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeHTML5SaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveHTML5OptionInfo=function(){if(this.saveHTML5OptionViewValidationCheck()){this.setHTML5OptionValue();this.mRe_cancelHTML5OptionInfo();}};Report.prototype.saveHTML5OptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.DPIDom.value);if(isNaN(a)){b.validationDom.innerHTML=this.m_languageMap.dpiError;b=null;return false;}b=null;return true;};Report.prototype.setHTML5OptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.isSplite=b.isSpliteDom.checked;a.dpiValue=Number(b.DPIDom.value);b=null;a=null;};function mRe_getDefaultSaveHTML5Option(){var a=null;if(typeof window.getDefaultSaveHTML5Option!="undefined"){a=getDefaultSaveHTML5Option();}else{a={isSplite:true,DPI:96};}return a;}Report.prototype.makeJPGSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveJPG_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_jpg1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_jpg2"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_jpg3"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>quality : <input id='re_jpg4"+this.m_uid+"' value='"+c.quality+"' title='quality' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveJPGOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelJPGOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setJPGViewDomInfo(b);};Report.prototype.mRe_setJPGViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_jpg1"+this.m_uid);b.dpiXDom=document.getElementById("re_jpg2"+this.m_uid);b.dpiYDom=document.getElementById("re_jpg3"+this.m_uid);b.qualityDom=document.getElementById("re_jpg4"+this.m_uid);b=null;};Report.prototype.mRe_disabledJPGViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.qualityDom.disabled=b;};Report.prototype.mRe_cancelJPGOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeJPGSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveJPGOptionInfo=function(){if(this.saveJPGOptionViewValidationCheck()){this.setJPGOptionValue();this.mRe_cancelJPGOptionInfo();}};Report.prototype.saveJPGOptionViewValidationCheck=function(){var b=this.m_saveInfo_view.child_option;var a=Number(b.qualityDom.value);if(isNaN(a)){b.validationDom.innerHTML="quality (1 ~ 100)";b=null;return false;}b=null;return true;};Report.prototype.setJPGOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);a.quality=Number(b.qualityDom.value);b=null;a=null;};function mRe_getDefaultSaveJPGOption(){var a=null;if(typeof window.getDefaultSaveJPGOption!="undefined"){a=getDefaultSaveJPGOption();}else{a={rotate90:false,dpiX:96,dpiY:96,quality:100};}return a;}Report.prototype.makeTIFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveTIF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif2"+this.m_uid+"' "+(c.blackWhite?"checked":"")+" title='blackWhite' type='checkbox' disabled/>blackWhite</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif5"+this.m_uid+"' "+(c.gray?"checked":"")+" title='gray' type='checkbox' disabled/>gray</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_tif3"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_tif4"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setTIFViewDomInfo(b);};Report.prototype.mRe_setTIFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_tif1"+this.m_uid);b.blackWhiteDom=document.getElementById("re_tif2"+this.m_uid);b.dpiXDom=document.getElementById("re_tif3"+this.m_uid);b.dpiYDom=document.getElementById("re_tif4"+this.m_uid);b.grayDom=document.getElementById("re_tif5"+this.m_uid);b=null;};Report.prototype.mRe_disabledTIFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.blackWhiteDom.disabled=b;a.grayDom.disabled=b;};Report.prototype.mRe_cancelTIFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeTIFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveTIFOptionInfo=function(){if(this.saveTIFOptionViewValidationCheck()){this.setTIFOptionValue();this.mRe_cancelTIFOptionInfo();}};Report.prototype.saveTIFOptionViewValidationCheck=function(){return true;};Report.prototype.setTIFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.blackWhite=b.blackWhiteDom.checked;a.gray=b.grayDom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);b=null;a=null;};function mRe_getDefaultSaveTIFOption(){var a=null;if(typeof window.getDefaultSaveTIFOption!="undefined"){a=getDefaultSaveTIFOption();}else{a={rotate90:false,blackWhite:true,gray:false,dpiX:96,dpiY:96};}return a;}Report.prototype.makeMultiTIFSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveTIF_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif1"+this.m_uid+"' "+(c.rotate90?"checked":"")+" title='rotate 90' type='checkbox' disabled/>rotate 90</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif2"+this.m_uid+"' "+(c.blackWhite?"checked":"")+" title='blackWhite' type='checkbox' disabled/>blackWhite</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_tif5"+this.m_uid+"' "+(c.gray?"checked":"")+" title='gray' type='checkbox' disabled/>gray</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI X : <input id='re_tif3"+this.m_uid+"' value='"+c.dpiX+"' title='DPI X' type='text' style='width:40px;' disabled/></td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'>DPI Y : <input id='re_tif4"+this.m_uid+"' value='"+c.dpiY+"' title='DPI Y' type='text' style='width:40px;' disabled/></td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveMultiTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelMultiTIFOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setMultiTIFViewDomInfo(b);};Report.prototype.mRe_setMultiTIFViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.rotate90Dom=document.getElementById("re_tif1"+this.m_uid);b.blackWhiteDom=document.getElementById("re_tif2"+this.m_uid);b.grayDom=document.getElementById("re_tif5"+this.m_uid);b.dpiXDom=document.getElementById("re_tif3"+this.m_uid);b.dpiYDom=document.getElementById("re_tif4"+this.m_uid);b=null;};Report.prototype.mRe_disabledMultiTIFViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.rotate90Dom.disabled=b;a.dpiXDom.disabled=b;a.dpiYDom.disabled=b;a.blackWhiteDom.disabled=b;a.grayDom.disabled=b;};Report.prototype.mRe_cancelMultiTIFOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeMultiTIFSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveMultiTIFOptionInfo=function(){if(this.saveMultiTIFOptionViewValidationCheck()){this.setMultiTIFOptionValue();this.mRe_cancelMultiTIFOptionInfo();}};Report.prototype.saveMultiTIFOptionViewValidationCheck=function(){return true;};Report.prototype.setMultiTIFOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.rotate90=b.rotate90Dom.checked;a.blackWhite=b.blackWhiteDom.checked;a.gray=b.grayDom.checked;a.dpiX=Number(b.dpiXDom.value);a.dpiY=Number(b.dpiYDom.value);b=null;a=null;};function mRe_getDefaultSaveMultiTIFOption(){var a=null;if(typeof window.getDefaultSaveMultiTIFOption!="undefined"){a=getDefaultSaveMultiTIFOption();}else{a={rotate90:false,blackWhite:true,gray:false,dpiX:96,dpiY:96};}return a;}Report.prototype.makePPTSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_savePPT_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt1"+this.m_uid+"' "+(c.mergeTable?"checked":"")+" title='"+this.m_languageMap.mergeTable+"' type='checkbox' disabled/>"+this.m_languageMap.mergeTable+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt2"+this.m_uid+"' "+(c.ignoreLineSpace?"checked":"")+" title='"+this.m_languageMap.ignoreLineSpace+"' type='checkbox' disabled/>"+this.m_languageMap.ignoreLineSpace+"</td></tr>");a.push("<tr><td valign='middle' style='padding-top:5px;'><input id='re_ppt3"+this.m_uid+"' "+(c.removeHyperlink?"checked":"")+" title='"+this.m_languageMap.removeHyperlink+"' type='checkbox' disabled/>"+this.m_languageMap.removeHyperlink+"</td></tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_savePPTOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelPPTOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setPPTViewDomInfo(b);};Report.prototype.mRe_setPPTViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.mergeTableDom=document.getElementById("re_ppt1"+this.m_uid);b.ignoreLineSpaceDom=document.getElementById("re_ppt2"+this.m_uid);b.removeHyperlinkDom=document.getElementById("re_ppt3"+this.m_uid);b=null;};Report.prototype.mRe_disabledPPTViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.mergeTableDom.disabled=b;a.ignoreLineSpaceDom.disabled=b;a.removeHyperlinkDom.disabled=b;};Report.prototype.mRe_cancelPPTOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makePPTSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_savePPTOptionInfo=function(){this.setPPTOptionValue();this.mRe_cancelPPTOptionInfo();};Report.prototype.setPPTOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.mergeTable=b.mergeTableDom.checked;a.ignoreLineSpace=b.ignoreLineSpaceDom.checked;a.removeHyperlink=b.removeHyperlinkDom.checked;b=null;a=null;};function mRe_getDefaultSavePPTOption(){var a=null;if(typeof window.getDefaultSavePPTOption!="undefined"){a=getDefaultSavePPTOption();}else{a={mergeTable:false,ignoreLineSpace:true,removeHyperlink:false};}return a;}Report.prototype.makeExcelDataSaveOptionWindow=function(){this.m_editOp=false;var c=this.m_saveInfo_view.child_option.json_data;var b=document.createElement("div");b.className="report_saveEXCELDATA_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:70%;'>");a.push("<table style='position:absolute;cursor:default' cellpadding='0' cellspacing='0' border='0'>");a.push("<tr><td valign='middle' style='padding-top:5px;'>"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+" :</td>");a.push("<td valign='middle' style='padding-top:5px;padding-left:5px'>");a.push("<select id='re_excelData1"+this.m_uid+"' title='"+this.m_languageMap.repeatPageSectionWhenAllSectionInOneSheet+"' style='right:0px;height:23px;width:105px;font-size:9pt;' disabled>");a.push("<option value='0' "+(c.outputPageSectionMethod==0?"selected":"")+">"+this.m_languageMap.excelDataNone+"</option>");a.push("<option value='1' "+(c.outputPageSectionMethod==1?"selected":"")+">"+this.m_languageMap.excelDataAtOnce+"</option>");a.push("<option value='2' "+(c.outputPageSectionMethod==2?"selected":"")+">"+this.m_languageMap.excelDataRepeatAtEachPage+"</option>");("</tr>");a.push("</table>");a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_saveExcelDataOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.ok+"</button>");a.push("<button title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_cancelExcelDataOptionInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;visibility:hidden;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:40px;font-size:8pt;color:red'></span>");b.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.mRe_setExcelDataViewDomInfo(b);};Report.prototype.mRe_setExcelDataViewDomInfo=function(a){var b=this.m_saveInfo_view.child_option;b.viewDom=a;b.validationDom=a.lastChild;b.cancelButtonDom=b.validationDom.previousSibling;b.saveButtonDom=b.cancelButtonDom.previousSibling;b.repeatPageSectionDom=document.getElementById("re_excelData1"+this.m_uid);b=null;};Report.prototype.mRe_disabledExcelDataViewDomInfo=function(b){var a=this.m_saveInfo_view.child_option;if(b){a.cancelButtonDom.style.visibility="hidden";a.saveButtonDom.style.visibility="hidden";}else{a.cancelButtonDom.style.visibility="visible";a.saveButtonDom.style.visibility="visible";}a.repeatPageSectionDom.disabled=b;};Report.prototype.mRe_cancelExcelDataOptionInfo=function(){this.m_popupViewDiv.removeChild(this.m_saveInfo_view.child_option.viewDom);this.makeExcelDataSaveOptionWindow();this.mRe_disabledViewDomInfo(false);};Report.prototype.mRe_saveExcelDataOptionInfo=function(){this.setExcelDataOptionValue();this.mRe_cancelExcelDataOptionInfo();};Report.prototype.setExcelDataOptionValue=function(){var b=this.m_saveInfo_view.child_option;var a=b.json_data;a.outputPageSectionMethod=Number(b.repeatPageSectionDom.value);b=null;a=null;};function mRe_getDefaultSaveExcelDataOption(){var a=null;if(typeof window.getDefaultSaveExcelDataOption!="undefined"){a=getDefaultSaveExcelDataOption();}else{a={outputPageSectionMethod:0};}return a;}function mRe_exprotFileName(b){var a="";a+=b.name;switch(b.exportType){case 1:a+=".xls";break;case 7:a+=".cell";break;case 2:a+=".pdf";break;case 3:a+=".hwp";break;case 4:a+=".rtf";break;case 5:a+=".ppt";break;case 6:a+=".html";break;case 8:a+=".html";break;case 9:a+=".doc";break;case 10:a+=".xlsx";break;case 11:a+=".jpg";break;case 12:a+=".txt";break;case 13:a+=".tif";break;case 14:a+=".tif";break;case 15:a+=".xls";break;default:break;}return a;}function mKey_selectSaveRange(c,d,b){if(32==c.keyCode||13==c.keyCode){var a=m_reportHashMap[d];if(null!=a){a.mRe_selectSaveRange(b);}}}Report.prototype.selectPrintView=function(){if(this.m_buttonEvent.startPrintButton!=null){var f=this.m_buttonEvent.startPrintButton();if(f!=true){this.m_isButtonLock=false;return;}}this.printOptionValue.isNetPrint=false;this.printOpReset();this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_popupViewDiv.style.zIndex="400";this.targetDiv.appendChild(this.m_popupViewDiv);var e=document.createElement("div");e.className="report_print_view_position report_view_box";var a=new Array();a.push("<div style='position:absolute;left:15px;right:15px;top:20px;height:48px;border:1px solid darkgray'>");a.push("<select title='"+this.m_languageMap.printType+"' id='re_printType1"+this.m_uid+"' style='position:absolute;left:10px;top:15px;width:90%;height:50%;font-size:9pt;' onChange=\"m_reportHashMap['"+this.m_uid+"'].selectPrintOption(this)\" tabindex='1'>");a.push(this.printOptionValue.isNetPrint?"<optgroup label='Local'>":"");var b=["pdf","html","hwp","exe"];if((typeof window.ReportPrintMenuOrder!="undefined")){b=ReportPrintMenuOrder();}for(var c=0;c<b.length;c++){if(this.m_printDisplay.pdf&&b[c]=="pdf"){a.push("<option value='pdf' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="pdf"?" selected":"");a.push(">"+this.printNames.pdf+"</option>");}if(this.m_printDisplay.html&&is_svg&&!is_window_safari&&b[c]=="html"){a.push("<option value='html' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="html"?" selected":"");a.push(">"+this.printNames.html+"</option>");}if(this.m_printDisplay.hwp&&this.m_isHWPPrint&&is_ie&&b[c]=="hwp"){a.push("<option value='hwp' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="hwp"?" selected":"");a.push(">"+this.printNames.hwp+"</option>");}if(this.m_printDisplay.exe&&is_window&&b[c]=="exe"){a.push("<option value='exe' ");a.push(this.printOptionValue.isNetPrint?"":"style='padding-left: 30px;'");a.push(this.printOptionValue.localStorage=="exe"?" selected":"");a.push(">"+this.printNames.exe+"</option>");}}a.push(this.printOptionValue.isNetPrint?"</optgroup>":"");if(this.printOptionValue.isNetPrint){a.push(" <optgroup label='Network'>");for(var c=0;c<this.printOptionValue.netPrintList.length;c++){var d=this.printOptionValue.netPrintList[c];a.push("    <option value='"+d.name+"' style='padding-left: 30px;'>"+d.name+"</option>");}a.push("</optgroup>");}a.push("</select>");a.push("</div>");a.push("<div id='re_printType2"+this.m_uid+"' style='position:absolute;left:15px;right:15px;top:83px;height:40px;border:1px solid darkgray;display:none'>");a.push("<table style='position:absolute;top:5px'>");a.push("<tbody><tr><td style='padding-left:5px;padding-top:5px'>"+this.m_languageMap.NofC+" : </td>");a.push("<td style='padding-left:5px;padding-top:5px'><input id='re_printType3"+this.m_uid+"' type='text' value='1' style='width:40px'></td>");a.push("</tr></tbody></table>");a.push("</div>");a.push("<div id='re_printType11"+this.m_uid+"' style='position:absolute;left:15px;right:15px;bottom:50px;height:130px;border:1px solid darkgray;background-color: inherit;'>");a.push("<table style='position:absolute;top:5px'>");a.push("<tbody>");a.push("	<tr><td aria-label='"+this.m_languageMap.total_page+"' title='"+this.m_languageMap.total_page+"' tabindex='2' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(1);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',1);  style='cursor:default'>");a.push("		<input id='re_printType4"+this.m_uid+"' type='radio' value='1' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==1?"checked":"")+"/>"+this.m_languageMap.total_page);a.push("	</td></tr>");a.push("	<tr><td aria-label='"+this.m_languageMap.currentPage+"' title='"+this.m_languageMap.currentPage+"' tabindex='3' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(2);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',2); style='cursor:default'>");a.push("		<input id='re_printType5"+this.m_uid+"' type='radio' value='2' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==2?"checked":"")+"/>"+this.m_languageMap.currentPage);a.push("	</td></tr>");a.push("	<tr><td aria-label='"+this.m_languageMap.page_designation+"' title='"+this.m_languageMap.page_designation+"' tabindex='4' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_selectPrintRange(3);\" onkeypress=mKey_selectPrintRange(event,'"+this.m_uid+"',3); style='cursor:default'>");a.push("		<input id='re_printType6"+this.m_uid+"' type='radio' value='3' name='m_ReSelectRange' tabindex='-1' "+(this.m_selectPageType.print==3?"checked":"")+"/>"+this.m_languageMap.page_designation);a.push("	</td></tr>");a.push("	<tr><td style='padding-left:25px;padding-top:5px'>");a.push("		<input title='"+this.m_languageMap.from+"' tabindex='5' type='text' id='re_printType7"+this.m_uid+"' value='1' style='width:40px' "+(this.m_selectPageType.print!=3?"disabled":"")+"/>"+this.m_languageMap.from+" &nbsp;&nbsp;&nbsp;");a.push("		<input title='"+this.m_languageMap.to+"' tabindex='6' type='text' id='re_printType8"+this.m_uid+"' value='"+this.m_pageCount+"' style='width:40px'"+(this.m_selectPageType.print!=3?"disabled":"")+"/>"+this.m_languageMap.to+"");a.push("	</td></tr>");a.push("</tbody></table>");a.push("</div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:14px;border:0;'>"+this.m_languageMap.printType+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:75px;border:0;display:none' id='re_printType9"+this.m_uid+"'>"+this.m_languageMap.print_info+"</span>");a.push("<span class='report_view_box' style='position:absolute;left:20px;bottom:174px;border:0;' id='re_printType10"+this.m_uid+"'>"+this.m_languageMap.print_range+"</span>");a.push("<button tabindex='7'  title='"+this.m_languageMap.print+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printExportInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.print+"</button>");a.push("<button tabindex='8'  title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeReportPrintInfo();return false;\" class='report_view_button' style='position:absolute;bottom:5px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");a.push("<span style='position:absolute;left:16px;bottom:37px;font-size:8pt;color:red' id='re_printType10"+this.m_uid+"'></span>");e.innerHTML=a.join("");a=null;if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(e);}this.mRe_setPrintViewDomInfo(e);if(this.printOptionValue.localStorage!="0"){this.mRe_selectPrintOption(this.printOptionValue.localStorage);}};Report.prototype.mRe_setPrintViewDomInfo=function(b){this.printOptionValue.domList=new Object();var c=new Object();var a=this.m_uid;c.viewDom=b;c.printTypeDom=document.getElementById("re_printType1"+a);c.validationDom=document.getElementById("re_printType10"+a);c.netSpan1Dom=document.getElementById("re_printType2"+a);c.netSpan2Dom=document.getElementById("re_printType9"+a);c.netPageCountDom=document.getElementById("re_printType3"+a);c.check1Dom=document.getElementById("re_printType4"+a);c.check2Dom=document.getElementById("re_printType5"+a);c.check3Dom=document.getElementById("re_printType6"+a);c.startInDom=document.getElementById("re_printType7"+a);c.endInDom=document.getElementById("re_printType8"+a);c.netSpan3Dom=document.getElementById("re_printType10"+a);c.printRangeDom=document.getElementById("re_printType11"+a);this.printOptionValue.domList=c;c.printTypeDom.focus();};Report.prototype.selectPrintLoader=function(){var a=this.printOptionValue.domList.printTypeDom.value;if(a=="pdf"){this.printView(true);}else{if(a=="html"){this.printHTMLView(true);}else{if(a=="hwp"){this.printHWPView(true);}else{if(a=="exe"){this.printEXEView(true);}}}}};Report.prototype.mRe_selectPrintOption=function(a){if(a=="pdf"||a=="html"||a=="hwp"){this.printOptionValue.domList.viewDom.style.height="";this.printOptionValue.domList.netSpan1Dom.style.display="none";this.printOptionValue.domList.netSpan2Dom.style.display="none";this.printOptionValue.domList.netSpan3Dom.style.display="block";this.printOptionValue.domList.printRangeDom.style.display="block";}else{if(a=="exe"){this.printOptionValue.domList.viewDom.style.height="130px";this.printOptionValue.domList.netSpan1Dom.style.display="none";this.printOptionValue.domList.netSpan2Dom.style.display="none";this.printOptionValue.domList.netSpan3Dom.style.display="none";this.printOptionValue.domList.printRangeDom.style.display="none";}else{this.printOptionValue.domList.viewDom.style.height="300px";this.printOptionValue.domList.netSpan1Dom.style.display="block";this.printOptionValue.domList.netSpan2Dom.style.display="block";this.printOptionValue.domList.netSpan3Dom.style.display="block";this.printOptionValue.domList.printRangeDom.style.display="block";}}};Report.prototype.mRe_selectPrintRange=function(b){var a=this.printOptionValue.domList;if(a.check1Dom.disabled){return;}if(1==b){a.check1Dom.checked=true;a.startInDom.disabled=true;a.endInDom.disabled=true;}else{if(2==b){a.check2Dom.checked=true;a.startInDom.disabled=true;a.endInDom.disabled=true;}else{a.check3Dom.checked=true;a.startInDom.disabled=false;a.endInDom.disabled=false;}}};Report.prototype.printViewValidationCheck=function(){var c=this.printOptionValue.domList;if(c.check3Dom.checked){var b=Number(c.startInDom.value);var a=Number(c.endInDom.value);if(isNaN(b)||isNaN(a)){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}else{if(b<=0.9||a<=0.9||b>a||b>this.m_pageCount||a>this.m_pageCount){c.validationDom.innerHTML=this.m_languageMap.printNum_validation;c=null;return false;}}}c=null;return true;};Report.prototype.makePrintOption=function(){var a=this.printOptionValue.domList;if(a.check1Dom.checked){this.printOptionValue.startNum=1;this.printOptionValue.endNum=this.m_pageCount;}else{if(a.check2Dom.checked){this.printOptionValue.startNum=this.beforePageIndex+1;this.printOptionValue.endNum=this.beforePageIndex+1;}else{this.printOptionValue.startNum=Number(a.startInDom.value);this.printOptionValue.endNum=Number(a.endInDom.value);}}};Report.prototype.mRe_printExportInfo=function(){this.m_isButtonLock=false;if(this.printViewValidationCheck()){this.makePrintOption();this.targetDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.selectPrintLoader();if(this.m_buttonEvent.printOkButton!=null){this.m_buttonEvent.printOkButton();}}};Report.prototype.mRe_closeReportPrintInfo=function(){this.m_isButtonLock=false;this.targetDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.disabledMenu(false);this.print_button.focus();if(this.m_buttonEvent.printCancelButton!=null){this.m_buttonEvent.printCancelButton();}};Report.prototype.checkPrintJsonOption=function(){var c=this.printOptionValue.domList;var a=false;if(is_ie){var b=this.m_versionInfo.build.substring(6).replace(/\_([0-9a-zA-Z]+)/g,"");if(106<Number(b)&&!this.m_isRedBC){a=true;this.m_isPrintPop=true;}}if(null!=c){return'{"isPopupPrint":'+a+',"pageCount":'+this.printOptionValue.pageCount+',"startNum":'+this.printOptionValue.startNum+',"endNum":'+this.printOptionValue.endNum+"}";}else{if(this.m_selectPageType.print==2){return'{"isPopupPrint":'+a+',"startNum":'+(this.beforePageIndex+1)+',"endNum":'+(this.beforePageIndex+1)+"}";}return'{"isPopupPrint":'+a+',"startNum":1,"endNum":'+this.m_pageCount+"}";}};Report.prototype.printOpReset=function(){this.printOptionValue.domList=null;};Report.prototype.printIEExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_reader9";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.adobe9Info+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(this.adobeMessage.is_message){a.push(this.adobeMessage.message);}else{a.push(this.m_languageMap.adobe9Info);a.push("<br>"+this.m_languageMap.adobe9Info2);a.push(this.m_languageMap.adobe9Info3);}a.push("</span><br>");var c=null!=this.m_pdfLink?this.m_pdfLink:("https://get.adobe.com/reader/?loc="+this.m_languageMap.languageInfo);a.push("<a style='position:ralative' href='"+c+"' target='blank'>"+c+"</a><br>");if(this.pESaveButtonVisible){a.push("<br><span>"+this.m_languageMap.adobe9Info4+"</span>");}a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");if(this.pESaveButtonVisible){a.push("<button tabindex='2' title='"+this.m_languageMap.save+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");a.push("<button tabindex='3' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");}else{a.push("<button tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");}b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_printFilePDF=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.printOpReset();this.reportCheckSend(1);};Report.prototype.mRe_closePrintFilePDF=function(){this.closePrintInfoWindow();this.disabledMenu(false);if(this.m_buttonEvent.PDFPrintAlertCloseButton!=null){this.m_buttonEvent.PDFPrintAlertCloseButton();}};Report.prototype.mRe_printIEWindow=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.printIEWindow();};Report.prototype.closePrintInfoWindow=function(){if(null!=this.m_printInfo_view){this.targetDiv.removeChild(this.m_popupViewDiv);this.m_popupViewDiv=null;this.m_printInfo_view=null;}};Report.prototype.printNotExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_NOTReader";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.adobe9Info5+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(this.adobeMessage.is_message){a.push(this.adobeMessage.message);}else{a.push(this.m_languageMap.adobe9Info5);a.push("<br>"+this.m_languageMap.adobe9Info2);a.push(this.m_languageMap.adobe9Info3);}a.push("</span><br>");var c=null!=this.m_pdfLink?this.m_pdfLink:("https://get.adobe.com/reader/?loc="+this.m_languageMap.languageInfo);a.push("<a style='position:ralative' href='"+c+"' target='blank'>"+c+"</a><br>");if(this.pESaveButtonVisible){a.push("<br><span>"+this.m_languageMap.adobe9Info4+"</span>");}a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");if(this.pESaveButtonVisible){a.push("<button  tabindex='2'  title='"+this.m_languageMap.save+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");a.push("<button  tabindex='3' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");}else{a.push("<button  tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");}b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.printFirefoxExportView=function(){if(this.m_directPrint){this.mRe_printPopFilePDF();return;}this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_popPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printLimit1+" "+this.m_languageMap.printLimit2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:7%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'>");a.push("<span>"+this.m_languageMap.pdfPrintLimit1+"</span>");a.push("<br>"+this.m_languageMap.pdfPrintLimit2);a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printPopFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");a.push("<button tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printIEWindow();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;visibility:hidden'>"+this.m_languageMap.ignore+"</button>");a.push("<button tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_printPopFilePDF=function(){var b="R08";if(this.m_is_serverSaveFile){b="R09S3";}this.closePrintInfoWindow();this.disabledMenu(false);if(this.m_directPrint&&is_safari){this.formTag_clipid.value=b;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value=new Date().getTime();if(null==this.formTag){var c=document.createElement("form");this.targetDiv.appendChild(c);c.appendChild(this.formTag_clipid);c.appendChild(this.formTag_uid);c.appendChild(this.formTag_clipUID);c.appendChild(this.formTag_print);c.appendChild(this.formTag_printImage);c.appendChild(this.formTag_path);c.appendChild(this.formTag_option);c.appendChild(this.formTag_ChromeFitToPage);c.appendChild(this.formTag_s_time);c.style.display="none";c.encoding="application/x-www-form-urlencoded";c.method="post";this.formTag=c;}this.formTag.action=this.servletPath;this.formTag.target="report_SubWindow";this.formTag.submit();return;}if(-1!=this.servletPath.indexOf("?")){var a=new Date().getTime();var d=this.servletPath+"&";d+="ClipID="+b;d+="&fileName=report.pdf";d+="&isPDFPrintImage="+this.isPDFPrintImage;d+="&optionValue="+this.checkPrintJsonOption();d+="&path="+this.clientPath;d+="&print=print";d+="&isChromePrintFitToPage="+this.isChromePrintFitToPage;d+="&uid="+this.m_uid;d+="&clipUID="+this.m_uid+"&s_time="+a;if(this.m_firefoxPrint.isPopup){window.open(d,"","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);}else{window.open(d,"_blank");}}else{this.formTag_clipid.value=b;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value=new Date().getTime();if(null==this.formTag){var c=document.createElement("form");this.targetDiv.appendChild(c);c.appendChild(this.formTag_clipid);c.appendChild(this.formTag_uid);c.appendChild(this.formTag_clipUID);c.appendChild(this.formTag_print);c.appendChild(this.formTag_printImage);c.appendChild(this.formTag_path);c.appendChild(this.formTag_option);c.appendChild(this.formTag_ChromeFitToPage);c.appendChild(this.formTag_s_time);c.style.display="none";c.encoding="application/x-www-form-urlencoded";c.method="post";this.formTag=c;}this.formTag.action=this.servletPath;if(this.m_firefoxPrint.isPopup){window.open("","report_SubWindow","height="+this.m_firefoxPrint.height+",width="+this.m_firefoxPrint.width);this.formTag.target="report_SubWindow";}else{this.formTag.target="_blank";}this.formTag.submit();}};Report.prototype.printEdgeExportView=function(){if(this.m_directPrint){this.mRe_printPopFilePDF();return;}this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_popPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.pdfPrintLimit3+" "+this.m_languageMap.pdfPrintLimit4+" "+this.m_languageMap.print_info2+"' tabindex='1'  style='position:absolute;left:13px;right:15px;top:7%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'>");a.push("<span>"+this.m_languageMap.pdfPrintLimit3+"</span>");a.push("<br>"+this.m_languageMap.pdfPrintLimit4);a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button tabindex='2' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printPopFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");a.push("<button tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printIEWindow();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;visibility:hidden'>"+this.m_languageMap.ignore+"</button>");a.push("<button tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrintFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");this.m_popupViewDiv.appendChild(b);this.m_printInfo_view=b;a=null;};Report.prototype.mRe_printEdgePopFilePDF=function(){this.closePrintInfoWindow();this.disabledMenu(false);var b=new Array();var g=this.servletPath;if(-1!=this.servletPath.indexOf("?")){var d=this.servletPath.split("?");if(g.length>1){var f=d[1];g=d[0];var j=f.split("&");for(var e=0;e<j.length;e++){var a=j[e].split("=");if(a.length>1){var h=document.createElement("input");h.type="hidden";h.name=a[0];h.value=a[1];this.formTag.appendChild(h);b.push(h);}}}}var c="R08";if(this.m_is_serverSaveFile){c="R09S3";}this.formTag_clipid.value=c;this.formTag_uid.value=this.m_uid;this.formTag_clipUID.value=this.m_uid;this.formTag_print.value="print";this.formTag_printImage.value=this.isPDFPrintImage;this.formTag_path.value=this.clientPath;this.formTag_option.value=this.checkPrintJsonOption();this.formTag_ChromeFitToPage.value=this.isChromePrintFitToPage;this.formTag_s_time.value=new Date().getTime();this.formTag.action=g;this.formTag.target="re_target"+this.m_uid;this.formTag.submit();if(b.length>0){for(var e=0;e<b.length;e++){var h=b[e];this.formTag.removeChild(h);}}b=null;};Report.prototype.printLimitedExportView=function(c){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_limitPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printLimit1+" "+this.m_languageMap.printLimit2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:5%;height:50%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;'><span>");a.push(this.m_languageMap.printLimit1);a.push("<br>"+this.m_languageMap.printLimit2+"</span>");a.push("</div></div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");if(this.pESaveButtonVisible){a.push("<button  tabindex='2' title='"+this.m_languageMap.save+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_printFilePDF();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:175px; height:30px;width:75px;'>"+this.m_languageMap.save+"</button>");}if("pdf"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnorePrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{if("hwp"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreHWPPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{if("exe"==c){a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreEXEPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}else{a.push("<button  tabindex='3' title='"+this.m_languageMap.ignore+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_IgnoreHTMLPrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:95px; height:30px;width:75px;'>"+this.m_languageMap.ignore+"</button>");}}}a.push("<button  tabindex='4' title='"+this.m_languageMap.cancel+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closePrinting();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.cancel+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_closePrinting=function(){this.closePrintInfoWindow();this.disabledMenu(false);};Report.prototype.mRe_IgnorePrinting=function(){this.closePrintInfoWindow();this.mRe_printView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreHTMLPrinting=function(){this.closePrintInfoWindow();this.mRe_printHTMLView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreHWPPrinting=function(){this.closePrintInfoWindow();this.mRe_printHWPView();this.disabledMenu(false);};Report.prototype.mRe_IgnoreEXEPrinting=function(){this.closePrintInfoWindow();this.mRe_printEXEView();this.disabledMenu(false);};Report.prototype.printHtmlPopupCheckExportView=function(){this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);if(null!=this.m_html_info){this.m_languageMap.printSet2=this.m_html_info;this.m_languageMap.printSet1="";}var b=document.createElement("div");b.className="report_view_box report_Ex_popHTMLPrint";var a=new Array();a.push("<div aria-label='"+this.m_languageMap.printSet1+" "+this.m_languageMap.printSet2+"' tabindex='1' style='position:absolute;left:13px;right:15px;top:5%;height:50%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;'><span>");a.push(this.m_languageMap.printSet1);if(this.m_language==0){a.push("<br>");}a.push(this.m_languageMap.printSet2+"</span>");a.push("</div></div>");a.push("<span class='report_view_box' style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<input tabindex='2' title='"+this.m_languageMap.printSet3+"' type='checkbox' value='true' id='htmlPopupCheck"+this.m_uid+"' style='position:absolute;bottom:40px;right:15px; height:20px;left:10px;'/>");a.push("<span style='position:absolute;bottom:40px;right:15px; height:20px;left:30px;'>"+this.m_languageMap.printSet3+"</span>");a.push("<button tabindex='3' title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_htmlPopupCheck();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_htmlPopupCheck=function(){var a=document.getElementById("htmlPopupCheck"+this.m_uid);if(null!=a){if(a.checked){mRe_setLocalStorage("mRe_htmlPopupCheck","1");}}this.mRe_closePrinting();this.checkPrintHTMLView();};Report.prototype.mRe_print_progress_check=function(){var a=this;var b=this.m_uid;if(a.m_fileDownLoadServerCheck){this.fileDownloadCheckTimer=window.setTimeout(function(){a.fileCheckSend("print");},1000);}};function mKey_selectPrintRange(c,d,b){if(32==c.keyCode||13==c.keyCode){var a=m_reportHashMap[d];if(null!=a){a.mRe_selectPrintRange(b);}}}function getPrintFrame(a){var f=document.styleSheets;var g="";if(typeof f!="undefined"){var e=f.length;for(var b=0;b<e;b++){var c=f[b];if(null!=c){if(null!=c.href&&-1!=c.href.indexOf("font.css")){g=c.href;}}}}var d=new Array();d.push('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">');d.push("<html>");d.push("<head>");d.push('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">');d.push("<title>report</title>");if(""!=g){d.push("<link rel='stylesheet' type='text/css' href='"+g+"'>");}d.push("<style media='print' type='text/css'>");d.push(" #header, #leftside, #rightside, #footer {");d.push("	display:none;");d.push("}");d.push("    @page {");if(!is_ie){d.push("size:");d.push((a.pageWidth/10)+"mm ");d.push((a.pageHeight/10)+"mm;");}d.push("       margin: 0mm 0mm 0mm 0mm;");d.push("    }");d.push("  body, #content, .container .row {");d.push(" margin : 0;");d.push(" width:100%;");d.push(" }");d.push("</style>");d.push(" <script type='text/javascript'>");d.push(" function HttpClient() {");d.push("	try {");d.push("		var objRequest = new XMLHttpRequest();");d.push("		if (null != objRequest)");d.push("			this.m_objHttpRequest = objRequest;");d.push("	} catch (e) {");d.push("		try {");d.push("			var objRequest = new ActiveXObject('Msxml2.XMLHTTP');");d.push("			if (null != objRequest)");d.push("				this.m_objHttpRequest = objRequest;");d.push("		} catch (e) {");d.push("			try {");d.push("				var objRequest = new ActiveXObject('Microsoft.XMLHTTP');");d.push("				if (null != objRequest)");d.push("					this.m_objHttpRequest = objRequest;");d.push("			} catch (e) {");d.push("			}");d.push("		}");d.push("	}");d.push(" }");d.push("HttpClient.prototype.send = function(strURL, objData, bAsync,");d.push("		handleASyncHttpResponse) {");d.push("	if (bAsync) {");d.push("		this.m_objHttpRequest.onreadystatechange = handleASyncHttpResponse;");d.push("	} else {");d.push("		this.m_objHttpRequest.onreadystatechange = null;");d.push("	}");d.push("	this.m_objHttpRequest.open('POST', strURL, bAsync);");d.push("	this.m_objHttpRequest.setRequestHeader('Content-Type',");d.push("			'application/x-www-form-urlencoded; charset=UTF-8');");d.push("	this.m_objHttpRequest.send(objData);");d.push("	if (!bAsync) {");d.push("		if (4 == this.m_objHttpRequest.readyState) {");d.push("			if (200 == this.m_objHttpRequest.status) {");d.push("				return this.m_objHttpRequest.responseText;");d.push("			} else {");d.push("			}");d.push("		}");d.push("		return this._handleSyncHttpResponse();");d.push("	}");d.push("};");d.push("var m_report = null;");d.push("var m_obj = null;");d.push("function bodyPaint(obj, report){");d.push("	m_report = report;");d.push("	m_obj = obj;");d.push("   window.setTimeout('bodyPaintRun()', 0);");d.push(" }");d.push("function bodyPaintRun(){");d.push("	var obj = m_obj;");d.push("	var svgBody = document.getElementById('body1');");d.push("	svgBody.innerHTML = '';");d.push("try{");d.push("	if(obj.type == 0){");d.push("		var newDiv = null;");d.push("		for(var i=(obj.option.startNum-1); i<obj.option.endNum; i++){");d.push("			newDiv = document.createElement('img');");d.push("			svgBody.appendChild(newDiv);");d.push("			newDiv.src = obj.url + '?&ClipID=R10&pageNumber=' + i + '&uid=' + obj.uid + '&clipUID=' + obj.uid + '&html5=false&DPI=96';");d.push("		}");d.push("	}");d.push("	else{");d.push("		var newDiv = null;");d.push("		var objHttpClient = new HttpClient();");d.push("		for(var i=(obj.option.startNum-1); i<obj.option.endNum; i++){");d.push("			newDiv = document.createElement('div');");d.push("			svgBody.appendChild(newDiv);");d.push("			var strUrl ='';");d.push("			if(-1 != obj.url.indexOf('?')){");d.push("				strUrl = obj.url + '&ClipID=R10&pageNumber=' + i + '&uid=' + obj.uid + '&clipUID=' + obj.uid + '&html5=true&DPI=96';");d.push("			}else{");d.push("				strUrl = obj.url + '?ClipID=R10&pageNumber=' + i + '&uid=' + obj.uid + '&clipUID=' + obj.uid + '&html5=true&DPI=96';");d.push("			}");d.push("			var strResult = objHttpClient.send(strUrl, '', false, null);");d.push("		    if(0 == strResult.indexOf('\"')){");d.push("					strResult = strResult.substring(1,strResult.length - 1);");d.push("			}");d.push("			var data = strResult.split('{clipreport_separator}');");d.push("			newDiv.innerHTML = unescape(data[1]);");d.push("			if(null != newDiv.firstChild && 'svg'== newDiv.firstChild.tagName){");if(is_ie){d.push("				newDiv.style.border='1px solid transparent';");d.push("				newDiv.style.overflow='visible';");}else{if(is_safari&&!is_window_safari){d.push("				newDiv.style.overflow='hidden';");d.push("				newDiv.style.border='0px solid red';");d.push("				newDiv.style.zoom='0.87';");d.push("				newDiv.style.width='"+(a.pageWidth/100)+"cm';");d.push("				newDiv.style.height='"+(a.pageHeight/100)+"cm';");}else{d.push("				newDiv.style.overflow='hidden';");d.push("				newDiv.style.border='0px solid red';");d.push("				newDiv.style.width='"+(a.pageWidth/100)+"cm';");d.push("				newDiv.style.height='"+((a.pageHeight/100)-0.1)+"cm';");}}d.push("				newDiv.firstChild.style.overflow = 'hidden';");d.push("			}");d.push("		}");d.push("	}");d.push("   if(obj.firefox){");d.push("       window.print();");d.push("	}else{");d.push("	   document.execCommand('print', false, null);");d.push("	}");d.push("   m_report.mRe_printHTMLViewEnd(true);");d.push("   m_report = null;");d.push("   m_obj= null;");d.push("}catch(err){");d.push("   m_report.mRe_printHTMLViewEnd(false);");d.push("   m_report = null;");d.push("   m_obj= null;");d.push("	}");d.push(" }");d.push("<\/script>");d.push("</head>");d.push("<body id='body1'>");d.push("</body>");d.push("</html>");return d.join("");}function getPDFPrintFrame(a){var c=a?"R09S3":"R08";var b=new Array();b.push('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">');b.push("<html>");b.push("<head>");b.push('<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">');b.push("<title>print</title>");b.push('<script type="text/javascript">');b.push("function receiveMessage(event){");b.push('var iframe = document.getElementById("target1");');b.push("document.body.removeChild(iframe);");b.push("iframe = document.createElement('iframe');");b.push("iframe.id = 'target1';");b.push("iframe.name = 're_target_print';");b.push("document.body.appendChild(iframe);");b.push("var data = window.eval(event.data);");b.push("document.getElementById('re_form_uid').value = data.uid;");b.push("document.getElementById('re_form_clipUID').value = data.uid;");b.push("document.getElementById('re_form_path').value = data.clientPath;");b.push("document.getElementById('re_form_printImage').value = data.isPDFPrintImage;");b.push("document.getElementById('re_form_ChromeFitToPage').value = data.isChromePrintFitToPage;");b.push("document.getElementById('re_form_s_time').value = new Date().getTime();");b.push('var jsonData = "{\\"drawDashedLineDirectly\\":true,\\"startNum\\":"+data.optionValue.startNum+",\\"endNum\\":"+data.optionValue.endNum+"}";');b.push("document.getElementById('re_form_option').value = jsonData;");b.push("var form1 = document.getElementById('re_form1');");b.push("form1.action = data.url;");b.push("if(-1 != data.url.indexOf('?')){");b.push("	var s_time = new Date().getTime();");b.push("	var strUrl = data.url + '&ClipID="+c+"&isPDFPrintImage=' + data.isPDFPrintImage + '&' + ");b.push("				'isChromePrintFitToPage=' + data.isChromePrintFitToPage + '&'+");b.push("				'optionValue=' + jsonData + '&print=print&uid=' + data.uid + '&path='+ escape(data.clientPath)+'&' + ");b.push("				's_time=' + s_time;");b.push("	iframe.src = strUrl;");b.push("}else{");b.push("	form1.submit();");b.push("}");b.push("	iframe.onload = function() {");b.push("		var win = iframe.contentWindow;");b.push('		window.parent.postMessage(data.uid,"*");');b.push("		if (win) {");b.push("			win.focus();");b.push("			win.print();");b.push("		}");b.push("	};");b.push("}");b.push("if (window.addEventListener){");b.push('	  addEventListener("message", receiveMessage, false);');b.push("} else {");b.push('	  attachEvent("onmessage", receiveMessage);');b.push("}");b.push("<\/script>");b.push("</head>");b.push("<body>");b.push('	<iframe id="target1" name="re_target_print"></iframe>');b.push("<form id='re_form1' style='display:none;' encoding='application/x-www-form-urlencoded' method='post' target='re_target_print'>");b.push("<input type='text' id='re_form_clipid' name='ClipID' value='"+c+"' />");b.push("<input type='text' id='re_form_uid' name='uid' />");b.push("<input type='text' id='re_form_clipUID' name='clipUID' />");b.push("<input type='text' id='re_form_print' name='print' value='print'/>");b.push("<input type='text' id='re_form_printImage' name='isPDFPrintImage' value='false'/>");b.push("<input type='text' id='re_form_path' name='path' />");b.push("<input type='text' id='re_form_option' name='optionValue' />");b.push("<input type='text' id='re_form_ChromeFitToPage' name='isChromePrintFitToPage' />");b.push("<input type='text' id='re_form_s_time' name='s_time' />");b.push("</body>");b.push("</html>");return b.join("");}Report.prototype.editableSignControl=function(n,a,o,g,i){if(this.m_isButtonLock==false){if(null!=this.signPaintDiv){return;}Re_zoom.isPop=true;var f=this;this.disabledMenu(true);a+=100;o+=100;var k=n.getAttribute("type");var d=n.getAttribute("controlindex");var q=document.createElement("div");if(this.m_signOption.staticPos){q.style.cssText="position:absolute;left:"+this.m_signOption.staticLeft+";top:"+this.m_signOption.staticTop+";width:"+(a+50)+"px;height:"+(o+110)+"px;";}else{q.style.cssText="position:absolute;left:"+(this.paintDiv.scrollLeft+10+this.m_signOption.offsetLeft)+"px;top:"+(this.paintDiv.scrollTop+10+this.m_signOption.offsetTop)+"px;width:"+(a+50)+"px;height:"+(o+110)+"px;";}q.className="report_sign_div";var b=document.createElement("div");b.className="report_sign_menu";var l=document.createElement("button");l.className="report_sign_button report_sign_save";l.innerHTML=this.m_languageMap.save;var m=document.createElement("button");m.className="report_sign_button report_sign_reset";m.innerHTML=this.m_languageMap.reset;var c=document.createElement("button");c.className="report_sign_button report_sign_cancel";c.innerHTML=this.m_languageMap.cancel;var p=document.createElement("span");p.innerHTML="&nbsp;&nbsp;";b.appendChild(l);b.appendChild(p.cloneNode(true));b.appendChild(m);b.appendChild(p.cloneNode(true));b.appendChild(c);var j=document.createElement("div");j.className="report_sign_paint";q.appendChild(b);q.appendChild(j);this.paintDiv.appendChild(q);this.signPaintDiv=q;var e=$(j);e.jSignature({"background-color":"transparent","decor-color":"transparent",lineWidth:g,color:i,width:(a),height:(o)});m.onclick=function(){e.jSignature("reset");};c.onclick=function(){f.paintDiv.removeChild(q);f.disabledMenu(false);f.signPaintDiv=null;};var h=this.m_necessaryCheck;l.onclick=function(){f.disabledMenu(false);f.signPaintDiv=null;var x=e.jSignature("getData").split("base64,");var v={necessaryPage:h,data:new Array()};v.data[Number(d)]=new Object();v.data[Number(d)].type=k;v.data[Number(d)].controlIndex=d;v.data[Number(d)].value=encodeURIComponent(x[1]);var u=new Date().getTime();var s="ClipID=R11&pageNumber="+f.beforePageIndex+"&clipUID="+f.m_uid+"&uid="+f.m_uid+"&Accessibility="+f.m_isAccessibility+"&data="+JSON.stringify(v)+"&s_time="+u;s=mRe_onBeforeSend(s);if(f.m_isCrossDomain){if(window.XDomainRequest){var r=new XDomainRequest();var t=servletPath+"?"+s;if(r){r.onload=function(){f.resultNewReport(mRe_onAfterSend(r.responseText));};r.onerror=function(){ReportWebLog("IE8 crossDomain error");mRe_ReportEventHandler(40);};r.open("GET",t);r.send();}}else{$.ajax({type:"POST",url:servletPath,crossDomain:true,data:s,success:function(y){paintReportText(mRe_onAfterSend(y));},error:function(y){ReportWebLog(y);mRe_ReportEventHandler(40);}});}}else{var w=new HttpClient();w.send(f.servletPath,s,true,function(){if(4==this.readyState){if(200==this.status){paintReportText(mRe_onAfterSend(this.responseText));}else{f.paintDiv.innerHTML=f.m_languageMap.link_error;mRe_ReportEventHandler(40);f.pageSlideShow();mRe_ReportWebLog(this.status);}}});}f.paintDiv.removeChild(q);f.createEditableProgress();n.style.zIndex="0";};}};Report.prototype.m_NecessaryPopup=function(e){this.m_necessaryCheck=true;this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var d=0;var c=document.createElement("div");c.className="report_view_box";var f=100;if(this.m_signOption.staticPos){c.style.cssText="position:absolute;left:"+this.m_signOption.staticLeft+";top:"+this.m_signOption.staticTop+";width:350px;";}else{c.style.cssText="position:absolute;left:"+(10+this.m_signOption.offsetLeft)+"px;top:"+(80+this.m_signOption.offsetTop)+"px;width:350px;";}var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;height:20%;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:26%;font-weight:bold;'><span>");a.push("필수 입력사항이 누락되었습니다.</span>");a.push("</div></div>");a.push("<div style='position:absolute;left:20px;right:5px;top:30%;'>");for(var b=0;b<e.length;b++){if(b==0){d=e[b].pageNum;}a.push((b+1)+". ");a.push(e[b].value+"<br>");f+=20;}c.style.height=f+"px";a.push("</div>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].NecessaryPage("+d+");return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");c.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(c);}a=null;};Report.prototype.NecessaryPage=function(a){if(this.m_popupViewDiv!=null){if(null!=this.signPaintDiv){this.paintDiv.removeChild(this.signPaintDiv);this.signPaintDiv=null;}this.targetDiv.removeChild(this.m_popupViewDiv);}this.disabledMenu(false);if(this.beforePageIndex==a){this.sendData(a);}else{this.selectPage(a);}};window.m_report_language_map={lic_error:["리포트 서버 라이센스에 문제가 있습니다.","Report a problem with the server license.","レポートサーバーのライセンスに問題があります。","报告服务器许可证出现问题。"],report_error:["잘못된 결과입니다.","Invalid results","結果が正しくありません。","结果错误。"],report_error2:["보고서 양식이 잘못되었습니다.(페이지가 없습니다.)","Report form is incorrect. (There is no page.)","レポートフォームが間違っています。（ページがありません。）","报告的形式不正确。 （没有页。）"],install_error:["리포트 서버 설치에 문제가 있습니다.","There is a problem with the report server installation.","レポートサーバーのインストールに問題があります。","报告服务器的安装出现问题。"],sesstion_error:["리포트파일이 삭제되어 찾을 수 없습니다.","This session has been terminated.","セッションが終了しました。","会话结束。"],link_error:["리포트 서버와의 연결에 실패하였습니다.","It failed to connect to the report server.","これは、レポートサーバーへの接続に失敗しました。","它无法连接到报表服务器。"],img_alt:["리포트 본문 입니다.","The body of the report.","レポートの本文です。","报告正文。"],save:["저장","Save","保存","保存"],ignore:["무시","Ignore","無視","忽略"],cancel:["취소","Cancel","キャンセル","取消"],reset:["초기화","Reset","リセット","重置"],pdf_save:["PDF 저장","PDF file","PDF形式で保存","保存成PDF文件"],excel_save:["엑셀 저장","Excel file","エクセル形式で保存","保存成表格文件"],hwp_save:["한글 저장","HWP file","ハングル形式で保存","保存成hwp文件"],rtf_save:["RTF 저장","RTF file","RTF形式で保存","保存成RTF文件"],ppt_save:["PPT 저장","PPT file","PPT形式で保存","保存成PPT文件"],html_save:["HTML 저장","HTML file","HTML形式で保存","保存成HTML文件"],hancell_save:["한셀 저장","Hancell file","ハンセル形式で保存","保存成Hancell文件"],html5_save:["HTML5 저장","HTML5 file","HTML5形式で保存","保存成HTML 5文件"],doc_save:["DOC 저장","DOC file","DOC形式で保存","保存成DOC文件"],docx_save:["DOCX 저장","DOCX file","DOCX形式で保存","保存成DOCX文件"],jpg_save:["JPG 저장","JPG file","JPG形式で保存","保存成JPG文件"],tif_save:["TIF 저장","TIF file","TIF形式で保存","保存成TIF文件"],excelData_save:["엑셀(data only) 저장","excel data only file","excel data only形式で保存","保存成excel data only文件"],txt_save:["TXT 저장","TXT file","TXT形式で保存","保存成TXT文件"],print:["인쇄","Print","印刷","打印"],doodle:["형광펜","highlighter","蛍光ペン","荧光笔"],first_page:["첫 페이지","First Page","先頭ページ","首页"],prv_page:["이전 페이지","Previous Page","前のページ","上一页"],page:["페이지","Page","ページ","页数"],total_page:["전체 페이지","All Page","全てのページ","全部页"],next_page:["다음 페이지","Next Page","次のページ","下一页"],last_page:["마지막 페이지","Last Page","最後のページ","末页"],splitPage:["페이지 분할 저장","Page Split Save","Page 分割保存","Page 斯普利特保存"],zoomIn:["화면 비율 선택","Zoom","画面の比率を選択","选择画面分配率"],report_info:["등록 정보","Information","登録情報","注册信息"],close:["닫기","Close","閉じる","关闭"],clipReport:["클립리포트","Clipreport","Clipreport","Clipreport"],version:["버전","Version","バージョン","版本"],webversion:["뷰어","Viewer","Viewer","Viewer"],build:["빌드","Build","ビルド","新建"],report_info_text:["경고:이 컴퓨터 프로그램은 저작권법과 국제 협약의 보호를 받습니다.<br>이 프로그램의 전부 혹은 일부를 무단으로 복제, 배포하는 행위는 민사<br>및 형사법에 의해 엄격히 규제되어 있으며 기소의 사유가 됩니다.","This program is ClipReport4.0 viewer that<br>was develop and deploy by the Clipsoft","警告:このコンピュータープログラムは、著作権法と国際条約による保護を受けています。<br>このプログラムの全部若しくは一部を無断で複製、配布する行為は、民事<br>及び刑事法により厳しく規制されており起訴事由となります。","警告：本计算机程序受著作权法和国际协议的保护。<br>任意复制、发放本程序的全部或部分的行为严格受到民事<br>和刑事法的管制，构成起诉的事由。"],ok:["확인","Ok","確認","确定"],fileType:["파일형식","File Type","ファイル形式","文件形式"],printType:["인쇄방식","Type","印刷方法","打印方式"],propertys:["옵션수정","Settings","オプションの修正","修改选项"],fileName:["파일명","Location","ファイル名","文件名"],save_range:["저장범위","Range","保存範囲","保存范围"],from:["부터"," from"," から","从"],to:["까지"," to"," まで","至"],currentPage:["현재 페이지","Current Page","現在のページ","当前页"],page_designation:["페이지 지정","Page","ページ指定","保存页"],NofC:["매수","Number of Copies","部数","张"],print_info:["인쇄정보","Information","印刷情報","打印信息"],print_info2:["인쇄 안내","Information","印刷案内","打印说明"],print_range:["인쇄범위","Range","印刷範囲","打印范围"],printName_validation:["파일이름이 올바르지 않습니다.","File name is incorrect.","ファイル名が正しくありません。","文件名不正确。"],printNum_validation:["저장범위의 지정 값이 올바르지 않습니다.","The specified value of the storage range is incorrect.","保存範囲に指定した値が正しくありません。","保存范围的指定值不正确。"],exeViewer_info:["EXE뷰어 안내","Information","印刷情報","打印信息"],sheet_type:["시트구분","Sheet Type","シートの区分け","表格区分"],sheet_type1:["페이지 마다","Pages","ページ毎に","每页"],sheet_type2:["하나의 시트","One Sheet","一つのシート","一个表格"],sheet_type3:["하나의 시트(페이지 영역 무시)","One Sheet(igore a page layout)","一つのシート(ページ領域を無視)","一个表格(忽略页面布局)"],sheet_type4:["리포트 마다(페이지 영역 무시)","One Sheet for each report(ignore a page layout)","レポート毎に","每份报告"],sheet_type5:["리포트 마다","One Sheet for each report","各レポートの一枚","一张纸上为每个报表"],merge_cell:["셀 합치기","Merge Cells","セルの結合","合并单元格"],merge_EmptyCell:["공백 셀일 경우 합치기","Merge blank cells","空白セルの場合結合","合并空白单元格"],cell_Separated:["페이지 크기로 셀 분리","Split row at the end of each page","ページのサイズに合わせてセルを分離","按照页面大小拆分单元格"],rightToLeft:["열이 오른쪽에서 왼쪽으로 진행","Display a sheet in a RTL(Right-to-left) layout","列番号を右から左へ表示","纵列自由向左进行"],fitToPageWhenPrinting:["출력시 페이지 맞춤","Fit page at the time of output","出力時のページ合わせる","在输出时适合页面"],cellSizeRatio:["셀 크기 비율","The ratio of a cell's size","セルサイズの比率","单元格大小比例"],cellWidth:["가로 비율","Column","横比","横向比例"],cellHeight:["세로 비율","Row","縦比","纵向比例"],rangeError:["좌표 오차 범위","Error Range","座標誤差の範囲","坐标误差范围"],displayFormat:["일반 표시형식 처리","Format Cells","一般表示形式で処理","常规显示形式处理"],text:["텍스트","Text","テキスト","文本"],normal:["일반","General","一般","一般"],removeHyperlink:["하이퍼링크 제거","removeHyperlink","ハイパーリンクの削除","刪除超鏈接"],repeatPageSectionWhenAllSectionInOneSheet:["페이지 머리글/바닥글 반복","repeatPageSectionWhenAllSectionInOneSheet","repeatPageSectionWhenAllSectionInOneSheet","repeatPageSectionWhenAllSectionInOneSheet"],printRate:["인쇄 확대/축소 비율","Zoom Rate","印刷拡大/縮小比率","打印放大/缩小比例"],widthError:["가로 비율의 설정값이 올바르지 않습니다.","Setting value of the Column is not correct.","横比の設定値が正しくありません。","横向比例的设定值不正确。"],heightError:["세로 비율의 설정값이 올바르지 않습니다.","Setting value of the Row is not correct.","縦比の設定値が正しくありません。","纵向比例的设定值不正确。"],widthErrorValue:["가로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Column, ( 50-200 ) is possible.","設定可能な横比の値は(50 ~ 200)です。","横向比例的设定值可在(50~200)范围内。"],heightErrorValue:["세로 비율의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Row, ( 50-200 ) is possible.","設定可能な縦比の値は(50 ~ 200)です。","纵向比例的设定值可在(50~200)范围内。"],coordinateError:["좌표 오차 범위의 설정값이 올바르지 않습니다.","Setting value of the error range of coordinates is incorrect.","座標誤差範囲の設定値が正しくありません。","坐标误差范围的设定值不正确。"],printError:["인쇄 확대/축소 비율의 설정값이 올바르지 않습니다.","Setting of print enlargement / reduction ratio is not correct.","印刷拡大/縮小比率の設定値が正しくありません。","打印放大/缩小比例的设定值不正确。"],printErrorValue:["인쇄 확대/축소 비율의 설정값은 (10 ~ 400) 가능합니다.","Setting of print enlargement / reduction ratio , ( 10-400 ) is possible.","設定可能な印刷拡大/縮小比率の値は(10 ~ 400)です。","打印放大/缩小比例可在(10~400)范围内。"],hwpExportMethod:["저장 방식","Storage method","保存方式","保存方法"],splitPageOnListTableOnly:["페이지 나눔","Page split","ページ分割","页面师"],listTableOnly:["표만 나열하기","ListTableOnly","切符だけリストする","要只列出票"],fixSize:["크기 고정","Locks controls","サイズを固定","固定尺寸"],allowOverlay:["겹침 허용","Overlay","重ね合わせを許可","允许重叠"],setPageBottomMarginToZero:["페이지 바닥 여백을 0으로 설정","Set the bottom margin of the page to 0","ページ下部の余白を「０」に設定","页脚空白设为0"],pageBottomMarginApplicationRate:["페이지 바닥 여백 적용비율","Application rate of margin","余白の適用率","保证金的应用率"],outputLikeWord:["글자처럼 출력","In Line with Text","文字のように出力","打印文字"],tableSplit:["쪽 영역에서 표 나눔","Split Table","改ページ領域でテーブルを分割","页域内拆分表"],Split:["나눔","Split Table","分割","拆分"],cellSplit:["셀 단위로 나눔","Split Table by row","セル単位に分割","以单元格单位拆分"],noneSplit:["나누지 않음","Do not split","分割しない","不拆分"],defaultCharGap:["기본 자간","Default a character spacing","基本カーニング","基本字间距"],charRatio:["자평","Character Ratio","字送り","字符比率"],lineSpaceRate:["줄간격 비율","Ratio of line spacing","行間隔の比率","行距的比率"],putCheckboxIntoCell:["셀 안에 체크박스 이미지로 넣기","Place a checkbox in a cell","セル内にチェックボックスを挿入","在单元格中添加复选框"],splitTextByLine:["문자열을 여러줄로 나눠서 표현","Split a multi-line text into lines.","テキストをライン別に分けて表示","分行显示文本"],defaultCharGapError:["기본 자간의 설정값이 올바르지 않습니다.","Setting value of the Default a character spacing is not correct.","設定した基本カーニング値が正しくありません。","基本字间距的设定值不正确。"],defaultCharGapValueError:["기본 자간의 설정값은 (-50 ~ 50) 가능합니다.","Setting value of the Default a character spacing, ( -50 ~ 50 ) is possible.","設定可能な基本カーニング値は(-50 ~ 50)です。","基本字间距的设定值可在(-50 ~ 50)范围内。"],defaultCharGapValue2Error:["기본 자간의 설정값은 (-3.0 ~ 3.0) 가능합니다.","Setting value of the Default a character spacing, ( -3.0 ~ 3.0 ) is possible.","設定可能な基本カーニング値は(-3.0 ~ 3.0)です。","基本字间距的设定值可在(-3.0 ~ 3.0)范围内。"],charRatioError:["자평의 설정값이 올바르지 않습니다.","Setting value of the Character Ratio is not correct.","設定した字送り値が正しくありません。","字符比率的设定值不正确。"],charRatioValueError:["자평의 설정값은 (50 ~ 200) 가능합니다.","Setting value of the Character ratio , ( 50-200 ) is possible.","設定可能な字送り値は(50 ~ 200)です。","字符比率的设定值可在(50 ~ 200)范围内。"],bottomMarginError:["여백 적용비율의 설정값이 올바르지 않습니다.","The setting value of the margin application rate is incorrect.","余白の適用率の設定値が正しくありません。","保证金的应用率的设定值是不正确的。"],bottomMarginValueError:["여백 적용비율의 설정값은 (1 ~ 100) 가능합니다.","The setting value of the margin application rate can be (1 to 100).","余白の適用率の設定値は、（1〜100）が可能です。","余量的施用率的设定值，就可以（1至100）。"],splitTextLine:["문자열을 여러 줄로 나누어 표현","Split a multi-line text into lines","文字列を複数行に分けて表示","分多行显示字符串"],processAsUnicode:["유니코드로 문자열을 처리","A text is encoded in Unicode format","文字列をユニコードとして処理","用字符编码处理字符串"],processEqualAlign:["균등분할 정렬 처리","Convert an equal alignment into","均等割付の整列指定","均等拆分排列"],soLeft:["왼쪽 정렬","Left","左揃え","靠左排列"],soCenter:["가운데 정렬","Center","中央揃え","居中排列"],soRight:["오른쪽 정렬","Right","右揃え","靠右排列"],soBoth:["양쪽 정렬","Both","両端揃え","两边对齐"],insertTableWrapper:["표를 감싸는 객체 삽입","Whether or not to insert an object that wraps around the table","テーブルを包み込むオブジェクトを挿入するかどうか","是否要插入的对象环绕表"],tableWrapperBottomGap:["표를 감싸는 객체의 아래쪽 여백","The bottom margin of an object(a control) including a table","テーブルを囲っているオブジェクト下部の余白","表格周围个体的底部空白"],tableWrapperBottomGapError:["표의 아래쪽 여백 설정값이 올바르지 않습니다.","Setting value of the margin below is not correct.","テーブル下部の余白の設定値が正しくありません。","表格底部空白的设定值不正确。"],tableWrapperBottomGapValueError:["표의 아래쪽 여백 설정값은 (0 ~ 500) 가능합니다.","Setting value of the margin below , (0 ~ 500) is possible.","テーブル下部の余白の設定値は(0 ~ 500)です。","表格底部空白的设定值可在(0~500)范围内。"],pageSplite:["페이지를 분할하여 저장","Save by dividing the page","ページを区切って保存","保存拆分页"],pageSpliteCount:["분할 수","Count","分割数","拆分数"],password:["문서암호","Password","文書パスワード","文件密码"],textToImage:["문자를 이미지로 표현","Text To Image","文字を画像として表示","图像显示文本"],importOriginImage:["원본 이미지 사용","Use Original Image","原画像を使用","使用原图"],pageSpliteCountError:["분할 수의 설정값이 올바르지 않습니다.","Setting value of the Count is not correct.","分割数の設定値が正しくありません。","拆分数的设定值不正确。"],html5page:["페이지 라인 표시","Show page breaks","ページ枠を表示","显示分页符号"],dpiError:["DPI의 설정값이 올바르지 않습니다.","Setting value of the DPI is not correct.","DPIの設定値が正しくありません。","DPI的设定值不正确。"],mergeTable:["이웃한 표 병합","Whether to merge the adjacent table","隣接したテーブルをマージするかどうか","是否合并相邻表"],ignoreLineSpace:["행간 무시","Line spacing ignored","行間無視","行间距忽略"],positionRelTo:["좌표 기준","Coordinate criteria","座標基準","协调标准"],paper:["종이","paper","紙","纸"],paragraph:["문단","paragraph","段落","段落"],fitShapeToText:["도형을 텍스트 크기에 맟춤","fitShapeToText","図形をテキストのサイズにカスタマイズされた","对文本的大小形状定制"],TableRowHeightSort:["표의 행의 높이 설정","TableRowHeightSort","表の行の高さを設定","设置在表中的行的高度"],excelDataNone:["저장안함","None","None","None"],excelDataAtOnce:["한번만","AtOnce","AtOnce","AtOnce"],excelDataRepeatAtEachPage:["페이지마다","RepeatAtEachPage","RepeatAtEachPage","RepeatAtEachPage"],languageInfo:["kr","en","jp","cn"],adobe9Info:["현재 Adobe Reader 9 버전이 설치되어 있습니다.","Version of Adode Reader 9 is installed currently .","現在、Adobe Reader 9がインストールされています。","当前已安装了Adobe Reader 9版本。"],adobe9Info2:["정상적인 인쇄를 사용하기 위해서는 Adode Reader 10 버전 이상을 설치하여야 합니다.","To use the normal printing , you need to install the version Adode Reader 10 and later.","正常に印刷するためには、Adode Reader 10以上をインストールする必要があります。","正常打印必须安装Adobe Reader 10以上的版本。"],adobe9Info3:["현재 사용 중이신 브라우져의 창을 종료 한 후 아래의 사이트를 통하여 설치 하시기 바랍니다.","After the completion of the browser window now gotten use it , please install via the following site .","現在ご利用中のブラウザを閉じた後、下記のサイトからインストールして下さい。","请关闭正在使用的浏览器窗口，通过下方网站安装。"],adobe9Info4:["설치 없이 인쇄를 원하신다면 저장 버튼을 이용하여 파일을 저장 후 인쇄 하실 수 있습니다.","After you save the file by using the Save button if you want to print without installing , you can print .","インストールせずに印刷したい場合は、[保存]をクリックしファイルを保存してから印刷して下さい。","若想不安装，直接打印，可以使用保存按钮保存文件后再打印。"],adobe9Info5:["현재 브라우져에서 Adobe Reader 찾을 수 없습니다.","We were not able to find Adode Reader in the browser now .","現在のブラウザで、Adobe Readerは見つかりません。","用当前的浏览器找不到Adobe Reader。"],exeInfo1:["인쇄에 필요한 프로그램을 찾을 수 없습니다.","I could not find the program you need to print.","印刷に必要なプログラムを見つけることができませんでした。","我找不到你需要打印的程序。"],exeInfo2:["아래에 링크를 통하여 프로그램을 설치하시기 바랍니다.","Please install the program via the link below.","下にリンクを介してプログラムをインストールしてください。","请通过以下链接安装该程序。"],exeInfo3:["설치가 완료되면 다시 인쇄 하실 수 있습니다.","When the installation is complete, you can re-print.","インストールが完了すると、再印刷することができます。","当安装完成后，可以重新打印。"],exeInfo4:["현재 사용중이신 인쇄 프로그램은 업데이트가 필요합니다.","Print program of your current use, the update is required.","現在ご使用の印刷プログラムは、更新が必要になります。","当前的使用的打印程序，则需要进行更新。"],exeViewerInfo1:["EXE 뷰어 프로그램을 찾을 수 없습니다.","EXE viewer program not found.","",""],exeViewerInfo2:["아래에 링크를 통하여 프로그램을 설치하시기 바랍니다.","Please install the program via the link below.","下にリンクを介してプログラムをインストールしてください。","请通过以下链接安装该程序。"],exeViewerInfo3:["설치가 완료되면 EXE뷰어 프로그램을 통하여 리포트를 확인 하실 수 있습니다.","Once the installation is complete, you can view the report through the Exe Viewer program.","",""],exeViewerInfo4:["현재 사용중이신 EXE뷰어 프로그램은 업데이트가 필요합니다.","The EXE viewer program that is currently in use requires an update.","",""],printLimit1:["현재 리포트에 대한 인쇄 페이지 수가 많습니다.","Print number of pages of the current report is large.","現在のレポートの印刷ページ数が多すぎます。","当前报告打印页数多。"],printLimit2:["페이지가 많을 경우 속도 저하의 문제가 될 수 있으므로 PDF 저장 인쇄를 권장하고 있습니다.","If the page is large , because there is that the speed reduction of the problems , PDF save , I recommends printing .","ページが多い場合、速度が低下することがあるためPDF形式で保存、印刷することをお勧めします。","页数过多可能减低速度，建议保存成为PDF文件后打印。"],printSet1:["처음 인쇄를 시작하셨다면 브라우져의 설정이 필요합니다.","If this is the first time you start printing you will need to set the browser .","初めて印刷する場合は、ブラウザの設定が必要です。","首次打印时需要设定浏览器。"],printSet2:["브라우저의 메뉴에 파일 -> 페이지설정 사용하여 여백을 모두 0, 머리글, 바닥글 사용 안 함으로 설정하시고 저장하시면 됩니다.","File to the browser menu - > 0 the margin of using the settings of the page , the header , it is the footer disabled to save .","ブラウザメニューのファイル -> ページ設定で余白を全て「0」にし, 「ヘッダーとフッターを使用しない」に設定してから保存して下さい。","在浏览器菜单中选择文件->页面设定，将空白全部设为0，不使用页眉和页脚，保存即可。"],printSet3:["다음 인쇄 사용시 이 팝업을 원하지 않을 경우 표시 안함","It does not want to appear in the case you do not want pop-up at the next printing use","次回印刷する際、このポップアップ画面の表示を望まない場合は表示しない。","若下次打印时不希望看到此弹出窗口，将不显示。"],pdfPrintLimit1:["현재 사용 중이신 브라우져는 팝업창의 인쇄화면을 제공하고 있습니다.","Currently gotten your browser offers a print screen of the pop-up.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。","目前得到您的浏览器提供的弹出打印屏幕。"],pdfPrintLimit2:["아래의 확인 버튼을 누르시면 팝업 인쇄창을 확인 하실 수 있습니다.","When you press the [OK] button below, you will be able to confirm the pop-up print window.","下の[OK]ボタンを押すと、ポップアップ印刷ウィンドウを確認することができます。","当您按下下面的[确定]按钮，你将能够确认弹出打印窗口。"],pdfPrintLimit3:["현재 사용 중이신 Edge Browser는 팝업창의 인쇄화면을 제공하고 있습니다. 만약 Adobe Reader가 없다면 PDF 파일로 다운로드 됩니다.","Currently gotten your browser offers a print screen of the pop-up. If there is no Adobe Reader, it will be downloaded as a PDF file.","現在ご使用いただいてブラウザはポップアップの印刷画面を提供しています。もしAdobe Readerがない場合は、PDFファイルとしてダウンロードされます。","目前得到您的浏览器提供的弹出打印屏幕。如果没有Adobe Reader的，它会下载一个PDF文件。"],pdfPrintLimit4:["아래의 확인 버튼을 누르시면 확인 하실 수 있습니다.","You can check by pressing the [OK] button below.","下の[OK]ボタンを押すと確認することができます。","您可以检查按下面的[确定]按钮。"]};function mRe_report_language(b){obj_language=new Object();for(var a in window.m_report_language_map){obj_language[a]=window.m_report_language_map[a][b];}return obj_language;}var JSON;if(!JSON){JSON=new Object();}(function(){function d(f){return f<10?"0"+f:f;}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(f){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"Z":null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(f){return this.valueOf();};}var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,h,b,j={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;function a(f){g.lastIndex=0;return g.test(f)?'"'+f.replace(g,function(k){var l=j[k];return typeof l==="string"?l:"\\u"+("0000"+k.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+f+'"';}function e(r,o){var m,l,s,f,p=h,n,q=o[r];if(q&&typeof q==="object"&&typeof q.toJSON==="function"){q=q.toJSON(r);}if(typeof i==="function"){q=i.call(o,r,q);}switch(typeof q){case"string":return a(q);case"number":return isFinite(q)?String(q):"null";case"boolean":case"null":return String(q);case"object":if(!q){return"null";}h+=b;n=[];if(Object.prototype.toString.apply(q)==="[object Array]"){f=q.length;for(m=0;m<f;m+=1){n[m]=e(m,q)||"null";}s=n.length===0?"[]":h?"[\n"+h+n.join(",\n"+h)+"\n"+p+"]":"["+n.join(",")+"]";h=p;return s;}if(i&&typeof i==="object"){f=i.length;for(m=0;m<f;m+=1){if(typeof i[m]==="string"){l=i[m];s=e(l,q);if(s){n.push(a(l)+(h?": ":":")+s);}}}}else{for(l in q){if(Object.prototype.hasOwnProperty.call(q,l)){s=e(l,q);if(s){n.push(a(l)+(h?": ":":")+s);}}}}s=n.length===0?"{}":h?"{\n"+h+n.join(",\n"+h)+"\n"+p+"}":"{"+n.join(",")+"}";h=p;return s;break;default:break;}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(m,k,l){var f;h="";b="";if(typeof l==="number"){for(f=0;f<l;f+=1){b+=" ";}}else{if(typeof l==="string"){b=l;}}i=k;if(k&&typeof k!=="function"&&(typeof k!=="object"||typeof k.length!=="number")){mRe_ReportWebLog("JSON.stringify");}return e("",{"":m});};}if(typeof JSON.parse!=="function"){JSON.parse=function(m,f){var l;function k(q,p){var o,n,r=q[p];if(r&&typeof r==="object"){for(o in r){if(Object.prototype.hasOwnProperty.call(r,o)){n=k(r,o);if(n!==undefined){r[o]=n;}else{delete r[o];}}}}return f.call(q,p,r);}m=String(m);c.lastIndex=0;if(c.test(m)){m=m.replace(c,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4);});}if(/^[\],:{}\s]*$/.test(m.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){l=(new Function("return ("+m+")"))();return typeof f==="function"?k({"":l},""):l;}ReportWebLog("JSON.parse");};}}());var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=Base64._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64;}else{if(isNaN(f)){d=64;}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d);}return a;},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h);}if(d!=64){a=a+String.fromCharCode(f);}}a=Base64._utf8_decode(a);return a;},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d);}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128);}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128);}}}return a;},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++;}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2;}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3;}}}return b;}};Report.prototype.notFoundEXEService=function(d){if(!this.m_isViewer){this.debugMeg("report log :: 설치된 exe Service 찾을 수 없습니다. pc에 설치가 필요합니다.");this.endDebugMeg(false);return;}this.debugMeg("report log :: 설치 안내창을 실행합니다.");this.endDebugMeg(false);this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.targetDiv.appendChild(this.m_popupViewDiv);var b=document.createElement("div");b.className="report_view_box report_Ex_NOTReader";b.style.height="150px";var a=new Array();a.push("<div style='position:absolute;left:13px;right:15px;top:5%;bottom:50px;border:1px solid darkgray'>");a.push("<div style='position:absolute;left:3px;right:3px;top:8%;'><span>");if(d){a.push(this.m_languageMap.exeInfo4);}else{a.push(this.m_languageMap.exeInfo1);}a.push("<br>"+this.m_languageMap.exeInfo2);a.push("</span><br>");var c=null!=this.m_exeLink?this.m_exeLink:("./install/CLIPreportPrintService.exe");a.push("<a style='position:ralative' href='"+c+"' target='blank'>download</a><br>");a.push("<br><span>"+this.m_languageMap.exeInfo3+"</span>");a.push("</div></div>");a.push("<span class='report_view_box'  style='position:absolute;left:20px;top:2%;border:0;'>"+this.m_languageMap.print_info2+"</span>");a.push("<button title='"+this.m_languageMap.ok+"' onclick=\"m_reportHashMap['"+this.m_uid+"'].mRe_closeExeInstallView();return false;\" class='report_view_button' style='position:absolute;bottom:10px;right:15px; height:30px;width:75px;'>"+this.m_languageMap.ok+"</button>");b.innerHTML=a.join("");if(null!=this.m_popupViewDiv){this.m_popupViewDiv.appendChild(b);}this.m_printInfo_view=b;a=null;};Report.prototype.mRe_closeExeInstallView=function(){this.closePrintInfoWindow();this.disabledMenu(false);this.debugMeg("report log :: 설치 안내창을 종료합니다.");this.endDebugMeg(true);};Report.prototype.startEXEPrintResponse=function(a){try{this.debugMeg("report log :: 서비스 응답 >>>"+a);this.endDebugMeg(true);var c=null;if(typeof a==="string"){c=objectCall(ClipStrTrim(a));}else{c=a;}var b=this;window.clearInterval(this.m_exePrintStatus.intervalKey);if(c.result){window.setTimeout(function(){b.exePrintStatusCheck(c.port);},1500);}else{var f=c.serviceCode;this.debugMeg("report log :: exe print service에 문제가 발생하였습니다. 코드번호  >> "+f);this.endDebugMeg(false);if(this.m_isViewer){this.removePrintProgress();if(400==f){this.notFoundEXEService(false);}}mRe_ReportEventHandler(105);}}catch(d){this.m_exePrintStatus.disConnectCount++;this.debugMeg("report log :: 다른 로컬서버가 존재하는것 같습니다.");this.debugMeg("report log :: startEXEPrintResponse function error >> "+d);this.endDebugMeg(false);mRe_ReportEventHandler(104);}};Report.prototype.exePrintStatusCheck=function(f){this.m_exePrintStatus.portNumber=f;var a=this;var d={ClipID:"P02",uid:a.m_uid};var g="option="+JSON.stringify(d);this.debugMeg("report log :: 인쇄가 종료될 때 까지 서비스에 인쇄상태를 요청합니다. >>>"+g);if(window.XDomainRequest){var b=new XDomainRequest();if(b){b.onload=function(){a.exePrintStatusResult(b.responseText);};b.onerror=function(){mRe_ReportEventHandler(105);if(a.m_isViewer){a.removePrintProgress();}};b.open("GET",this.m_exePrintStatus.url+f+"?"+g);b.send();}}else{var e=this.m_exePrintStatus.url+f;var c="POST";if(typeof getExePrintAjaxType!="undefined"){c=getExePrintAjaxType();}$.ajax({type:c,url:e,crossDomain:true,data:g,success:function(h){a.exePrintStatusResult(h);},error:function(h){mRe_ReportEventHandler(105);if(a.m_isViewer){a.removePrintProgress();}}});}this.endDebugMeg(true);};Report.prototype.exePrintStatusResult=function(a){try{var c=null;if(typeof a==="string"){c=objectCall(ClipStrTrim(a));}else{c=a;}this.debugMeg("report log :: 서비스 응답 >>>"+c);var b=this;if(c.endPrint){if(this.m_isViewer){this.removePrintProgress();}if(c.okButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 종료 되었습니다. ");if(this.m_exePrintEvent.ok!=null){this.m_exePrintEvent.ok(c.errorCode);}mRe_ReportEventHandler(106);}else{if(c.cancelButton){this.debugMeg("report log :: 인쇄에 대한 이벤트가 취소 되었습니다. ");if(c.errorCode==2){this.notFoundEXEService(true);}if(this.m_exePrintEvent.cancel!=null){this.m_exePrintEvent.cancel(c.errorCode);}mRe_ReportEventHandler(107);}}this.endDebugMeg(false);}else{if(false==c.endPrint){this.debugMeg("report log :: 인쇄가 아직 진행중 입니다....");window.setTimeout(function(){b.exePrintStatusCheck(b.m_exePrintStatus.portNumber);},1500);}}}catch(d){this.debugMeg("report log :: exePrintStatusResult function error >> "+d);this.endDebugMeg(true);mRe_ReportEventHandler(105);if(this.m_isViewer){this.removePrintProgress();}}};Report.prototype.printEXEDirect=function(){this.debugMeg("<<<<<<<<<<<< 리포트 디버깅 로그를 시작합니다 >>>>>>>>>>>>>>>");this.debugMeg("userAgent Check :: "+agt);this.m_isViewer=false;if(this.m_reportKey!=null){this.checkReportCreate();}else{if(this.userJsp==null){this.newReportCreate(this.servletPath,this.oof);}else{this.newReportCreate(this.userJsp,null);}}};function EFormSocket(){this.eform=null;this.wsPath=null;this.elm_target=null;this.eform_key=null;this.room_key=null;this.isMain=true;this.is_report_show=false;this.webSocket=null;this.stateChangeFunction=null;this.stateWs=0;}EFormSocket.prototype.setStateChange=function(a){this.stateChangeFunction=a;};EFormSocket.prototype.callStateChange=function(b,a){this.stateWs=b;if(this.stateChangeFunction!=undefined){this.stateChangeFunction(a);}};EFormSocket.prototype.main_connect_info=function(a,b,d,c,e){this.isMain=true;this.eform=a;this.wsPath=b;this.eform_key=d;this.room_key=c;this.elm_target=e;};EFormSocket.prototype.sub_connect_info=function(a,b,c,d){this.isMain=false;this.eform=a;this.wsPath=b;this.room_key=c;this.elm_target=d;};EFormSocket.prototype.connect=function(){this.debugMeg("중계 서버 접속 중입니다.");this.elm_target.innerHTML="서버 접속 중입니다.";var b=this;if(this.wsPath=="localhost"){this.webSocket={};mWebSocket=this.webSocket;this.room_key="null";this.webSocket.send=function(c){if(b.isMain){if((window)&&(window.external)&&("MainWebBrowserCtrl_EFormHandleMessage" in window.external)){window.external.MainWebBrowserCtrl_EFormHandleMessage(c);}}else{if((window)&&(window.external)&&("SubWebBrowserCtrl_EFormHandleMessage" in window.external)){window.external.SubWebBrowserCtrl_EFormHandleMessage(c);}}};this.webSocket.close=function(){};window.mirroringWinFormMessage=function(d,e){if(e!=undefined){alert("mirroringWinFormMessage"+d);}var c={};c.data=d;mWebSocket.onmessage(c);};}else{this.webSocket=new WebSocket(this.wsPath);}this.webSocket.onmessage=function(c){b.message(c);};this.webSocket.onerror=function(c){b.onerror(c);};this.webSocket.onopen=function(c){b.onopen(c);};this.webSocket.onclose=function(c){console.log("stateWs::"+b.stateWs);if(b.stateWs!=203){b.onerror(c);}};if(this.wsPath=="localhost"){var a={};a.data=JSON.stringify({cmd:"room-joined",roomkey:"null"});this.webSocket.onmessage(a);}};EFormSocket.prototype.onerror=function(d){this.callStateChange(100,100);var a=this;this.debugMeg("중계서버 error >>"+d);var c=this.getTargetDiv();var b=document.createElement("span");b.innerHTML="중계서버에 장애가 발생했습니다. 잠시후에 재접속해주시기 바랍니다.";var e=document.createElement("button");e.innerHTML="재접속";e.onclick=function(){a.connect();};c.appendChild(b);c.appendChild(document.createElement("br"));c.appendChild(e);this.webSocket.close();};EFormSocket.prototype.onopen=function(e){this.debugMeg("중계서버 open >>"+e);this.callStateChange(200,200);if(this.room_key==""){if(this.isMain){this.createRoom();}else{var b=this;var d=this.getTargetDiv();var c=document.createElement("span");c.innerHTML="연결할 채널을 입력하세요.";var f=document.createElement("input");var g=document.createElement("button");g.innerHTML="연결하기";var a=this.isMain;g.onclick=function(){var h=f.value;b.webSocket.send(JSON.stringify({cmd:"join-room",roomkey:h,isMain:a}));};d.appendChild(c);d.appendChild(document.createElement("br"));d.appendChild(f);d.appendChild(g);}}else{this.createRoom(this.room_key);}};EFormSocket.prototype.createRoom=function(a){if(null!=a){this.webSocket.send(JSON.stringify({cmd:"create-room",id:a}));}else{this.webSocket.send(JSON.stringify({cmd:"create-room",id:""}));}};EFormSocket.prototype.message=function(m){this.debugMeg("중계서버 메시지 >> "+m);var e=this.webSocket;var j=this.eform_key;var i=JSON.parse(m.data);var b=i.cmd;if(b!=null){if(b=="call-event"){if(i.type=="doodle"){this.receiveDoodle(i);}else{if(i.type=="pagemove"){this.receivePageMove(i);}else{if(i.type=="focusctrl"){this.receiveFocusControl(i);}else{if(i.type=="inputbox"){this.receiveInputValue(i);}else{if(i.type=="checkbox"){this.receiveInputCheckbox(i);}else{if(i.type=="radiobox"){this.receiveInputRadiobox(i);}else{if(i.type=="button"){this.receiveInputButton(i);}else{if(i.type=="image"){this.receiveInputImage(i);}else{if(i.type=="sign"){this.receiveInputSign(i);}else{if(i.type=="signPath"){this.receiveInputSignPath(i);}else{if(i.type=="signlock"){this.receiveInputSignLock(i);}else{if(i.type=="screenlock"){this.receiveScreenLock(i);}else{if(i.type=="calendar"){this.receiveInputCalendar(i);}else{if(i.type=="selectbox"){this.receiveInputSelectbox(i);}else{if(i.type=="scroll"&&this.isMain){this.receiveScrollPosition(i);}else{if(i.type=="moveUp"){this.receiveMoveUp();}else{if(i.type=="moveDown"){this.receiveMoveDown();}else{if(i.type=="scrollTo"){this.receiveScrollTo(i);}else{if(i.type=="syncSign"){this.receiveSyncSignView(i);}else{if(i.type=="syncSignHybrid"){this.receiveSyncSignHybridView(i);}else{if(i.type=="hybridSignEvent"){this.receiveHybridSignViewEvent(i);}else{if(i.type=="hyInputFocusCtrl"){this.receiveHybridInputFocusControl(i);}else{if(i.type=="hyInputCallKeyboard"){this.receiveHybridInputCallKeyboard(i);}else{if(i.type=="HybirdClose"){this.receiveHybirdClose(i);}else{if(i.type=="subClose"){var c=this.getTargetDiv();c.innerHTML="";this.eform=resetSubEForm(this.eform);this.is_report_show=false;if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}if(this.eform.m_subReportEvent.closeReportAfter!=null){this.eform.m_subReportEvent.closeReportAfter();}}else{if(i.type=="userData"){if(this.eform.m_socketReportEvent.userData!=null){this.eform.m_socketReportEvent.userData(i.data);}}}}}}}}}}}}}}}}}}}}}}}}}}}}else{if(b=="room-created"){var k=this.isMain;var g=i.roomkey;this.debugMeg("연결됨 룸키 >> "+g);e.send(JSON.stringify({cmd:"join-room",roomkey:g,isMain:k}));}else{if(b=="room-joined"){var g=i.roomkey;this.debugMeg("room에 입장 완료");var c=this.getTargetDiv();if(this.isMain){if(this.room_key==""){c.innerHTML="모바일 화면에서 "+g+"를 입력해주세요.";}else{c.innerHTML="레포트 호출 중입니다.";this.eform.default_view();this.is_report_show=true;}}else{if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}else{c.innerHTML="pc 접속 대기중 입니다. <br/>대기화면... ";}}}else{if(b=="room-notexist"){this.debugMeg("room이 존재하지 않음.");alert("room key가 올바르지 않습니다. 다시입력해주세요.");}else{if(b=="room-enter"){this.callStateChange(300,300);this.debugMeg("sub가 접속. 레포트 호출.");if(this.isMain){this.eform.default_view();this.is_report_show=true;}}else{if(b=="room-empty"){this.callStateChange(200,201);var c=this.getTargetDiv();if(this.isMain){c.innerHTML="모바일 기기로 접속해주시기 바랍니다.";}}else{if(b=="show-report"){this.callStateChange(400,400);if(!this.isMain){var h=i.eformkey;this.eform=resetSubEForm(this.eform);this.eform.m_reportKey=h;if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("show","");}if(this.eform.m_subReportEvent.callReportBefore!=null){this.eform.m_subReportEvent.callReportBefore();}this.eform.default_view();this.is_report_show=true;}}else{if(b=="room-leave"){this.callStateChange(200,202);var g=i.roomkey;var c=null;if(this.isMain){if(null!=this.eform){if(this.eform.m_isEndReport){this.eform.eFormTempSubmitSave();}}c=this.getTargetDiv();if(this.room_key==""){c.innerHTML="모바일 화면에서 "+g+"를 입력해주세요.";return;}else{c.innerHTML="모바일 기기에 연결이 종료 되었습니다. 재접속해주시기 바랍니다.";}}else{c=this.getTargetDiv();if(this.room_key==""){var a=this;var d=document.createElement("span");d.innerHTML="연결할 채널을 입력하세요.";var f=document.createElement("input");var l=document.createElement("button");l.innerHTML="연결하기";var k=this.isMain;l.onclick=function(){var n=f.value;a.webSocket.send(JSON.stringify({cmd:"join-room",roomkey:n,isMain:k}));};c.appendChild(d);c.appendChild(document.createElement("br"));c.appendChild(f);c.appendChild(l);}else{if(typeof ClipHybrid!="undefined"){ClipHybrid.callMirraring("wait","업무처리중입니다. 잠시만 기다려주세요.");}else{c.innerHTML="pc 접속 대기중 입니다. <br/>대기화면... ";}}}}else{if(b=="room-full"){var c=this.getTargetDiv();c.innerHTML="이미 접속되어 있습니다.다시 접속해주시기 바랍니다.";this.webSocket.close();}else{if(b=="room-disconnection"){this.callStateChange(203,203);var c=this.getTargetDiv();c.innerHTML="다른 접속에 의해서 연결이 해제 되었습니다.";this.webSocket.close();}}}}}}}}}}}};EFormSocket.prototype.callSubReport=function(){var a=this.webSocket;var b=this.eform_key;if(null!=this.eform){b=b.replace("'version'","'pageNum':"+this.eform.beforePageIndex+",'version'");}if(this.wsPath=="localhost"){a.send(JSON.stringify({cmd:"show-report",eformkey:b}));}else{a.send(JSON.stringify({cmd:"call-report",eformkey:b}));}};EFormSocket.prototype.closeSubReport=function(){if(null!=this.eform){if(this.eform.m_isEndReport){this.eform.eFormTempSubmitSave();}}var a={cmd:"call-event",type:"subClose"};this.webSocket.send(JSON.stringify(a));};EFormSocket.prototype.sendUserData=function(a){var b={cmd:"call-event",type:"userData",data:a};this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.debugMeg=function(a){this.eform.debugMeg("eform log ::"+a);};EFormSocket.prototype.getTargetDiv=function(){targetDiv=this.elm_target;targetDiv.innerHTML="";return targetDiv;};EFormSocket.prototype.sendDoodlePathDraw=function(b){var a={cmd:"call-event",type:"doodle",event:"draw",data:{id:"",stroke_width:"",stroke:"",stroke_opacity:"",d:""}};a.data.id=b.getAttribute("id");a.data.stroke_width=b.getAttributeNS(null,"stroke-width");a.data.stroke=b.getAttributeNS(null,"stroke");a.data.stroke_opacity=b.getAttributeNS(null,"stroke-opacity");a.data.d=b.getAttributeNS(null,"d");this.webSocket.send(JSON.stringify(a));};EFormSocket.prototype.sendDoodlePathRemove=function(b){var a={cmd:"call-event",type:"doodle",event:"remove",data:{id:""}};a.data.id=b.getAttribute("id");this.webSocket.send(JSON.stringify(a));};EFormSocket.prototype.sendDoodlePathRemoveAll=function(){var a={cmd:"call-event",type:"doodle",event:"removeall",data:{}};this.webSocket.send(JSON.stringify(a));};EFormSocket.prototype.receiveDoodle=function(e){var c=null;var b=document.getElementById(this.eform.m_uid+"doodle");if(null!=b){c=b.firstChild;}if(e.event=="draw"){if(null!=c){var a=this.eform;var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("id",e.data.id);d.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");d.setAttributeNS(null,"stroke-width",e.data.stroke_width);d.setAttributeNS(null,"fill","none");d.setAttributeNS(null,"stroke",e.data.stroke);d.setAttributeNS(null,"stroke-opacity",e.data.stroke_opacity);d.setAttributeNS(null,"d",e.data.d);d.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};d.onmousemove=d.ontouchmove=function(){if(a.eFormDoodleOption.is_eraser&&a.eFormDoodleOption.is_eraser_down){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};c.appendChild(d);}}else{if(e.event=="remove"){if(null!=c){var d=document.getElementById(e.data.id);c.removeChild(d);}}else{if(e.event=="removeall"){if(null!=c){if(0!=c.childNodes.length){while(c.firstChild){c.removeChild(c.firstChild);}}this.eform.eFormDoodleOption.pagePathSave[this.eform.beforePageIndex]=null;}}}}};EFormSocket.prototype.sendPageMove=function(a){var b={cmd:"call-event",type:"pagemove",data:{pageIndex:0}};b.data.pageIndex=a;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receivePageMove=function(b){var a=b.data.pageIndex;if(this.eform.eFormDoodleOption.is_Ds){this.eform.removePalletDoodle();}this.eform.EF_DoodlePageSave();this.eform.m_default_selectPage(a);};EFormSocket.prototype.sendInputValue=function(a,b){var c={cmd:"call-event",type:"inputbox",event:"setValue",data:{ctrlID:"",value:"",isEventBubble:true}};c.data.ctrlID=a.ctrlID;c.data.value=a.getValue();c.data.isEventBubble=b;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveInputValue=function(b){if(b.event=="setValue"){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.m_default_setValue(b.data.value,b.data.isEventBubble,false);}}};EFormSocket.prototype.sendInputCheckbox=function(b,a,c){if(typeof c=="undefined"){c=true;}var d={cmd:"call-event",type:"checkbox",event:a,data:{ctrlID:"",isEventBubble:true}};d.data.ctrlID=b.ctrlID;d.data.isEventBubble=c;this.webSocket.send(JSON.stringify(d));};EFormSocket.prototype.receiveInputCheckbox=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(b.event=="check"){if(null!=a){a.m_default_check(b.data.isEventBubble);}}else{if(b.event=="unCheck"){if(null!=a){a.m_default_unCheck(b.data.isEventBubble);}}}};EFormSocket.prototype.sendInputRadiobox=function(a,b){var c={cmd:"call-event",type:"radiobox",event:"select",data:{ctrlID:"",isEventBubble:true}};c.data.ctrlID=a.ctrlID;c.data.isEventBubble=b;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveInputRadiobox=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.m_default_select(b.data.isEventBubble);}};EFormSocket.prototype.sendInputButton=function(a,b,c){var d={cmd:"call-event",type:"button",event:b,data:{ctrlID:"",value:"",isEventBubble:true}};d.data.ctrlID=a.ctrlID;if(b=="label"){d.data.value=a.getLabel();}else{if(b=="value"){d.data.value=a.getValue();}else{d.data.isEventBubble=c;}}this.webSocket.send(JSON.stringify(d));};EFormSocket.prototype.receiveInputButton=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(b.event=="click"){a.onClick(b.data.isEventBubble);}else{if(b.event=="label"){a.m_default_setLabel(b.data.value);}else{if(b.event=="value"){a.m_default_setValue(b.data.value);}}}}};EFormSocket.prototype.sendInputImage=function(b,e){var h=5000;var g={cmd:"call-event",type:"image",data:{ctrlID:"",value:"",totalCnt:0,index:0}};g.data.ctrlID=b.ctrlID;var a=e.length;if(a==0){g.data.totalCnt=1;g.data.index=0;g.data.value="";this.webSocket.send(JSON.stringify(g));}else{var f=Math.ceil(a/h);g.data.totalCnt=f;for(var c=0;c<f;c++){var d;if((c+1)==f){d=e.substring(c*h);}else{d=e.substring(c*h,(c+1)*h);}g.data.index=c;g.data.value=d;sleep(10);this.webSocket.send(JSON.stringify(g));}}};EFormSocket.prototype.receiveInputImage=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[b.data.index]=b.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==b.data.totalCnt){a.m_default_setValue(a.splitMap.dataList.join(""));a.splitMap=null;}}};EFormSocket.prototype.sendInputSign=function(b,e){var h=5000;var g={cmd:"call-event",type:"sign",data:{ctrlID:"",value:"",totalCnt:0,index:0}};g.data.ctrlID=b.ctrlID;var a=e.length;if(a==0){g.data.totalCnt=1;g.data.index=0;g.data.value="";this.webSocket.send(JSON.stringify(g));}else{var f=Math.ceil(a/h);g.data.totalCnt=f;for(var c=0;c<f;c++){var d;if((c+1)==f){d=e.substring(c*h);}else{d=e.substring(c*h,(c+1)*h);}g.data.index=c;g.data.value=d;sleep(10);this.webSocket.send(JSON.stringify(g));}}};EFormSocket.prototype.receiveInputSign=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(null==a.splitMap){a.splitMap={receiveCount:0,dataList:[]};}a.splitMap.dataList[b.data.index]=b.data.value;a.splitMap.receiveCount++;if(a.splitMap.receiveCount==b.data.totalCnt){a.m_default_setValue(a.splitMap.dataList.join(""));a.splitMap=null;}}};EFormSocket.prototype.sendInputSignPath=function(b,c){var h=5000;var g={cmd:"call-event",type:"signPath",data:{ctrlID:"",value:"",totalCnt:0,index:0}};g.data.ctrlID=b.ctrlID;var a=c.length;if(a==0){g.data.totalCnt=1;g.data.index=0;g.data.value="";this.webSocket.send(JSON.stringify(g));}else{var f=Math.ceil(a/h);g.data.totalCnt=f;for(var e=0;e<f;e++){var d;if((e+1)==f){d=c.substring(e*h);}else{d=c.substring(e*h,(e+1)*h);}g.data.index=e;g.data.value=d;sleep(10);this.webSocket.send(JSON.stringify(g));}}};EFormSocket.prototype.receiveInputSignPath=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(null==a.splitPathMap){a.splitPathMap={receiveCount:0,dataList:[]};}a.splitPathMap.dataList[b.data.index]=b.data.value;a.splitPathMap.receiveCount++;if(a.splitPathMap.receiveCount==b.data.totalCnt){a.controlData.pathString=a.splitPathMap.dataList.join("");a.splitPathMap=null;}}};EFormSocket.prototype.sendInputSignLock=function(a){var b={cmd:"call-event",type:"signlock",event:"lock",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendInputSignUnLock=function(a){var b={cmd:"call-event",type:"signlock",event:"unlock",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveInputSignLock=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.multiViewSignLock(b.event);}};EFormSocket.prototype.sendScreenLock=function(a){var b={cmd:"call-event",type:"screenlock",event:"lock",controlType:a};this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendScreenUnLock=function(){var a={cmd:"call-event",type:"screenlock",event:"unlock",controlType:"none"};this.webSocket.send(JSON.stringify(a));};EFormSocket.prototype.receiveScreenLock=function(a){if(a.event=="lock"){this.eform.createSignBlockScreen(a.controlType);}else{this.eform.removeSignBlockScreen();}};EFormSocket.prototype.sendHybirdClose=function(a){var b={cmd:"call-event",type:"HybirdClose",controlType:a};this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveHybirdClose=function(b){if(is_appControl){if(b.controlType=="key"){ClipHybrid.closeNativeControl(2);}else{ClipHybrid.closeNativeControl(1);}}else{if(b.controlType==="key"){var a={methodName:"CloseVirtualKeyboard"};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}else{}}};EFormSocket.prototype.sendInputCalendar=function(a,e,b,d){var c={cmd:"call-event",type:"calendar",data:{ctrlID:"",yearValue:"",monthValue:"",dayValue:""}};c.data.ctrlID=a.ctrlID;c.data.yearValue=e;c.data.monthValue=b;c.data.dayValue=d;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveInputCalendar=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.m_default_setValue(b.data.yearValue,b.data.monthValue,b.data.dayValue);}};EFormSocket.prototype.sendInputSelectbox=function(a,b,c){var d={cmd:"call-event",type:"selectbox",event:b,data:{ctrlID:"",value:""}};d.data.ctrlID=a.ctrlID;d.data.value=c;this.webSocket.send(JSON.stringify(d));};EFormSocket.prototype.receiveInputSelectbox=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(b.event=="change"){a.m_default_onChange();}else{if(b.event=="value"){a.m_default_setValue(b.data.value);}}}};EFormSocket.prototype.sendScrollPosition=function(a){var b={cmd:"call-event",type:"scroll",data:{ctrlID:"",scrollTop:"",scrollHeight:"",clientHeight:""}};b.data.ctrlID=a.srcElement.id;b.data.scrollTop=a.srcElement.scrollTop;b.data.scrollHeight=a.srcElement.scrollHeight;b.data.clientHeight=a.srcElement.clientHeight;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveScrollPosition=function(e){var c=document.getElementById("scroll_guider"+this.eform.m_uid);if(c!=null){var b=this.eform.paintDiv.scrollHeight;var d=this.eform.paintDiv.offsetTop-this.eform.paintDiv.scrollTop;var a=e.data.clientHeight/e.data.scrollHeight*b;this.scrollTop=e.data.scrollTop/e.data.scrollHeight*b;c.style.height=a+"px";c.style.top=(this.scrollTop+d)+"px";this.eform.setProperty("sub_position",e.data);}};EFormSocket.prototype.sendScrollTo=function(){var c={cmd:"call-event",type:"scrollTo",data:{scrollTop:"",scrollHeight:""}};var b=document.getElementById("scroll_guider"+this.eform.m_uid);var a=b.offsetTop+this.eform.paintDiv.scrollTop;this.debugMeg("this.eform.paintDiv.scrollTop:"+this.eform.paintDiv.scrollTop+":this.eform.paintDiv.offsetTop:"+this.eform.paintDiv.offsetTop);c.data.scrollTop=a-this.eform.paintDiv.offsetTop;c.data.scrollHeight=this.eform.paintDiv.scrollHeight;this.debugMeg("send",c);this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveScrollTo=function(b){this.debugMeg("receiveScrollTo",b);var a=b.data.scrollTop*(this.eform.paintDiv.scrollHeight/b.data.scrollHeight);this.debugMeg("receiveScrollTo",a);this.eform.paintDiv.scrollTop=a;};EFormSocket.prototype.sendMoveUp=function(a){this.debugMeg("sendMoveUp");var b={cmd:"call-event",type:"moveUp"};this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveMoveUp=function(){var a=this.eform.paintDiv.scrollTop-20;this.debugMeg("top",a);this.eform.paintDiv.scrollTop=a;this.debugMeg("top",this.eform.paintDiv.scrollTop);};EFormSocket.prototype.sendMoveDown=function(a){this.debugMeg("sendMoveDown");var b={cmd:"call-event",type:"moveDown"};this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveMoveDown=function(){var a=this.eform.paintDiv.scrollTop+20;this.debugMeg("top",a);this.eform.paintDiv.scrollTop=a;this.debugMeg("top",this.eform.paintDiv.scrollTop);};function sleep(a){var b=new Date().getTime()+(a);while(new Date().getTime()<=b){}}EFormSocket.prototype.sendSyncSignHybridView=function(a){var b={cmd:"call-event",type:"syncSignHybrid",event:"call",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveSyncSignHybridView=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.eFormHybridSignView();}};EFormSocket.prototype.sendSyncSignResize=function(a){var b={cmd:"call-event",type:"syncSign",event:"resize",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendSyncSignView=function(a){var b={cmd:"call-event",type:"syncSign",event:"popView",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendSyncSignCencelButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"cencelButton",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendSyncSignResetButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"resetButton",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendSyncSignOkButton=function(a){var b={cmd:"call-event",type:"syncSign",event:"okButton",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.sendSyncSignData=function(a,b,d){var c={cmd:"call-event",type:"syncSign",event:"signData",data:{ctrlID:"",moveCount:b,signData:d,width:500,height:500}};if(null!=mRe_sign.jSign){canvas=mRe_sign.jSign.context.firstChild.nextElementSibling.nextElementSibling;c.data.width=canvas.width;c.data.height=canvas.height;}c.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveSyncSignView=function(m){var o=this.eform.eFormControlList[m.data.ctrlID];if(null!=o){if(m.event=="popView"){o.eFormSyncView();}else{if(m.event=="cencelButton"){o.eFormSyncSignCencelButton();}else{if(m.event=="resetButton"){o.eFormSyncSignResetButton();}else{if(m.event=="okButton"){o.eFormSyncSignOkButton();}else{if(m.event=="signData"){o.controlData.po.move_count+=m.data.moveCount;mRe_sign.move_count+=m.data.moveCount;var v=m.data.signData.split(":");var e=null;if(null!=mRe_sign.jSign){e=mRe_sign.jSign.context.firstChild.nextElementSibling.nextElementSibling;var f=e.width/m.data.width;var h=e.height/m.data.height;var l,j;var k=e.getContext("2d");for(var q=0;q<v.length;q++){var p=v[q];if(p=="D"){l=v[++q]*f;j=v[++q]*h;var n=v[++q]*f;canvasBasicDot(k,l,j,n);}else{if(p=="L"){if(q==0){continue;}var b=v[++q]*f;var a=v[++q]*h;canvasBasicLine(k,l,j,b,a);l=b;j=a;}else{if(p=="C"){var b=v[++q]*f;var a=v[++q]*h;var t=v[++q]*f;var s=v[++q]*h;var d=v[++q]*f;var c=v[++q]*h;canvasBasicCurve(k,l,j,b,a,t,s,d,c);l=b;j=a;}}}}}}else{if(m.event=="resize"){var g=mRe_sign.eform;var u=mRe_sign.jSign.jSignature("getData").split("base64,")[1];var r=mRe_sign.move_count;g.eFormSyncSignCencelButton();mRe_sign={image:null,move_count:0};mRe_sign.move_count=r;mRe_sign.image=u;if(g.isSyncSignView){g.eFormSyncSignControl();}else{g.eFormSignControl();}}}}}}}}};EFormSocket.prototype.sendHybridSignViewEvent=function(a,b){var c={cmd:"call-event",type:"hybridSignEvent",event:b,data:{ctrlID:""}};c.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveHybridSignViewEvent=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(b.event=="ok"){a.onOkButton();}else{a.onCencelButton();}}};EFormSocket.prototype.sendHybridInputFocusControl=function(a){var b={cmd:"call-event",type:"hyInputFocusCtrl",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveHybridInputFocusControl=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.createSubCallKeyboardButton();}};EFormSocket.prototype.sendHybridInputCallKeyboard=function(a){var b={cmd:"call-event",type:"hyInputCallKeyboard",data:{ctrlID:""}};b.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(b));};EFormSocket.prototype.receiveHybridInputCallKeyboard=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){a.callHybridInput();}};EFormSocket.prototype.sendFocusControl=function(a,b){var c={cmd:"call-event",type:"focusctrl",event:b,data:{ctrlID:""}};c.data.ctrlID=a.ctrlID;this.webSocket.send(JSON.stringify(c));};EFormSocket.prototype.receiveFocusControl=function(b){var a=this.eform.eFormControlList[b.data.ctrlID];if(null!=a){if(b.event=="in"){a.multiViewFocus();}else{a.multiViewBlur();}}};var canvasBasicDot=function(b,a,e,d){var c=b.fillStyle;b.fillStyle=b.strokeStyle;b.fillRect(a-d/2,e-d/2,d,d);b.fillStyle=c;},canvasBasicLine=function(b,c,a,e,d){b.beginPath();b.moveTo(c,a);b.lineTo(e,d);b.stroke();},canvasBasicCurve=function(i,b,a,f,e,d,c,h,g){i.beginPath();i.moveTo(b,a);i.bezierCurveTo(d,c,h,g,f,e);i.stroke();};var mRe_FocusControl={objCtrl:null};function creatMainEForm(c,b,d,f,e){if(null==e){mRe_ReportEventHandler(20);}var a=new Report(c,null,null,null,e);a.is_eForm=true;a.m_reportKey=f;eform_init(a);a.multiView.isSocket=true;a.multiView.socket=new EFormSocket();a.multiView.socket.main_connect_info(a,b,f,d,e);return a;}function creatSubEForm(c,b,d,e){if(null==e){mRe_ReportEventHandler(20);}var a=new Report(c,null,null,null,e);a.is_eForm=true;eform_init(a);a.m_isDefaultDoodleVisble=true;a.multiView.isSocket=true;a.multiView.socket=new EFormSocket();a.multiView.socket.sub_connect_info(a,b,d,e);return a;}function resetSubEForm(a){a.is_eFormData=false;a.beforePageIndex=1;var b=a.eForm_isNecessary.is_start;a.eForm_isNecessary={pageList:null,check:false,is_start:b};a.eFormData=null;a.eFormCheckImage=null;a.eFormRadioImage=null;a.eFormControlList=null;a.eFormControlGroupList=null;a.eFormDoodleOption={is_Ds:false,is_eraser:false,is_eraser_down:false,is_move:false,zoomIn:1,tos:null,path:null,pathArray:null,gesture:{isStart:false,pos:null,zoom:1,line:0,zoomUp:1},pens:{width:16,color:"rgb(237, 68, 61)",op:0.5},tempPens:{width:16,color:"rgb(237, 68, 61)",op:0.5,penList:[],opList:[],colorList:[]},pagePathSave:[],pageImgSave:[]};a.swipeOption.is_start=false;a.swipeOption.s_x=0;a.swipeOption.s_y=0;a.swipeOption.e_x=0;a.swipeOption.e_y=0;a.tripleEvent.x=0;a.tripleEvent.y=0;a.tripleEvent.cnt=0;a.eFormRadioChecked={};a.eFormCheckboxChecked={};a.m_nextPageSave={poNum:-1,strPageData:null};a.m_properties=function(){};a.m_isThumbnail=false;a.m_isSplitView=false;a.m_splitView={pos:null,arr:null,zoomRate:null,stopPos:{x:0,y:0},isStopButton:false,isMoveButton:true,leftButton:null,centerButton:null,rightButton:null,isQuick:false,time:5000,pageInfo:[],event:null,inputOrder:null};a.m_eformPageDisabled=[];return a;}function createEForm(b,c,d){if(null==d){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,c,d);a.is_eForm=true;eform_init(a);return a;}function createJSPEForm(c,d,b,e){if(null==e){mRe_ReportEventHandler(20);}var a=new Report(c,d,b,null,e);a.is_eForm=true;eform_init(a);return a;}function createImportJSPEForm(b,d,c){if(null==c){mRe_ReportEventHandler(20);}var a=new Report(b,null,null,null,c);a.is_eForm=true;a.m_reportKey=d;eform_init(a);return a;}function eform_init(a){a.tocOption={nec:[false,false,false],viewPN:[{visible:false,startCh:"",endCh:""},{visible:false,startCh:"",endCh:""},{visible:false,startCh:"",endCh:""}]};a.swipeOption={isDisabled:true,is_start:false,s_x:0,s_y:0,e_x:0,e_y:0};a.tripleEvent={isDisabled:false,x:0,y:0,cnt:0};a.m_eformDisabled=false;a.m_eformPageDisabled=[];a.m_isEFormPageMoveEvent=null;a.eFormRadioChecked={};a.eFormCheckboxChecked={};a.m_twoTouchEvtDisabled=false;a.m_signMoveCount=9;a.m_isPreviewImg=false;a.m_nextPageSave={poNum:-1,strPageData:null};a.m_isDefaultDoodleVisble=false;a.multiView={isSocket:false,socekt:null};a.m_isMultiViewFoucs=false;a.m_properties=function(){};a.m_isThumbnail=false;a.m_isInputFocus=false;a.m_focusInputDOM=null;a.m_isSplitView=false;a.m_splitView={pos:null,arr:null,zoomRate:null,stopPos:{x:0,y:0},isStopButton:false,isMoveButton:true,leftButton:null,centerButton:null,rightButton:null,isQuick:false,time:5000,pageInfo:[],event:null,inputOrder:null};a.m_subReportEvent={callReportBefore:null,closeReportAfter:null};a.m_socketReportEvent={userData:null,socketStatusEvnet:null};a.m_isPopupSelect=false;a.m_isHybridQuickControl=false;a.m_nQuickControlMobileZoom=null;a.m_nHybridTempZoom=null;a.m_HybridQuickControlEvent=null;a.m_isGuiderLineDisplay=true;a.m_SubInputCallButtonText="사용자입력";a.m_isHybridQuickControlZoom=false;}Report.prototype.pageScrollEFormEvent=function(b){if(this.m_isInputFocus&&!is_smartphone){if(null!=this.m_focusInputDOM&&!this.m_isHybridQuickControlZoom){this.m_focusInputDOM.blur();}this.m_isHybridQuickControlZoom=false;}if(this.multiView.isSocket){if(!this.multiView.socket.isMain){this.multiView.socket.sendScrollPosition(b);}else{var a=document.getElementById("scroll_guider"+this.m_uid);if(a!=null){var d=this.multiView.socket.scrollTop;var c=this.paintDiv.offsetTop-this.paintDiv.scrollTop;a.style.top=(d+c)+"px";}}}};Report.prototype.createEFormView=function(){if(this.m_isSplitView){var b=this.m_splitView.leftButton=document.createElement("button");var i=this.m_splitView.centerButton=document.createElement("button");var h=this.m_splitView.rightButton=document.createElement("button");b.className="eform_slide_button eform_slide_button_left";i.className="eform_slide_button eform_slide_button_center";h.className="eform_slide_button eform_slide_button_right";var d=this;if(this.m_splitView.isQuick){var g=this.m_splitView.inputOrder;b.onclick=function(){d.focusSplitViewQuickInputOrder(g);};i.onclick=function(){d.changeRatioCombo("PageWidth");};h.onclick=function(){d.focusSplitViewQuickInputOrder(g);};}else{i.className="eform_slide_button eform_slide_button_stop";b.onclick=function(){i.className="eform_slide_button eform_slide_button_play";d.prevSplitView();};i.onclick=function(){i.className="eform_slide_button eform_slide_button_stop";d.stopSplitView();};h.onclick=function(){i.className="eform_slide_button eform_slide_button_play";d.nextSplitView();};}this.targetDiv.firstChild.appendChild(b);this.targetDiv.firstChild.appendChild(i);this.targetDiv.firstChild.appendChild(h);}var e=document.getElementById("scroll_guider_selector"+this.m_uid);if(e!=null){var f=document.getElementById("scroll_guider"+this.m_uid);var a=this.paintDiv.offsetTop;var c=this;e.addEventListener("mousedown",function(j){e.downFlag=0;e.moveFlag=0;console.log("sg_selector:mousedown:event:",j);e.event=j;},false);e.addEventListener("mousemove",function(l){e.moveFlag=1;if(e.downFlag==0){var k=l.movementY;k=l.clientY-e.event.clientY;e.event=l;c.debugMeg("sg_selector.event:event.clientY:",l);if(f!=null){var j=parseInt(f.style.top,10);if(j+k>=a){f.style.top=(j+k)+"px";}else{f.style.top=a+"px";}}else{c.debugMeg("guider null!!");}}},false);e.addEventListener("mouseup",function(j){c.debugMeg("sg_selector:mouseup:event:",j);if(e.moveFlag===0){e.downFlag=1;c.debugMeg("click");}else{if(e.moveFlag===1&&e.downFlag==0){c.debugMeg("drag");e.downFlag=1;c.multiView.socket.sendScrollTo();}}},false);e.addEventListener("mouseleave",function(j){if(e.moveFlag===0){e.downFlag=1;c.debugMeg("click");}else{if(e.moveFlag===1&&e.downFlag==0){c.debugMeg("drag");e.downFlag=1;c.multiView.socket.sendScrollTo();}}},false);}else{this.debugMeg("sg_selector null!!!");}};Report.prototype.eformCreateTag=function(c,b){var a=is_smartphone?"m_":"";c.push("<div id='re_paintDiv"+b+"' name='CLIP_REPORT_DIV' class='"+a+"eform_paint_div' style='"+((this.m_isMenu)?"":"top:0px;")+(null!=this.paintDiv?this.paintDiv:"")+"' onscroll=\"m_reportHashMap['"+b+"'].pageScrollEvent(event)\" ");if(is_firefox){c.push("onwheel=\"m_reportHashMap['"+b+"'].pageMousewheelEvent(event)\">");}else{c.push("onmousewheel=\"m_reportHashMap['"+b+"'].pageMousewheelEvent(event)\">");}c.push("</div>");if(this.multiView.isSocket){if(this.multiView.socket.isMain){var d="";if(!this.m_isGuiderLineDisplay){d="display:none;";}c.push("<div id='scroll_guider"+b+"' style='position:absolute;left:2px;right:18px;top:0px;height: 0px; border:2px solid gold;overflow:hidden;pointer-events: none;margin:0 auto;z-index:130;"+d+"'>");c.push("<div id='scroll_guider_selector"+b+"' style='width:2%;height:100%;background:gold;pointer-events: auto;'></div>");c.push("</div>");}}c.push("<div id='re_menu"+b+"' class='"+a+"eform_menu_div' style='"+((this.m_isMenu)?"":"height:0px;")+(null!=this.menuDiv?this.menuDiv:"")+";z-index:125;'>");c.push("<table class='report_menu_table' vertical-align='middle'><tr><td class='report_menu_table_td'>");c.push("<div class='"+a+"eform_menu_table_td_div'><nobr>");if(this.m_isSplitView){c.push("<button id='re_setting"+b+"' onclick=\"m_reportHashMap['"+b+"'].m_splitViewSetting();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.setting?a+"eform_menu_dis_setting_button":a+"eform_menu_setting_button")+"' style='"+(null!=this.setting_button?this.setting_button:"")+"' "+(this.m_disControl.setting?"disabled":"")+"></button>");}c.push("<button title='"+this.m_languageMap.first_page+"' id='re_first"+b+"' onclick=\"m_reportHashMap['"+b+"'].firstPage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.first?a+"eform_menu_dis_leftEnd_button":a+"eform_menu_leftEnd_button")+"' style='"+(null!=this.first_button?this.first_button:"")+"' "+(this.m_disControl.first?"disabled":"")+"></button>");c.push("<button title='"+this.m_languageMap.prv_page+"' id='re_prev"+b+"' onclick=\"m_reportHashMap['"+b+"'].previousPage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.prev?a+"eform_menu_dis_left_button":a+"eform_menu_left_button")+"' style='"+(null!=this.prev_button?this.prev_button:"")+"' "+(this.m_disControl.prev?"disabled":"")+"></button>");c.push("<table class='"+a+"eform_input_table' vertical-align='middle'>");c.push("<tr>");c.push("<td class='"+a+"eform_input_table_td_input'>");c.push("<input title='"+this.m_languageMap.page+"' id='re_input"+b+"' type='text' value='1' class='"+a+"eform_menu_pageCount_input' onkeypress=\"enterEvent(event, m_reportHashMap['"+b+"'], this)\" onblur=\"m_reportHashMap['"+b+"'].selectPage(Number(this.value) - 1)\" style='border:0px none !important;"+(null!=this.input?this.input:"")+"' "+(this.m_disControl.input?"disabled":"")+"/>");c.push("</td>");c.push("<td class='"+a+"eform_input_table_td' ");c.push("onclick=\"m_reportHashMap['"+b+"'].mRe_pageCountLabelClick();return false;\"");c.push(">");c.push("<input title='"+this.m_languageMap.total_page+"'  id='re_totalCountNumber"+b+"' value='/&nbsp;0' class='"+a+"eform_menu_pageCount_span' style='"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' readonly></input><span id='re_totalCount"+b+"' class='"+a+"eform_menu_pageCount_span' style='border:0px none !important;"+(null!=this.totalCountSpan?this.totalCountSpan:"")+"' "+(this.m_disControl.caption?"disabled":""));c.push("/>");c.push("<img alt='전자서식 생성중 표시' id='re_progressImg"+b+"' class='report_menu_progress' src='"+progressImg()+"'/></span>");c.push("</td>");c.push("</tr></table>");c.push("<button title='"+this.m_languageMap.next_page+"'  id='re_next"+b+"' onclick=\"m_reportHashMap['"+b+"'].nextPage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.next?a+"eform_menu_dis_right_button":a+"eform_menu_right_button")+"' style='"+(null!=this.next_button?this.next_button:"")+"' "+(this.m_disControl.next?"disabled":"")+"></button>");c.push("<button  title='"+this.m_languageMap.last_page+"'  id='re_last"+b+"' onclick=\"m_reportHashMap['"+b+"'].lastPage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.last?a+"eform_menu_dis_rightEnd_button":a+"eform_menu_rightEnd_button")+"' style='"+(null!=this.last_button?this.last_button:"")+"' "+(this.m_disControl.last?"disabled":"")+"></button>");c.push("<select title='"+this.m_languageMap.zoomIn+"'  onChange=\"m_reportHashMap['"+b+"'].zoomIn(this)\" name='zoomSelect' id='re_zoomSelect"+b+"' class='"+a+"eform_menu_zoom_combo'  style='"+(null!=this.zoomCombo?this.zoomCombo:"")+"' ");c.push(true==this.m_disControl.zoomIn?"disabled":"");c.push(">");this.comboOptionCreateTag(c);c.push("</select>");if(!is_smartphone){c.push("<button title='"+this.m_languageMap.print+"' id='re_print"+b+"' onclick=\"m_reportHashMap['"+b+"'].EFormPrint();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.save?a+"eform_menu_dis_print_button":a+"eform_menu_print_button")+"' style='"+(null!=this.print_button?this.print_button:"")+"' "+(this.m_disControl.print?"disabled":"")+"></button>");}if(!is_window_safari){c.push("<button title='"+this.m_languageMap.doodle+"'  id='re_doodle"+b+"' onclick=\"m_reportHashMap['"+b+"'].EFormDoodle();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.doodle?a+"eform_menu_dis_doodle_button":a+"eform_menu_doodle_button")+"' style='"+(null!=this.doodle_button?this.doodle_button:"")+"' "+(this.m_disControl.doodle?"disabled":"")+"></button>");}c.push("<button  title='"+this.m_languageMap.save+"'  id='re_save"+b+"' onclick=\"m_reportHashMap['"+b+"'].EFormSave();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.save?a+"eform_menu_dis_save_button":a+"eform_menu_save_button")+"' style='"+(null!=this.save_button?this.save_button:"")+"' "+(this.m_disControl.save?"disabled":"")+"></button>");c.push("<button title='"+this.m_languageMap.close+"'  id='re_close"+b+"' onclick=\"m_reportHashMap['"+b+"'].closeReport();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.close?a+"eform_menu_dis_close_button":a+"eform_menu_close_button")+"' style='"+(null!=this.close_button?this.close_button:"")+"' "+(this.m_disControl.close?"disabled":"")+"></button>");c.push("</nobr></div>");c.push("</td></tr></table>");c.push("<table id='re_doodleDiv"+b+"' class='report_menu_table' vertical-align='middle' style='display:none;'><tr><td class='report_menu_table_td'>");c.push("<div class='"+a+"eform_menu_table_td_div'><nobr>");c.push("<button id='re_doodleprev"+b+"' onclick=\"m_reportHashMap['"+b+"'].previousDoodlePage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.prev?a+"eform_menu_dis_left_button":a+"eform_menu_doodleleft_button")+"' style='"+(null!=this.prev_button?this.prev_button:"")+"' "+(this.m_disControl.prev?"disabled":"")+"></button>");c.push("<table class='"+a+"eform_doodle_pageinfo_table' vertical-align='middle' ");c.push(">");c.push("<tr>");c.push("<td id='re_doodle_pageinfo"+b+"' ");c.push("onclick=\"m_reportHashMap['"+b+"'].mRe_pageCountLabelClick();return false;\"");c.push(">");c.push("</td></tr></table>");c.push("<button id='re_doodlenext"+b+"' onclick=\"m_reportHashMap['"+b+"'].nextDoodlePage();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.next?a+"eform_menu_dis_right_button":a+"eform_menu_doodleright_button")+"' style='"+(null!=this.next_button?this.next_button:"")+"' "+(this.m_disControl.next?"disabled":"")+"></button>");c.push("<button id='re_doodlepen"+b+"' onclick=\"m_reportHashMap['"+b+"'].penDoodle();return false;\" class='"+a+"eform_menu_button "+a+"eform_menu_doodlePen_button'></button>");c.push("<button id='re_doodlepallet"+b+"' onclick=\"m_reportHashMap['"+b+"'].palletDoodle();return false;\" class='"+a+"eform_menu_button "+a+"eform_menu_doodlePallet_button'></button>");c.push("<button id='re_doodleeraser"+b+"' onclick=\"m_reportHashMap['"+b+"'].eraserDoodle();return false;\" class='"+a+"eform_menu_button "+a+"eform_menu_doodleEraser_button'></button>");c.push("<button id='re_doodleeraserall"+b+"' onclick=\"m_reportHashMap['"+b+"'].eraserAllDoodle();return false;\" class='"+a+"eform_menu_button "+a+"eform_menu_doodleEraserAll_button'></button>");if(is_smartphone){c.push("<button id='re_doodlemove"+b+"' onclick=\"m_reportHashMap['"+b+"'].moveDoodle();return false;\" class='"+a+"eform_menu_button "+a+"eform_menu_doodleMove_button'></button>");}c.push("<button id='re_doodleclose"+b+"' onclick=\"m_reportHashMap['"+b+"'].closeDoodle();return false;\" class='"+a+"eform_menu_button "+(this.m_disControl.close?a+"eform_menu_dis_doodleClose_button":a+"eform_menu_doodleClose_button")+"' style='"+(null!=this.doodle_close_button?this.doodle_close_button:"")+"' "+(this.m_disControl.close?"disabled":"")+"></button>");c.push("</nobr></div>");c.push("</td></tr></table>");c.push("</div>");};Report.prototype.getEFormSaveData=function(a){a=null==a?true:a;this.EF_DoodlePageSave();var b={uid:null,data:null,doodleInfo:null};b.uid=this.m_uid;b.data=this.eFormData;b.doodleInfo=this.eFormDoodleOption.pagePathSave;if(a){return Base64.encode(JSON.stringify(b));}return JSON.stringify(b);};Report.prototype.getEFormTemporaryData=function(a){a=null==a?true:a;this.EF_DoodlePageSave();var b={doodleInfo:null,data:null};b.doodleInfo=this.eFormDoodleOption.pagePathSave;b.data=this.eFormData;if(a){return Base64.encode(JSON.stringify(b));}return JSON.stringify(b);};Report.prototype.setEFormTemporaryData=function(c,a){a=null==a?true:a;var b=null;if(a){var b=Base64.decode(c);}else{var b=c;}if(null!=b){var d=JSON.parse(b);if(null!=d){this.eFormTempData=d;d=null;}}};Report.prototype.setEFormAppendData=function(d,a){a=null==a?true:a;var b=null;if(a){var b=Base64.decode(d);}else{var b=d;}if(null!=b){var c=JSON.parse(b);if(null!=c){this.eFormAppendData=c;c=null;}}};Report.prototype.validationEFormData=function(b){for(var a in b){if(null==this.eFormTempData.data[a]){this.eFormData=b;this.debugMeg("report log :: 임시저장의 데이터가 리포트폼과 맞지 않습니다.");return;}}this.eFormData=this.eFormTempData.data;this.eFormDoodleOption.pagePathSave=this.eFormTempData.doodleInfo;this.eFormTempData=null;};Report.prototype.appendEFormData=function(){if(null!=this.eFormAppendData){for(var b in this.eFormData){var c=this.eFormAppendData.data[b];if(null!=c){var a=this.eFormData[b].pageNumber;c.pageNumber=a;this.eFormData[b]=c;}}this.eFormAppendData=null;}};Report.prototype.updateEFormControl=function(e){for(var b in this.eFormControlList){var d=this.eFormControlList[b];var c=e.eFormControlList[b];if(null==d||null==c){continue;}var a=c.controlData;if(a.type=="sign"||a.type=="signGroup"||a.type=="image"){d.setValue(c.getValue());}else{if(a.type=="input"){d.setValue(c.getValue(),false);}else{if(a.type=="checkbox"){if(a.checked=="true"){d.check(false);}else{d.unCheck(false);}}else{if(a.type=="radiobox"){if(a.checked=="true"){d.select(false);}}else{if(a.type=="calendar"){d.setValue(a.yearValue,a.monthValue,a.dayValue);}else{if(a.type=="selectbox"){if(JSON.stringify(d.controlData.options)==JSON.stringify(a.options)){d.setValue(c.getValue());}else{d.controlData.value=a.value;d.setOptions(a.options);}}else{if(a.type=="button"){d.setValue(c.getValue());d.setLabel(c.getLabel());}}}}}}}}};Report.prototype.getEFormData=function(){var c=new Object();for(var b in this.eFormControlList){var d=this.eFormControlList[b];var a=d.controlData;if(c[a.id]==null){c[a.id]={data:new Array()};}if(a.type=="sign"||a.type=="signGroup"||a.type=="image"){c[a.id].data.push(a.image);}else{if(a.type=="input"){c[a.id].data.push(a.value);}else{if(a.type=="checkbox"||a.type=="radiobox"){if(a.checked=="true"){c[a.id].data.push(a.value);}}else{if(a.type=="calendar"){c[a.id].data.push(d.getValue());}else{if(a.type=="selectbox"){c[a.id].data.push(a.value);}else{if(a.type=="button"){c[a.id].data.push(a.value);}}}}}}}return c;};Report.prototype.EFormPrint=function(){if(this.m_isEndReport){this.eForm_isNecessary.check=false;if(this.RequiredCheckControl()){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}this.eFormSubmitSave("print");this.printWindowView();}}};Report.prototype.EFormSave=function(){if(this.m_isEndReport){this.eForm_isNecessary.check=false;if(this.RequiredCheckControl()){if(this.eForm_isNecessary.is_start){this.eForm_isNecessary.check=true;}if(this.m_buttonEvent.startSaveButton!=null){var a=this.m_buttonEvent.startSaveButton();if(a!=true){return;}}this.eFormSubmitSave("save");}}else{mRe_ReportEventHandler(10);}};Report.prototype.eformDoodlePosition=function(b,c,a,g){var f={x:0,y:0};var h=null;if(b==0){if(is_android&&!is_samsung_browser){h=$(c).offsetCustom();}else{h=$(c).offset();}this.eFormDoodleOption.tos=h;}else{h=this.eFormDoodleOption.tos;}var d=this.eFormDoodleOption.zoomIn;var i=g?a:a.touches[0];if(is_smartphone){if(is_PosiFix){f.x=((h.left*-1*d)+i.clientX)/d;f.y=((h.top*-1*d)+i.clientY)/d;}else{f.x=((h.left*-1*d)+i.pageX)/d;f.y=((h.top*-1*d)+i.pageY)/d;}}else{var e=d;if(is_edge||is_firefox||is_ie){e=1;}if(is_PosiFix){f.x=((h.left*-1*e)+i.clientX)/d;f.y=((h.top*-1*e)+i.clientY)/d;}else{f.x=((h.left*-1*e)+i.pageX)/d;f.y=((h.top*-1*e)+i.pageY)/d;}}return f;};Report.prototype.setCloseDoodleButtonEvent=function(a){this.m_buttonEvent.closeDoodleButton=a;};Report.prototype.closeDoodle=function(){this.removePalletDoodle();if(null!=this.m_buttonEvent.closeDoodleButton){try{this.m_buttonEvent.closeDoodleButton();}catch(b){mRe_ReportWebLog(b.message);}}this.EF_DoodlePageSave();this.eFormDoodleOption.is_Ds=false;this.doodleDiv.previousSibling.style.display="";this.doodleDiv.style.display="none";var a=document.getElementById(this.m_uid+"doodle");a.style.zIndex=this.getProperty("doodleZIndex");};Report.prototype.previousDoodlePage=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.debugMeg("report log :: 이전 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){this.selectPage((this.beforePageIndex-1));}};Report.prototype.nextDoodlePage=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.debugMeg("report log :: 다음 페이지로 이동 합니다.",true);if(this.m_isButtonLock==false){this.selectPage((this.beforePageIndex+1));}};Report.prototype.setIsPreviewImg=function(a){this.m_isPreviewImg=a;};Report.prototype.setSignMoveCount=function(a){this.m_signMoveCount=a;};Report.prototype.setSelectBoxPopupView=function(a){this.m_isPopupSelect=a;};Report.prototype.setSubInputCallButtonText=function(a){this.m_SubInputCallButtonText=a;};Report.prototype.pageMove=function(a){if(isNaN(a)||!this.m_isEndReport){return;}a--;if(a<0||this.m_pageCount<=a||this.beforePageIndex==a){return;}if(this.eFormDoodleOption.is_Ds){this.removePalletDoodle();}this.selectPage(a);};Report.prototype.EF_DoodlePageSave=function(){var a=document.getElementById(this.m_uid+"doodle");if(null!=a){var c=a.firstChild;var f=c.childNodes.length;var h=new Array();var b=0;for(var d=0;d<f;d++){var g=c.childNodes[d];var e=g.getAttribute("eraser");if(null==e){h[b]=new Object();h[b].id=g.getAttribute("id");h[b].stroke_width=g.getAttributeNS(null,"stroke-width");h[b].stroke=g.getAttributeNS(null,"stroke");h[b].stroke_opacity=g.getAttributeNS(null,"stroke-opacity");h[b].d=g.getAttributeNS(null,"d");b++;}}this.eFormDoodleOption.pagePathSave[this.beforePageIndex]=h;}};Report.prototype.EF_setPathPage=function(){var b=document.getElementById(this.m_uid+"doodle");var c=b.firstChild;if(0==c.childNodes.length){var a=this;var g=this.eFormDoodleOption.pagePathSave[this.beforePageIndex];if(null!=g){var e=g.length;for(var d=0;d<e;d++){var f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("id",g[d].id);f.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");f.setAttributeNS(null,"stroke-width",g[d].stroke_width);f.setAttributeNS(null,"fill","none");f.setAttributeNS(null,"stroke",g[d].stroke);f.setAttributeNS(null,"stroke-opacity",g[d].stroke_opacity);f.setAttributeNS(null,"d",g[d].d);f.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};f.onmousemove=f.ontouchmove=function(){if(a.eFormDoodleOption.is_eraser&&a.eFormDoodleOption.is_eraser_down){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};c.appendChild(f);}}}};Report.prototype.EFormDoodle=function(){this.eFormDoodleOption.is_Ds=true;var f=this.beforePageIndex;var e=document.getElementById("re_doodle_pageinfo"+this.m_uid);if(null!=e){e.innerHTML=(f+1)+this.m_TPC.before+this.m_pageCount+this.m_TPC.after;}this.doodleDiv.previousSibling.style.display="none";this.doodleDiv.style.display="";if(this.eFormDoodleOption.is_eraser){this.eraserDoodle();}else{this.penDoodle();}var b=document.getElementById(this.m_uid+"doodle");this.setProperty("doodleZIndex",b.style.zIndex);b.style.zIndex="300";var c=b.firstChild;this.EF_setPathPage();var a=this;var d=null;var g=null;c.onmousedown=function(j){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}if(a.eFormDoodleOption.is_eraser){a.eFormDoodleOption.is_eraser_down=true;var i=a.eFormDoodleOption.pens;var k=a.eformDoodlePosition(0,this,j,true);g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke-width",6);g.setAttributeNS(null,"stroke","rgb(255,255,255)");g.setAttributeNS(null,"stroke-opacity",0.5);g.setAttribute("eraser",true);d=new Array();d[0]="M"+k.x+","+k.y;setPath(g,d);c.appendChild(g);}else{var i=a.eFormDoodleOption.pens;var k=a.eformDoodlePosition(0,this,j,true);g=document.createElementNS("http://www.w3.org/2000/svg","path");var h=a.beforePageIndex+"_"+Math.floor((Math.random()*100000)+1);g.setAttribute("id","clip_path"+h);g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"stroke-width",i.width);g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke",i.color);g.setAttributeNS(null,"stroke-opacity",i.op);d=new Array();d[0]="M"+k.x+","+k.y;setPath(g,d);c.appendChild(g);g.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};g.onmousemove=function(){if(a.eFormDoodleOption.is_eraser&&a.eFormDoodleOption.is_eraser_down){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};}};c.onmousemove=function(i){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}var h=false;if(!i.which&&i.button){if(i.button&1){evnet.which=1;}}if(typeof subEForm!="undefined"){h=true;}if(i.which==1||h){if(null!=d){var k=a.eformDoodlePosition(1,this,i,true);var j=d.length;if(i.shiftKey){d[j]="H"+k.x;}else{d[j]="L"+k.x+","+k.y;}if(is_opera){if(d.length%7==0){setPath(g,d);}}else{setPath(g,d);}}}};c.onmouseup=function(h){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}if(a.eFormDoodleOption.is_eraser){a.eFormDoodleOption.is_eraser_down=false;window.setTimeout(function(){a.remove_eraser_path(c);},500);}else{if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathDraw(g);}}g=null;d=null;};c.ontouchstart=function(j){if(j.touches.length==1){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}if(a.eFormDoodleOption.is_eraser){a.eFormDoodleOption.is_eraser_down=true;var i=a.eFormDoodleOption.pens;var k=a.eformDoodlePosition(0,this,j,false);g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke-width",6);g.setAttributeNS(null,"stroke","rgb(255,255,255)");g.setAttributeNS(null,"stroke-opacity",0.6);g.setAttribute("eraser",true);d=new Array();d[0]="M"+k.x+","+k.y;setPath(g,d);c.appendChild(g);}else{var i=a.eFormDoodleOption.pens;var k=a.eformDoodlePosition(0,this,j,false);g=document.createElementNS("http://www.w3.org/2000/svg","path");var h=a.beforePageIndex+"_"+Math.floor((Math.random()*100000)+1);g.setAttribute("id","clip_path"+h);g.setAttributeNS(null,"style","-webkit-tap-highlight-color: rgba(0, 0, 0, 0);");g.setAttributeNS(null,"stroke-width",i.width);g.setAttributeNS(null,"fill","none");g.setAttributeNS(null,"stroke",i.color);g.setAttributeNS(null,"stroke-opacity",i.op);d=new Array();d[0]="M"+k.x+","+k.y;setPath(g,d);c.appendChild(g);g.onclick=function(){if(a.eFormDoodleOption.is_eraser){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(this);}c.removeChild(this);}};}}};c.ontouchmove=function(h){if(null!=d&&(h.touches.length<2)){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}if(h.cancelable){h.preventDefault();}var k=a.eformDoodlePosition(1,this,h,false);var i=d.length;d[i]="L"+k.x+","+k.y;if(a.eFormDoodleOption.is_eraser){var j=document.elementFromPoint(h.touches[0].clientX,h.touches[0].clientY);if("path"==j.tagName){if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathRemove(j);}c.removeChild(j);}}if(is_android){if(d.length%7==0){setPath(g,d);}}else{setPath(g,d);}}};c.ontouchend=function(h){if(a.eFormDoodleOption.is_move||!a.eFormDoodleOption.is_Ds){return;}setPath(g,d);if(a.eFormDoodleOption.is_eraser){a.eFormDoodleOption.is_eraser_down=false;window.setTimeout(function(){a.remove_eraser_path(c);},500);}else{if(a.multiView.isSocket){a.multiView.socket.sendDoodlePathDraw(g);}}g=null;d=null;};};Report.prototype.remove_eraser_path=function(a){var d=a.childNodes.length;for(var b=d-1;b>-1;b--){var e=a.childNodes[b];var c=e.getAttribute("eraser");if(null!=c&&c){a.removeChild(e);}}};Report.prototype.penDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_eraser=false;this.eFormDoodleOption.is_move=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=c){c.style.border="";}if(null!=b){b.style.border="";}if(null!=a){a.style.border="2px solid rgba(33, 150, 243, 0.8)";a.focus();}};Report.prototype.palletDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}var c=document.getElementById("eformPallet"+this.m_uid);if(null!=c){return;}mRe_pallet=this;var c=document.createElement("div");c.id="eformPallet"+this.m_uid;if(is_smartphone){c.className="m_eform_pallet_background";}else{c.className="eform_pallet_background";}var a=document.createElement("div");a.className="eform_pallet_OP_background";c.appendChild(a);var b=this.paintDiv.offsetHeight;if(null!=b){if(320<b){this.palletDoodleHeight(c);}else{this.palletDoodleWidth(c);}}this.targetDiv.appendChild(c);};Report.prototype.removePalletDoodle=function(){var a=document.getElementById("eformPallet"+this.m_uid);if(null!=a){this.targetDiv.removeChild(a);mRe_pallet=null;}};Report.prototype.eraserDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_eraser=true;this.eFormDoodleOption.is_move=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=a){a.style.border="";}if(null!=b){b.style.border="";}if(null!=c){c.style.border="2px solid rgba(33, 150, 243, 0.8)";c.focus();}};Report.prototype.moveDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}this.removePalletDoodle();this.eFormDoodleOption.is_move=true;this.eFormDoodleOption.is_eraser=false;var a=document.getElementById("re_doodlepen"+this.m_uid);var c=document.getElementById("re_doodleeraser"+this.m_uid);var b=document.getElementById("re_doodlemove"+this.m_uid);if(null!=a){a.style.border="";}if(null!=b){b.style.border="2px solid rgba(33, 150, 243, 0.8)";b.focus();}if(null!=c){c.style.border="";}};Report.prototype.eraserAllDoodle=function(){if(!this.eFormDoodleOption.is_Ds){return;}var a=document.getElementById(this.m_uid+"doodle");var b=a.firstChild;if(0!=b.childNodes.length){while(b.firstChild){b.removeChild(b.firstChild);}}this.eFormDoodleOption.pagePathSave[this.beforePageIndex]=new Array();this.penDoodle();if(this.multiView.isSocket){this.multiView.socket.sendDoodlePathRemoveAll();}};Report.prototype.eformReceiveData=function(c){var b=jQuery.parseJSON(c);if(null!=b){var a=Base64.decode(b.viewData);switch(b.id){case 1:resultPageCountText(a);break;case 2:paintEFormReportText(a);break;case 3:eFormResultText(a,"save");break;}}};Report.prototype.eFormTempSubmitSave=function(){if(typeof window.onBrokenSendData!="undefined"){var d={type:"update",uid:this.m_uid,data:this.getEFormTemporaryData(true)};if(!onBrokenSendData(this,d)){return;}}var d="ClipID=R31";d+="&uid="+this.m_uid;d+="&clipUID="+this.m_uid+"&data="+encodeURIComponent(this.getEFormTemporaryData(true))+"&";d=mRe_onBeforeSend(d);var f=this.servletPath;this.debugMeg("report log :: 듀얼모니터 eform 에서 작성한 내용을 임시 저장하기위해 서버접속 시도합니다 >>>> "+f);var e=new HttpClient();var b=e.send(f,d,false,null);var a=objectCall(b);if(typeof a=="string"){a=objectCall(a);}if(null!=a){var c=m_reportHashMap[a.uid];if(null!=c){if(a.status){c.debugMeg("report log :: 임시 저장 성공!");}else{c.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");}}}};Report.prototype.eFormSubmitSave=function(g){if(typeof window.onBrokenSendData!="undefined"){var c={type:"update",uid:this.m_uid,data:this.getEFormTemporaryData(true)};if(!onBrokenSendData(this,c)){return;}}var c="ClipID=R31";c+="&uid="+this.m_uid;c+="&clipUID="+this.m_uid+"&data="+encodeURIComponent(this.getEFormTemporaryData(true))+"&";c=mRe_onBeforeSend(c);var f=this.servletPath;this.debugMeg("report log :: eform 작성한 내용을 저장하기위해 서버접속 시도합니다 >>>> "+f);if(this.m_isCrossDomain){var b=this;if(window.XDomainRequest){var a=new XDomainRequest();var d=f+"?"+c;if(-1!=f.indexOf("?")){d=f+"&"+c;}if(a){a.onload=function(){eFormResultText(mRe_onAfterSend(a.responseText),g);};a.onerror=function(){b.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);b.endDebugMeg(false);};a.open("GET",d);a.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:c,success:function(h){eFormResultText(mRe_onAfterSend(h),g);},error:function(h){b.debugMeg("report log :: 서버 통신 오류 발생 >>> "+h);mRe_ReportEventHandler(40);b.endDebugMeg(false);}});}}else{var b=this;var e=new HttpClient();e.send(f,c,true,function(){if(4==this.readyState){if(200==this.status){eFormResultText(mRe_onAfterSend(this.responseText),g);}else{b.paintDiv.innerHTML=b.m_languageMap.link_error;b.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);b.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});}};Report.prototype.RequiredCheckMessage=function(){var c=new Array();for(var b in this.eFormData){var a=this.eFormData[b];if(a.is_nc){if(a.disable||!a.visible){continue;}if(""!=a.necessaryMessage){c.push(a.necessaryMessage);}}}return EFormNecessaryCheckMessage(c);};Report.prototype.RequiredCheckControl=function(){var e=this.eFormAllIndexControlList.length;for(var c=0;c<e;c++){var b=this.eFormAllIndexControlList[c];var a=this.eFormData[b];if(null==a){continue;}else{if(null==a.disable||null==a.visible){continue;}else{if(a.disable||!a.visible){continue;}}}if(a.is_nc){this.debugMeg("report log :: 필수항목이 모두 체크되지 않았습니다. 서버에 데이터 업데이트를 중지합니다.");this.eForm_isNecessary.check=true;if(this.RequiredCheckMessage()){this.m_isNecessaryInfo=b;if(null!=a.pageNumber){if(this.beforePageIndex==a.pageNumber){this.resetEFormPage(a.pageNumber);}else{this.selectPage(a.pageNumber);}}else{for(var d=0;d<this.eForm_isNecessary.pageList.length;d++){if(null==this.eForm_isNecessary.pageList[d]){this.selectPage(d);break;}}}}return false;}}return true;};Report.prototype.getNecessaryCheckPage=function(h){var g=true;var e=new Array();var f=this.eFormAllIndexControlList.length;var b=true;for(var d=0;d<f;d++){var c=this.eFormAllIndexControlList[d];var a=this.eFormData[c];if(null==a){continue;}else{if(null==a.disable||null==a.visible){continue;}else{if(a.disable||!a.visible){continue;}}}if(a.is_nc){this.eForm_isNecessary.check=true;if(null!=a.pageNumber){if(this.beforePageIndex==a.pageNumber){g=false;if(""!=a.necessaryMessage){e.push(a.necessaryMessage);}if(b){this.m_isNecessaryInfo=c;b=false;}}}}}if(!g){if(h){if(EFormNecessaryCheckMessage(e)){this.resetEFormPage(this.beforePageIndex);}}else{this.resetEFormPage(this.beforePageIndex);}}return g;};Report.prototype.getNecessaryCheck=function(){var e=this.eFormAllIndexControlList.length;for(var c=0;c<e;c++){var b=this.eFormAllIndexControlList[c];var a=this.eFormData[b];if(null==a){continue;}else{if(null==a.disable||null==a.visible){continue;}else{if(a.disable||!a.visible){continue;}}}if(a.is_nc){this.eForm_isNecessary.check=true;this.m_isNecessaryInfo=b;if(null!=a.pageNumber){if(this.beforePageIndex==a.pageNumber){this.resetEFormPage(a.pageNumber);}else{this.selectPage(a.pageNumber);}}else{for(var d=0;d<this.eForm_isNecessary.pageList.length;d++){if(null==this.eForm_isNecessary.pageList[d]){this.selectPage(d);break;}}}return false;}}return true;};Report.prototype.findEFormControls=function(a){if(this.eForm_isNecessary.pageList==null){this.eForm_isNecessary.pageList=new Array(this.m_pageCount);}this.eForm_isNecessary.pageList[this.beforePageIndex]=true;for(var b=0;b<a.length;b++){controls=this.eFormControlList[a[b]];switch(controls.getType()){case"image":controls.eventHandlerImage();break;case"input":controls.eventHandlerInput();break;case"sign":controls.eventHandlerSign();break;case"signGroup":controls.eventHandlerSignGroup();break;case"checkbox":controls.eventHandlerInputCheckbox();break;case"radiobox":controls.eventHandlerInputRadiobox();break;case"calendar":controls.eventHandlerCalendar();break;case"selectbox":controls.eventHandlerSelectBox();break;case"button":controls.eventHandlerButton();break;default:break;}}};Report.prototype.eformControlReSet=function(){this.m_IO_HE=null;for(var a in this.eFormControlList){var b=this.eFormControlList[a];b.deleteDOM();}};Report.prototype.defaultControlSet=function(){this.eFormControlList=new Object();this.eFormControlGroupList=new Object();this.eFormIndexControlList=new Array();this.eFormAllIndexControlList=new Array();var i=new Array();var e=new Array();for(var f in this.eFormData){var g=this.eFormData[f];var d=null;if(null!=g.inputOrder){i[(g.inputOrder-1)]=f;}else{e.push(f);}switch(g.type){case"radiobox":d=new EFormRadiobox();d.init(f,g,this);if(null==this.eFormRadioChecked[g.id]){if(g.checked=="true"){g.is_nc=false;for(var c in this.eFormData){var a=this.eFormData[c];if(g.id==a.id&&f!=c){a.checked="false";a.is_nc=false;}}this.eFormRadioChecked[g.id]=f;}if(null==g.is_nc){if(g.isNecessaryCheck=="true"){g.is_nc=true;}else{g.is_nc=false;}}}break;case"checkbox":d=new EFormCheckbox();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"){if(g.checked=="false"){if(g.requiredCheckInGroup){var b=true;for(var c in this.eFormData){var a=this.eFormData[c];if(g.id==a.id&&f!=c){if(a.checked=="true"){b=false;break;}}}g.is_nc=b;}else{g.is_nc=true;}}}break;case"input":d=new EFormInput();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&ClipStrTrim(g.value)==""){g.is_nc=true;}break;case"sign":d=new EFormSign();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&g.image==""){g.is_nc=true;}break;case"signGroup":d=new EFormSignGroup();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&g.image==""){g.is_nc=true;}break;case"image":d=new EFormImage();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&g.image==""){g.is_nc=true;}break;case"calendar":d=new EFormCalendar();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&d.getValue()==""){g.is_nc=true;}break;case"selectbox":d=new EFormSelectbox();d.init(f,g,this);g.is_nc=false;if(g.isNecessaryCheck=="true"&&d.getValue()==""){g.is_nc=true;}break;case"button":d=new EFormButton();d.init(f,g,this);break;default:break;}this.eFormControlList[f]=d;var h=this.eFormControlGroupList[g.id];if(null==h){h=new EFormGroup();h.init(g.id,this);h.appendControl(d);this.eFormControlGroupList[g.id]=h;}else{h.appendControl(d);}d.setGroup(h);}this.eFormAllIndexControlList=i.concat(e);i=null;e=null;};Report.prototype.defaultTOCSet=function(b){if(null==b){this.eFormTOCList=new Array();return;}this.eFormTOCList=b;var c=this.eFormTOCList.length;for(var a=0;a<c;a++){var d=this.eFormTOCList[a];d.title=Base64.decode(d.title);}b=null;};Report.prototype.resetEFormPage=function(a){this.eformControlReSet();var c=new Array();for(var b in this.eFormControlList){var d=this.eFormControlList[b];if(a==d.controlData.pageNumber){c.push(b);}}this.findEFormControls(c);this.focusInputOrder();this.necessaryFocus();c=null;};Report.prototype.sendEFormData=function(a){if(this.m_isSlidePage&&null!=this.m_tempPaintDiv){this.slideImageView(a);this.m_tempPaintDiv.style.overflowX="hidden";this.m_tempPaintDiv.style.overflowY="hidden";var c=$(this.m_tempPaintDiv).attr("next");var b=this;if("right"==c){$(this.m_tempPaintDiv).animate({left:"100%",width:"100%"},700,function(){try{b.targetDiv.firstChild.removeChild(this);b.m_tempPaintDiv=null;}catch(d){mRe_ReportWebLog(d.message);}});}else{$(this.m_tempPaintDiv).animate({left:"-100%",width:"100%"},700,function(){try{b.targetDiv.firstChild.removeChild(this);b.m_tempPaintDiv=null;}catch(d){mRe_ReportWebLog(d.message);}});}$(this.paintDiv).animate({left:"0%",width:"100%",opacity:1},700,function(){b.createEditableProgress();b.sendEFormPageData(a);});}else{this.sendEFormPageData(a);}};Report.prototype.sendEFormPageData=function(c){var g=this;if(this.m_nextPageSave.poNum==c){window.setTimeout(function(){paintEFormReportText(g.m_nextPageSave.strPageData);},10);return;}var a=this.is_eFormData;var i=this.m_isAccessibility;var h={isData:a,pageNumber:c,isAccessibility:i};if(typeof window.onBrokenSendData!="undefined"){var j={type:"pageView",uid:this.m_uid,options:h};if(!onBrokenSendData(this,j)){return;}}var j="ClipID=R30&uid="+this.m_uid+"&clipUID="+this.m_uid+"&option="+JSON.stringify(h);j=mRe_onBeforeSend(j);var f=this.servletPath;this.debugMeg("report log :: eform 화면을 가져오는 통신을 시도합니다 >>>> "+f);if(this.m_isCrossDomain){if(window.XDomainRequest){var e=new XDomainRequest();var b=f+"?"+j;if(-1!=f.indexOf("?")){b=f+"&"+j;}if(e){e.onload=function(){paintEFormReportText(mRe_onAfterSend(e.responseText));};e.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);};e.open("GET",b);e.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(k){paintEFormReportText(mRe_onAfterSend(k));},error:function(k){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+k);mRe_ReportEventHandler(40);g.endDebugMeg(false);}});}}else{var g=this;var d=new HttpClient();d.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){paintEFormReportText(mRe_onAfterSend(this.responseText));}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;g.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.m_isButtonLock=false;mRe_ReportWebLog(this.status);}}});}};Report.prototype.sendEFormNaxtPageData=function(c){var a=this.is_eFormData;var i=this.m_isAccessibility;var h={isData:a,pageNumber:c,isAccessibility:i};var j="ClipID=R30&uid="+this.m_uid+"&clipUID="+this.m_uid+"&option="+JSON.stringify(h);j=mRe_onBeforeSend(j);var f=this.servletPath;this.debugMeg("report log :: eform 화면을 가져오는 통신을 시도합니다 >>>> "+f);if(this.m_isCrossDomain){var g=this;if(window.XDomainRequest){var e=new XDomainRequest();var b=f+"?"+j;if(-1!=f.indexOf("?")){b=f+"&"+j;}if(e){e.onload=function(){g.nextReportTextSave(mRe_onAfterSend(e.responseText),c);};e.onerror=function(){g.debugMeg("report log :: IE8 크로스도메인 오류 발생 .. ");mRe_ReportEventHandler(40);g.endDebugMeg(false);};e.open("GET",b);e.send();}}else{$.ajax({type:"POST",url:f,crossDomain:true,data:j,success:function(k){g.nextReportTextSave(mRe_onAfterSend(k),c);},error:function(k){g.debugMeg("report log :: 서버 통신 오류 발생 >>> "+k);mRe_ReportEventHandler(40);g.endDebugMeg(false);}});}}else{var g=this;var d=new HttpClient();d.send(f,j,true,function(){if(4==this.readyState){if(200==this.status){g.nextReportTextSave(mRe_onAfterSend(this.responseText),c);}else{g.paintDiv.innerHTML=g.m_languageMap.link_error;g.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);g.endDebugMeg(false);g.m_isButtonLock=false;mRe_ReportWebLog(this.status);}}});}};Report.prototype.nextReportTextSave=function(b,a){this.m_nextPageSave.poNum=a;this.m_nextPageSave.strPageData=b;};Report.prototype.EFormDisabled=function(b){this.m_eformDisabled=b;if(null!=this.eFormControlList){for(var a in this.eFormControlList){var c=this.eFormControlList[a];if(null!=c){c.setDisabled(c.getDisabled());}}}};Report.prototype.EFormPageDisabled=function(c,b){c=c-1;this.m_eformPageDisabled[c]=b;if(null!=this.eFormControlList){for(var a in this.eFormControlList){var d=this.eFormControlList[a];if(null!=d){if(d.controlData.pageNumber==c){d.setDisabled(d.getDisabled());}}}}};Report.prototype.setDefaultPageNumber=function(a){this.beforePageIndex=a-1;};Report.prototype.setEFormMobileSwipeDisabled=function(a){this.swipeOption.isDisabled=a;};Report.prototype.setEFormMobileDoubleTouchDisabled=function(a){this.tripleEvent.isDisabled=a;};Report.prototype.setEFormMobilePageMoveButtonDisabled=function(a){this.m_PageMove.ButtonDisabled=a;this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;};Report.prototype.setEndPageMoveEvent=function(a){this.m_isEFormPageMoveEvent=a;};Report.prototype.setNecessaryEnabled=function(a){this.eForm_isNecessary.is_start=a;};Report.prototype.setNextPageLoading=function(a){this.m_is_eform_nextPage=a;};Report.prototype.setTouchZoomInDisabled=function(a){this.m_twoTouchEvtDisabled=a;};Report.prototype.setDoodlePenDefaultVisible=function(a){this.m_isDefaultDoodleVisble=a;};Report.prototype.eFormGestureEvent=function(){var a=this;this.paintDiv.ontouchstart=function(c){if(c.touches.length==1){if(!a.eFormDoodleOption.is_Ds){var e=c.touches[0];var b,d;if(is_PosiFix){b=e.clientX;d=e.clientY;}else{b=e.pageX;d=e.pageY;}if(!a.m_PageMove.ButtonDisabled){a.createPageMoveButton("eform");}if(!a.swipeOption.isDisabled){a.swipeOption.is_start=true;a.swipeOption.s_x=b;a.swipeOption.s_y=d;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}if(!a.tripleEvent.isDisabled){if(e.target.tagName!="DIV"||((a.tripleEvent.x+30)<b||(a.tripleEvent.x-30)>b)||((a.tripleEvent.y+30)<d||(a.tripleEvent.y-30)>d)){a.tripleEvent.cnt=0;a.tripleEvent.x=b;a.tripleEvent.y=d;}else{if(a.tripleEvent.x==0&&a.tripleEvent.y==0){a.tripleEvent.x=b;a.tripleEvent.y=d;}}}}}if(!a.m_twoTouchEvtDisabled){if(c.touches.length==2&&c.cancelable){c.preventDefault();a.swipeOption.is_start=false;a.eFormDoodleOption.gesture.zoom=a.eFormDoodleOption.zoomIn;a.eFormDoodleOption.gesture.isStart=true;var b,d;if(is_PosiFix){b=Math.abs(c.touches[0].clientX-c.touches[1].clientX);d=Math.abs(c.touches[0].clientY-c.touches[1].clientY);}else{b=Math.abs(c.touches[0].pageX-c.touches[1].pageX);d=Math.abs(c.touches[0].pageY-c.touches[1].pageY);}a.eFormDoodleOption.gesture.line=Math.sqrt((b*b)+(d*d));a.eFormDoodleOption.gesture.pos=a.eformDoodlePosition(0,this,c,false);a.paintDiv.lastChild.lastChild.style.display="block";a.paintDiv.firstChild.style.display="none";}}};this.paintDiv.ontouchmove=function(f){if(f.touches.length==1){if(!a.eFormDoodleOption.is_Ds){if(a.swipeOption.is_start&&!a.swipeOption.isDisabled){var b,h;if(is_PosiFix){b=f.touches[0].clientX;h=f.touches[0].clientY;}else{b=f.touches[0].pageX;h=f.touches[0].pageY;}if(a.swipeOption.is_start){a.swipeOption.e_x=b;a.swipeOption.e_y=h;}}}}if(!a.m_twoTouchEvtDisabled){if(f.touches.length==2&&f.cancelable){a.swipeOption.is_start=false;var d=a.eFormDoodleOption.gesture;f.preventDefault();var b,h;if(is_PosiFix){b=Math.abs(f.touches[0].clientX-f.touches[1].clientX);h=Math.abs(f.touches[0].clientY-f.touches[1].clientY);}else{b=Math.abs(f.touches[0].pageX-f.touches[1].pageX);h=Math.abs(f.touches[0].pageY-f.touches[1].pageY);}var c=Math.sqrt((b*b)+(h*h));var e=null;if(c>d.line){e=d.zoom*(c/d.line);}else{e=d.zoom/(d.line/c);}var g=a.paintDiv.clientWidth;minZoomSize=g/Number(a.pageWidth);if(minZoomSize>0.75){minZoomSize=0.75;}if(e>4){e=4;}else{if(e<minZoomSize){if(is_android_mobile44&&minZoomSize<0.5){minZoomSize=0.55;}e=minZoomSize;}}d.zoomUp=e;a.eFormZoom(e,0);}}};this.paintDiv.ontouchend=function(e){if(!a.eFormDoodleOption.is_Ds){var g=e.changedTouches[0];var b,f;if(is_PosiFix){b=g.clientX;f=g.clientY;}else{b=g.pageX;f=g.pageY;}if(((a.tripleEvent.x+30)>b&&(a.tripleEvent.x-30)<b)&&((a.tripleEvent.y+30)>f&&(a.tripleEvent.y-30)<f)){a.tripleEvent.cnt++;}if(!a.tripleEvent.isDisabled&&a.tripleEvent.cnt==2){var d=a.paintDiv.offsetWidth/2;if(a.tripleEvent.x>d){a.nextPage();}else{a.previousPage();}a.tripleEvent.cnt=0;a.tripleEvent.x=0;a.tripleEvent.y=0;a.swipeOption.s_x=0;a.swipeOption.s_y=0;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}else{if(!a.swipeOption.isDisabled&&a.swipeOption.is_start){a.swipeOption.is_start=false;if(a.swipeOption.s_x-a.swipeOption.e_x>140&&a.swipeOption.e_x!=0){a.swipeEForm(0);}if(a.swipeOption.s_x-a.swipeOption.e_x<-140&&a.swipeOption.e_x!=0){a.swipeEForm(1);}a.swipeOption.s_x=0;a.swipeOption.s_y=0;a.swipeOption.e_x=0;a.swipeOption.e_y=0;}}a.swipeOption.is_start=false;}var c=a.eFormDoodleOption.gesture;if(c.isStart){a.eFormZoom(c.zoomUp,1);a.paintDiv.lastChild.lastChild.style.display="";a.paintDiv.firstChild.style.display="block";}c.isStart=false;};};Report.prototype.swipeEForm=function(a){switch(a){case 0:if((this.paintDiv.clientWidth+this.paintDiv.scrollLeft+3)>=this.paintDiv.scrollWidth){this.nextPage();}break;case 1:if(this.paintDiv.scrollLeft==0){this.previousPage();}break;default:break;}};Report.prototype.slideImageView=function(a){if(this.m_isPreviewImg){var b="ClipID=R98&startPageNum="+(a+1)+"&endPageNum="+(a+1)+"&uid="+this.m_uid+"&clipUID="+this.m_uid;var c=document.createElement("img");c.className="eform_zoomInOut";c.style.display="block";if(null!=this.paintDiv.firstChild){this.paintDiv.firstChild.appendChild(c);}b=mRe_onBeforeSend(b);var f=this.servletPath;var e=new HttpClient();var d=e.send(f,b,false,null);c.src="data:image/png;base64,"+d;this.mRe_beforeImgData=d;}else{var c=document.createElement("img");c.className="eform_zoomInOut";if(null!=this.paintDiv.firstChild){this.paintDiv.firstChild.appendChild(c);}c.src="data:image/png;base64,"+mRe_whiteImg;this.mRe_beforeImgData=mRe_whiteImg;}};Report.prototype.zoomImageView=function(){if(this.m_isPreviewImg){if(null==this.mRe_beforeImgData){var b="ClipID=R98&startPageNum="+(this.beforePageIndex+1)+"&endPageNum="+(this.beforePageIndex+1)+"&clipUID="+this.m_uid+"&uid="+this.m_uid;var c=document.createElement("img");c.className="eform_zoomInOut";if(null!=this.paintDiv.lastChild){this.paintDiv.lastChild.appendChild(c);}b=mRe_onBeforeSend(b);var e=this.servletPath;var d=new HttpClient();var a=this;d.send(e,b,true,function(){if(4==this.readyState){if(200==this.status){var f=mRe_onAfterSend(this.responseText);c.src="data:image/png;base64,"+f;}else{a.debugMeg("report log :: 서버 통신 오류 발생 >>> ajax 통신 상태 "+this.status);mRe_ReportEventHandler(40);a.endDebugMeg(false);mRe_ReportWebLog(this.status);}}});}else{var c=document.createElement("img");c.className="eform_zoomInOut";if(null!=this.paintDiv.lastChild){this.paintDiv.lastChild.appendChild(c);}c.src="data:image/png;base64,"+this.mRe_beforeImgData;this.mRe_beforeImgData=null;}}else{var c=document.createElement("img");c.className="eform_zoomInOut";if(null!=this.paintDiv.lastChild){this.paintDiv.lastChild.appendChild(c);}c.src="data:image/png;base64,"+mRe_whiteImg;this.mRe_beforeImgData=null;}};Report.prototype.setSplitView=function(a){if(is_smartphone){this.m_isSplitView=a;this.setStyle("firstPage_button","display:none;");this.setStyle("save_button","display:none;");this.setStyle("lastPage_button","display:none;");this.setStyle("zoomIn","display:none;");this.setStyle("doodle_button","display:none;");this.setDefaultRatio("PageWidth");}};Report.prototype.setSplitViewQuick=function(a){this.m_splitView.isQuick=a;if(a){this.swipeOption.isDisabled=false;this.tripleEvent.isDisabled=false;}else{this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;}};Report.prototype.setSplitViewSlideTime=function(a){if(!isNaN(Number(a))){this.m_splitView.time=Number(a)*1000;}};Report.prototype.setSpliteViewPageMoveRequiredEvent=function(a){this.m_splitView.event=a;};Report.prototype.m_splitViewSetting=function(){if(!this.m_splitView.isQuick){this.stopSplitView();}this.disabledMenu(true);this.m_popupViewDiv=document.createElement("div");this.m_popupViewDiv.className="report_popup_view";this.m_popupViewDiv.style.position="absolute";this.targetDiv.appendChild(this.m_popupViewDiv);var c=this;var f=document.createElement("div");f.className="eform_setting_view_box";var k=document.createElement("table");k.className="eform_setting_view_table";var a=document.createElement("tr");k.appendChild(a);var n=document.createElement("td");n.innerHTML="슬라이드 시간 : ";a.appendChild(n);n=document.createElement("td");var j=document.createElement("select");j.className="eform_setting_view_select";var m=(this.m_splitView.time/1000);for(var d=1;d<11;d++){var e=document.createElement("option");e.value=d+"";e.innerHTML=d+"초";if(d==m){e.selected=true;}j.appendChild(e);}n.appendChild(j);a.appendChild(n);a=document.createElement("tr");k.appendChild(a);n=document.createElement("td");var g=document.createElement("input");g.type="checkbox";g.className="eform_setting_view_checkbox";g.checked=this.m_splitView.isQuick;n.appendChild(g);var h=document.createElement("span");h.innerHTML="퀵모드 전환";n.appendChild(h);a.appendChild(n);n=document.createElement("td");a.appendChild(n);var l=document.createElement("button");l.className="eform_setting_view_okButton";l.innerHTML=this.m_languageMap.ok;l.onclick=function(){c.m_splitViewSetting_ok(j,g);};var b=document.createElement("button");b.className="eform_setting_view_cencelButton";b.innerHTML=this.m_languageMap.cancel;b.onclick=function(){c.m_splitViewSetting_close();};f.appendChild(k);f.appendChild(l);f.appendChild(b);this.m_popupViewDiv.appendChild(f);};Report.prototype.m_splitViewSetting_ok=function(e,c){var f=e.value;this.m_splitView.time=Number(f)*1000;if(c.checked!=this.m_splitView.isQuick){this.m_splitView.isQuick=c.checked;var b=this;if(this.m_splitView.isQuick){this.swipeOption.isDisabled=false;this.tripleEvent.isDisabled=false;var d=this.m_splitView.inputOrder;this.m_splitView.centerButton.className="eform_slide_button eform_slide_button_center";this.m_splitView.centerButton.onclick=function(){b.changeRatioCombo("PageWidth");};this.m_splitView.leftButton.onclick=function(){b.focusSplitViewQuickInputOrder(d);};this.m_splitView.rightButton.onclick=function(){b.focusSplitViewQuickInputOrder(d);};this.changeRatioCombo("PageWidth");}else{this.swipeOption.isDisabled=true;this.tripleEvent.isDisabled=true;var a=this.m_splitView.centerButton;a.className="eform_slide_button eform_slide_button_stop";this.m_splitView.leftButton.disabled=false;this.m_splitView.leftButton.onclick=function(){a.className="eform_slide_button eform_slide_button_play";b.prevSplitView();};this.m_splitView.centerButton.onclick=function(){a.className="eform_slide_button eform_slide_button_stop";b.stopSplitView();};this.m_splitView.rightButton.disabled=false;this.m_splitView.rightButton.onclick=function(){a.className="eform_slide_button eform_slide_button_play";b.nextSplitView();};this.eFormSplitViewZoom();}}this.m_splitViewSetting_close();};Report.prototype.m_splitViewSetting_close=function(){this.targetDiv.removeChild(this.m_popupViewDiv);this.disabledMenu(false);this.m_popupViewDiv=null;};Report.prototype.stopSplitView=function(){if(this.m_isSplitView){if(this.m_splitView.isStopButton){var a=this.paintDiv;$(a).stop(true,false);this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);this.m_stopSplitViewPosition();}}};Report.prototype.m_setSplitViewStopButton=function(a){this.m_splitView.isStopButton=a;};Report.prototype.m_setSplitViewMoveButton=function(a){this.m_splitView.isMoveButton=a;};Report.prototype.m_stopSplitViewPosition=function(){var a=this.paintDiv;this.m_splitView.stopPos.x=a.scrollLeft;this.m_splitView.stopPos.y=a.scrollTop;};Report.prototype.m_splitViewMovePosition=function(){var a=this.paintDiv;a.scrollLeft=this.m_splitView.stopPos.x;a.scrollTop=this.m_splitView.stopPos.y;};Report.prototype.prevSplitView=function(){if(this.m_isSplitView){if(!this.m_splitView.isMoveButton){}else{this.m_setSplitViewStopButton(true);this.m_setSplitViewMoveButton(false);this.m_splitViewMovePosition();if(this.m_splitView.pos-1>=0){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=null;var c=null;if(this.m_splitView.pos==1&&this.paintDiv.scrollTop>0){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==1&&this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){a=this.m_splitView.arr[this.m_splitView.pos-1];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollTop<parseInt(Number(this.pageHeight*this.m_splitView.zoomRate)/2)){a=this.m_splitView.arr[this.m_splitView.pos-1];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollLeft>0){a=this.m_splitView.arr[this.m_splitView.pos];}else{a=this.m_splitView.arr[this.m_splitView.pos-1];}}}}var d=this.paintDiv;$(d).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){--b.m_splitView.pos;b.m_stopSplitViewPosition();b.m_setSplitViewMoveButton(true);b.prevSplitView();});}else{if(this.m_splitView.pos==0){if(this.paintDiv.scrollLeft>0||this.paintDiv.scrollTop>0){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=this.m_splitView.arr[this.m_splitView.pos];var d=this.paintDiv;$(d).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){b.m_stopSplitViewPosition();b.m_setSplitViewStopButton(false);b.m_setSplitViewMoveButton(true);});}else{this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);}}}}}};Report.prototype.nextSplitView=function(){if(this.m_isSplitView){if(!this.m_splitView.isMoveButton){}else{this.m_setSplitViewStopButton(true);this.m_setSplitViewMoveButton(false);this.m_splitViewMovePosition();if(this.m_splitView.pos+1<4){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=null;if(this.m_splitView.pos==1&&this.paintDiv.scrollTop>0){a=this.m_splitView.arr[this.m_splitView.pos+1];}else{if(this.m_splitView.pos==1&&this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollTop<parseInt(Number(this.pageHeight*this.m_splitView.zoomRate)/2)){a=this.m_splitView.arr[this.m_splitView.pos];}else{if(this.m_splitView.pos==2&&this.paintDiv.scrollLeft>0){a=this.m_splitView.arr[this.m_splitView.pos+1];}else{a=this.m_splitView.arr[this.m_splitView.pos+1];}}}}var c=this.paintDiv;$(c).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){++b.m_splitView.pos;if(b.m_splitView.pos==3){b.m_splitView.pageInfo[b.beforePageIndex]=true;}b.m_stopSplitViewPosition();b.m_setSplitViewMoveButton(true);b.nextSplitView();});}else{if(this.m_splitView.pos==3){if(this.paintDiv.scrollLeft<parseInt(Number(this.pageWidth*this.m_splitView.zoomRate)-Number(this.paintDiv.clientWidth))){var b=this;this.eFormZoom(this.m_splitView.zoomRate,1);var a=this.m_splitView.arr[this.m_splitView.pos];var c=this.paintDiv;$(c).animate({scrollLeft:a.x,scrollTop:a.y},this.m_splitView.time,function(){b.m_stopSplitViewPosition();b.m_setSplitViewStopButton(false);b.m_setSplitViewMoveButton(true);});}else{this.m_setSplitViewStopButton(false);this.m_setSplitViewMoveButton(true);}}}}}};Report.prototype.eFormSplitViewZoom=function(){var a=this.paintDiv.clientHeight;var c=this.paintDiv.clientWidth;var b=(a*2)/Number(this.pageHeight);this.m_splitView.zoomRate=b;this.m_splitView.pos=0;this.m_splitView.arr=new Array(4);this.m_splitView.arr[0]={x:0,y:0};this.m_splitView.arr[1]={x:parseInt(Number(this.pageWidth*b)-Number(c)),y:0};this.m_splitView.arr[2]={x:0,y:((Number(this.pageHeight)*b)/2)};this.m_splitView.arr[3]={x:parseInt(Number(this.pageWidth*b)-Number(c)),y:(parseInt(Number(this.pageHeight*b)/2))};this.m_splitView.stopPos={x:0,y:0};this.paintDiv.scrollTop=0;this.paintDiv.scrollLeft=0;this.eFormZoom(b,1);};Report.prototype.eFormZoom=function(e,b){var f=e;this.eFormDoodleOption.zoomIn=Re_zoom.rate=f;var c=this.paintDiv.firstChild.firstChild;if(null!=c&&b>0){c.setAttribute("width",Number(this.pageWidth)*Number(f));c.setAttribute("height",Number(this.pageHeight)*Number(f));if(null!=c.lastChild){c.lastChild.setAttribute("transform","scale("+f+") translate(0,0)");}if(is_apple){if(1<Number(f)){c.setAttribute("text-rendering","geometricPrecision");}else{c.setAttribute("text-rendering","auto");}}}var a=this.paintDiv.firstChild.nextSibling;if(null!=a&&b>=0){a.style.zoom=f;if(is_smartphone){a.style.display="block";a.style.position="absolute";var d=a.offsetWidth*f;if((d)>this.paintDiv.offsetWidth){a.style.left="0px";}else{var g=((this.paintDiv.offsetWidth-d)/2)/f;a.style.left=g+"px";}}}this.zoomChangeEForm();};Report.prototype.zoomChangeEForm=function(){if(this.multiView.isSocket){if(!this.multiView.socket.isMain){var g=this.paintDiv;var b={srcElement:g};this.multiView.socket.sendScrollPosition(b);}else{var e=document.getElementById("scroll_guider"+this.m_uid);if(e!=null){var a=this.multiView.socket;var f=this.getProperty("sub_position");if(null!=f){var d=this.paintDiv.scrollHeight;var h=this.paintDiv.offsetTop-this.paintDiv.scrollTop;var c=f.clientHeight/f.scrollHeight*d;a.scrollTop=f.scrollTop/f.scrollHeight*d;e.style.height=c+"px";e.style.top=(a.scrollTop+h)+"px";}}}}};Report.prototype.inputOrderFoucs=function(j){if(null==this.m_IO_HE){this.m_IO_HE=new Object();this.m_IO_HE.main=document.getElementById(this.m_uid+"IndexOrder");this.m_IO_HE.inner=document.getElementById(this.m_uid+"IO_in");this.m_IO_HE.left=this.m_IO_HE.inner.firstChild;this.m_IO_HE.right=this.m_IO_HE.inner.lastChild;}var c=j.getHE();var m=this.m_IO_HE;var i=this;this.m_IO_HE.target=c;if(null!=c){var a=this.eFormDoodleOption.zoomIn;if(this.m_isHybridQuickControl&&is_smartphone){if(a!=this.m_nQuickControlMobileZoom){this.m_nHybridTempZoom=a;}this.eFormZoom(this.m_nQuickControlMobileZoom,1);a=this.eFormDoodleOption.zoomIn;}c.style.zIndex="101";m.main.style.display="block";m.inner.style.display="block";var e=is_edge?c.offsetTop/a:c.offsetTop;var g=is_edge?c.offsetLeft/a:c.offsetLeft;var l=j.controlData.inputOrder;if(this.m_isSplitView){m.left.style.display="none";m.right.style.display="none";m.main.onclick=function(){i.inputOrderBlur();};if(this.m_splitView.isQuick){this.m_splitView.inputOrder=l;if(findPrevControl(this.eFormIndexControlList,l)){this.m_splitView.leftButton.onclick=null;this.m_splitView.leftButton.disabled=true;}else{this.m_splitView.leftButton.disabled=false;this.m_splitView.leftButton.onclick=function(n){i.defaultFoucsOut(j);i.nextInputOrder(l-1,false);if(n.stopPropagation){n.stopPropagation();}else{n.cancelBubble=true;}};}if(findNextControl(this.eFormIndexControlList,l)){this.m_splitView.rightButton.onclick=null;this.m_splitView.rightButton.disabled=true;}else{this.m_splitView.rightButton.disabled=false;this.m_splitView.rightButton.onclick=function(n){i.defaultFoucsOut(j);i.nextInputOrder(l+1,true);if(n.stopPropagation){n.stopPropagation();}else{n.cancelBubble=true;}};}}}else{if(this.m_isHybridQuickControl){m.left.style.display="none";m.right.style.display="none";m.main.onclick=function(){i.inputOrderBlur();};if(null!=this.paintDiv){this.m_isHybridQuickControlZoom=true;e=e+c.parentElement.offsetTop;g=g+c.parentElement.offsetLeft;var b=(this.paintDiv.offsetWidth-c.offsetWidth)/2;var k=(this.paintDiv.offsetHeight-c.offsetHeight)/2;var h=(g-(b/a))*a;var d=(e-100)*a;this.paintDiv.scrollLeft=h;this.paintDiv.scrollTop=d;}return;}else{if(this.multiView.isSocket){m.left.style.display="none";m.right.style.display="none";}else{m.left.style.display="block";m.right.style.display="block";}var f=2;if(findPrevControl(this.eFormIndexControlList,l)){m.left.style.display="none";f--;}if(findNextControl(this.eFormIndexControlList,l)){m.right.style.display="none";f--;}if(f>1&&45>c.offsetWidth){m.inner.style.left=(c.offsetLeft-13)+"px";m.inner.style.top=(e-25)+"px";m.inner.style.width="1.2cm";}else{m.inner.style.left=c.style.left;m.inner.style.top=(e-25)+"px";m.inner.style.width=c.style.width;}m.main.onclick=function(){i.inputOrderBlur();};m.left.onclick=function(n){i.defaultFoucsOut(j);i.nextInputOrder(l-1,false);if(n.stopPropagation){n.stopPropagation();}else{n.cancelBubble=true;}};m.right.onclick=function(n){i.defaultFoucsOut(j);i.nextInputOrder(l+1,true);if(n.stopPropagation){n.stopPropagation();}else{n.cancelBubble=true;}};}}if(null!=this.paintDiv){this.m_isHybridQuickControlZoom=true;if((this.paintDiv.scrollHeight+5)>this.paintDiv.offsetHeight){this.paintDiv.scrollTop=(e-30)*a;}if((this.paintDiv.scrollWidth+5)>this.paintDiv.offsetWidth){this.paintDiv.scrollLeft=(g-10)*a;}}}};Report.prototype.defaultFoucsOut=function(a){if(("sign"==a.getType()||"signGroup"==a.getType())&&a.isDOM){if(a.controlData.isDirectSign){var b=document.getElementById(this.m_uid+"okUBT");if(null!=b){b.click();}}}};Report.prototype.defaultFoucsIn=function(a){if(a.isDOM){a.getHE().focus();if(("sign"==a.getType()||"signGroup"==a.getType())){if(a.controlData.isDirectSign){if(null!=a.signElement){a.signElement.click();}}}}};Report.prototype.inputOrderBlur=function(){if(null!=this.m_IO_HE){this.m_IO_HE.target.style.zIndex="";this.m_IO_HE.main.style.display="";this.m_IO_HE.inner.style.display="";}if(this.m_isHybridQuickControl){if(null!=this.m_nHybridTempZoom){this.eFormZoom(this.m_nHybridTempZoom,1);}}};Report.prototype.focusInputOrder=function(){if(null!=this.eFormIndexInfo){this.nextInputOrder(this.eFormIndexInfo.inputOrder,this.eFormIndexInfo.isNext);}else{if(this.m_isSplitView){if(this.m_splitView.isQuick){for(var c=0;c<this.eFormIndexControlList.length;c++){var d=this.eFormIndexControlList[c];if(null!=d){if(d.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(d);break;}}}var a=this;var b=this.m_splitView.inputOrder;this.m_splitView.leftButton.disabled=false;this.m_splitView.rightButton.disabled=false;this.m_splitView.leftButton.onclick=function(){a.focusSplitViewQuickInputOrder(b);};this.m_splitView.rightButton.onclick=function(){a.focusSplitViewQuickInputOrder(b);};}}}};Report.prototype.focusSplitViewQuickInputOrder=function(b){for(var a=0;a<this.eFormIndexControlList.length;a++){var c=this.eFormIndexControlList[a];if(null!=c){if(null==b){if(c.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(c);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=c.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber);}break;}else{if(c.controlData.inputOrder==b){if(c.controlData.pageNumber==this.beforePageIndex){this.defaultFoucsIn(c);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=c.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber);}break;}}}}};Report.prototype.nextInputOrder=function(a,c){var b=this.eFormIndexControlList[a];if(null!=b){if(!b.controlData.disable&&b.controlData.visible&&!b.controlData.indexOrderDisable){if(b.isDOM){this.eFormIndexInfo=null;this.defaultFoucsIn(b);}else{this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=a;this.eFormIndexInfo.isNext=c;this.selectPage(b.controlData.pageNumber);}}else{this.eFormIndexInfo=null;if(c){this.nextInputOrder(a+1,true);}else{this.nextInputOrder(a-1,false);}}}};Report.prototype.nextHybridInputOrder=function(d,b){var c=this.eFormIndexControlList[b];if(null!=c){if(!c.controlData.disable&&c.controlData.visible&&!c.controlData.indexOrderDisable&&c.controlData.is_nc){if(c.isDOM){this.eFormIndexInfo=null;this.defaultFoucsIn(c);}else{var g=this.eFormIndexControlList[d];for(var a=0;a<d;a++){var f=this.eFormIndexControlList[a];if(null!=f&&f.controlData.is_nc&&f.controlData.pageNumber==g.controlData.pageNumber&&!f.controlData.disable&&f.controlData.visible){this.eFormIndexInfo=null;this.defaultFoucsIn(f);return;}}this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=b;this.eFormIndexInfo.isNext=true;this.selectPage(c.controlData.pageNumber);}}else{this.eFormIndexInfo=null;this.nextHybridInputOrder(d,b+1);}}else{var g=this.eFormIndexControlList[d];var e=null;for(var a=0;a<b;a++){var f=this.eFormIndexControlList[a];if(null!=f&&f.controlData.is_nc&&!f.controlData.disable&&f.controlData.visible){if(f.controlData.pageNumber==g.controlData.pageNumber){this.eFormIndexInfo=null;this.defaultFoucsIn(f);return;}else{if(null==e){e=f;}}}}if(null!=e){this.eFormIndexInfo=new Object();this.eFormIndexInfo.inputOrder=e.controlData.inputOrder;this.eFormIndexInfo.isNext=true;this.selectPage(e.controlData.pageNumber);return;}if(this.m_HybridQuickControlEvent!=null){this.m_HybridQuickControlEvent();}}};Report.prototype.nextHybridInputControl=function(c){if(this.m_isHybridQuickControl){if(null!=c.controlData.inputOrder){var a=c.controlData.inputOrder;this.defaultFoucsOut(c);var b=this;window.setTimeout(function(){b.nextHybridInputOrder(a,a+1);},100);return true;}}return false;};Report.prototype.necessaryFocus=function(){if(null!=this.m_isNecessaryInfo){var b=this.eFormControlList[this.m_isNecessaryInfo];var a=b.getHE();if(null!=a){a.focus();}}this.m_isNecessaryInfo=null;};Report.prototype.m_dynamicScript=function(b){if(null!=b){b=Base64.decode(b);try{this.dynamicScript=objectEFormCall("function(){if(this.m_debug.isDebug){debugger;}\r\n"+b+"}");}catch(a){this.dynamicScript=null;this.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> "+a.message);mRe_ReportEventHandler(31);}}};function objectEFormCall(a){var b=(new Function("return ("+a+")"))();return b;}Report.prototype.resetDynamicScript=function(){for(var a in this.eFormData){var b=this.eFormControlList[a];switch(b.controlData.type){case"radiobox":b.event.selectedEvent=null;b.event.unSelectedEvent=null;break;case"checkbox":b.event.checkedEvent=null;b.event.unCheckedEvent=null;break;case"input":b.event.focusEvent=null;b.event.blurEvent=null;break;case"sign":case"signGroup":b.event.clickEvent=null;b.event.okButtonEvent=null;b.event.cencelButtonEvent=null;break;case"image":b.event.clickEvent=null;break;case"calendar":b.event.clickEvent=null;break;case"selectbox":b.event.changeEvent=null;break;case"button":b.event.clickEvent=null;break;default:break;}}};Report.prototype.defaultEFormSet=function(){this.paintDiv.firstChild.firstChild.style.overflow="hidden";this.pageWidth=this.paintDiv.firstChild.firstChild.getAttribute("width");this.pageHeight=this.paintDiv.firstChild.firstChild.getAttribute("height");if(this.multiView.isSocket){if(this.multiView.socket.isMain){var c=this.paintDiv.lastChild.childNodes;for(var b=0;b<c.length;b++){var a=c[b];if("DIV"==a.tagName){var d=110+(b*10);a.style.zIndex=""+d;}}}}};Report.prototype.getFormat=function(b,a){return b.formatting(a);};Report.prototype.setGuiderLineDisplay=function(a){this.m_isGuiderLineDisplay=a;};Report.prototype.setHybridProgress=function(a){this.m_isHybridProgress=a;};Report.prototype.setHybridQuickControlCompleteEvent=function(a){this.setQuickControlCompleteEvent(a);};Report.prototype.setQuickControlCompleteEvent=function(a){this.m_HybridQuickControlEvent=a;};Report.prototype.setHybridQuickControl=function(a){this.setQuickControl(a);};Report.prototype.setQuickControl=function(a){this.m_isHybridQuickControl=a;if(a&&null==this.m_nQuickControlMobileZoom){this.m_nQuickControlMobileZoom=1.4;}};Report.prototype.setQuickControlMobileZoom=function(a){this.m_nQuickControlMobileZoom=a;};Report.prototype.callSubReport=function(){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.callSubReport();}}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.closeSubReport=function(){if(this.multiView.isSocket){if(this.multiView.socket.isMain){this.multiView.socket.closeSubReport();}}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.setSubCallReportEvent=function(a){this.m_subReportEvent.callReportBefore=a;};Report.prototype.setSubCloseReportEvent=function(a){this.m_subReportEvent.closeReportAfter=a;};Report.prototype.sendUserData=function(a){if(this.multiView.isSocket){this.multiView.socket.sendUserData(a);}else{this.debugMeg("report log :: eform 소켓 설정이 없습니다....");}};Report.prototype.receiveUserDataCallBack=function(a){this.m_socketReportEvent.userData=a;};Report.prototype.setSocketStatusEvent=function(a){this.m_socketReportEvent.userData=a;};Report.prototype.createSignBlockScreen=function(d){if(typeof d=="undefined"){d="none";}this.removeSignBlockScreen();this.m_signBlockScreen=document.createElement("div");this.m_signBlockScreen.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;background-color:rgba(192,192,192,0.3);z-index:800;";var f=document.createElement("div");if(d=="key"){f.className="eform_keyboard_wait";}else{f.className="eform_sign_wait";}var c=document.createElement("button");c.className="eform_wait_close_button";c.innerHTML="×";var a=this;c.onclick=function(){if(a.multiView.isSocket){a.multiView.socket.sendHybirdClose(d);}a.removeSignBlockScreen();};this.m_signBlockScreen.appendChild(f);this.m_signBlockScreen.appendChild(c);this.targetDiv.appendChild(this.m_signBlockScreen);var b=this.paintDiv.offsetWidth;var e=340;if(null!=b){e=(b/2)-(f.offsetWidth/2);}f.style.left=e+"px";c.style.left=(e+f.offsetWidth-20)+"px";};Report.prototype.removeSignBlockScreen=function(){if(this.m_signBlockScreen!=null){try{this.targetDiv.removeChild(this.m_signBlockScreen);this.m_signBlockScreen=null;}catch(a){report.debugMeg("report log : warning 동시서명 화면에 스크린블럭이 존재하지 않지만 삭제요청이 들어옴 ");}}};function paintEFormReportText(h){if(0==h.indexOf('"')){h=h.substring(1,h.length-1);}var c=h.split("{clipreport_separator}");var f=objectCall(ClipStrTrim(c[0]));if(typeof f=="string"){f=objectCall(f);}var a=m_reportHashMap[f.uid];a.debugMeg("report log :: eform 리포트 페이지 서버 수신 완료...");try{if(f.status){a.debugMeg("report log :: eform 리포트 페이지 서버 수신 완료 메시지 >>> "+c[0]);if(null!=f.pageWidth){a.m_printPage.pageWidth=f.pageWidth;a.m_printPage.pageHeight=f.pageHeight;}var b=false;if(!a.is_eFormData){var g=objectCall(c[3]);if(typeof g=="string"){g=objectCall(g);}a.eFormCheckImage=g.checkImage;a.eFormRadioImage=g.radioImage;a.m_dynamicScript(g.dynamicScript);if(null!=a.eFormTempData){a.validationEFormData(g.data);}else{a.eFormData=g.data;if(a.m_isDefaultDoodleVisble&&null!=g.doodleInfo){a.eFormDoodleOption.pagePathSave=g.doodleInfo;}}a.appendEFormData();a.defaultControlSet();a.defaultTOCSet(g.toc);if(null!=g.thumbnail){a.m_isThumbnail=g.thumbnail;}g=null;b=true;}a.eformControlReSet();a.debugMeg("report log :: eform 리포트 화면를 SVG로 표현!");a.paintDiv.innerHTML=unescape(c[1]);a.defaultEFormSet();a.zoomImageView();if(is_smartphone){if(a.m_isSplitView&&!a.m_splitView.isQuick){a.eFormSplitViewZoom();}else{if(b){a.zoomIn(a.zoomCombo);}else{a.eFormZoom(a.eFormDoodleOption.zoomIn,1);}}}else{a.zoomIn(a.zoomCombo);}a.eFormGestureEvent();a.setPaintDivEvent(a.paintDiv,f.uid);a.m_isButtonLock=false;var j=objectCall(c[2]);if(typeof j=="string"){j=objectCall(j);}a.findEFormControls(j);if(a.eFormDoodleOption.is_Ds){a.EFormDoodle();}else{a.EF_setPathPage();}if(null==a.m_drilingTop){if((is_smartphone&&a.m_mobile.scrollTop)||(!is_smartphone&&a.m_pcView.scrollTop)||a.m_scrollEv.isScrollPaging){a.paintDiv.scrollTop=1;}}else{a.paintDiv.scrollTop=a.m_drilingTop;a.m_drilingTop=null;}if(!a.is_eFormData){if(null!=a.dynamicScript){window.setTimeout(function(){try{a.dynamicScript();}catch(k){a.resetDynamicScript();a.debugMeg("report log :: 리포트파일에 설정된 동적 속성 스크립에 문제가 있습니다. >> "+k.message);mRe_ReportEventHandler(31);}},0);}a.is_eFormData=true;}a.focusInputOrder();a.necessaryFocus();if(a.m_isEndReport&&a.m_isEndReportEvent){if(a.m_endreportprogress.is_visible){a.m_endreportprogress.is_visible=false;a.removeEndReportProgress();}mRe_ReportEventHandler(200);if(a.m_isReportEndFunction!=null){window.setTimeout(a.m_isReportEndFunction,0);}a.m_isEndReportEvent=false;a.debugMeg("report log :: eform 리포트 뷰어 종료!");a.endDebugMeg(false);}else{if(!a.m_isEndReport){if(a.m_endreportprogress.is_visible){a.createEndReportProgress();}}}a.endDebugMeg(true);if(!b){if(a.m_isEFormPageMoveEvent!=null){a.m_isEFormPageMoveEvent();}}if((a.beforePageIndex+1<a.m_pageCount)&&a.m_is_eform_nextPage){a.sendEFormNaxtPageData(a.beforePageIndex+1);}}else{a.debugMeg("report log :: eform 리포트 생성중 오류 발생(export) >>> 서버로그 확인 필요!");a.debugMeg("report log :: eform 리포트 페이지 서버 수신 메시지 >>> "+c[0]);var i=a.m_languageMap.report_error;if(f.event==12){a.debugMeg("report log :: EFORM 사용 권한이 없습니다 (라이센스)");if(a.m_isViewer){i=a.m_languageMap.lic_error+".!! (errorCode : LE0"+f.event+")";mRe_ReportEventHandler(12);}}else{mRe_ReportEventHandler(30);if(f.event==60){i=a.m_languageMap.sesstion_error;mRe_ReportEventHandler(60);a.debugMeg("report log :: eform 리포트서버와의 세션 종료!");}}a.paintDiv.innerHTML=i;a.m_isButtonLock=false;}}catch(d){a.debugMeg("report log :: 서버에서 내려온 결과 메시지 >>> "+h);a.debugMeg("report log :: 서버에서 내려온 메시지 오류 >>> "+d.message);a.paintDiv.innerHTML=a.m_languageMap.report_error;mRe_ReportEventHandler(30);a.m_isButtonLock=false;}a.removeHybridProgress();if(a.m_pageMoveEvent.end!=null){a.m_pageMoveEvent.end();}}function eFormResultText(b,d){var a=objectCall(b);if(typeof a=="string"){a=objectCall(a);}if(null!=a){var c=m_reportHashMap[a.uid];if(null!=c){if(a.status){c.debugMeg("report log :: 저장 성공!");if("save"==d&&c.m_buttonEvent.endSaveButton!=null){c.m_buttonEvent.endSaveButton();}}else{c.debugMeg("report log :: 서버에서 저장중 오류 발생 서버 로그 확인 필요!");}}}mRe_ReportEventHandler(a.event);}function eFormFocusControl(a){a.className+=" eform_control_focus";}function eFormBlurControl(a){var b=a.className;b=b.replace("eform_control_focus","");a.className=b;}function setPath(a,b){a.setAttributeNS(null,"d",b.join(""));}function findPrevControl(c,a){var b=null;for(;a>1;a--){b=c[a];if(!b.controlData.disable&&b.controlData.visible){return false;}}return true;}function findNextControl(c,a){var b=null;a++;for(;a<c.length;a++){b=c[a];if(!b.controlData.disable&&b.controlData.visible){return false;}}return true;}Report.prototype.getProperty=function(a){return this.m_properties[a];};Report.prototype.setProperty=function(a,b){this.m_properties[a]=b;};Report.prototype.newGroup=function(){var a=new EFormGroup();a.init("",this);return a;};Report.prototype.findControl=function(a){var c=this.findGroup(a);if(null!=c){var b=c.getControlList();if(null!=b&&b.length>0){c=b[0];}}return c;};Report.prototype.findControlByID=function(a){var b=null;if(null!=this.eFormControlList){b=this.eFormControlList[a];}return b;};Report.prototype.findGroup=function(a){var b=this.eFormControlGroupList[a];if(null==b){b=new EFormGroup();b.init("",this);}return b;};Report.prototype.findGroupByName=function(b){var c=new EFormGroup();c.init(b,this);for(var a in this.eFormData){if(-1!=this.eFormData[a].id.indexOf(b)){c.appendControl(this.eFormControlList[a]);}}return c;};Report.prototype.findGroupByControlType=function(d){var c=new EFormGroup();c.init("",this);for(var b in this.eFormData){var a=this.eFormData[b];if(d==a.type){c.appendControl(this.eFormControlList[b]);}}return c;};Report.prototype.findGroupByNameAndControlType=function(c,e){var d=new EFormGroup();d.init(c,this);for(var b in this.eFormData){var a=this.eFormData[b];if(e==a.type&&-1!=a.id.indexOf(c)){d.appendControl(this.eFormControlList[b]);}}return d;};function EFormGroup(){this.parent=null;this.groupID=null;this.controlList=null;}EFormGroup.prototype.init=function(a,b){this.parent=b;this.groupID=a;this.controlList=new Array();};EFormGroup.prototype.deleteMe=function(){this.parent=null;this.groupID=null;this.controlList=null;};EFormGroup.prototype.appendControl=function(a){this.controlList.push(a);};EFormGroup.prototype.appendGroup=function(a){if(null!=a.controlList){this.controlList.push.apply(this.controlList,a.controlList);}};EFormGroup.prototype.getGroupId=function(){return this.groupID;};EFormGroup.prototype.setVisible=function(a){var c=this.controlList.length;for(var b=0;b<c;b++){var d=this.controlList[b];d.setVisible(a);}};EFormGroup.prototype.setDisabled=function(c){var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];d.setDisabled(c);}};EFormGroup.prototype.getControlList=function(){return this.controlList;};EFormGroup.prototype.getValueOfControl=function(c){var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if(d.getValue()==c){return d;}}return null;};EFormGroup.prototype.check=function(c){if(typeof c=="undefined"){c=true;}var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if("checkbox"==d.getType()){d.check(c);}}};EFormGroup.prototype.unCheck=function(c){if(typeof c=="undefined"){c=true;}var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if("checkbox"==d.getType()){d.unCheck(c);}}};EFormGroup.prototype.unSelect=function(c){if(typeof c=="undefined"){c=true;}var b=this.controlList.length;for(var a=0;a<b;a++){var d=this.controlList[a];if("radiobox"==d.getType()){d.controlData.checked="false";if("true"==d.controlData.isNecessaryCheck){d.controlData.is_nc=true;}if(d.isDOM){d.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;}d.eform.eFormRadioChecked[d.controlData.id]=null;d.setDisabled(d.controlData.disable);d.onUnSelected(c);}}};EFormGroup.prototype.getRadioValue=function(){var b="";var c=this.controlList.length;for(var a=0;a<c;a++){var d=this.controlList[a];if("radiobox"==d.getType()){if("true"==d.controlData.checked){if(""!=b){b+=" ";}b+=d.controlData.value;}}}return b;};function EFormInput(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.inputElement=null;this.inputElement_div=null;this.inputElement_td=null;this.inputElement_GT=null;this.event={focusEvent:null,blurEvent:null,keyUpEvent:null,requiredGuideEvent:null,changeEvent:null,eventTarget:null};this.title=null;this.isScroll=false;this.is_mousedown=false;this.callKeyboardButton=null;}EFormInput.prototype.setGroup=function(a){this.group=a;};EFormInput.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=unescape(a.value.replace(/\\u/g,"%u"));if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.maxLength){this.controlData.maxLength=0;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isNumber){a.isNumber=false;}if(null==a.isNoWrap){a.isNoWrap=false;}if(null==a.isGuideText){a.isGuideText=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}if(null==a.isFollowText){a.isFollowText=true;}if(null!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.title=this.controlData.title;}if(null==a.format){this.controlData.format="";this.controlData.formatData=this.controlData.value;}else{a.format=a.format.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.formatData=this.controlData.value.formatting(a.format);}};EFormInput.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormInput.prototype.deleteDOM=function(){this.isDOM=false;this.inputElement=null;this.inputElement_div=null;this.inputElement_td=null;this.inputElement_GT=null;};EFormInput.prototype.getHE=function(){if(this.isDOM){return this.inputElement;}return null;};EFormInput.prototype.eventHandlerInput=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.inputElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.inputElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.inputElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");if(this.controlData.isGuideText){this.inputElement_GT=document.getElementById(this.eform.m_uid+this.ctrlID+"GT");}if(null==this.title){this.title=this.inputElement.title;}else{this.inputElement.title=this.title;}var d=this;if(this.controlData.isNumber){if(!is_appControl&&!is_exeControl){var e=this.inputElement.parentElement;var b=document.createElement("input");b.type="number";b.id=this.inputElement.id;b.className=this.inputElement.className;b.tabIndex=this.inputElement.tabIndex;b.style.cssText=this.inputElement.style.cssText;e.insertBefore(b,this.inputElement);e.removeChild(this.inputElement);this.inputElement=b;b.oninput=function(){var f=this.maxLength;if(null!=f&&f>0){if(this.value.length>f){this.value=this.value.slice(0,f);}}};}}else{var c=this.controlData;this.inputElement.onkeyup=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}d.onKeyUp(this);};}this.inputElement.value=this.controlData.value.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}var a=this.controlData.value;this.controlData.formatData=a;if(""!=this.controlData.format){this.controlData.formatData=a.formatting(this.controlData.format);a=this.controlData.formatData;}if(""!=ClipStrTrim(a)){this.controlData.is_nc=false;}else{if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}}if(typeof this.inputElement_td.innerText!=="undefined"){this.inputElement_td.innerText=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.inputElement_td.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}this.inputElement.onblur=function(){d.blurControl(this);d.onBlur();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}};this.inputElement.onfocus=function(){d.focusControl();d.onFocus();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};if(is_appControl||is_exeControl){this.inputElement.readOnly=true;this.inputElement.onclick=function(){d.callHybridInput();return false;};}this.checkKeyEvent();this.setIsScroll(this.isScroll);this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormInput.prototype.callHybridInput=function(){this.eform.inputOrderFoucs(this);if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;}var d=this;var a=null;if(this.eform.multiView.isSocket){a=d.eform.multiView.socket;a.sendScreenLock("key");}window.set_report_input_data=function(f,e){if("next"==f){d.setValue(e);if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}d.eform.nextHybridInputControl(d);}else{if("cencel"==f){d.inputElement.blur();}else{if("ok"==f){d.setValue(e);if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}d.inputElement.blur();}}}if(null!=a){a.sendScreenUnLock();}};var c=new Object();c.id=this.inputElement.id;c.title=this.getTitle();c.guideMsg="";if(this.controlData.isGuideText){if(this.isDOM){c.guideMsg=this.inputElement_GT.value;}}c.type=this.controlData.isNumber?"number":"text";c.maxLength=this.controlData.maxLength;c.text=this.inputElement.value;c.format=this.controlData.format;if(is_appControl){ClipHybrid.callNativeControl("edit",JSON.stringify(c));}else{var b={methodName:"ShowVirtualKeyboard",data:null};b.data=c;window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(b));}if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"in");}};EFormInput.prototype.getCtrlID=function(){return this.ctrlID;};EFormInput.prototype.getType=function(){return this.controlData.type;};EFormInput.prototype.getLabel=function(){return this.controlData.formatData;};EFormInput.prototype.getValue=function(){return this.controlData.value;};EFormInput.prototype.m_default_setValue=function(d,c,e){if(this.controlData.value!=d){this.controlData.value=d;this.controlData.formatData=d;if(this.isDOM){this.inputElement.value=d.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));var b=d;if(""!=this.controlData.format){this.controlData.formatData=d.formatting(this.controlData.format);b=this.controlData.formatData;}if(typeof this.inputElement_td.innerText!=="undefined"){this.inputElement_td.innerText=b.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.inputElement_td.innerHTML=b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\\n/g,"<br />\n");}this.inputElement.scrollTop=0;this.setIsScroll(this.isScroll);if(""!=ClipStrTrim(b)){this.controlData.is_nc=false;if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}else{var b=d;if(""!=this.controlData.format){this.controlData.formatData=d.formatting(this.controlData.format);b=this.controlData.formatData;}if(""!=ClipStrTrim(b)){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}if(this.eform.multiView.isSocket&&e){this.eform.multiView.socket.sendInputValue(this,c);}if(null!=this.event.changeEvent&&c){var a=this;window.setTimeout(function(){a.event.changeEvent();},10);}}};EFormInput.prototype.setValue=function(b,a){if(typeof a=="undefined"){a=true;}this.m_default_setValue(b,a,true);};EFormInput.prototype.getVisible=function(){return this.controlData.visible;};EFormInput.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.inputElement.style.display="";this.inputElement_div.style.display="";this.inputElement_td.style.display="";}else{this.inputElement.style.display="none";this.inputElement_div.style.display="none";this.inputElement_td.style.display="none";}}};EFormInput.prototype.setUseNumberKeyPad=function(b){this.controlData.isNumber=b;if(!is_appControl&&!is_exeControl){return;}if(this.isDOM){var d=this;if(b){if(this.inputElement.tagName.toLocaleLowerCase()=="textarea"){var e=this.inputElement.parentElement;var a=document.createElement("input");a.type="number";a.id=this.inputElement.id;a.className=this.inputElement.className;a.tabIndex=this.inputElement.tabIndex;a.style.cssText=this.inputElement.style.cssText;e.insertBefore(a,this.inputElement);e.removeChild(this.inputElement);this.inputElement=a;a.oninput=function(){var f=this.maxLength;if(null!=f&&f>0){if(this.value.length>f){this.value=this.value.slice(0,f);}}};this.inputElement.value=this.controlData.value;if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}this.inputElement.onblur=function(){d.setValue(this.value);d.onBlur();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}};this.inputElement.onfocus=function(){d.focusControl();d.onFocus();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};}}else{if(this.inputElement.tagName.toLocaleLowerCase()=="input"){var e=this.inputElement.parentElement;var a=document.createElement("textarea");a.id=this.inputElement.id;a.className=this.inputElement.className;a.tabIndex=this.inputElement.tabIndex;a.style.cssText=this.inputElement.style.cssText;e.insertBefore(a,this.inputElement);e.removeChild(this.inputElement);this.inputElement=a;a.oninput=function(){var f=this.maxLength;if(null!=f&&f>0){if(this.value.length>f){this.value=this.value.slice(0,f);}}};this.inputElement.value=this.controlData.value;if(0<this.controlData.maxLength){this.inputElement.maxLength=this.controlData.maxLength;}this.inputElement.onblur=function(){d.setValue(this.value);d.onBlur();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"out");}};this.inputElement.onfocus=function(){d.focusControl();d.onFocus();if(d.eform.multiView.isSocket){d.eform.multiView.socket.sendFocusControl(d,"in");}};var c=this.controlData;this.inputElement.onkeyup=function(){if(c.maxLength>0){this.value=this.value.slice(0,c.maxLength);}d.onKeyUp();};}}}this.checkKeyEvent();};EFormInput.prototype.setUseNoWrap=function(a){this.controlData.isNoWrap=a;this.checkKeyEvent();};EFormInput.prototype.checkKeyEvent=function(){if(this.isDOM){if(this.controlData.isNoWrap||this.controlData.isNumber){this.inputElement.onkeypress=function(a){if(a.keyCode==13){this.blur();return false;}return true;};}else{this.inputElement.onkeypress=null;}}};EFormInput.prototype.getDisabled=function(){return this.controlData.disable;};EFormInput.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.inputElement.disabled=true;this.inputElement_div.className="eF_Rect";}else{this.inputElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormInput.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.formatData){this.controlData.is_nc=false;if(this.isDOM){this.inputElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.inputElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormInput.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormInput.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormInput.prototype.setMaxLength=function(a){this.controlData.maxLength=a;if(this.isDOM&&0<a){this.inputElement.maxLength=a;}};EFormInput.prototype.onChangeEvent=function(a){this.event.changeEvent=a;};EFormInput.prototype.onRequiredGuideEvent=function(a){this.event.requiredGuideEvent=a;};EFormInput.prototype.onKeyUpEvent=function(a){this.event.keyUpEvent=a;};EFormInput.prototype.onFocusEvent=function(a){this.event.focusEvent=a;this.event.eventTarget=this;};EFormInput.prototype.onBlurEvent=function(a){this.event.blurEvent=a;this.event.eventTarget=this;};EFormInput.prototype.getTitle=function(){return this.title;};EFormInput.prototype.setTitle=function(a){this.controlData.title=a;this.title=a;if(this.isDOM){this.inputElement.title=a;}};EFormInput.prototype.getFormat=function(){return this.controlData.format;};EFormInput.prototype.setFormat=function(c){this.controlData.format=c;var b=this.controlData.value;if(this.isDOM){var a=b;if(""!=this.controlData.format){this.controlData.formatData=b.formatting(this.controlData.format);a=this.controlData.formatData;}if(typeof this.inputElement_td.innerText!=="undefined"){this.inputElement_td.innerText=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.inputElement_td.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\\n/g,"<br />\n");}if(""!=ClipStrTrim(a)){this.controlData.is_nc=false;if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){this.inputElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}else{var a=b;if(""!=this.controlData.format){this.controlData.formatData=b.formatting(this.controlData.format);a=this.controlData.formatData;}if(""!=ClipStrTrim(a)){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}};EFormInput.prototype.setIsScroll=function(a){this.isScroll=a;if(this.isDOM){if(a){this.inputElement.style.overflowY="auto";}else{this.inputElement.style.overflowY="hidden";}}};EFormInput.prototype.focus=function(){if(this.isDOM){var a=this.inputElement.focus();}};EFormInput.prototype.onFocus=function(){if(null!=this.event.focusEvent){this.event.focusEvent();}};EFormInput.prototype.onKeyUp=function(a){if(null!=this.event.keyUpEvent){this.event.keyUpEvent(a);}};EFormInput.prototype.blurControl=function(a){this.eform.m_isInputFocus=false;this.eform.m_focusInputDOM=null;var b=false;if(this.controlData.isFollowText&&this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;if(this.controlData.guideText==a.value){this.setValue(a.value);if(""!=this.controlData.formatData){b=true;}}else{this.setValue("");a.value="";if(this.event.requiredGuideEvent!=null){this.event.requiredGuideEvent();}}}else{if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=0;}this.setValue(a.value);if(""!=this.controlData.formatData){b=true;}}this.removeSubCallKeyboardButton();if(!is_appControl&&!is_exeControl&&b){this.eform.nextHybridInputControl(this);}};EFormInput.prototype.onBlur=function(){if(null!=this.event.blurEvent){this.event.blurEvent();}};EFormInput.prototype.focusControl=function(){this.eform.m_isInputFocus=true;if(this.isDOM){this.eform.m_focusInputDOM=this.inputElement;}if(this.controlData.isGuideText){this.inputElement_GT.style.opacity=1;}if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isHybridQuickControl&&(is_appControl||is_exeControl)){this.callHybridInput();if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}};EFormInput.prototype.HybridFocusControl=function(){if(is_appControl||is_exeControl){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendHybridInputFocusControl(this);}this.onFocus();}if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}};EFormInput.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.inputElement.focus();}else{this.inputElement_td.className="eform_control_focus";this.HybridFocusControl();}}}};EFormInput.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.inputElement_td.className="";this.inputElement.blur();}};EFormInput.prototype.createSubCallKeyboardButton=function(){if(this.isDOM&&null==this.callKeyboardButton){var a=this;var b=document.createElement("button");var c=this.inputElement;var d=c.parentElement;b.className="eform_keyboard_call_button";b.style.left=c.offsetLeft+"px";b.style.top=(c.offsetTop+c.offsetHeight+5)+"px";b.innerHTML=this.eform.m_SubInputCallButtonText;b.onmousedown=function(e){if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendHybridInputCallKeyboard(a);}a.removeSubCallKeyboardButton();e.preventDefault();};d.appendChild(b);this.callKeyboardButton=b;}};EFormInput.prototype.removeSubCallKeyboardButton=function(){if(this.isDOM){if(null!=this.callKeyboardButton){try{this.inputElement.parentElement.removeChild(this.callKeyboardButton);}catch(a){}this.callKeyboardButton=null;}}};String.prototype.formatting=function(l){if(""==l){return this;}var a=this;var d="";if(/\((\D+)\)/.test(l)){d=l.substring(l.indexOf("("),l.indexOf(")")+1);l=l.substring(d.length,l.length);}var g="";var m="";if(/\'(\D+)\'/.test(l)){g=l.substring(l.indexOf("'"),l.lastIndexOf("'")+1);l=l.substring(0,l.length-g.length);m=g.substring(1,g.length-1);}if(l.indexOf("9#")){l=l.replace("9#","#");}if("-1"==l.indexOf("#")&&"-1"==l.indexOf("0")){return inputValidateCheck(l,a,d);}else{var o="";var f=l.indexOf(".");var k="-1"!=l.indexOf(",")?1:0;k="-1"!=f?(k+2):k;var c=false;switch(k){case 2:case 3:c=true;break;}if(""!=d){d=d.charAt(1);if(d!=a.charAt(0)){d="";}}var j="";if(-1!=f){while("0"==l.charAt((f+1))){j+="0";f++;}}else{if(-1!=a.indexOf(".")){a=a.substring(0,a.indexOf("."));}}var e=0;a=a.replace(/[^.\d]/g,"");if("9#"!=l){for(var h=0;h<a.length;h++){if("0"!=a.charAt(h)){e=h;if(0!=h&&"."==a.charAt(h)){e--;}break;}}}a=a.substring(e,a.length);switch(k){case 0:o=inputMoneyUnitValidateCheckPattern3(a,l,j);break;case 1:o=inputMoneyUnitValidateCheckPattern2(a,c,j);break;case 2:o=inputMoneyUnitValidateCheckPattern3(a,l,j);break;case 3:if(-1==a.indexOf(".")){o=inputMoneyUnitValidateCheckPattern2(a,c,j);if(""!=j){o+="."+j;}}else{var b=a.indexOf(".");o+=inputMoneyUnitValidateCheckPattern2(a.substring(0,b),c,j);o+=".";var n=inputMoneyUnitValidateCheckPattern1(a.substring(b+1,a.length),j);o+=n;}break;}if(""!=d){o=d+o;}if(null!=m&&""!=m){o+=m;}return o;}};inputMoneyUnitValidateCheckPattern1=function(a,d){var c="";var e=a.length;e=0==d.length?e:d.length;for(var b=0;b<e;b++){if(""!=a.charAt(b)){c+=a.charAt(b);continue;}else{c+="0";}}return c;};inputMoneyUnitValidateCheckPattern2=function(a,b,g){var j="";a=a.replace(/\D/g,"");var e=a.length;var c=e%3;var h=(e/2)-1;var l=0;var f=0;var k=false;for(var d=0;d<e;d++){if(0==d&&a.charCodeAt(d)==48){j=a.charAt(d);}else{if(c==l){if(e>3&&c!=0){j=j+",";k=true;}else{if(e>3){k=true;}}}if(3==f){j=j+",";f=0;}j+=a.charAt(d);l++;if(k){f++;}}}if(""==j&&b&&""!=g){j="0";}return j;};inputMoneyUnitValidateCheckPattern3=function(b,h,e){var d="";b=b.replace(/[^\.\d]/g,"");var g=0==e.length?0:e.length;var f=b.length;for(var c=0;c<f;c++){d+=b.charAt(c);}if(""==d&&"0"==h.replace(/[^\.\d]/g,"").charAt(0)){d="0";}if(-1!=b.indexOf(".")){var a=b.substring(b.indexOf("."),f).length;for(var c=a;c<=g;c++){d+="0";}}else{if(0<g){d+=".";for(var c=0;c<g;c++){d+="0";}}}return d;};formatStatus=function(a){if(""==a){return 0;}var b;if("-1"==a.indexOf("#")&&"-1"==a.indexOf("0")){return 1;}else{b="-1"!=a.indexOf(",")?3:2;b="-1"!=a.indexOf(".")?(b+2):b;return b;}};inputValidateCheck=function(h,a,c){var j="";var b="";var d=0;var g=0;var e=h.length;if(""!=c){c=c.charAt(1);if(c!=a.charAt(0)){c="";}}reSpecialChar=/\s/g;a=a.replace(reSpecialChar,"");if(-1==h.indexOf("@")){reSpecialChar=/\W/g;a=a.replace(reSpecialChar,"");}for(var f=0;f<e;f++){if(d!=e&&""!=a.charAt(g)){if("9"!=h.charAt(d)&&"y"!=h.charAt(d)&&"m"!=h.charAt(d)&&"d"!=h.charAt(d)&&"h"!=h.charAt(d)&&"n"!=h.charAt(d)&&"s"!=h.charAt(d)&&"A"!=h.charAt(d)&&"a"!=h.charAt(d)&&"C"!=h.charAt(d)&&"L"!=h.charAt(d)&&"*"!=h.charAt(d)&&"@"!=h.charAt(d)){j=j+h.charAt(d);d++;}else{for(;g<a.length;g++){b=validateFormat(d,a.charAt(g),h,a);if(""!=b){j=j+b;g++;if("9"!=h.charAt(d+1)&&"y"!=h.charAt(d+1)&&"m"!=h.charAt(d+1)&&"d"!=h.charAt(d+1)&&"h"!=h.charAt(d+1)&&"n"!=h.charAt(d+1)&&"s"!=h.charAt(d+1)&&"A"!=h.charAt(d+1)&&"a"!=h.charAt(d+1)&&"C"!=h.charAt(d+1)&&"L"!=h.charAt(d+1)&&"*"!=h.charAt(d+1)&&"@"!=h.charAt(d+1)){j=j+h.charAt(d+1);d++;}break;}}d++;}}}if(""!=c){j=c+j;}return j;};validateFormat=function(a,e,c,b){var d=e.charCodeAt(0);switch(c.charAt(a)){case"@":return e;case"*":return"*";case"9":if(d>=48&&d<=57){return String.fromCharCode(d);}return"";case"y":if(d>=48&&d<=57){return String.fromCharCode(d);}return"";case"m":if("m"==c.charAt(a+1)){if(d>=48&&d<=49){return String.fromCharCode(d);}}else{if("m"==c.charAt(a-1)&&"1"==b.charAt(a-1)){if(d>=48&&d<=50){return String.fromCharCode(d);}}else{if(d>=48&&d<=57){return String.fromCharCode(d);}}}return"";case"d":if("d"==c.charAt(a+1)){if("m"==c.charAt(a-2)&&"2"==b.charAt(a-2)&&(("m"==c.charAt(a-3)&&"0"==b.charAt(a-3))||"m"!=c.charAt(a-3))){if(d>=48&&d<=50){return String.fromCharCode(d);}}else{if(d>=48&&d<=51){return String.fromCharCode(d);}}}else{if("d"==c.charAt(a-1)&&"3"!=b.charAt(a-1)){if(d>=48&&d<=57){return String.fromCharCode(d);}}else{if("d"==c.charAt(a-1)&&"3"==b.charAt(a-1)){if(d>=48&&d<=49){return String.fromCharCode(d);}}else{if(d>=48&&d<=57){return String.fromCharCode(d);}}}}return"";case"h":if("h"==c.charAt(a+1)){if(d>=48&&d<=50){return String.fromCharCode(d);}}else{if("h"==c.charAt(a-1)&&"2"==b.charAt(a-1)){if(d>=48&&d<=52){return String.fromCharCode(d);}}else{if(d>=48&&d<=57){return String.fromCharCode(d);}}}return"";case"n":if("n"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d);}}else{if(d>=48&&d<=57){return String.fromCharCode(d);}}return"";case"s":if("s"==c.charAt(a+1)){if(d>=48&&d<=53){return String.fromCharCode(d);}}else{if(d>=48&&d<=57){return String.fromCharCode(d);}}return"";case"A":if((d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e;}return"";case"a":if((d==32)||(d>=48&&d<=57)||(d>=65&&d<=90)||(d>=97&&d<=129)){return e;}return"";case"C":if((d>=48&&d<=112)||d>185||(d>=97&&d<=129)){return e;}return"";case"L":if((d>=65&&d<=90)||(d>=97&&d<=129)){return e;}return"";default:return"";}};function EFormCheckbox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.event={checkedEvent:null,unCheckedEvent:null,eventTarget:null};this.title=null;}EFormCheckbox.prototype.setGroup=function(a){this.group=a;};EFormCheckbox.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}};EFormCheckbox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormCheckbox.prototype.deleteDOM=function(){this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;};EFormCheckbox.prototype.getHE=function(){if(this.isDOM){return this.checkElement;}return null;};EFormCheckbox.prototype.eventHandlerInputCheckbox=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.checkElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.checkElement_img=document.getElementById(this.eform.m_uid+this.ctrlID+"IMG");this.checkElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"DIV");this.checkElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.checkElement.title;}else{this.checkElement.title=this.title;this.checkElement.innerHTML=this.title;}if(null==this.controlData.isNValue&&this.controlData.isNecessaryCheck=="true"){this.controlData.isNValue=true;if("true"==this.controlData.checked){this.controlData.is_nc=false;}}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){if("true"!=this.controlData.checked){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}if("true"==this.controlData.checked){if("check"==this.controlData.imageType){this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormCheckImage;}else{this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormRadioImage;}}else{this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;}var a=this;this.checkElement.onmousedown=function(b){this.focus();if("true"==a.controlData.checked){a.unCheck(true);}else{a.check(true);}b.preventDefault();};this.checkElement.onkeyup=function(b){if(32==b.keyCode||13==b.keyCode){this.focus();if("true"==a.controlData.checked){a.unCheck(true);}else{a.check(true);}b.preventDefault();}};if(null!=this.checkElement_focusDiv){this.checkElement.onblur=function(){if(null!=a.checkElement_focusDiv){a.checkElement_focusDiv.className="eF_Rect";if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"out");}}};this.checkElement.onfocus=function(){a.focusControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"in");}};}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormCheckbox.prototype.getCtrlID=function(){return this.ctrlID;};EFormCheckbox.prototype.getType=function(){return this.controlData.type;};EFormCheckbox.prototype.unCheck=function(a){if(typeof a=="undefined"){a=true;}if(!this.isChecked()){return;}this.m_default_unCheck(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCheckbox(this,"unCheck",a);}};EFormCheckbox.prototype.m_default_unCheck=function(a){if(this.isDOM){this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;}this.controlData.checked="false";if(this.controlData.isNValue){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){if(this.isDOM){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}this.requiredUnCheckInGroup();this.onUnChecked(a);};EFormCheckbox.prototype.requiredUnCheckInGroup=function(){var b=false;var e=new Object();for(var d in this.eform.eFormData){var c=this.eform.eFormData[d];if(this.controlData.id==c.id){if(c.checked=="true"){b=true;}e[d]=c;}}for(var a in e){var c=e[a];if(c.requiredCheckInGroup){if(c.isNecessaryCheck=="true"){if(b){c.is_nc=false;if(c.isNValue){var f=this.eform.eFormControlList[a];if(f.isDOM){f.checkElement_div.className="eF_Rect";}}}else{c.is_nc=true;if(c.isNValue){if(this.eform.eForm_isNecessary.check){var f=this.eform.eFormControlList[a];if(f.isDOM){f.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}}}}};EFormCheckbox.prototype.check=function(a){if(typeof a=="undefined"){a=true;}if(this.isChecked()){return;}this.m_default_check(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCheckbox(this,"check",a);}this.eform.nextHybridInputControl(this);};EFormCheckbox.prototype.focus=function(){if(this.isDOM){var a=this.checkElement;setTimeout(function(){a.focus();},1);}};EFormCheckbox.prototype.m_default_check=function(a){if(this.isDOM){if("check"==this.controlData.imageType){this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormCheckImage;}else{this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormRadioImage;}}this.controlData.checked="true";this.controlData.is_nc=false;if(this.controlData.isNValue){if(this.isDOM){this.checkElement_div.className="eF_Rect";}}this.requiredCheckInGroup();this.onChecked(a);};EFormCheckbox.prototype.requiredCheckInGroup=function(){for(var b in this.eform.eFormData){var a=this.eform.eFormData[b];if(this.controlData.id==a.id&&a.requiredCheckInGroup){a.is_nc=false;if(a.isNValue){var c=this.eform.eFormControlList[b];if(c.isDOM){c.checkElement_div.className="eF_Rect";}}}}};EFormCheckbox.prototype.isChecked=function(){return this.controlData.checked=="true";};EFormCheckbox.prototype.getValue=function(){return this.controlData.value;};EFormCheckbox.prototype.getVisible=function(){return this.controlData.visible;};EFormCheckbox.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.checkElement.style.display="";this.checkElement_img.style.display="";this.checkElement_div.style.display="";this.checkElement_focusDiv.style.display="";}else{this.checkElement.style.display="none";this.checkElement_img.style.display="none";this.checkElement_div.style.display="none";this.checkElement_focusDiv.style.display="none";}}};EFormCheckbox.prototype.getDisabled=function(){return this.controlData.disable;};EFormCheckbox.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.checkElement.disabled=true;this.checkElement_div.className="eF_Rect";}else{this.checkElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormCheckbox.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNValue=true;this.controlData.isNecessaryCheck="true";if("true"==this.controlData.checked){this.controlData.is_nc=false;if(this.isDOM){this.checkElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;this.requiredUnCheckInGroup();}}else{this.controlData.isNValue=false;this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.checkElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormCheckbox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormCheckbox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormCheckbox.prototype.onUnCheckedEvent=function(a){this.event.unCheckedEvent=a;this.event.eventTarget=this;};EFormCheckbox.prototype.onCheckedEvent=function(a){this.event.checkedEvent=a;this.event.eventTarget=this;};EFormCheckbox.prototype.getTitle=function(){return this.title;};EFormCheckbox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.checkElement.title=a;this.checkElement.innerHTML=a;}};EFormCheckbox.prototype.onUnChecked=function(b){if(null!=this.event.unCheckedEvent&&b){var a=this;window.setTimeout(function(){a.event.unCheckedEvent();},10);}};EFormCheckbox.prototype.onChecked=function(b){if(null!=this.event.checkedEvent&&b){var a=this;window.setTimeout(function(){a.event.checkedEvent();},10);}};EFormCheckbox.prototype.focusControl=function(){this.checkElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormCheckbox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.checkElement.focus();}else{this.checkElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormCheckbox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.checkElement_focusDiv.className="eF_Rect";}};function EFormRadiobox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;this.event={selectedEvent:null,unSelectedEvent:null,eventTarget:null};this.title=null;}EFormRadiobox.prototype.setGroup=function(a){this.group=a;};EFormRadiobox.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}};EFormRadiobox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormRadiobox.prototype.deleteDOM=function(){this.isDOM=false;this.checkElement=null;this.checkElement_img=null;this.checkElement_div=null;this.checkElement_focusDiv=null;};EFormRadiobox.prototype.getHE=function(){if(this.isDOM){return this.checkElement;}return null;};EFormRadiobox.prototype.eventHandlerInputRadiobox=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.checkElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.checkElement_img=document.getElementById(this.eform.m_uid+this.ctrlID+"IMG");this.checkElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"DIV");this.checkElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;if(null==this.title){this.title=this.checkElement.title;}else{this.checkElement.title=this.title;this.checkElement.innerHTML=this.title;}var a=this.eform.eFormRadioChecked[this.controlData.id];if(this.eform.eForm_isNecessary.check&&null==a&&"true"==this.controlData.isNecessaryCheck){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}var b=this;if(null!=a&&this.ctrlID!=a){this.controlData.checked="false";this.controlData.is_nc=false;}else{if("true"==this.controlData.checked){if("check"==this.controlData.imageType){this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormCheckImage;}else{this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormRadioImage;}this.eform.eFormRadioChecked[this.controlData.id]=this.ctrlID;this.controlData.is_nc=false;}}this.checkElement.onmousedown=function(c){this.focus();b.select(true);c.preventDefault();};this.checkElement.onkeyup=function(c){if(32==c.keyCode||13==c.keyCode){this.focus();b.select(true);c.preventDefault();}};if(null!=this.checkElement_focusDiv){this.checkElement.onblur=function(){if(null!=b.checkElement_focusDiv){b.checkElement_focusDiv.className="eF_Rect";if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"out");}}};this.checkElement.onfocus=function(){b.focusControl();if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"in");}};}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormRadiobox.prototype.isSelected=function(){return this.controlData.checked=="true";};EFormRadiobox.prototype.select=function(a){if(typeof a=="undefined"){a=true;}if(this.isSelected()){this.eform.nextHybridInputControl(this);return;}this.m_default_select(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputRadiobox(this,a);}this.eform.nextHybridInputControl(this);};EFormRadiobox.prototype.m_default_select=function(a){if("false"==this.controlData.checked){if(this.isDOM){if("check"==this.controlData.imageType){this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormCheckImage;}else{this.checkElement_img.src="data:image/png;base64,"+this.eform.eFormRadioImage;}}this.controlData.checked="true";this.controlData.is_nc=false;if(this.isDOM){this.checkElement_div.className="eF_Rect";}this.eform.eFormRadioChecked[this.controlData.id]=this.ctrlID;this.onSelected(a);}this.findUnCheckRadio(a);};EFormRadiobox.prototype.findUnCheckRadio=function(d){var b=this.group.getControlList();for(var a=0;a<b.length;a++){if(this!=b[a]){var c=b[a];c.controlData.checked="false";c.controlData.is_nc=false;if(null!=c.checkElement_img&&null!=c.checkElement_div){c.checkElement_img.src="data:image/png;base64,"+mRe_blankImg;c.checkElement_div.className="eF_Rect";}c.onUnSelected(d);}}};EFormRadiobox.prototype.getCtrlID=function(){return this.ctrlID;};EFormRadiobox.prototype.getType=function(){return this.controlData.type;};EFormRadiobox.prototype.getValue=function(){return this.controlData.value;};EFormRadiobox.prototype.getVisible=function(){return this.controlData.visible;};EFormRadiobox.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.checkElement.style.display="";this.checkElement_img.style.display="";this.checkElement_div.style.display="";this.checkElement_focusDiv.style.display="";}else{this.checkElement.style.display="none";this.checkElement_img.style.display="none";this.checkElement_div.style.display="none";this.checkElement_focusDiv.style.display="none";}}};EFormRadiobox.prototype.getDisabled=function(){return this.controlData.disable;};EFormRadiobox.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.checkElement.disabled=true;this.checkElement_div.className="eF_Rect";}else{this.checkElement.disabled=false;if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.checkElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormRadiobox.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(null!=this.eform.eFormRadioChecked[this.controlData.id]){this.controlData.is_nc=false;if(this.isDOM){this.checkElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.checkElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormRadiobox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormRadiobox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormRadiobox.prototype.onUnSelectedEvent=function(a){this.event.unSelectedEvent=a;this.event.eventTarget=this;};EFormRadiobox.prototype.onSelectedEvent=function(a){this.event.selectedEvent=a;this.event.eventTarget=this;};EFormRadiobox.prototype.getTitle=function(){return this.title;};EFormRadiobox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.checkElement.title=a;this.checkElement.innerHTML=a;}};EFormRadiobox.prototype.focus=function(){if(this.isDOM){var a=this.checkElement;setTimeout(function(){a.focus();},1);}};EFormRadiobox.prototype.onUnSelected=function(b){if(null!=this.event.unSelectedEvent&&b){var a=this;window.setTimeout(function(){a.event.unSelectedEvent();},10);}};EFormRadiobox.prototype.onSelected=function(b){if(null!=this.event.selectedEvent&&b){var a=this;window.setTimeout(function(){a.event.selectedEvent();},10);}};EFormRadiobox.prototype.focusControl=function(){this.checkElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormRadiobox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.checkElement.focus();}else{this.checkElement_focusDiv.className="eF_Rect eform_control_focus";if(this.m_isHybridQuickControl&&typeof ClipHybrid!="undefined"){if(null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}}}}}};EFormRadiobox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.checkElement_focusDiv.className="eF_Rect";}};function EFormImage(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.imageElement=null;this.imageElement_canas=null;this.imageElement_guideSpan=null;this.imageElement_focusDiv=null;this.imageElemnet_camera=null;this.event={clickEvent:null,eventTarget:null};this.title=null;}EFormImage.prototype.setGroup=function(a){this.group=a;};EFormImage.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}};EFormImage.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormImage.prototype.deleteDOM=function(){this.isDOM=false;this.imageElement=null;this.imageElement_canas=null;this.imageElement_guideSpan=null;this.imageElement_focusDiv=null;};EFormImage.prototype.getHE=function(){if(this.isDOM){return this.imageElement;}return null;};EFormImage.prototype.eventHandlerImage=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.imageElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.imageElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.imageElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.imageElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");this.imageElemnet_camera=null;if(null==this.title){this.title=this.imageElement.title;}else{this.imageElement.title=this.title;this.imageElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(""!=this.controlData.image){drawReportImage(this.imageElement_canas,this.controlData);}var a=this;if(null!=this.imageElement_focusDiv&&null!=this.imageElement){this.imageElement.onblur=function(){var b=a.imageElement_focusDiv;if(null!=b){b.className="eF_Rect";}if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"out");}};this.imageElement.onfocus=function(){a.focusControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"in");}};}this.imageElement.onmousedown=function(b){a.onClick();};this.imageElement.onkeyup=function(b){if(32==b.keyCode||13==b.keyCode){a.onClick();}};this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormImage.prototype.getCtrlID=function(){return this.ctrlID;};EFormImage.prototype.getType=function(){return this.controlData.type;};EFormImage.prototype.getVisible=function(){return this.controlData.visible;};EFormImage.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.imageElement.style.display="";this.imageElement_canas.style.display="";this.imageElement_guideSpan.style.display="";this.imageElement_focusDiv.style.display="";}else{this.imageElement.style.display="none";this.imageElement_canas.style.display="none";this.imageElement_guideSpan.style.display="none";this.imageElement_focusDiv.style.display="none";}}};EFormImage.prototype.getDisabled=function(){return this.controlData.disable;};EFormImage.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.imageElement.disabled=true;this.imageElement_guideSpan.className="eF_Rect";}else{this.imageElement.disabled=false;if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}}}};EFormImage.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormImage.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormImage.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;if(this.isDOM){this.imageElement_guideSpan.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.imageElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormImage.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputImage(this,a);}};EFormImage.prototype.m_default_setValue=function(b,a){if(""==b&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.isDOM){this.controlData.image=b;drawReportImage(this.imageElement_canas,this.controlData,a);if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.imageElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.imageElement_guideSpan.className="eF_Rect";}}else{this.imageElement_guideSpan.className="eF_Rect";}}};EFormImage.prototype.setSendCameraImgValue=function(){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputImage(this,this.controlData.image);}};EFormImage.prototype.setCameraImgValue=function(a){this.controlData.is_nc=false;if(this.isDOM){if(-1==a.indexOf("base64,")){a="data:image/png;base64,"+a;}drawReportImageSetData(this,this.imageElement_canas,this.controlData,a);this.imageElement_guideSpan.className="eF_Rect";}};EFormImage.prototype.callInappCamera=function(){var a=this;window.set_report_inapp_data=function(c){a.setValue(c);};if(typeof ClipHybrid!="undefined"){ClipHybrid.getCameraPicture("",this.imageElement.offsetWidth,this.imageElement.offsetHeight);}else{ReportWebLog("Not Found InappCamera !!");if(this.imageElemnet_camera!=null){this.imageElemnet_camera.click();}else{var b=document.createElement("input");b.tabIndex=-1;b.style.cssText="display:none";b.type="file";b.setAttribute("accept","image/*");b.setAttribute("capture","camera");this.imageElement.parentElement.appendChild(b);b.onchange=function(){var c=new FileReader();var d=this.files[0];c.addEventListener("load",function(){a.setCameraImgValue(c.result);},false);if(d){c.readAsDataURL(d);}};this.imageElemnet_camera=b;b.click();}}};EFormImage.prototype.callInappSealStamp=function(){var b=this;window.set_report_inapp_data=function(c){b.m_default_setValue(c,true);};if(typeof ClipHybrid!="undefined"){var a=new Object();a.width=this.imageElement.offsetWidth;a.height=this.imageElement.offsetHeight;ClipHybrid.callNativeControl("sealStamp",JSON.stringify(a));}};EFormImage.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormImage.prototype.getTitle=function(){return this.title;};EFormImage.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.imageElement.title=a;this.imageElement.innerHTML=a;}};EFormImage.prototype.onClick=function(){if(null!=this.event.clickEvent){var a=this.event.clickEvent();if(true==a){return a;}}return false;};EFormImage.prototype.focusControl=function(){this.imageElement_focusDiv.className="eF_Rect eform_control_focus";if(null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormImage.prototype.focus=function(){if(this.isDOM){var a=this.imageElement;setTimeout(function(){a.focus();},1);}};EFormImage.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.imageElement.focus();}else{this.imageElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormImage.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.imageElement_focusDiv.className="eF_Rect";}};function drawReportImage(b,a,c){var d="jpeg";if(c){d="png";}if(""==a.image){b.src="data:image/"+d+";base64,"+mRe_blankImg;}else{b.src="data:image/"+d+";base64,"+a.image;}}function drawReportImageSetData(b,d,a,h){var g=document.createElement("canvas");var f=d.clientWidth;var c=d.clientHeight;var e=g.getContext("2d");e.clearRect(0,0,f,c);e.Re_image=d;d.onload=function(){var k=document.createElement("canvas");k.width=d.width;k.height=d.height;var j=k.getContext("2d");j.drawImage(this,0,0,d.width,d.height);resample_single(k,f,c,g);var i=g.toDataURL("image/jpeg",1);i=i.substring(i.indexOf("base64,")+7,i.length);a.image=i;e.Re_image=null;k=null;b.setSendCameraImgValue();};d.src=h;}function resample_single(k,a,d,p){var P=k.width;var F=k.height;a=Math.round(a);d=Math.round(d);var C=P/a;var I=F/d;var e=Math.ceil(C/2);var v=Math.ceil(I/2);var z=k.getContext("2d");var l=z.getImageData(0,0,P,F);var u=z.createImageData(a,d);var O=l.data;var K=u.data;for(var M=0;M<d;M++){for(var N=0;N<a;N++){var s=(N+M*a)*4;var J=0;var L=0;var E=0;var m=0;var r=0;var x=0;var y=0;var b=(M+0.5)*I;var q=Math.floor(M*I);var h=Math.ceil((M+1)*I);for(var o=q;o<h;o++){var f=Math.abs(b-(o+0.5))/v;var c=(N+0.5)*C;var G=f*f;var n=Math.floor(N*C);var D=Math.ceil((N+1)*C);for(var B=n;B<D;B++){var g=Math.abs(c-(B+0.5))/e;var H=Math.sqrt(G+g*g);if(H>=1){continue;}J=2*H*H*H-3*H*H+1;var t=4*(B+o*P);y+=J*O[t+3];E+=J;if(O[t+3]<255){J=J*O[t+3]/250;}m+=J*O[t];r+=J*O[t+1];x+=J*O[t+2];L+=J;}}K[s]=m/L;K[s+1]=r/L;K[s+2]=x/L;K[s+3]=y/E;}}z.clearRect(0,0,P,F);p.width=a;p.height=d;var A=p.getContext("2d");A.putImageData(u,0,0);}var mRe_sign=null;var mRe_calendar=null;var mRe_selectbox=null;var mRe_splitMap=null;var mRe_mirraringData=null;if(window.addEventListener){window.addEventListener("resize",function(){if(is_smartphone){if(null!=mRe_sign){var c=mRe_sign.eform;var e=mRe_sign.jSign.jSignature("getData").split("base64,")[1];var b=mRe_sign.move_count;if(c.isSyncSignView){c.eFormSyncSignCencelButton();mRe_sign={image:null,move_count:0};mRe_sign.move_count=b;mRe_sign.image=e;if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendSyncSignResize(c);}c.eFormSyncSignControl();}else{mRe_sign.cencelButton.click();mRe_sign={image:null,move_count:0};mRe_sign.move_count=b;mRe_sign.image=e;c.eFormSignControl();}}if(null!=mRe_pallet){var c=mRe_pallet;c.removePalletDoodle();c.palletDoodle();c=null;}}if(null!=mRe_calendar){var d=mRe_calendar;d.reSize();d=null;}if(null!=mRe_selectbox){var a=mRe_selectbox;a.reSize();a=null;}},false);}function EFormSign(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_guideInput=null;this.signElement_focusDiv=null;this.event={clickEvent:null,okButtonEvent:null,cencelButtonEvent:null,eventTarget:null};this.title=null;this.isSyncSignView=false;}EFormSign.prototype.setGroup=function(a){this.group=a;};EFormSign.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(""!=a.guideMessage){this.controlData.guideMessage=a.guideMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(this.eform.multiView.isSocket){this.isSyncSignView=true;}};EFormSign.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSign.prototype.deleteDOM=function(){this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_focusDiv=null;};EFormSign.prototype.getHE=function(){if(this.isDOM){return this.signElement;}return null;};EFormSign.prototype.eventHandlerSign=function(){this.isDOM=true;this.signElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.signElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.signElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.signElement_guideInput=document.getElementById(this.eform.m_uid+this.ctrlID+"GuideInput");this.signElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.signElement.title;}else{this.signElement.title=this.title;this.signElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}if(null!=this.signElement_canas){this.signElement_canas.width=this.controlData.width;this.signElement_canas.height=this.controlData.height;}if(""!=this.controlData.value){drawReportSign(this.signElement_canas,this.controlData);}var b=this;if(null!=this.signElement_focusDiv&&null!=this.signElement){this.signElement.onblur=function(){var c=b.signElement_focusDiv;if(null!=c){c.className="eF_Rect";}if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"out");}};this.signElement.onfocus=function(){b.focusControl();if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendFocusControl(b,"in");}};}this.signElement.onmousedown=function(){if(b.onClick()!=false){if(b.controlData.isDirectSign){b.focusControl();b.eFormDirectSignControl();}else{if(b.isSyncSignView){b.eFormSyncSignControl();if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendSyncSignView(b);}}else{b.eFormSignControl();}}}};this.signElement.onkeyup=function(c){if(32==c.keyCode){if(b.onClick()!=false){if(b.controlData.isDirectSign){b.focusControl();b.eFormDirectSignControl();}else{if(b.isSyncSignView){b.eFormSyncSignControl();if(b.eform.multiView.isSocket){b.eform.multiView.socket.sendSyncSignView(b);}}else{b.eFormSignControl();}}}}};if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var a=this.signElement_guideInput.lastChild.lastChild.lastChild.lastChild;if(typeof a.textContent!=="undefined"){a.textContent=this.controlData.guideMessage;}else{a.innerText=this.controlData.guideMessage;}}this.signElement_guideInput.style.fontFamily=this.controlData.fontName;this.signElement_guideInput.style.fontSize=this.controlData.fontSize;this.signElement_guideInput.style.color=this.controlData.fontColor;this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSign.prototype.eFormDirectSignControl=function(){var f=this;var n=this.eform;var c=this.signElement.parentElement;var i=is_edge?this.signElement.offsetLeft/n.eFormDoodleOption.zoomIn:this.signElement.offsetLeft;var l=is_edge?this.signElement.offsetTop/n.eFormDoodleOption.zoomIn:this.signElement.offsetTop;var p=this.signElement.offsetWidth;var o=this.signElement.offsetHeight;var a=document.createElement("div");a.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;opacity: 0;background-color:#FFF;z-index:200";var g=document.createElement("div");g.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;z-index:200";var b=document.createElement("div");b.style.position="absolute";b.style.left=i+"px";b.style.top=l+"px";b.style.width=p+"px";b.style.height=o+"px";b.style.zIndex="200";var q=document.createElement("div");q.style.position="absolute";q.style.left=(i+3)+"px";q.style.top=(l+o+3)+"px";q.style.width=p+"px";var r=document.createElement("button");r.id=n.m_uid+"okUBT";r.className="eform_sign_button_in eform_sign_save";r.innerHTML=n.m_languageMap.save;var h=document.createElement("button");h.className="eform_sign_button_in eform_sign_reset";h.innerHTML=n.m_languageMap.reset;var k=document.createElement("button");k.className="eform_sign_button_in eform_sign_cancel";k.innerHTML=n.m_languageMap.cancel;q.appendChild(r);q.appendChild(h);q.appendChild(k);g.appendChild(b);g.appendChild(q);c.appendChild(a);c.appendChild(g);if(!is_smartphone){r.focus();r.onkeydown=function(s){if(s.keyCode==9){k.click();}};}var e=this.controlData;e.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);this.signElement_guideInput.style.visibility="visible";var j=$(b);j.jSignature({"decor-color":"transparent",lineWidth:(e.penWidth*2),color:e.penColor,width:(p*2),height:(o*2),cssclass:"eform_sign_canvas_in",imageData:e.image});if(is_smartphone){j.bind("touchstart",function(s){e.po.is_down=true;});j.bind("touchmove",function(s){if(e.po.is_down||e.po.move_count>0){e.po.move_count++;}});}else{j.bind("mousedown",function(s){e.po.is_down=true;});j.bind("mousemove",function(s){if(e.po.is_down){e.po.move_count++;}});}j.bind("change",function(s){e.po.is_down=false;if(!is_smartphone){r.focus();}});h.onclick=function(s){j.jSignature("reset");e.po={is_down:false,move_count:0,reset:true};if(!is_smartphone){r.focus();}if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};var m=this.signElement_guideSpan;k.onclick=function(s){if(e.is_nc){if(n.eForm_isNecessary.check&&e.isNecessaryCheck=="true"){m.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,e);c.removeChild(a);c.removeChild(g);if(e.showDisplayTextInDialog){f.signElement_guideInput.style.visibility="visible";}else{f.signElement_guideInput.style.visibility="hidden";}if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendInputSignUnLock(f);}f.signElement.focus();f.onCencelButton();if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};b.onmousedown=b.onclick=function(s){if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};if(is_smartphone){g.onclick=function(s){r.click();};}r.onclick=function(s){if(e.po.move_count>n.m_signMoveCount){e.is_nc=false;}else{if(e.po.move_count!=0&&e.isNecessaryCheck=="true"){e.is_nc=true;}}if(((e.po.move_count==0&&e.po.reset)||e.po.move_count==0&&""==e.image)&&e.isNecessaryCheck=="true"){e.image="";e.is_nc=true;}else{var t=j.jSignature("getData").split("base64,")[1];e.image=t;drawReportSign(d,e);}if(e.is_nc){if(n.eForm_isNecessary.check&&e.isNecessaryCheck=="true"){m.className="eF_Rect eForm_NecessaryCheck";}}else{m.className="eF_Rect";}c.removeChild(a);c.removeChild(g);if(e.showDisplayTextInDialog){f.signElement_guideInput.style.visibility="visible";}else{f.signElement_guideInput.style.visibility="hidden";}f.setSendValue(e.image);if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendInputSignUnLock(f);}f.signElement.focus();f.onOkButton();if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}if(!e.is_nc){f.eform.nextHybridInputControl(f);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}};EFormSign.prototype.eFormSignControl=function(){var g=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={image:null,move_count:0};}var z=this.eform;mRe_sign.report=z;mRe_sign.eform=this;z.disabledMenu(true);var l;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var B=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*B;}if(this.controlData.height<this.controlData.width){var B=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*B;}}var r=(z.paintDiv.offsetWidth-(this.controlData.width+50));var c=(z.paintDiv.offsetHeight-(this.controlData.height+110));if(r<c){l=z.paintDiv.offsetWidth/(this.controlData.width+150);}else{l=z.paintDiv.offsetHeight/(this.controlData.height+210);}var w=this.signElement.offsetWidth;var e=this.signElement.offsetHeight;var x=this.controlData.width*l;var v=this.controlData.height*l;var k=(z.paintDiv.offsetWidth-(x+50))/2;if(k<20){l=l*0.9;x=this.controlData.width*l;v=this.controlData.height*l;k=(z.paintDiv.offsetWidth-(x+50))/2;}var j=(z.paintDiv.offsetHeight-(v+110))/2;if(j<0){j=0;}l=(x+50)/400;var o=x/w;var p=document.createElement("div");if(is_smartphone){p.className="m_eform_sign_background";}else{p.className="eform_sign_background";}var u=p.cloneNode(true);u.style.cssText="opacity: 0;background-color:#FFF;";var q=document.createElement("div");mRe_sign.signPaintDiv=q;if(z.m_signOption.staticPos){q.style.cssText="position:absolute;left:"+z.m_signOption.staticLeft+";top:"+z.m_signOption.staticTop+";width:"+(x+50)+"px;height:"+(v+110)+"px;";}else{q.style.cssText="position:absolute;left:"+(k+z.m_signOption.offsetLeft)+"px;top:"+(j+z.m_signOption.offsetTop)+"px;width:"+(x+50)+"px;height:"+(v+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}q.className="eform_sign_div";var m=document.createElement("div");m.className="eform_sign_title";m.innerHTML=this.controlData.title;var a=document.createElement("div");a.className="eform_sign_menu";var E=document.createElement("button");mRe_sign.okButton=E;E.className="eform_sign_button eform_sign_save";E.style.zoom=l<1?l:1;E.innerHTML=z.m_languageMap.save;var n=document.createElement("button");mRe_sign.resetButton=n;n.className="eform_sign_button eform_sign_reset";n.style.zoom=l<1?l:1;n.innerHTML=z.m_languageMap.reset;var t=document.createElement("button");mRe_sign.cencelButton=t;t.className="eform_sign_button eform_sign_cancel";t.style.zoom=l<1?l:1;t.innerHTML=z.m_languageMap.cancel;var C=document.createElement("span");C.innerHTML="&nbsp;&nbsp;";a.appendChild(E);a.appendChild(C.cloneNode(true));a.appendChild(n);a.appendChild(C.cloneNode(true));a.appendChild(t);Re_zoom.isPop=true;var i=document.createElement("div");i.className="eform_sign_paint";i.style.overflow="hidden";var D=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=D;D.className="eform_sign_paint_guide";var h="border:0px none !important;left:0px;top:0px;width:"+w+"px;height:"+e+"px;";if(is_firefox){h+="transform: scale("+o+");transform-origin: left top 0;";}else{h+="zoom:"+o+";";}D.style.cssText=h;if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==D.tagName){D.value=this.controlData.guideMessage;}else{var b=D.lastChild.lastChild.lastChild.lastChild;if(typeof b.textContent!=="undefined"){b.textContent=this.controlData.guideMessage;}else{b.innerText=this.controlData.guideMessage;}}}D.style.fontFamily=this.controlData.fontName;D.style.fontSize=this.controlData.fontSize;D.style.color=this.controlData.fontColor;i.appendChild(D);q.appendChild(m);q.appendChild(a);q.appendChild(i);p.appendChild(q);z.targetDiv.appendChild(u);z.targetDiv.appendChild(p);E.focus();E.onkeydown=function(F){if(F.keyCode==9){t.click();}};z.signPaintDiv=p;var f=this.controlData;f.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}var A=null;if(null!=mRe_sign.image){A=mRe_sign.image;f.po.move_count=mRe_sign.move_count;mRe_sign.image=null;}else{A=f.image;}var s=$(i);mRe_sign.jSign=s;s.jSignature({"decor-color":"transparent",lineWidth:(f.penWidth*o),color:f.penColor,width:"100%",height:"100%",cssclass:"eform_sign_canvas",imageData:A});if(is_smartphone){s.bind("touchstart",function(F){f.po.is_down=true;});s.bind("touchmove",function(F){if(f.po.is_down||f.po.move_count>0){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}else{s.bind("mousedown",function(F){f.po.is_down=true;});s.bind("mousemove",function(F){if(f.po.is_down){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}s.bind("change",function(F){f.po.is_down=false;E.focus();});n.onclick=function(){s.jSignature("reset");f.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;E.focus();};var y=this.signElement_guideSpan;t.onclick=function(){if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,f);mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);z.disabledMenu(false);z.signPaintDiv=null;Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendInputSignUnLock(g);}g.signElement.focus();g.onCencelButton();};E.onclick=function(){mRe_sign.move_count=0;if(f.po.move_count>z.m_signMoveCount){f.is_nc=false;}else{if(f.po.move_count!=0&&f.isNecessaryCheck=="true"){f.is_nc=true;}}z.disabledMenu(false);z.signPaintDiv=null;if(((f.po.move_count==0&&f.po.reset)||f.po.move_count==0&&""==f.image)&&f.isNecessaryCheck=="true"){f.image="";f.is_nc=true;}else{var F=s.jSignature("getData").split("base64,")[1];f.image=F;drawReportSign(d,f);}if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}else{y.className="eF_Rect";}mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}g.setSendValue(f.image);if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendInputSignUnLock(g);}g.signElement.focus();g.onOkButton();if(!f.is_nc){g.eform.nextHybridInputControl(g);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}}};EFormSign.prototype.getCtrlID=function(){return this.ctrlID;};EFormSign.prototype.getType=function(){return this.controlData.type;};EFormSign.prototype.getValue=function(){return this.controlData.image;};EFormSign.prototype.setValue=function(a){this.m_default_setValue(a);this.setSendValue(a);};EFormSign.prototype.setSendValue=function(a){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSign(this,a);}};EFormSign.prototype.isSyncSignView=function(){return this.isSyncSignView;};EFormSign.prototype.setSyncSignView=function(a){if(this.eform.multiView.isSocket){this.isSyncSignView=a;}};EFormSign.prototype.m_default_setValue=function(b){this.controlData.image=b;if(""==b&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.isDOM){drawReportReSizeSign(this.signElement_canas,this.controlData);if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect";}}else{this.signElement_guideSpan.className="eF_Rect";}if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}else{var a=document.createElement("canvas");a.width=this.controlData.width;a.height=this.controlData.height;drawReportReSizeSign(a,this.controlData);}};EFormSign.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}}else{this.controlData.is_nc=true;if(this.isDOM){if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSign.prototype.getVisible=function(){return this.controlData.visible;};EFormSign.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.signElement.style.display="";this.signElement_canas.style.display="";this.signElement_guideSpan.style.display="";this.signElement_focusDiv.style.display="";this.signElement_guideInput.style.display="";}else{this.signElement.style.display="none";this.signElement_canas.style.display="none";this.signElement_guideSpan.style.display="none";this.signElement_focusDiv.style.display="none";this.signElement_guideInput.style.display="none";}}};EFormSign.prototype.getDisabled=function(){return this.controlData.disable;};EFormSign.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.signElement.disabled=true;this.signElement_guideSpan.className="eF_Rect";}else{this.signElement.disabled=false;if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}}}};EFormSign.prototype.setGuideTextVisible=function(a){this.controlData.showDisplayTextInDialog=a;if(this.isDOM){if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}};EFormSign.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSign.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSign.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormSign.prototype.onOkButtonEvent=function(a){this.event.okButtonEvent=a;this.event.eventTarget=this;};EFormSign.prototype.onCencelButtonEvent=function(a){this.event.cencelButtonEvent=a;this.event.eventTarget=this;};EFormSign.prototype.click=function(){if(this.isDOM&&!this.controlData.disable&&this.controlData.visible){this.signElement.focus();if(this.onClick()!=false){if(this.controlData.isDirectSign){this.focusControl();this.eFormDirectSignControl();}else{this.eFormSignControl();}}}};EFormSign.prototype.getTitle=function(){return this.title;};EFormSign.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.signElement.title=a;this.signElement.innerHTML=a;}};EFormSign.prototype.onClick=function(){if(null!=this.event.clickEvent){return this.event.clickEvent();}return true;};EFormSign.prototype.onOkButton=function(){if(null!=this.event.okButtonEvent){this.event.okButtonEvent();}};EFormSign.prototype.onCencelButton=function(){if(null!=this.event.cencelButtonEvent){this.event.cencelButtonEvent();}};EFormSign.prototype.focus=function(){if(this.isDOM){var a=this.signElement;setTimeout(function(){a.focus();},1);}};EFormSign.prototype.focusControl=function(){this.signElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormSign.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.signElement.focus();}else{this.signElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSign.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.signElement_focusDiv.className="eF_Rect";}};EFormSign.prototype.multiViewSignLock=function(a){if(this.isDOM){if(a=="lock"){this.signElement_focusDiv.innerHTML="<font style='font-size:10pt;color:gray;'>사용자 입력중..</font>";if(!this.controlData.disable){this.signElement.disabled=true;}}else{this.signElement_focusDiv.innerHTML="";if(!this.controlData.disable){this.signElement.disabled=false;}}}};function drawReportSign(c,a){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height);var b=new Image();d.Re_image=b;b.onload=function(){d.drawImage(this,0,0,c.width,c.height);d.Re_image=null;};b.src="data:image/png;base64,"+a.image;}function resetReportSign(a){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height);if(null!=b.Re_image){b.Re_image.onload=null;b.Re_image=null;}}function drawReportReSizeSign(c,a){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height);var b=new Image();d.Re_image=b;var e=c.width;var f=c.height;b.onload=function(){var i={x:0,y:0,width:0,height:0};if((this.width/e)>(this.height/f)){i.width=c.width;var h=this.width/e;i.height=(this.height/h);i.y=(c.height-i.height)/2;}else{i.height=c.height;var g=this.height/f;i.width=(this.width/g);i.x=(c.width-i.width)/2;}d.drawImage(this,i.x,i.y,i.width,i.height);a.image=c.toDataURL().substring(22);d.Re_image=null;};b.src="data:image/png;base64,"+a.image;}EFormSign.prototype.eFormSyncView=function(){if(this.controlData.isDirectSign){this.focusControl();}else{this.eFormSyncSignControl();}};EFormSign.prototype.eFormSyncSignControl=function(){mRe_mirraringData=null;var g=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={image:null,move_count:0};}var z=this.eform;mRe_sign.report=z;mRe_sign.eform=this;z.disabledMenu(true);var l;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var B=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*B;}if(this.controlData.height<this.controlData.width){var B=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*B;}}var r=(z.paintDiv.offsetWidth-(this.controlData.width+50));var c=(z.paintDiv.offsetHeight-(this.controlData.height+110));if(r<c){l=z.paintDiv.offsetWidth/(this.controlData.width+150);}else{l=z.paintDiv.offsetHeight/(this.controlData.height+210);}var w=this.signElement.offsetWidth;var e=this.signElement.offsetHeight;var x=this.controlData.width*l;var v=this.controlData.height*l;var k=(z.paintDiv.offsetWidth-(x+50))/2;if(k<20){l=l*0.9;x=this.controlData.width*l;v=this.controlData.height*l;k=(z.paintDiv.offsetWidth-(x+50))/2;}var j=(z.paintDiv.offsetHeight-(v+110))/2;if(j<0){j=0;}l=(x+50)/400;var o=x/w;var p=document.createElement("div");p.id="Re_signView";if(is_smartphone){p.className="m_eform_sign_background";}else{p.className="eform_sign_background";}var u=p.cloneNode(true);u.id="Re_signViewOp";u.style.cssText="opacity: 0;background-color:#FFF;";var q=document.createElement("div");mRe_sign.signPaintDiv=q;if(z.m_signOption.staticPos){q.style.cssText="position:absolute;left:"+z.m_signOption.staticLeft+";top:"+z.m_signOption.staticTop+";width:"+(x+50)+"px;height:"+(v+110)+"px;";}else{q.style.cssText="position:absolute;left:"+(k+z.m_signOption.offsetLeft)+"px;top:"+(j+z.m_signOption.offsetTop)+"px;width:"+(x+50)+"px;height:"+(v+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}q.className="eform_sign_div";var m=document.createElement("div");m.className="eform_sign_title";m.innerHTML=this.controlData.title;var a=document.createElement("div");a.className="eform_sign_menu";var E=document.createElement("button");E.id="Re_signView_ok";mRe_sign.okButton=E;E.className="eform_sign_button eform_sign_save";E.style.zoom=l<1?l:1;E.innerHTML=z.m_languageMap.save;var n=document.createElement("button");mRe_sign.resetButton=n;n.className="eform_sign_button eform_sign_reset";n.style.zoom=l<1?l:1;n.innerHTML=z.m_languageMap.reset;var t=document.createElement("button");mRe_sign.cencelButton=t;t.className="eform_sign_button eform_sign_cancel";t.style.zoom=l<1?l:1;t.innerHTML=z.m_languageMap.cancel;var C=document.createElement("span");C.innerHTML="&nbsp;&nbsp;";a.appendChild(E);a.appendChild(C.cloneNode(true));a.appendChild(n);a.appendChild(C.cloneNode(true));a.appendChild(t);Re_zoom.isPop=true;var i=document.createElement("div");i.className="eform_sign_paint";i.style.overflow="hidden";var D=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=D;D.className="eform_sign_paint_guide";var h="border:0px none !important;left:0px;top:0px;width:"+w+"px;height:"+e+"px;";if(is_firefox){h+="transform: scale("+o+");transform-origin: left top 0;";}else{h+="zoom:"+o+";";}D.style.cssText=h;if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==D.tagName){D.value=this.controlData.guideMessage;}else{var b=D.lastChild.lastChild.lastChild.lastChild;if(typeof b.textContent!=="undefined"){b.textContent=this.controlData.guideMessage;}else{b.innerText=this.controlData.guideMessage;}}}D.style.fontFamily=this.controlData.fontName;D.style.fontSize=this.controlData.fontSize;D.style.color=this.controlData.fontColor;i.appendChild(D);q.appendChild(m);q.appendChild(a);q.appendChild(i);p.appendChild(q);z.targetDiv.appendChild(u);z.targetDiv.appendChild(p);E.focus();E.onkeydown=function(F){if(F.keyCode==9){t.click();}};z.signPaintDiv=p;var f=this.controlData;f.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}var A=null;if(null!=mRe_sign.image){A=mRe_sign.image;f.po.move_count=mRe_sign.move_count;mRe_sign.image=null;}else{A=f.image;}var s=$(i);mRe_sign.jSign=s;s.jSignature({"decor-color":"transparent",lineWidth:(f.penWidth*o),color:f.penColor,width:"100%",height:"100%",cssclass:"eform_sign_canvas",imageData:A});mRe_mirraringData="";if(is_smartphone){s.bind("touchstart",function(F){f.po.is_down=true;});s.bind("touchmove",function(F){if(f.po.is_down||f.po.move_count>0){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}else{s.bind("mousedown",function(F){f.po.is_down=true;});s.bind("mousemove",function(F){if(f.po.is_down){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}s.bind("change",function(F){f.po.is_down=false;if(g.eform.multiView.isSocket&&f.po.move_count>0){g.eform.multiView.socket.sendSyncSignData(g,f.po.move_count,mRe_mirraringData);}mRe_mirraringData="";E.focus();});n.onclick=function(){f.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignResetButton(g);}s.jSignature("reset");E.focus();};var y=this.signElement_guideSpan;t.onclick=function(){if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,f);mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);z.disabledMenu(false);z.signPaintDiv=null;Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignCencelButton(g);}g.signElement.focus();g.onCencelButton();};E.onclick=function(){mRe_sign.move_count=0;if(f.po.move_count>z.m_signMoveCount){f.is_nc=false;}else{if(f.po.move_count!=0&&f.isNecessaryCheck=="true"){f.is_nc=true;}}z.disabledMenu(false);z.signPaintDiv=null;if(((f.po.move_count==0&&f.po.reset)||f.po.move_count==0&&""==f.image)&&f.isNecessaryCheck=="true"){f.image="";f.is_nc=true;}else{var F=s.jSignature("getData").split("base64,")[1];f.image=F;drawReportSign(d,f);}if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}else{y.className="eF_Rect";}mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignOkButton(g);}g.signElement.focus();g.onOkButton();if(!f.is_nc){g.eform.nextHybridInputControl(g);}};}};EFormSign.prototype.eFormSyncSignOkButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var e=this.signElement_canas;var f=mRe_sign.jSign;var a=document.getElementById("Re_signView");var h=document.getElementById("Re_signViewOp");mRe_sign.move_count=0;if(c.po.move_count>d.m_signMoveCount){c.is_nc=false;}else{if(c.po.move_count!=0&&c.isNecessaryCheck=="true"){c.is_nc=true;}}d.disabledMenu(false);d.signPaintDiv=null;if(((c.po.move_count==0&&c.po.reset)||c.po.move_count==0&&""==c.image)&&c.isNecessaryCheck=="true"){c.image="";c.is_nc=true;}else{var g=f.jSignature("getData").split("base64,")[1];c.image=g;drawReportSign(e,c);}if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}}else{b.className="eF_Rect";}mRe_sign=null;d.targetDiv.removeChild(h);d.targetDiv.removeChild(a);Re_zoom.isPop=false;if(c.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}this.signElement.focus();this.onOkButton();};EFormSign.prototype.eFormSyncSignResetButton=function(){var a=this.controlData;var b=document.getElementById("Re_signView_ok");a.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;mRe_sign.jSign.jSignature("reset");b.focus();};EFormSign.prototype.eFormSyncSignCencelButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var e=this.signElement_canas;var a=document.getElementById("Re_signView");var f=document.getElementById("Re_signViewOp");if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(e,c);mRe_sign=null;d.targetDiv.removeChild(f);d.targetDiv.removeChild(a);d.disabledMenu(false);d.signPaintDiv=null;Re_zoom.isPop=false;if(c.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}this.signElement.focus();this.onCencelButton();};function EFormSignGroup(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_guideInput=null;this.signElement_focusDiv=null;this.event={clickEvent:null,okButtonEvent:null,cencelButtonEvent:null,eventTarget:null};this.title=null;this.isSyncSignView=false;this.is_mousedown=false;}EFormSignGroup.prototype.setGroup=function(a){this.group=a;};EFormSignGroup.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(""!=a.guideMessage){this.controlData.guideMessage=a.guideMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.title){this.controlData.title=a.title.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(""!=a.detailTitle){this.controlData.detailTitle=a.detailTitle.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.pathString){a.pathString="";}if(this.eform.multiView.isSocket){this.isSyncSignView=true;}};EFormSignGroup.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSignGroup.prototype.deleteDOM=function(){this.isDOM=false;this.signElement=null;this.signElement_canas=null;this.signElement_guideSpan=null;this.signElement_focusDiv=null;};EFormSignGroup.prototype.getHE=function(){if(this.isDOM){return this.signElement;}return null;};EFormSignGroup.prototype.eventHandlerSignGroup=function(){this.isDOM=true;this.signElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.signElement_canas=document.getElementById(this.eform.m_uid+this.ctrlID+"Canvas");this.signElement_guideSpan=document.getElementById(this.eform.m_uid+this.ctrlID+"Guide");this.signElement_guideInput=document.getElementById(this.eform.m_uid+this.ctrlID+"GuideInput");this.signElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.signElement.title;}else{this.signElement.title=this.title;this.signElement.innerHTML=this.title;}this.controlData.is_ef="yes";if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}if(null!=this.signElement_canas){this.signElement_canas.width=this.controlData.width;this.signElement_canas.height=this.controlData.height;}if(""!=this.controlData.value){drawReportSign(this.signElement_canas,this.controlData);}var c=this;if(null!=this.signElement_focusDiv&&null!=this.signElement){this.signElement.onblur=function(){var d=c.signElement_focusDiv;if(null!=d){d.className="eF_Rect";}if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"out");}};this.signElement.onfocus=function(){c.focusControl();if(c.eform.multiView.isSocket){c.eform.multiView.socket.sendFocusControl(c,"in");}};}var a=this.eform.multiView;if(a.isSocket){if(a.socket.isMain){this.eFormControlSocketMainEventRegistered();}else{if(typeof ClipHybrid=="undefined"){this.eFormControlDefaultEventRegistered();}else{this.eFormControlHybridEventRegistered();}}}else{if(typeof ClipHybrid=="undefined"){this.eFormControlDefaultEventRegistered();}else{this.eFormControlHybridEventRegistered();}}if("INPUT"==this.signElement_guideInput.tagName){this.signElement_guideInput.value=this.controlData.guideMessage;}else{var b=this.signElement_guideInput.lastChild.lastChild.lastChild.lastChild;if(typeof b.textContent!=="undefined"){b.textContent=this.controlData.guideMessage;}else{b.innerText=this.controlData.guideMessage;}}this.signElement_guideInput.style.fontFamily=this.controlData.fontName;this.signElement_guideInput.style.fontSize=this.controlData.fontSize;this.signElement_guideInput.style.color=this.controlData.fontColor;this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSignGroup.prototype.eFormControlSocketMainEventRegistered=function(){var a=this;this.signElement.onmousedown=function(){if(a.onClick()!=false){a.eform.multiView.socket.sendSyncSignHybridView(a);}};this.signElement.onkeyup=function(b){if(32==b.keyCode){if(a.onClick()!=false){a.eform.multiView.socket.sendSyncSignHybridView(a);}}};};EFormSignGroup.prototype.eFormControlHybridEventRegistered=function(){var a=this;this.signElement.onmousedown=function(){if(a.onClick()!=false){a.is_mousedown=true;a.eFormHybridSignView();}};this.signElement.onkeyup=function(b){if(32==b.keyCode){if(a.onClick()!=false){a.eFormHybridSignView();}}};};EFormSignGroup.prototype.eFormControlDefaultEventRegistered=function(){var a=this;this.signElement.onmousedown=function(){if(a.onClick()!=false){if(a.controlData.isDirectSign){a.focusControl();a.eFormDirectSignControl();}else{if(a.isSyncSignView){a.eFormSyncSignControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendSyncSignView(a);}}else{a.eFormSignControl();}}}};this.signElement.onkeyup=function(b){if(32==b.keyCode){if(a.onClick()!=false){if(a.controlData.isDirectSign){a.focusControl();a.eFormDirectSignControl();}else{if(a.isSyncSignView){a.eFormSyncSignControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendSyncSignView(a);}}else{a.eFormSignControl();}}}}};};EFormSignGroup.prototype.eFormHybridSignView=function(){if(!is_appControl&&!is_exeControl){this.eFormSyncSignControl();if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendSyncSignView(this);}}else{this.eform.inputOrderFoucs(this);var b=this;var i=this.eform;var f=null;if(this.eform.multiView.isSocket){f=i.multiView.socket;f.sendScreenLock("sign");}window.set_report_sign_date=function(k,j){if(k=="ok"){b.setHybridSignData(j);if(null!=f){f.sendHybridSignViewEvent(b,"ok");}b.onOkButton();}else{if(k=="next"){b.setHybridSignData(j);if(null!=f){f.sendHybridSignViewEvent(b,"ok");}i.nextHybridInputControl(b);}else{if(k=="cencel"){if(null!=f){f.sendHybridSignViewEvent(b,"cencel");}b.onCencelButton();}}}if(null!=f){f.sendScreenUnLock();}};var d=new Array();var h=this.group.getControlList();for(var e=0;e<h.length;e++){var g=h[e];var c=new Object();c.id=g.ctrlID;c.title=g.controlData.title;c.detailTitle=g.controlData.detailTitle;c.guideMsg=g.controlData.guideMessage;c.width=g.controlData.width;c.height=g.controlData.height;c.path=g.controlData.pathString;d.push(c);}if(is_appControl){ClipHybrid.callNativeControl("sign",JSON.stringify(d));}else{var a={methodName:"ShowSignatureBoard",data:d};window.external.ClipSubWebBrowserCtrl_Invoke(JSON.stringify(a));}}};EFormSignGroup.prototype.setHybridSignData=function(f){var a=this.eform;var c=null;if(this.eform.multiView.isSocket){c=a.multiView.socket;}var e=JSON.parse(f);for(var d=0;d<e.length;d++){var g=e[d];var b=a.eFormControlList[g.id];if(null!=b){b.setValue(g.base64);b.controlData.pathString=g.path;if(null!=c){c.sendInputSignPath(b,g.path);}}else{mRe_ReportWebLog("not Found Control!! stackFlow function : setHybridSignData control id:"+g.id);}}};EFormSignGroup.prototype.eFormDirectSignControl=function(){var f=this;var n=this.eform;var c=this.signElement.parentElement;var i=is_edge?this.signElement.offsetLeft/n.eFormDoodleOption.zoomIn:this.signElement.offsetLeft;var l=is_edge?this.signElement.offsetTop/n.eFormDoodleOption.zoomIn:this.signElement.offsetTop;var p=this.signElement.offsetWidth;var o=this.signElement.offsetHeight;var a=document.createElement("div");a.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;opacity: 0;background-color:#FFF;z-index:200";var g=document.createElement("div");g.style.cssText="position:absolute;left:0px;top:0px;right:0px;bottom:0px;z-index:200";var b=document.createElement("div");b.style.position="absolute";b.style.left=i+"px";b.style.top=l+"px";b.style.width=p+"px";b.style.height=o+"px";b.style.zIndex="200";var q=document.createElement("div");q.style.position="absolute";q.style.left=(i+3)+"px";q.style.top=(l+o+3)+"px";q.style.width=p+"px";var r=document.createElement("button");r.id=n.m_uid+"okUBT";r.className="eform_sign_button_in eform_sign_save";r.innerHTML=n.m_languageMap.save;var h=document.createElement("button");h.className="eform_sign_button_in eform_sign_reset";h.innerHTML=n.m_languageMap.reset;var k=document.createElement("button");k.className="eform_sign_button_in eform_sign_cancel";k.innerHTML=n.m_languageMap.cancel;q.appendChild(r);q.appendChild(h);q.appendChild(k);g.appendChild(b);g.appendChild(q);c.appendChild(a);c.appendChild(g);if(!is_smartphone){r.focus();r.onkeydown=function(s){if(s.keyCode==9){k.click();}};}var e=this.controlData;e.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);this.signElement_guideInput.style.visibility="visible";var j=$(b);j.jSignature({"decor-color":"transparent",lineWidth:(e.penWidth*2),color:e.penColor,width:(p*2),height:(o*2),cssclass:"eform_sign_canvas_in",imageData:e.image});if(is_smartphone){j.bind("touchstart",function(s){e.po.is_down=true;});j.bind("touchmove",function(s){if(e.po.is_down||e.po.move_count>0){e.po.move_count++;}});}else{j.bind("mousedown",function(s){e.po.is_down=true;});j.bind("mousemove",function(s){if(e.po.is_down){e.po.move_count++;}});}j.bind("change",function(s){e.po.is_down=false;if(!is_smartphone){r.focus();}});h.onclick=function(s){j.jSignature("reset");e.po={is_down:false,move_count:0,reset:true};if(!is_smartphone){r.focus();}if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};var m=this.signElement_guideSpan;k.onclick=function(s){if(e.is_nc){if(n.eForm_isNecessary.check&&e.isNecessaryCheck=="true"){m.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,e);c.removeChild(a);c.removeChild(g);if(e.showDisplayTextInDialog){f.signElement_guideInput.style.visibility="visible";}else{f.signElement_guideInput.style.visibility="hidden";}if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendInputSignUnLock(f);}f.signElement.focus();f.onCencelButton();if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};b.onmousedown=b.onclick=function(s){if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}};if(is_smartphone){g.onclick=function(s){r.click();};}r.onclick=function(s){if(e.po.move_count>n.m_signMoveCount){e.is_nc=false;}else{if(e.po.move_count!=0&&e.isNecessaryCheck=="true"){e.is_nc=true;}}if(((e.po.move_count==0&&e.po.reset)||e.po.move_count==0&&""==e.image)&&e.isNecessaryCheck=="true"){e.image="";e.is_nc=true;}else{var t=j.jSignature("getData").split("base64,")[1];e.image=t;drawReportSign(d,e);}if(e.is_nc){if(n.eForm_isNecessary.check&&e.isNecessaryCheck=="true"){m.className="eF_Rect eForm_NecessaryCheck";}}else{m.className="eF_Rect";}c.removeChild(a);c.removeChild(g);if(e.showDisplayTextInDialog){f.signElement_guideInput.style.visibility="visible";}else{f.signElement_guideInput.style.visibility="hidden";}f.setSendValue(e.image);if(f.eform.multiView.isSocket){f.eform.multiView.socket.sendInputSignUnLock(f);}f.signElement.focus();f.onOkButton();if(s.stopPropagation){s.stopPropagation();}else{s.cancelBubble=true;}if(!e.is_nc){f.eform.nextHybridInputControl(f);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}};EFormSignGroup.prototype.eFormSignControl=function(){var g=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={image:null,move_count:0};}var z=this.eform;mRe_sign.report=z;mRe_sign.eform=this;z.disabledMenu(true);var l;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var B=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*B;}if(this.controlData.height<this.controlData.width){var B=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*B;}}var r=(z.paintDiv.offsetWidth-(this.controlData.width+50));var c=(z.paintDiv.offsetHeight-(this.controlData.height+110));if(r<c){l=z.paintDiv.offsetWidth/(this.controlData.width+150);}else{l=z.paintDiv.offsetHeight/(this.controlData.height+210);}var w=this.signElement.offsetWidth;var e=this.signElement.offsetHeight;var x=this.controlData.width*l;var v=this.controlData.height*l;var k=(z.paintDiv.offsetWidth-(x+50))/2;if(k<20){l=l*0.9;x=this.controlData.width*l;v=this.controlData.height*l;k=(z.paintDiv.offsetWidth-(x+50))/2;}var j=(z.paintDiv.offsetHeight-(v+110))/2;if(j<0){j=0;}l=(x+50)/400;var o=x/w;var p=document.createElement("div");if(is_smartphone){p.className="m_eform_sign_background";}else{p.className="eform_sign_background";}var u=p.cloneNode(true);u.style.cssText="opacity: 0;background-color:#FFF;";var q=document.createElement("div");mRe_sign.signPaintDiv=q;if(z.m_signOption.staticPos){q.style.cssText="position:absolute;left:"+z.m_signOption.staticLeft+";top:"+z.m_signOption.staticTop+";width:"+(x+50)+"px;height:"+(v+110)+"px;";}else{q.style.cssText="position:absolute;left:"+(k+z.m_signOption.offsetLeft)+"px;top:"+(j+z.m_signOption.offsetTop)+"px;width:"+(x+50)+"px;height:"+(v+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}q.className="eform_sign_div";var m=document.createElement("div");m.className="eform_sign_title";m.innerHTML=this.controlData.title;var a=document.createElement("div");a.className="eform_sign_menu";var E=document.createElement("button");mRe_sign.okButton=E;E.className="eform_sign_button eform_sign_save";E.style.zoom=l<1?l:1;E.innerHTML=z.m_languageMap.save;var n=document.createElement("button");mRe_sign.resetButton=n;n.className="eform_sign_button eform_sign_reset";n.style.zoom=l<1?l:1;n.innerHTML=z.m_languageMap.reset;var t=document.createElement("button");mRe_sign.cencelButton=t;t.className="eform_sign_button eform_sign_cancel";t.style.zoom=l<1?l:1;t.innerHTML=z.m_languageMap.cancel;var C=document.createElement("span");C.innerHTML="&nbsp;&nbsp;";a.appendChild(E);a.appendChild(C.cloneNode(true));a.appendChild(n);a.appendChild(C.cloneNode(true));a.appendChild(t);Re_zoom.isPop=true;var i=document.createElement("div");i.className="eform_sign_paint";i.style.overflow="hidden";var D=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=D;D.className="eform_sign_paint_guide";var h="border:0px none !important;left:0px;top:0px;width:"+w+"px;height:"+e+"px;";if(is_firefox){h+="transform: scale("+o+");transform-origin: left top 0;";}else{h+="zoom:"+o+";";}D.style.cssText=h;if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==D.tagName){D.value=this.controlData.guideMessage;}else{var b=D.lastChild.lastChild.lastChild.lastChild;if(typeof b.textContent!=="undefined"){b.textContent=this.controlData.guideMessage;}else{b.innerText=this.controlData.guideMessage;}}}D.style.fontFamily=this.controlData.fontName;D.style.fontSize=this.controlData.fontSize;D.style.color=this.controlData.fontColor;i.appendChild(D);q.appendChild(m);q.appendChild(a);q.appendChild(i);p.appendChild(q);z.targetDiv.appendChild(u);z.targetDiv.appendChild(p);E.focus();E.onkeydown=function(F){if(F.keyCode==9){t.click();}};z.signPaintDiv=p;var f=this.controlData;f.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}var A=null;if(null!=mRe_sign.image){A=mRe_sign.image;f.po.move_count=mRe_sign.move_count;mRe_sign.image=null;}else{A=f.image;}var s=$(i);mRe_sign.jSign=s;s.jSignature({"decor-color":"transparent",lineWidth:(f.penWidth*o),color:f.penColor,width:"100%",height:"100%",cssclass:"eform_sign_canvas",imageData:A});if(is_smartphone){s.bind("touchstart",function(F){f.po.is_down=true;});s.bind("touchmove",function(F){if(f.po.is_down||f.po.move_count>0){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}else{s.bind("mousedown",function(F){f.po.is_down=true;});s.bind("mousemove",function(F){if(f.po.is_down){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}s.bind("change",function(F){f.po.is_down=false;E.focus();});n.onclick=function(){s.jSignature("reset");f.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;E.focus();};var y=this.signElement_guideSpan;t.onclick=function(){if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,f);mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);z.disabledMenu(false);z.signPaintDiv=null;Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendInputSignUnLock(g);}g.signElement.focus();g.onCencelButton();};E.onclick=function(){mRe_sign.move_count=0;if(f.po.move_count>z.m_signMoveCount){f.is_nc=false;}else{if(f.po.move_count!=0&&f.isNecessaryCheck=="true"){f.is_nc=true;}}z.disabledMenu(false);z.signPaintDiv=null;if(((f.po.move_count==0&&f.po.reset)||f.po.move_count==0&&""==f.image)&&f.isNecessaryCheck=="true"){f.image="";f.is_nc=true;}else{var F=s.jSignature("getData").split("base64,")[1];f.image=F;drawReportSign(d,f);}if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}else{y.className="eF_Rect";}mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}g.setSendValue(f.image);if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendInputSignUnLock(g);}g.signElement.focus();g.onOkButton();if(!f.is_nc){g.eform.nextHybridInputControl(g);}};if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSignLock(this);}}};EFormSignGroup.prototype.getCtrlID=function(){return this.ctrlID;};EFormSignGroup.prototype.getType=function(){return this.controlData.type;};EFormSignGroup.prototype.getValue=function(){return this.controlData.image;};EFormSignGroup.prototype.setValue=function(a){this.m_default_setValue(a);this.setSendValue(a);};EFormSignGroup.prototype.setSendValue=function(a){if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSign(this,a);}};EFormSignGroup.prototype.isSyncSignView=function(){return this.isSyncSignView;};EFormSignGroup.prototype.setSyncSignView=function(a){if(this.eform.multiView.isSocket){this.isSyncSignView=a;}};EFormSignGroup.prototype.m_default_setValue=function(b){this.controlData.image=b;if(""==b&&this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}else{this.controlData.is_nc=false;}if(this.isDOM){drawReportReSizeSign(this.signElement_canas,this.controlData);if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}else{this.signElement_guideSpan.className="eF_Rect";}}else{this.signElement_guideSpan.className="eF_Rect";}if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}else{var a=document.createElement("canvas");a.width=this.controlData.width;a.height=this.controlData.height;drawReportReSizeSign(a,this.controlData);}};EFormSignGroup.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.image){this.controlData.is_nc=false;if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}}else{this.controlData.is_nc=true;if(this.isDOM){if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.signElement_guideSpan.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSignGroup.prototype.getVisible=function(){return this.controlData.visible;};EFormSignGroup.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.signElement.style.display="";this.signElement_canas.style.display="";this.signElement_guideSpan.style.display="";this.signElement_focusDiv.style.display="";this.signElement_guideInput.style.display="";}else{this.signElement.style.display="none";this.signElement_canas.style.display="none";this.signElement_guideSpan.style.display="none";this.signElement_focusDiv.style.display="none";this.signElement_guideInput.style.display="none";}}};EFormSignGroup.prototype.getDisabled=function(){return this.controlData.disable;};EFormSignGroup.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.signElement.disabled=true;this.signElement_guideSpan.className="eF_Rect";}else{this.signElement.disabled=false;if(this.controlData.is_nc){if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"){this.signElement_guideSpan.className="eF_Rect eForm_NecessaryCheck";}}}}};EFormSignGroup.prototype.setGuideTextVisible=function(a){this.controlData.showDisplayTextInDialog=a;if(this.isDOM){if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}}};EFormSignGroup.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSignGroup.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSignGroup.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.onOkButtonEvent=function(a){this.event.okButtonEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.onCencelButtonEvent=function(a){this.event.cencelButtonEvent=a;this.event.eventTarget=this;};EFormSignGroup.prototype.click=function(){if(this.isDOM&&!this.controlData.disable&&this.controlData.visible){this.signElement.focus();if(this.onClick()!=false){if(this.controlData.isDirectSign){this.focusControl();this.eFormDirectSignControl();}else{this.eFormSignControl();}}}};EFormSignGroup.prototype.getTitle=function(){return this.title;};EFormSignGroup.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.signElement.title=a;this.signElement.innerHTML=a;}};EFormSignGroup.prototype.getDetailTitle=function(){return this.controlData.detailTitle;};EFormSignGroup.prototype.setDetailTitle=function(a){this.controlData.detailTitle=a;};EFormSignGroup.prototype.onClick=function(){if(null!=this.event.clickEvent){return this.event.clickEvent();}return true;};EFormSignGroup.prototype.onOkButton=function(){if(null!=this.event.okButtonEvent){this.event.okButtonEvent();}};EFormSignGroup.prototype.onCencelButton=function(){if(null!=this.event.cencelButtonEvent){this.event.cencelButtonEvent();}};EFormSignGroup.prototype.focus=function(){if(this.isDOM){var a=this.signElement;setTimeout(function(){a.focus();},1);}};EFormSignGroup.prototype.focusControl=function(){this.signElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isHybridQuickControl&&typeof ClipHybrid!="undefined"){if(null!=this.controlData.inputOrder){if(!this.is_mousedown){this.eFormHybridSignView();}this.is_mousedown=false;if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}}};EFormSignGroup.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.signElement.focus();}else{this.signElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSignGroup.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.signElement_focusDiv.className="eF_Rect";}};EFormSignGroup.prototype.multiViewSignLock=function(a){if(this.isDOM){if(a=="lock"){this.signElement_focusDiv.innerHTML="<font style='font-size:10pt;color:gray;'>사용자 입력중..</font>";if(!this.controlData.disable){this.signElement.disabled=true;}}else{this.signElement_focusDiv.innerHTML="";if(!this.controlData.disable){this.signElement.disabled=false;}}}};function drawReportSign(c,a){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height);var b=new Image();d.Re_image=b;b.onload=function(){d.drawImage(this,0,0,c.width,c.height);d.Re_image=null;};b.src="data:image/png;base64,"+a.image;}function resetReportSign(a){var b=a.getContext("2d");b.clearRect(0,0,a.width,a.height);if(null!=b.Re_image){b.Re_image.onload=null;b.Re_image=null;}}function drawReportReSizeSign(c,a){var d=c.getContext("2d");d.clearRect(0,0,c.width,c.height);var b=new Image();d.Re_image=b;var e=c.width;var f=c.height;b.onload=function(){var i={x:0,y:0,width:0,height:0};if((this.width/e)>(this.height/f)){i.width=c.width;var h=this.width/e;i.height=(this.height/h);i.y=(c.height-i.height)/2;}else{i.height=c.height;var g=this.height/f;i.width=(this.width/g);i.x=(c.width-i.width)/2;}d.drawImage(this,i.x,i.y,i.width,i.height);a.image=c.toDataURL().substring(22);d.Re_image=null;};b.src="data:image/png;base64,"+a.image;}EFormSignGroup.prototype.eFormSyncView=function(){if(this.controlData.isDirectSign){this.focusControl();}else{this.eFormSyncSignControl();}};EFormSignGroup.prototype.eFormSyncSignControl=function(){mRe_mirraringData=null;var g=this;if(this.eform.m_isButtonLock==false){if(null!=this.eform.signPaintDiv){return;}if(null==mRe_sign){mRe_sign=new Object();mRe_sign={image:null,move_count:0};}var z=this.eform;mRe_sign.report=z;mRe_sign.eform=this;z.disabledMenu(true);var l;if(this.controlData.width<500&&this.controlData.height<500){if(this.controlData.width<this.controlData.height){var B=500/this.controlData.height;this.controlData.height=500;this.controlData.width=this.controlData.width*B;}if(this.controlData.height<this.controlData.width){var B=500/this.controlData.width;this.controlData.width=500;this.controlData.height=this.controlData.height*B;}}var r=(z.paintDiv.offsetWidth-(this.controlData.width+50));var c=(z.paintDiv.offsetHeight-(this.controlData.height+110));if(r<c){l=z.paintDiv.offsetWidth/(this.controlData.width+150);}else{l=z.paintDiv.offsetHeight/(this.controlData.height+210);}var w=this.signElement.offsetWidth;var e=this.signElement.offsetHeight;var x=this.controlData.width*l;var v=this.controlData.height*l;var k=(z.paintDiv.offsetWidth-(x+50))/2;if(k<20){l=l*0.9;x=this.controlData.width*l;v=this.controlData.height*l;k=(z.paintDiv.offsetWidth-(x+50))/2;}var j=(z.paintDiv.offsetHeight-(v+110))/2;if(j<0){j=0;}l=(x+50)/400;var o=x/w;var p=document.createElement("div");p.id="Re_signView";if(is_smartphone){p.className="m_eform_sign_background";}else{p.className="eform_sign_background";}var u=p.cloneNode(true);u.id="Re_signViewOp";u.style.cssText="opacity: 0;background-color:#FFF;";var q=document.createElement("div");mRe_sign.signPaintDiv=q;if(z.m_signOption.staticPos){q.style.cssText="position:absolute;left:"+z.m_signOption.staticLeft+";top:"+z.m_signOption.staticTop+";width:"+(x+50)+"px;height:"+(v+110)+"px;";}else{q.style.cssText="position:absolute;left:"+(k+z.m_signOption.offsetLeft)+"px;top:"+(j+z.m_signOption.offsetTop)+"px;width:"+(x+50)+"px;height:"+(v+110)+"px;";}if(null!=this.signElement_focusDiv){this.signElement_focusDiv.className="eF_Rect";}q.className="eform_sign_div";var m=document.createElement("div");m.className="eform_sign_title";m.innerHTML=this.controlData.title;var a=document.createElement("div");a.className="eform_sign_menu";var E=document.createElement("button");E.id="Re_signView_ok";mRe_sign.okButton=E;E.className="eform_sign_button eform_sign_save";E.style.zoom=l<1?l:1;E.innerHTML=z.m_languageMap.save;var n=document.createElement("button");mRe_sign.resetButton=n;n.className="eform_sign_button eform_sign_reset";n.style.zoom=l<1?l:1;n.innerHTML=z.m_languageMap.reset;var t=document.createElement("button");mRe_sign.cencelButton=t;t.className="eform_sign_button eform_sign_cancel";t.style.zoom=l<1?l:1;t.innerHTML=z.m_languageMap.cancel;var C=document.createElement("span");C.innerHTML="&nbsp;&nbsp;";a.appendChild(E);a.appendChild(C.cloneNode(true));a.appendChild(n);a.appendChild(C.cloneNode(true));a.appendChild(t);Re_zoom.isPop=true;var i=document.createElement("div");i.className="eform_sign_paint";i.style.overflow="hidden";var D=this.signElement_guideInput.cloneNode(true);mRe_sign.guideInput=D;D.className="eform_sign_paint_guide";var h="border:0px none !important;left:0px;top:0px;width:"+w+"px;height:"+e+"px;";if(is_firefox){h+="transform: scale("+o+");transform-origin: left top 0;";}else{h+="zoom:"+o+";";}D.style.cssText=h;if(null==this.controlData.showDisplayTextInDialog||this.controlData.showDisplayTextInDialog){if("INPUT"==D.tagName){D.value=this.controlData.guideMessage;}else{var b=D.lastChild.lastChild.lastChild.lastChild;if(typeof b.textContent!=="undefined"){b.textContent=this.controlData.guideMessage;}else{b.innerText=this.controlData.guideMessage;}}}D.style.fontFamily=this.controlData.fontName;D.style.fontSize=this.controlData.fontSize;D.style.color=this.controlData.fontColor;i.appendChild(D);q.appendChild(m);q.appendChild(a);q.appendChild(i);p.appendChild(q);z.targetDiv.appendChild(u);z.targetDiv.appendChild(p);E.focus();E.onkeydown=function(F){if(F.keyCode==9){t.click();}};z.signPaintDiv=p;var f=this.controlData;f.po={is_down:false,move_count:0,reset:false};var d=this.signElement_canas;resetReportSign(d);if(this.controlData.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}var A=null;if(null!=mRe_sign.image){A=mRe_sign.image;f.po.move_count=mRe_sign.move_count;mRe_sign.image=null;}else{A=f.image;}var s=$(i);mRe_sign.jSign=s;s.jSignature({"decor-color":"transparent",lineWidth:(f.penWidth*o),color:f.penColor,width:"100%",height:"100%",cssclass:"eform_sign_canvas",imageData:A});mRe_mirraringData="";if(is_smartphone){s.bind("touchstart",function(F){f.po.is_down=true;});s.bind("touchmove",function(F){if(f.po.is_down||f.po.move_count>0){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}else{s.bind("mousedown",function(F){f.po.is_down=true;});s.bind("mousemove",function(F){if(f.po.is_down){f.po.move_count++;mRe_sign.move_count=f.po.move_count;}});}s.bind("change",function(F){f.po.is_down=false;if(g.eform.multiView.isSocket&&f.po.move_count>0){g.eform.multiView.socket.sendSyncSignData(g,f.po.move_count,mRe_mirraringData);}mRe_mirraringData="";E.focus();});n.onclick=function(){f.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignResetButton(g);}s.jSignature("reset");E.focus();};var y=this.signElement_guideSpan;t.onclick=function(){if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(d,f);mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);z.disabledMenu(false);z.signPaintDiv=null;Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignCencelButton(g);}g.signElement.focus();g.onCencelButton();};E.onclick=function(){mRe_sign.move_count=0;if(f.po.move_count>z.m_signMoveCount){f.is_nc=false;}else{if(f.po.move_count!=0&&f.isNecessaryCheck=="true"){f.is_nc=true;}}z.disabledMenu(false);z.signPaintDiv=null;if(((f.po.move_count==0&&f.po.reset)||f.po.move_count==0&&""==f.image)&&f.isNecessaryCheck=="true"){f.image="";f.is_nc=true;}else{var F=s.jSignature("getData").split("base64,")[1];f.image=F;drawReportSign(d,f);}if(f.is_nc){if(z.eForm_isNecessary.check&&f.isNecessaryCheck=="true"){y.className="eF_Rect eForm_NecessaryCheck";}}else{y.className="eF_Rect";}mRe_sign=null;z.targetDiv.removeChild(u);z.targetDiv.removeChild(p);Re_zoom.isPop=false;if(f.showDisplayTextInDialog){g.signElement_guideInput.style.visibility="visible";}else{g.signElement_guideInput.style.visibility="hidden";}if(g.eform.multiView.isSocket){g.eform.multiView.socket.sendSyncSignOkButton(g);}g.signElement.focus();g.onOkButton();};}};EFormSignGroup.prototype.eFormSyncSignOkButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var e=this.signElement_canas;var f=mRe_sign.jSign;var a=document.getElementById("Re_signView");var h=document.getElementById("Re_signViewOp");mRe_sign.move_count=0;if(c.po.move_count>d.m_signMoveCount){c.is_nc=false;}else{if(c.po.move_count!=0&&c.isNecessaryCheck=="true"){c.is_nc=true;}}d.disabledMenu(false);d.signPaintDiv=null;if(((c.po.move_count==0&&c.po.reset)||c.po.move_count==0&&""==c.image)&&c.isNecessaryCheck=="true"){c.image="";c.is_nc=true;}else{var g=f.jSignature("getData").split("base64,")[1];c.image=g;drawReportSign(e,c);}if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}}else{b.className="eF_Rect";}mRe_sign=null;d.targetDiv.removeChild(h);d.targetDiv.removeChild(a);Re_zoom.isPop=false;if(c.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}this.signElement.focus();this.onOkButton();};EFormSignGroup.prototype.eFormSyncSignResetButton=function(){var a=this.controlData;var b=document.getElementById("Re_signView_ok");a.po={is_down:false,move_count:0,reset:true};mRe_sign.move_count=0;mRe_sign.jSign.jSignature("reset");b.focus();};EFormSignGroup.prototype.eFormSyncSignCencelButton=function(){var d=this.eform;var c=this.controlData;var b=this.signElement_guideSpan;var e=this.signElement_canas;var a=document.getElementById("Re_signView");var f=document.getElementById("Re_signViewOp");if(c.is_nc){if(d.eForm_isNecessary.check&&c.isNecessaryCheck=="true"){b.className="eF_Rect eForm_NecessaryCheck";}}drawReportSign(e,c);mRe_sign=null;d.targetDiv.removeChild(f);d.targetDiv.removeChild(a);d.disabledMenu(false);d.signPaintDiv=null;Re_zoom.isPop=false;if(c.showDisplayTextInDialog){this.signElement_guideInput.style.visibility="visible";}else{this.signElement_guideInput.style.visibility="hidden";}this.signElement.focus();this.onCencelButton();};function EFormCalendar(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.calendarElement=null;this.calendarElement_div=null;this.calendarElement_td=null;this.calendarElement_focusDiv=null;this.event={clickEvent:null,dayClickEvent:null,eventTarget:null};this.title=null;this.viewOption={calendarBGDom:null,calendarFrameDom:null,textYearMonthDom:null,dayDomList:[[],[],[],[],[],[]],dayList:["SUN","MON","TUE","WED","THU","FRI","SAT"],newYear:0,newMonth:0,newDay:0};}EFormCalendar.prototype.setGroup=function(a){this.group=a;};EFormCalendar.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.yearValue=a.yearValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.monthValue=a.monthValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.dayValue=a.dayValue.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}};EFormCalendar.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.viewOption=null;this.deleteDOM();};EFormCalendar.prototype.deleteDOM=function(){this.isDOM=false;this.calendarElement=null;this.calendarElement_div=null;this.calendarElement_td=null;this.calendarElement_focusDiv=null;};EFormCalendar.prototype.getHE=function(){if(this.isDOM){return this.calendarElement;}return null;};EFormCalendar.prototype.eventHandlerCalendar=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.calendarElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.calendarElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.calendarElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.calendarElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.calendarElement.title;}else{this.calendarElement.title=this.title;this.calendarElement.innerHTML=this.title;}var b=this.getValue();if(""!=b){this.controlData.is_nc=false;}else{if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}}var a=this;if(null!=this.calendarElement_focusDiv&&null!=this.calendarElement){this.calendarElement.onblur=function(){var c=a.calendarElement_focusDiv;if(null!=c){c.className="eF_Rect";}if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"out");}};this.calendarElement.onfocus=function(){a.focusControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"in");}};}if(typeof this.calendarElement_td.innerText!=="undefined"){this.calendarElement_td.firstChild.innerText=b;}else{this.calendarElement_td.firstChild.innerHTML=b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}this.calendarElement.onmousedown=function(c){if(a.onClick()!=false){a.eformCalendarControl();}c.preventDefault();};this.calendarElement.onkeyup=function(c){if(32==c.keyCode||13==c.keyCode){if(a.onClick()!=false){a.eformCalendarControl();}}};this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormCalendar.prototype.click=function(a){if(typeof a=="undefined"){a=true;}if(!this.controlData.disable&&this.controlData.visible){this.calendarElement.focus();}if(a){if(this.onClick()!=false){this.eformCalendarControl();}}else{this.eformCalendarControl();}};EFormCalendar.prototype.eformCalendarControl=function(){if(this.eform.m_isButtonLock==false&&this.viewOption.calendarBGDom==null){if(null==mRe_calendar){mRe_calendar=this;}var q=this.eform;q.disabledMenu(true);this.viewOption.calendarBGDom=document.createElement("div");this.viewOption.calendarBGDom.className=is_smartphone?"m_eform_calendar_div":"eform_calendar_div";this.viewOption.calendarFrameDom=document.createElement("div");this.viewOption.calendarBGDom.appendChild(this.viewOption.calendarFrameDom);q.targetDiv.appendChild(this.viewOption.calendarBGDom);this.reSize();this.viewOption.calendarBGDom.onclick=function(){mRe_calendar.removeCalendarView();};this.viewOption.calendarFrameDom.onclick=function(i){if(i.stopPropagation){i.stopPropagation();}else{i.cancelBubble=true;}};var h=this.viewOption.calendarFrameDom;var t=document.createElement("div");t.className="eform_calendar_header_div";var o=document.createElement("div");o.className="eform_calendar_body_div";var s=document.createElement("table");s.className="eform_calendar_year_header";var z=document.createElement("tr");var k=document.createElement("td");k.vAlign="middle";k.style.cssText="width:15%;height:60%";var x=document.createElement("button");x.title="이전 년도";x.className="eform_calendar_prev_year";k.appendChild(x);x.onmousedown=function(i){mRe_calendar.moveYear(-1);i.preventDefault();};x.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveYear(-1);}};var d=document.createElement("td");d.vAlign="middle";d.style.cssText="width:11%;height:60%";var l=document.createElement("button");l.title="이전 달";l.className="eform_calendar_prev_month";d.appendChild(l);l.onmousedown=function(i){mRe_calendar.moveMonth(-1);i.preventDefault();};l.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveMonth(-1);}};var A=document.createElement("td");A.vAlign="middle";A.style.cssText="width:48%;height:60%";this.viewOption.textYearMonthDom=A;var e=document.createElement("td");e.vAlign="middle";e.style.cssText="width:11%;height:60%";var f=document.createElement("button");f.title="다음 달";f.className="eform_calendar_next_month";e.appendChild(f);f.onmousedown=function(i){mRe_calendar.moveMonth(1);i.preventDefault();};f.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveMonth(1);}};var a=document.createElement("td");a.vAlign="middle";a.style.cssText="width:15%;height:60%";var w=document.createElement("button");w.title="다음 년도";w.className="eform_calendar_next_year";a.appendChild(w);w.onmousedown=function(i){mRe_calendar.moveYear(1);i.preventDefault();};w.onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){mRe_calendar.moveYear(1);}};z.appendChild(k);z.appendChild(d);z.appendChild(A);z.appendChild(e);z.appendChild(a);s.appendChild(z);t.appendChild(s);var b=document.createElement("table");b.className="eform_calendar_month_header";var y=document.createElement("tr");for(var r=0;r<7;r++){var c=document.createElement("td");c.style.cssText="width:14.3%;height:40%;cursor:default;";c.innerHTML=this.viewOption.dayList[r];y.appendChild(c);}b.appendChild(y);t.appendChild(b);var v=document.createElement("table");v.className="eform_calendar_body";for(var r=0;r<6;r++){y=document.createElement("tr");for(var p=0;p<7;p++){var c=document.createElement("td");c.style.cssText="width:14.3%;height:16.666%;cursor:default;";if(p==0){c.className="eform_calendar_day eform_calendar_sunDay";}else{if(p==6){c.className="eform_calendar_day eform_calendar_saturday";}else{c.className="eform_calendar_day";}}y.appendChild(c);this.viewOption.dayDomList[r][p]=c;}v.appendChild(y);}o.appendChild(v);h.appendChild(t);h.appendChild(o);var m=Number(this.controlData.yearValue);var n=Number(this.controlData.monthValue);var g=Number(this.controlData.dayValue);var u=new Date();if(0==m){m=u.getFullYear();}if(0==n){n=u.getMonth()+1;}if(0==g){g=u.getDate();}if(!mRe_isValidDate(m,n,g)){m=u.getFullYear();n=u.getMonth()+1;u=u.getDate();}this.viewOption.newYear=m;this.viewOption.newMonth=n;this.viewOption.newDay=g;this.insertDay();}};EFormCalendar.prototype.reSize=function(){if(null!=this.viewOption.calendarBGDom){var a=this.eform;var b=a.paintDiv.offsetWidth;var f=a.paintDiv.offsetHeight;var e=0;var c=0;var g=0;var d=is_smartphone?500:420;if(b>f){g=f-40;if(g>d){g=d;c=(f-g)/2;}else{c=20;}e=(b-g)/2;}else{g=b-40;if(g>d){g=d;e=(b-g)/2;}else{e=20;}c=(f-g)/2;}this.viewOption.calendarFrameDom.style.cssText="position:absolute;left:"+e+"px;top:"+c+"px;width:"+g+"px;height:"+g+"px;background-color: white;border: 1px solid gray;";}};EFormCalendar.prototype.insertDay=function(){var g=this;var m,e,c;m=this.viewOption.newYear;e=this.viewOption.newMonth;c=this.viewOption.newDay;this.viewOption.textYearMonthDom.innerHTML=m+"."+e;this.viewOption.textYearMonthDom.style.color="white";var f=new Date(m,e-1,1);var h=f.getDay();var d="312831303130313130313031";var a=d.substring(((e-1)*2),((e-1)*2+2));if((e==2)&&(((m%4==0)&&(m%100!=0))||(m%400==0))){a="29";}var o=this.viewOption.dayDomList;var p=parseInt(a);var b=0;var n=1;for(var l=0;l<6;l++){for(var k=0;k<7;k++){o[l][k].style.backgroundColor="";o[l][k].style.color="";if(b<h||n>p){o[l][k].innerHTML="";o[l][k].title="";o[l][k].tabIndex=-1;o[l][k].onmousedown=null;o[l][k].onkeyup=null;}else{o[l][k].innerHTML=n;o[l][k].title=n+"일";o[l][k].tabIndex=0;if(c==n){o[l][k].focus();}o[l][k].onmousedown=function(i){g.setCalendarValue(this.textContent);i.preventDefault();};o[l][k].onkeyup=function(i){if(32==i.keyCode||13==i.keyCode){g.setCalendarValue(this.textContent);}};n=n+1;}b=b+1;}}};EFormCalendar.prototype.setCalendarValue=function(b){var a=true;if(null!=this.event.dayClickEvent){a=this.event.dayClickEvent(this.viewOption.newYear,this.viewOption.newMonth,b);}if(a){this.setValue(this.viewOption.newYear,this.viewOption.newMonth,b);this.removeCalendarView();if(!this.eform.nextHybridInputControl(this)){this.calendarElement.focus();}else{if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendFocusControl(this,"out");}}}};EFormCalendar.prototype.removeCalendarView=function(){this.eform.disabledMenu(false);this.eform.targetDiv.removeChild(this.viewOption.calendarBGDom);mRe_calendar=null;this.viewOption={calendarBGDom:null,calendarFrameDom:null,textYearMonthDom:null,dayDomList:[[],[],[],[],[],[]],dayList:["SUN","MON","TUE","WED","THU","FRI","SAT"],newYear:0,newMonth:0,newDay:0};};EFormCalendar.prototype.getCtrlID=function(){return this.ctrlID;};EFormCalendar.prototype.getType=function(){return this.controlData.type;};EFormCalendar.prototype.getValue=function(){var a=Number(this.controlData.yearValue);var c=Number(this.controlData.monthValue);var e=Number(this.controlData.dayValue);var g=new Array();switch(this.controlData.displayType){case 0:if(0==a){var b=new Date();a=b.getFullYear();}if(mRe_isValidDate(a,c,e)){g[0]=a+"";if(10>c){g[1]="0"+c;}else{g[1]=c+"";}if(10>e){g[2]="0"+e;}else{g[2]=e+"";}if(3==this.controlData.formatType){g[0]+="년 ";g[1]+="월 ";g[2]+="일";}}else{return"";}break;case 1:if(0<a){g[0]=a+"";}else{return"";}if(0<c&&13>c){if(10>c){g[1]="0"+c;}else{g[1]=c+"";}}else{return"";}if(3==this.controlData.formatType){g[0]+="년 ";g[1]+="월";}break;case 2:if(0==a){var b=new Date();a=b.getFullYear();}if(mRe_isValidDate(a,c,e)){if(10>c){g[0]="0"+c;}else{g[0]=c+"";}if(10>e){g[1]="0"+e;}else{g[1]=e+"";}}else{return"";}if(3==this.controlData.formatType){g[0]+="월 ";g[1]+="일";}break;case 3:if(0<a){if(3==this.controlData.formatType){return a+"년";}return a+"";}else{return"";}break;case 4:var f="";if(0<c&&13>c){if(10>c){f="0"+c;}else{f=c+"";}if(3==this.controlData.formatType){f+="월";}}return f;break;case 5:var d="";if(0<e&&32>e){if(10>e){d="0"+e;}else{d=e+"";}if(3==this.controlData.formatType){d+="일";}}return d;break;default:break;}switch(this.controlData.formatType){case 0:return g.join("-");break;case 1:return g.join("/");break;case 2:return g.join(".");break;case 3:return g.join("");break;default:break;}return"";};EFormCalendar.prototype.moveYear=function(a){this.viewOption.newYear+=a;this.insertDay();};EFormCalendar.prototype.moveMonth=function(a){this.viewOption.newMonth+=a;if(0==this.viewOption.newMonth){this.viewOption.newYear--;this.viewOption.newMonth=12;}else{if(13==this.viewOption.newMonth){this.viewOption.newYear++;this.viewOption.newMonth=1;}}this.insertDay();};EFormCalendar.prototype.setValue=function(c,a,b){this.m_default_setValue(c,a,b);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputCalendar(this,c,a,b);}};EFormCalendar.prototype.m_default_setValue=function(d,a,c){if(this.controlData.yearValue!=d||this.controlData.monthValue!=a||this.controlData.dayValue!=c){this.controlData.yearValue=d+"";this.controlData.monthValue=a+"";this.controlData.dayValue=c+"";var b=this.getValue();if(this.isDOM){if(typeof this.calendarElement_td.innerText!=="undefined"){this.calendarElement_td.firstChild.innerText=b;}else{this.calendarElement_td.firstChild.innerHTML=b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}if(""!=b){this.controlData.is_nc=false;if(this.eform.eForm_isNecessary.check){this.calendarElement_div.className="eF_Rect";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}else{if(""!=b){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}}};EFormCalendar.prototype.getVisible=function(){return this.controlData.visible;};EFormCalendar.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.calendarElement.style.display="";this.calendarElement_div.style.display="";this.calendarElement_td.style.display="";this.calendarElement_focusDiv.style.display="";}else{this.calendarElement.style.display="none";this.calendarElement_div.style.display="none";this.calendarElement_td.style.display="none";this.calendarElement_focusDiv.style.display="none";}}};EFormCalendar.prototype.getDisabled=function(){return this.controlData.disable;};EFormCalendar.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.calendarElement.disabled=true;this.calendarElement_div.className="eF_Rect";this.calendarElement.style.cursor="auto";}else{this.calendarElement.disabled=false;this.calendarElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.calendarElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormCalendar.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.getValue()){this.controlData.is_nc=false;if(this.isDOM){this.calendarElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.calendarElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormCalendar.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormCalendar.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormCalendar.prototype.getTitle=function(){return this.title;};EFormCalendar.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.calendarElement.title=a;}};EFormCalendar.prototype.callInappCalendar=function(){var b=new Date();var a=Number(this.controlData.yearValue);if(a==0){a=b.getFullYear();}var c=Number(this.controlData.monthValue);var d=Number(this.controlData.dayValue);if(!mRe_isValidDate(a,c,d)){a=b.getFullYear();c=b.getMonth()+1;d=b.getDate();}var e=this;window.set_report_inapp_date=function(g,h,f){e.setValue(g,h,f);};if(typeof ClipHybrid!="undefined"){ClipHybrid.getCalendarDate(a,c,d);}else{ReportWebLog("Not Found InappCalendar !!");}};EFormCalendar.prototype.onDayClickEvent=function(a){this.event.dayClickEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormCalendar.prototype.onClick=function(){if(null!=this.event.clickEvent){var a=this.event.clickEvent();if(false==a){return a;}}return true;};EFormCalendar.prototype.focus=function(){if(this.isDOM){var a=this.calendarElement;setTimeout(function(){a.focus();},1);}};EFormCalendar.prototype.focusControl=function(){this.calendarElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}if(this.eform.m_isHybridQuickControl){if(null!=this.controlData.inputOrder&&this.controlData.is_nc){this.eformCalendarControl();if(event.stopPropagation){event.stopPropagation();}else{event.cancelBubble=true;}}}};EFormCalendar.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.calendarElement.focus();}else{this.calendarElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormCalendar.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null,element:null,className:null};if(this.isDOM){this.calendarElement_focusDiv.className="eF_Rect";}};function mRe_isLeaf(b){var a=false;if(b%4==0){a=true;if(b%100==0){a=false;}if(b%400==0){a=true;}}return a;}function mRe_isValidDate(c,e,a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];if(a==0){return false;}var d=false;if(mRe_isLeaf(c)){if(e==2){if(a<=b[e-1]+1){d=true;}}else{if(a<=b[e-1]){d=true;}}}else{if(a<=b[e-1]){d=true;}}return d;}function EFormSelectbox(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.selectboxElement=null;this.selectboxElement_div=null;this.selectboxElement_td=null;this.selectboxElement_focusDiv=null;this.event={changeEvent:null,eventTarget:null};this.title=null;this.viewOption={selectboxBGDom:null,selectboxFrameDom:null};}EFormSelectbox.prototype.setGroup=function(a){this.group=a;};EFormSelectbox.prototype.init=function(b,a,d){this.eform=d;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.label="";for(var c=0;c<this.controlData.options.length;c++){var e=this.controlData.options[c];e.L=e.L.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');e.V=e.V.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(this.controlData.value==e.V){this.controlData.label=e.L;}}if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}mRe_selectbox=null;};EFormSelectbox.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormSelectbox.prototype.deleteDOM=function(){this.isDOM=false;this.selectboxElement=null;this.selectboxElement_div=null;this.selectboxElement_td=null;this.selectboxElement_focusDiv=null;};EFormSelectbox.prototype.getHE=function(){if(this.isDOM){return this.selectboxElement;}return null;};EFormSelectbox.prototype.eventHandlerSelectBox=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.selectboxElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.selectboxElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.selectboxElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.selectboxElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.selectboxElement.title;}else{this.selectboxElement.title=this.title;}if(this.eform.m_isPopupSelect){var g=this.selectboxElement.parentElement;var d=document.createElement("button");d.id=this.selectboxElement.id;d.title=this.title;d.className=this.selectboxElement.className;d.tabIndex=this.selectboxElement.tabIndex;d.style.cssText=this.selectboxElement.style.cssText;g.insertBefore(d,this.selectboxElement);g.removeChild(this.selectboxElement);this.selectboxElement=d;}else{this.selectboxElement.innerHTML="";for(var b=0;b<this.controlData.options.length;b++){var f=this.controlData.options[b];var a=document.createElement("option");a.value=f.V;a.innerHTML=f.L;this.selectboxElement.appendChild(a);}this.selectboxElement.value=this.controlData.value;}var c=this.controlData.label;if(""!=c){this.controlData.is_nc=false;}else{if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}}var e=this;if(null!=this.selectboxElement_focusDiv&&null!=this.selectboxElement){this.selectboxElement.onblur=function(){var h=e.selectboxElement_focusDiv;if(null!=h){h.className="eF_Rect";}if(e.eform.multiView.isSocket){e.eform.multiView.socket.sendFocusControl(e,"out");}};this.selectboxElement.onfocus=function(){e.focusControl();if(e.eform.multiView.isSocket){e.eform.multiView.socket.sendFocusControl(e,"in");}};}if(typeof this.selectboxElement_td.innerText!=="undefined"){this.selectboxElement_td.firstChild.innerText=c;}else{this.selectboxElement_td.firstChild.innerHTML=c.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}if(this.eform.m_isPopupSelect){this.selectboxElement.onmousedown=function(h){e.eformSelectPopupControl();};this.selectboxElement.onkeyup=function(h){if(32==h.keyCode||13==h.keyCode){e.eformSelectPopupControl();}};}else{this.selectboxElement.onchange=function(h){e.EFormSelectboxControl(this);};}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSelectbox.prototype.EFormSelectboxControl=function(a){if(this.eform.m_isButtonLock==false){this.setValue(a.value);this.onChange();this.eform.nextHybridInputControl(this);}};EFormSelectbox.prototype.selectLabelOption=function(a){if(this.eform.m_isButtonLock==false){var b=a.getAttribute("value");if(this.controlData.value!=b){this.setValue(b);this.onChange();this.removeSelectboxView();this.eform.nextHybridInputControl(this);return;}}this.removeSelectboxView();};EFormSelectbox.prototype.eformSelectPopupControl=function(){if(this.eform.m_isButtonLock==false){if(null==mRe_selectbox){mRe_selectbox=this;}var d=this.eform;d.disabledMenu(true);this.viewOption.selectboxBGDom=document.createElement("div");this.viewOption.selectboxBGDom.className=is_smartphone?"m_eform_calendar_div":"eform_calendar_div";this.viewOption.selectboxFrameDom=document.createElement("div");this.viewOption.selectboxFrameDom.tabIndex=0;this.viewOption.selectboxBGDom.appendChild(this.viewOption.selectboxFrameDom);d.targetDiv.appendChild(this.viewOption.selectboxBGDom);this.reSize();this.viewOption.selectboxBGDom.onclick=function(){mRe_selectbox.removeSelectboxView();};this.viewOption.selectboxFrameDom.onclick=function(k){if(k.stopPropagation){k.stopPropagation();}else{k.cancelBubble=true;}};var a=document.createElement("div");a.className="eform_selectbox_menu_top";var j=document.createElement("div");j.className="eform_selectbox_menu_top_text";j.title=this.title;j.innerHTML=this.title;j.tabIndex=0;var i=document.createElement("div");i.className="eform_selectbox_menu_top_close";i.title="닫기";i.tabIndex=0;i.onmousedown=function(k){mRe_selectbox.removeSelectboxView();k.preventDefault();};i.onkeyup=function(k){if(32==k.keyCode||13==k.keyCode){mRe_selectbox.removeSelectboxView();}};a.appendChild(j);a.appendChild(i);var c=document.createElement("div");c.className="eform_selectbox_menu_body";for(var f=0;f<this.controlData.options.length;f++){var h=this.controlData.options[f];var b=document.createElement("div");b.tabIndex=0;b.title=h.L;b.setAttribute("label",h.L);b.setAttribute("value",h.V);b.innerHTML=h.L;b.className="eform_selectbox_menu_list";if(h.V==this.controlData.value){var e=document.createElement("div");e.className="eform_selectbox_menu_selectedList";b.appendChild(e);}c.appendChild(b);b.onmousedown=function(k){mRe_selectbox.selectLabelOption(this);k.preventDefault();};b.onkeyup=function(k){if(32==k.keyCode||13==k.keyCode){mRe_selectbox.selectLabelOption(this);}};}var g=document.createElement("div");g.className="eform_selectbox_menu_bottom";this.viewOption.selectboxFrameDom.appendChild(a);this.viewOption.selectboxFrameDom.appendChild(c);this.viewOption.selectboxFrameDom.appendChild(g);window.setTimeout(function(){mRe_selectbox.viewOption.selectboxFrameDom.focus();},10);}};EFormSelectbox.prototype.removeSelectboxView=function(){this.eform.disabledMenu(false);this.eform.targetDiv.removeChild(this.viewOption.selectboxBGDom);mRe_selectbox=null;this.viewOption={selectboxBGDom:null,selectboxFrameDom:null};this.selectboxElement.focus();};EFormSelectbox.prototype.reSize=function(){if(null!=this.viewOption.selectboxBGDom){var a=this.eform;var b=a.paintDiv.offsetWidth;var f=a.paintDiv.offsetHeight;var e=0;var c=0;var g=0;var d=is_smartphone?500:420;if(b>f){g=f-40;if(g>d){g=d;c=(f-g)/2;}else{c=20;}e=(b-g)/2;}else{g=b-40;if(g>d){g=d;e=(b-g)/2;}else{e=20;}c=(f-g)/2;}var h=g*0.8;e+=(g-h)/2;this.viewOption.selectboxFrameDom.style.cssText="position:absolute;left:"+e+"px;top:"+c+"px;width:"+h+"px;height:"+g+"px;";}};EFormSelectbox.prototype.getCtrlID=function(){return this.ctrlID;};EFormSelectbox.prototype.getType=function(){return this.controlData.type;};EFormSelectbox.prototype.getValue=function(){return this.controlData.value;};EFormSelectbox.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSelectbox(this,"value",a);}};EFormSelectbox.prototype.m_default_setValue=function(a){if(this.controlData.value!=a){this.controlData.value=a;this.changeSelect(a);}};EFormSelectbox.prototype.changeSelect=function(c){var b="";if(this.isDOM){if(this.eform.m_isPopupSelect){for(var a=0;a<this.controlData.options.length;a++){var d=this.controlData.options[a];if(d.V==c){b=d.L;}}}else{this.selectboxElement.value=c;if(this.selectboxElement.selectedIndex!=-1){b=this.selectboxElement[this.selectboxElement.selectedIndex].innerHTML;}}this.controlData.label=b;if(typeof this.selectboxElement_td.innerText!=="undefined"){this.selectboxElement_td.firstChild.innerText=b;}else{this.selectboxElement_td.firstChild.innerHTML=b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}if(""!=b){this.controlData.is_nc=false;if(this.eform.eForm_isNecessary.check){this.selectboxElement_div.className="eF_Rect";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}else{for(var a=0;a<this.controlData.options.length;a++){var d=this.controlData.options[a];if(d.V==c){b=d.L;}}this.controlData.label=b;if(""!=b){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}};EFormSelectbox.prototype.getVisible=function(){return this.controlData.visible;};EFormSelectbox.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.selectboxElement.style.display="";this.selectboxElement_div.style.display="";this.selectboxElement_td.style.display="";this.selectboxElement_focusDiv.style.display="";}else{this.selectboxElement.style.display="none";this.selectboxElement_div.style.display="none";this.selectboxElement_td.style.display="none";this.selectboxElement_focusDiv.style.display="none";}}};EFormSelectbox.prototype.getDisabled=function(){return this.controlData.disable;};EFormSelectbox.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.selectboxElement.disabled=true;this.selectboxElement_div.className="eF_Rect";this.selectboxElement.style.cursor="auto";}else{this.selectboxElement.disabled=false;this.selectboxElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.selectboxElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormSelectbox.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.label){this.controlData.is_nc=false;if(this.isDOM){this.selectboxElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.selectboxElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormSelectbox.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormSelectbox.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormSelectbox.prototype.getTitle=function(){return this.title;};EFormSelectbox.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.selectboxElement.title=a;}};EFormSelectbox.prototype.onChangeEvent=function(a){this.event.changeEvent=a;this.event.eventTarget=this;};EFormSelectbox.prototype.onChange=function(){this.m_default_onChange();if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputSelectbox(this,"change","");}};EFormSelectbox.prototype.m_default_onChange=function(){if(null!=this.event.changeEvent){this.event.changeEvent();}};EFormSelectbox.prototype.setOptions=function(b){try{var d=JSON.parse(b);this.controlData.options=d;if(!this.eform.m_isPopupSelect){if(this.isDOM){this.selectboxElement.innerHTML="";for(var c=0;c<this.controlData.options.length;c++){var g=this.controlData.options[c];var a=document.createElement("option");a.value=g.V;a.innerHTML=g.L;this.selectboxElement.appendChild(a);}}}this.changeSelect(this.controlData.value);}catch(f){ReportWebLog("selectbox의 setOptions 함수에 오류가 발생하였습니다."+f);}};EFormSelectbox.prototype.focus=function(){if(this.isDOM){var a=this.selectboxElement;setTimeout(function(){a.focus();},1);}};EFormSelectbox.prototype.focusControl=function(){this.selectboxElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormSelectbox.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.selectboxElement.focus();}else{this.selectboxElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormSelectbox.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.selectboxElement_focusDiv.className="eF_Rect";}};function EFormButton(){this.eform=null;this.ctrlID=null;this.controlData=null;this.group=null;this.isDOM=false;this.buttonElement=null;this.buttonElement_div=null;this.buttonElement_td=null;this.buttonElement_focusDiv=null;this.event={clickEvent:null,eventTarget:null};this.title=null;this.isSendClickEvent=true;}EFormButton.prototype.setGroup=function(a){this.group=a;};EFormButton.prototype.init=function(b,a,c){this.eform=c;this.ctrlID=b;this.controlData=a;this.controlData.necessaryMessage=a.necessaryMessage.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.value=a.value.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');this.controlData.label=a.label.replace(/\\\//g,"/").replace(/\\\\/g,"\\").replace(/\\\"/g,'"');if(null!=a.inputOrder){this.eform.eFormIndexControlList[a.inputOrder]=this;}if(null==a.indexOrderDisable){a.indexOrderDisable=false;}if(null==a.isToView){a.isToView=true;}else{if(!a.isToView){a.is_nc=false;}}};EFormButton.prototype.deleteMe=function(){this.eform=null;this.ctrlID=null;this.controlData=null;this.event=null;this.group=null;this.deleteDOM();};EFormButton.prototype.deleteDOM=function(){this.isDOM=false;this.buttonElement=null;this.buttonElement_div=null;this.buttonElement_td=null;this.buttonElement_focusDiv=null;};EFormButton.prototype.getHE=function(){if(this.isDOM){return this.buttonElement;}return null;};EFormButton.prototype.eventHandlerButton=function(){if(!this.controlData.isToView){return;}this.isDOM=true;this.buttonElement=document.getElementById(this.eform.m_uid+this.ctrlID);this.buttonElement_div=document.getElementById(this.eform.m_uid+this.ctrlID+"SPAN");this.buttonElement_td=document.getElementById(this.eform.m_uid+this.ctrlID+"TD");this.buttonElement_focusDiv=document.getElementById(this.eform.m_uid+this.ctrlID+"FOCUS");if(null==this.title){this.title=this.buttonElement.title;}else{this.buttonElement.title=this.title;}var b=this.controlData.label;if(""!=ClipStrTrim(this.controlData.value)){this.controlData.is_nc=false;}else{if(this.controlData.isNecessaryCheck=="true"){this.controlData.is_nc=true;}if(this.eform.eForm_isNecessary.check&&this.controlData.is_nc){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}}var a=this;if(null!=this.buttonElement_focusDiv&&null!=this.buttonElement){this.buttonElement.onblur=function(){var c=a.buttonElement_focusDiv;if(null!=c){c.className="eF_Rect";}if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"out");}a.eform.nextHybridInputControl(a);};this.buttonElement.onfocus=function(){a.focusControl();if(a.eform.multiView.isSocket){a.eform.multiView.socket.sendFocusControl(a,"in");}};}if(typeof this.buttonElement_td.innerText!=="undefined"){this.buttonElement_td.firstChild.innerText=b.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.buttonElement_td.firstChild.innerHTML=b.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}this.buttonElement.onmousedown=function(c){a.EFormButtonControl(true);};this.buttonElement.onkeyup=function(c){if(32==c.keyCode||13==c.keyCode){a.EFormButtonControl(true);}};this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormButton.prototype.EFormButtonControl=function(a){if(this.eform.m_isButtonLock==false){this.onClick(a);if(this.eform.multiView.isSocket&&this.isSendClickEvent){this.eform.multiView.socket.sendInputButton(this,"click",a);}}};EFormButton.prototype.getCtrlID=function(){return this.ctrlID;};EFormButton.prototype.getType=function(){return this.controlData.type;};EFormButton.prototype.getValue=function(){return this.controlData.value;};EFormButton.prototype.setValue=function(a){this.m_default_setValue(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputButton(this,"value");}};EFormButton.prototype.m_default_setValue=function(a){if(this.controlData.value!=a){this.controlData.value=a;if(this.isDOM){if(""!=ClipStrTrim(a)){this.controlData.is_nc=false;if(this.eform.eForm_isNecessary.check){this.buttonElement_div.className="eF_Rect";}}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;if(this.eform.eForm_isNecessary.check){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}}}}else{if(""!=ClipStrTrim(a)){this.controlData.is_nc=false;}else{if("true"==this.controlData.isNecessaryCheck){this.controlData.is_nc=true;}}}}};EFormButton.prototype.getLabel=function(){return this.controlData.label;};EFormButton.prototype.setLabel=function(a){this.m_default_setLabel(a);if(this.eform.multiView.isSocket){this.eform.multiView.socket.sendInputButton(this,"label");}};EFormButton.prototype.m_default_setLabel=function(a){if(this.controlData.label!=a){if(this.isDOM){if(typeof this.buttonElement_td.innerText!=="undefined"){this.buttonElement_td.firstChild.innerText=a.replace(/(\\r\\n)|(\\n)/g,String.fromCharCode(13));}else{this.buttonElement_td.firstChild.innerHTML=a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br />\n");}}this.controlData.label=a;}};EFormButton.prototype.getVisible=function(){return this.controlData.visible;};EFormButton.prototype.setVisible=function(a){this.controlData.visible=a;if(this.isDOM){if(a){this.buttonElement.style.display="";this.buttonElement_div.style.display="";this.buttonElement_td.style.display="";this.buttonElement_focusDiv.style.display="";}else{this.buttonElement.style.display="none";this.buttonElement_div.style.display="none";this.buttonElement_td.style.display="none";this.buttonElement_focusDiv.style.display="none";}}};EFormButton.prototype.getDisabled=function(){return this.controlData.disable;};EFormButton.prototype.setDisabled=function(b){this.controlData.disable=b;if(this.isDOM){var a=this.eform.m_eformPageDisabled[this.controlData.pageNumber];if(null==a){a=false;}if(b||a||this.eform.m_eformDisabled){this.buttonElement.disabled=true;this.buttonElement_div.className="eF_Rect";this.buttonElement.style.cursor="auto";}else{this.buttonElement.disabled=false;this.buttonElement.style.cursor="pointer";if(this.eform.eForm_isNecessary.check&&this.controlData.isNecessaryCheck=="true"&&this.controlData.is_nc){this.buttonElement_div.className="eF_Rect eForm_NecessaryCheck";}}}};EFormButton.prototype.setNecessaryCheck=function(a){if(a){this.controlData.isNecessaryCheck="true";if(""!=this.controlData.value){this.controlData.is_nc=false;if(this.isDOM){this.buttonElement_div.className="eF_Rect";}}else{this.controlData.is_nc=true;}}else{this.controlData.is_nc=false;this.controlData.isNecessaryCheck="false";if(this.isDOM){this.buttonElement_div.className="eF_Rect";}}this.setDisabled(this.controlData.disable);this.setVisible(this.controlData.visible);};EFormButton.prototype.getIndexOrderDisabled=function(){return this.controlData.indexOrderDisable;};EFormButton.prototype.setIndexOrderDisabled=function(a){this.controlData.indexOrderDisable=a;};EFormButton.prototype.getTitle=function(){return this.title;};EFormButton.prototype.setTitle=function(a){this.title=a;if(this.isDOM){this.buttonElement.title=a;}};EFormButton.prototype.onClickEvent=function(a){this.event.clickEvent=a;this.event.eventTarget=this;};EFormButton.prototype.onClick=function(a){if(null!=this.event.clickEvent&&a){this.event.clickEvent();}};EFormButton.prototype.click=function(a){if(typeof a=="undefined"){a=true;}this.buttonElement.focus();this.EFormButtonControl(a);};EFormButton.prototype.setMirroringClickEvent=function(a){this.isSendClickEvent=a;};EFormButton.prototype.focus=function(){if(this.isDOM){var a=this.buttonElement;setTimeout(function(){a.focus();},1);}};EFormButton.prototype.focusControl=function(){this.buttonElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl||null!=this.controlData.inputOrder){this.eform.inputOrderFoucs(this);}else{this.eform.inputOrderBlur();}};EFormButton.prototype.multiViewFocus=function(){if(null==mRe_FocusControl.objCtrl||mRe_FocusControl.objCtrl!=this){mRe_FocusControl.objCtrl=this;if(this.isDOM){if(this.eform.m_isMultiViewFoucs){this.buttonElement.focus();}else{this.buttonElement_focusDiv.className="eF_Rect eform_control_focus";if(this.eform.m_isHybridQuickControl){this.eform.inputOrderFoucs(this);}}}}};EFormButton.prototype.multiViewBlur=function(){mRe_FocusControl={objCtrl:null};if(this.isDOM){this.buttonElement_focusDiv.className="eF_Rect";}};Report.prototype.changePalletColor=function(b){var d=b.firstChild.style.backgroundColor;var c=this.eFormDoodleOption.tempPens;if(null!=c.penList){for(var e=0;e<c.penList.length;e++){var a=c.penList[e];a.firstChild.style.backgroundColor=d;if(null!=a.style.border&&""!=a.style.border){a.style.border="2px solid "+d;}}}if(null!=c.opList){for(var e=0;e<c.opList.length;e++){var a=c.opList[e];a.firstChild.style.backgroundColor=d;if(null!=a.style.border&&""!=a.style.border){a.style.border="2px solid "+d;}}}if(null!=c.colorList){for(var e=0;e<c.colorList.length;e++){c.colorList[e].style.border="";}}b.style.border="2px solid "+d;c.color=d;};Report.prototype.changePalletWidth=function(a){var c=this.eFormDoodleOption.tempPens;var b=c.color;if(null!=c.penList){for(var d=0;d<c.penList.length;d++){c.penList[d].style.border="";}a.style.border="2px solid "+b;}c.width=a.firstChild.offsetWidth;};Report.prototype.changePalletOP=function(a){var c=this.eFormDoodleOption.tempPens;var b=c.color;if(null!=c.opList){for(var d=0;d<c.opList.length;d++){c.opList[d].style.border="";}a.style.border="2px solid "+b;}c.op=Number(a.firstChild.style.opacity);};Report.prototype.createPalletPenWidthLayout=function(k,g){var c=this;var a=document.createElement("div");a.style.cssText="position:relative;width:250px;height:50px";var f=document.createElement("div");f.style.cssText="position:relative;width:250px;height:30px";for(var i=0;i<5;i++){var d=getPalletPenWidth(i);var e=document.createElement("span");e.className="eform_pallet_outE";e.style.left=(i*50)+"px";var j=document.createElement("span");j.className="eform_pallet_inE";if(g.width==d){j.style.border="2px solid "+g.color;}var h=document.createElement("span");h.style.cssText="position:absolute;left:"+((40-d)/2)+"px;top:"+((40-d)/2)+"px;width:"+d+"px;height:"+d+"px;border-radius:100%;";h.style.backgroundColor=g.color;g.penList[i]=j;j.onclick=function(){c.changePalletWidth(this);};j.appendChild(h);e.appendChild(j);var b=document.createElement("span");b.className="eform_pallet_outText";b.style.left=(i*50)+"px";b.innerHTML=d>10?(""+d):("0"+d);a.appendChild(e);f.appendChild(b);}k.appendChild(a);k.appendChild(f);};Report.prototype.createPalletOPLayout=function(g,d){var b=this;var j=document.createElement("div");j.style.cssText="position:relative;width:250px;height:50px";var f=document.createElement("div");f.style.cssText="position:relative;width:250px;height:30px";for(var h=0;h<5;h++){var i=getPalletOpacity(h);var c=document.createElement("span");c.className="eform_pallet_outE";c.style.left=(h*50)+"px";var k=document.createElement("span");k.className="eform_pallet_inE";if(d.op==i){k.style.border="2px solid "+d.color;}var e=document.createElement("span");e.style.cssText="position:absolute;left:12px;top:12px;width:16px;height:16px;border-radius:100%;";e.style.backgroundColor=d.color;e.style.opacity=i;d.opList[h]=k;k.onclick=function(){b.changePalletOP(this);};k.appendChild(e);c.appendChild(k);var a=document.createElement("span");a.className="eform_pallet_outText";a.style.left=(h*50)+"px";a.innerHTML=(i*100)+"%";j.appendChild(c);f.appendChild(a);}g.appendChild(j);g.appendChild(f);};Report.prototype.createPalletColorLayout=function(g,h,l){var e=this;var m=document.createElement("div");var d=document.createElement("div");if(l=="height"){m.style.cssText="position:relative;width:250px;height:50px";d.style.cssText="position:relative;width:250px;height:50px";}else{m.style.cssText="position:absolute;width:250px;height:50px";d.style.cssText="position:absolute;left:250px;width:250px;height:50px";}var n=document.createElement("div");for(var j=0;j<5;j++){var c=getPalletColor(j);var f=document.createElement("span");f.className="eform_pallet_outE";f.style.top="0px";f.style.left=(j*50)+"px";var p=document.createElement("span");p.className="eform_pallet_inE";n.style.backgroundColor=c;if(h.color==n.style.backgroundColor){p.style.border="2px solid "+h.color;}var i=document.createElement("span");i.className="eform_pallet_Circle";i.style.backgroundColor=c;h.colorList[j]=p;p.onclick=function(){e.changePalletColor(this);};p.appendChild(i);f.appendChild(p);var k=j+5;c=getPalletColor(k);var b=document.createElement("span");b.className="eform_pallet_outE";b.style.top="0px";b.style.left=(j*50)+"px";var o=document.createElement("span");o.className="eform_pallet_inE";n.style.backgroundColor=c;if(h.color==n.style.backgroundColor){o.style.border="2px solid "+h.color;}var a=document.createElement("span");a.className="eform_pallet_Circle";a.style.backgroundColor=c;h.colorList[k]=o;o.onclick=function(){e.changePalletColor(this);};o.appendChild(a);b.appendChild(o);m.appendChild(f);d.appendChild(b);}g.appendChild(m);g.appendChild(d);};Report.prototype.palletDoodleWidth=function(b){var c=this;var f=this.eFormDoodleOption.tempPens;f.penList=[];f.opList=[];f.colorList=[];var i=document.createElement("div");i.className="eform_pallet_width";var d=document.createElement("div");d.className="eform_pallet_line";d.style.cssText="width:480px;top:53px";i.appendChild(d);d=document.createElement("div");d.className="eform_pallet_line";d.style.cssText="left:249px;top:65px;height:60px;width:0px;";i.appendChild(d);var k=document.createElement("div");k.style.cssText="position:absolute;left:0px;top:50px;width:250px;height:80px";this.createPalletPenWidthLayout(k,f);i.appendChild(k);var e=document.createElement("div");e.style.cssText="position:absolute;top:0px;width:500px;height:50px";this.createPalletColorLayout(e,f,"width");i.appendChild(e);var g=document.createElement("div");g.style.cssText="position:absolute;left:250px;top:50px;width:250px;height:80px";this.createPalletOPLayout(g,f);i.appendChild(g);var j=document.createElement("div");j.style.cssText="position:absolute;top:130px;width:500px;height:60px";var h=document.createElement("button");h.className="eform_pallet_button eform_pallet_button_ok";h.style.left="170px";h.innerHTML=this.m_languageMap.ok;h.onclick=function(){var l=c.eFormDoodleOption;l.pens.width=l.tempPens.width;l.pens.color=l.tempPens.color;l.pens.op=l.tempPens.op;l.tempPens.penList=[];l.tempPens.opList=[];l.tempPens.colorList=[];c.removePalletDoodle();c.penDoodle();};var a=document.createElement("button");a.className="eform_pallet_button eform_pallet_button_cancel";a.style.left="180px";a.innerHTML=this.m_languageMap.cancel;a.onclick=function(){c.removePalletDoodle();};j.appendChild(h);j.appendChild(a);i.appendChild(j);b.appendChild(i);};Report.prototype.palletDoodleHeight=function(b){var c=this;var f=this.eFormDoodleOption.tempPens;f.penList=[];f.opList=[];f.colorList=[];var i=document.createElement("div");i.className="eform_pallet";var d=document.createElement("div");d.className="eform_pallet_line";d.style.top="80px";i.appendChild(d);d=d.cloneNode(true);d.style.top="180px";i.appendChild(d);d=d.cloneNode(true);d.style.top="260px";i.appendChild(d);var k=document.createElement("div");k.style.cssText="position:relative;width:250px;height:80px";this.createPalletPenWidthLayout(k,f);i.appendChild(k);var e=document.createElement("div");e.style.cssText="position:relative;width:250px;height:100px";this.createPalletColorLayout(e,f,"height");i.appendChild(e);var g=document.createElement("div");g.style.cssText="position:relative;width:250px;height:80px";this.createPalletOPLayout(g,f);i.appendChild(g);var j=document.createElement("div");j.style.cssText="position:relative;width:250px;height:60px";var h=document.createElement("button");h.className="eform_pallet_button eform_pallet_button_ok";h.innerHTML=this.m_languageMap.ok;h.onclick=function(){var l=c.eFormDoodleOption;l.pens.width=l.tempPens.width;l.pens.color=l.tempPens.color;l.pens.op=l.tempPens.op;l.tempPens.penList=[];l.tempPens.opList=[];l.tempPens.colorList=[];c.removePalletDoodle();c.penDoodle();};var a=document.createElement("button");a.className="eform_pallet_button eform_pallet_button_cancel";a.innerHTML=this.m_languageMap.cancel;a.onclick=function(){c.removePalletDoodle();};j.appendChild(h);j.appendChild(a);i.appendChild(j);b.appendChild(i);};Report.prototype.EFormTOCView=function(){if(this.m_isEndReport){if(null!=this.m_he_Toc){return;}var f=this;var m=document.createElement("div");m.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;background-color:rgba(0,0,0,0);z-index:1000;";this.targetDiv.appendChild(m);this.m_he_Toc=m;var n=document.createElement("div");n.className="eform_toc_menu_top";var h=document.createElement("div");h.className="eform_toc_menu_top_text";h.innerHTML="페이지 바로가기";var d=document.createElement("div");d.className="eform_toc_menu_top_close";d.onclick=function(){f.EFormCloseTOCView();};n.appendChild(h);n.appendChild(d);var q=document.createElement("div");q.className="eform_toc_menu_body";var p=this.getEFormTOCData();if(null!=p){var i=p.length;for(var g=0;g<i;g++){var c=p[g];var j="eform_toc_list_depth";var e="";var k="";var o=null;switch(c.depth){case 0:e="eform_toc_list_depth_text eform_toc_list_depth1_text";if(this.tocOption.nec[0]){if(c.necessaryControl){j="eform_toc_nec_list_depth";}k+="left:20px;";}else{k+="left:5px;";}if(this.tocOption.viewPN[0].visible){o=document.createElement("div");o.innerHTML=this.tocOption.viewPN[0].startCh+c.page+this.tocOption.viewPN[0].endCh;k+="right:30px;";}else{k+="right:5px;";}break;case 1:e="eform_toc_list_depth_text eform_toc_list_depth2_text";if(this.tocOption.nec[1]){if(c.necessaryControl){j="eform_toc_nec_list_depth";}k+="left:25px;";}else{k+="left:15px;";}if(this.tocOption.viewPN[1].visible){o=document.createElement("div");o.innerHTML=this.tocOption.viewPN[1].startCh+c.page+this.tocOption.viewPN[1].endCh;k+="right:30px;";}else{k+="right:5px;";}break;case 2:e="eform_toc_list_depth_text eform_toc_list_depth3_text";if(this.tocOption.nec[2]){if(c.necessaryControl){j="eform_toc_nec_list_depth";}k+="left:35px;";}else{k+="left:30px;";}if(this.tocOption.viewPN[2].visible){o=document.createElement("div");o.innerHTML=this.tocOption.viewPN[2].startCh+c.page+this.tocOption.viewPN[2].endCh;k+="right:30px;";}else{k+="right:5px;";}break;default:break;}var l=document.createElement("div");l.className=j;var a=document.createElement("div");a.className=e;a.style.cssText=k;a.innerHTML=c.title;a.setAttribute("pageNumber",c.page);a.onclick=function(){var r=this.getAttribute("pageNumber");f.pageMove(Number(r));};l.appendChild(a);if(null!=o){o.className="eform_toc_list_depth_pageNumber";l.appendChild(o);}q.appendChild(l);}}var b=document.createElement("div");b.className="eform_toc_menu_bottom";m.appendChild(n);m.appendChild(q);m.appendChild(b);}else{this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태이거나 목차의 보이기옵션이 false상태에서 EFormTOCView 함수가 호출되었습니다.");}};Report.prototype.EFormCloseTOCView=function(){if(null!=this.m_he_Toc){this.targetDiv.removeChild(this.m_he_Toc);this.m_he_Toc=null;}};Report.prototype.setTOCVisible=function(a){this.m_isTOCVisible=a;};Report.prototype.setTOCNecessaryOption=function(b,a){if(null!=this.tocOption){this.tocOption.nec[(Number(b)-1)]=a;}};Report.prototype.setTOCPageNumberOption=function(b,a,d,c){if(null!=this.tocOption){option=this.tocOption.viewPN[(Number(b)-1)];if(null!=option){option.visible=a;option.startCh=d;option.endCh=c;}}};Report.prototype.getEFormTOCData=function(){if(this.m_isEndReport){if(this.eFormTOCList.length>0){var d=new Array();for(var b in this.eFormData){var a=this.eFormData[b];if(a.visible&&!a.disable&&"true"==a.isNecessaryCheck){d[a.pageNumber]=true;}}var e=this.eFormTOCList.length;for(var c=0;c<e;c++){var f=this.eFormTOCList[c];f.necessaryControl=false;if(null!=d[(f.page-1)]){f.necessaryControl=true;}}d=null;}return this.eFormTOCList;}this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태에서 getEFormTOCData 함수가 호출되었습니다.");return null;};Report.prototype.EFormThumbnailView=function(){if(this.m_isEndReport){if(this.m_isThumbnail){if(null!=this.m_he_Thumbnail){if(this.m_he_Thumbnail.style.display=="none"){this.m_he_Thumbnail.style.display="";if(this.m_thumbnail_count<this.m_pageCount){this.EF_thumbnail_page();}else{this.EF_thumbnail_focus();}}return;}this.m_thumbnail_count=0;var b=this;var g=document.createElement("div");g.style.cssText="position:absolute;left:0px;right:0px;top:0px;bottom:0px;border:0px solid;overflow:hidden;background-color:rgba(0,0,0,0);z-index:1000;";this.targetDiv.appendChild(g);this.m_he_Thumbnail=g;var a=document.createElement("div");a.className="eform_thumbnail_menu_top";var f=document.createElement("div");f.className="eform_thumbnail_menu_top_text";f.innerHTML="페이지 바로가기";var e=document.createElement("div");e.className="eform_thumbnail_menu_top_close";e.onclick=function(){g.style.display="none";};a.appendChild(f);a.appendChild(e);var d=document.createElement("div");d.id=this.m_uid+"thumbnailBody";d.className="eform_thumbnail_menu_body";var c=document.createElement("div");c.className="eform_thumbnail_menu_bottom";g.appendChild(a);g.appendChild(d);g.appendChild(c);this.EF_thumbnail_page();}else{this.debugMeg("report log :: 이 서식에는 Thumbnail 존재하지 않습니다.");}}else{this.debugMeg("report log :: 리포트폼이 완료되지 않은 상태에서 EFormThumbnailView 함수가 호출되었습니다.");}};Report.prototype.EF_thumbnail_page=function(){if(this.m_thumbnail_count<this.m_pageCount){var a=this;var b={uid:this.m_uid,pageNum:this.m_thumbnail_count};var e=this.servletPath;var c=-1!=e.indexOf("?")?"GET":"POST";var d="ClipID=R32&ClipData="+JSON.stringify(b);d=mRe_onBeforeSend(d);$.ajax({type:c,url:e,data:d,success:function(f){f=mRe_onAfterSend(f);if(null!=f){a.EF_thumbnail_MakePage(f);}},error:function(f){a.debugMeg("report log :: 썸네일 관련 이미지 통신 오류 발생 >>>"+f);}});}else{this.EF_thumbnail_focus();}};Report.prototype.EF_thumbnail_MakePage=function(j){var c=document.getElementById(this.m_uid+"thumbnailBody");try{var d=jQuery.parseJSON(j);if(null!=d){if(d.resValue.event==200){var g=d.resValue.pageNum;var b=document.createElement("div");b.className="eform_thumbnail_menu_body_div";b.style.top=(10+(g*5))+"px";var a=this;b.onclick=function(){a.pageMove(g+1);a.EF_thumbnail_focus();};var i=document.createElement("div");i.className="eform_thumbnail_menu_body_img";i.style.backgroundImage="url('data:image/jpg;base64, "+d.resValue.viewData+"')";var h=document.createElement("div");h.innerHTML=""+(g+1);b.appendChild(i);b.appendChild(h);c.appendChild(b);this.m_thumbnail_count++;this.EF_thumbnail_page();}else{this.debugMeg("report log :: 이폼 서버 오류가 발생하였습니다. 서버 로그를 확인하세요 >>> 코드:"+d.resValue.event);}}}catch(f){this.debugMeg("report log :: 이폼 서버 응답 오류 >>> 서버 응답 데이터 없거나  데이터가 잘못되었습니다.");this.debugMeg("report log :: 이폼 서버 응답 >>> "+j);}};Report.prototype.EF_thumbnail_focus=function(){var b=document.getElementById(this.m_uid+"thumbnailBody");try{if(null!=this.m_thumbnailFocusBody){this.m_thumbnailFocusBody.className="eform_thumbnail_menu_body_div";}if(null!=b){var a=b.children[this.beforePageIndex];if(null!=a){a.className="eform_thumbnail_menu_body_focus_div";this.m_thumbnailFocusBody=a;b.scrollTop=a.offsetTop;}}}catch(c){this.debugMeg("report log :: 이폼 썹네일 포커스 오류 >>> "+c);}};var docElem=window.document.documentElement;function getWindow(a){return jQuery.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:false;}jQuery.fn.extend({offset:function(b){if(arguments.length){return b===undefined?this:this.each(function(g){jQuery.offset.setOffset(this,b,g);});}var a,f,d={top:0,left:0},c=this[0],e=c&&c.ownerDocument;if(!e){return;}a=e.documentElement;if(!jQuery.contains(a,c)){return d;}if(typeof c.getBoundingClientRect!==typeof undefined){d=c.getBoundingClientRect();}f=getWindow(e);return{top:d.top+(f.pageYOffset||a.scrollTop)-(a.clientTop||0),left:d.left+(f.pageXOffset||a.scrollLeft)-(a.clientLeft||0)};},offsetCustom:function(b){if(arguments.length){return b===undefined?this:this.each(function(g){jQuery.offset.setOffset(this,b,g);});}var a,f,d={top:0,left:0},c=this[0],e=c&&c.ownerDocument;if(!e){return;}a=e.documentElement;if(!jQuery.contains(a,c)){return d;}if(typeof c.getBoundingClientRect!==typeof undefined){d=c.getBoundingClientRect();}f=getWindow(e);return{top:d.top+(a.scrollTop)-(a.clientTop||0),left:d.left+(a.scrollLeft)-(a.clientLeft||0)};},position:function(){if(!this[0]){return;}var c,d,a={top:0,left:0},b=this[0];if(jQuery.css(b,"position")==="fixed"){d=b.getBoundingClientRect();}else{c=this.offsetParent();d=this.offset();if(!jQuery.nodeName(c[0],"html")){a=c.offset();}a.top+=jQuery.css(c[0],"borderTopWidth",true);a.left+=jQuery.css(c[0],"borderLeftWidth",true);}return{top:d.top-a.top-jQuery.css(b,"marginTop",true),left:d.left-a.left-jQuery.css(b,"marginLeft",true)};},offsetParent:function(){return this.map(function(){var a=this.offsetParent||docElem;while(a&&(!jQuery.nodeName(a,"html")&&jQuery.css(a,"position")==="static")){a=a.offsetParent;}return a||docElem;});}});(function(){var a="jSignature";var i=function(r,t){var s;this.kick=function(){clearTimeout(s);s=setTimeout(t,r);};this.clear=function(){clearTimeout(s);};return this;};var b=function(r){this.topics={};this.context=r?r:this;this.publish=function(w,y,x,t){if(this.topics[w]){var z=this.topics[w],A=Array.prototype.slice.call(arguments,1),C=[],B,v,s,u;for(v=0,s=z.length;v<s;v++){u=z[v];if(null!=u){B=u[0];if(u[1]){u[0]=function(){};C.push(v);}B.apply(this.context,A);}}for(v=0,s=C.length;v<s;v++){z.splice(C[v],1);}}};this.subscribe=function(s,u,t){if(!this.topics[s]){this.topics[s]=[[u,t]];}else{this.topics[s].push([u,t]);}return{topic:s,callback:u};};this.unsubscribe=function(v){if(this.topics[v.topic]){var t=this.topics[v.topic];for(var u=0,s=t.length;u<s;u++){if(null!=t[u]){if(t[u][0]===v.callback){t.splice(u,1);}}}}};};function m(u){var H,t,B=u.css("color"),r,G=u[0];var I=false;while(G&&!r&&!I){try{H=$(G).css("background-color");}catch(F){H="transparent";}if(H!=="transparent"&&H!=="rgba(0, 0, 0, 0)"){r=H;}I=G.body;G=G.parentNode;}var D=/rgb[a]*\((\d+),\s*(\d+),\s*(\d+)/,C=/#([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})([AaBbCcDdEeFf\d]{2})/,s;H=t;H=B.match(D);if(H){s={r:parseInt(H[1],10),g:parseInt(H[2],10),b:parseInt(H[3],10)};}else{H=B.match(C);if(H){s={r:parseInt(H[1],16),g:parseInt(H[2],16),b:parseInt(H[3],16)};}}var y;if(!r){if(s){if(Math.max.apply(null,[s.r,s.g,s.b])>127){y={r:0,g:0,b:0};}else{y={r:255,g:255,b:255};}}else{y={r:255,g:255,b:255};}}else{H=t;H=r.match(D);if(H){y={r:parseInt(H[1],10),g:parseInt(H[2],10),b:parseInt(H[3],10)};}else{H=r.match(C);if(H){y={r:parseInt(H[1],16),g:parseInt(H[2],16),b:parseInt(H[3],16)};}}}var v=function(J){return"rgb("+[J.r,J.g,J.b].join(", ")+")";},A,E,w;if(s&&y){var x=Math.max.apply(null,[s.r,s.g,s.b]);E=Math.max.apply(null,[y.r,y.g,y.b]);w=Math.round(E+(-1*(E-x)*0.75));A={r:w,g:w,b:w};}else{if(s){E=Math.max.apply(null,[s.r,s.g,s.b]);var z=+1;if(E>127){z=-1;}w=Math.round(E+(z*96));A={r:w,g:w,b:w};}else{A={r:191,g:191,b:191};}}return{color:B,"background-color":y?v(y):r,"decor-color":v(A)};}function h(r,t){this.x=r;this.y=t;this.reverse=function(){return new this.constructor(this.x*-1,this.y*-1);};this._length=null;this.getLength=function(){if(!this._length){this._length=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));}return this._length;};var s=function(u){return Math.round(u/Math.abs(u));};this.resizeTo=function(v){if(this.x===0&&this.y===0){this._length=0;}else{if(this.x===0){this._length=v;this.y=v*s(this.y);}else{if(this.y===0){this._length=v;this.x=v*s(this.x);}else{var w=Math.abs(this.y/this.x),u=Math.sqrt(Math.pow(v,2)/(1+Math.pow(w,2))),z=w*u;this._length=v;this.x=u*s(this.x);this.y=z*s(this.y);}}}return this;};this.angleTo=function(u){var v=this.getLength()*u.getLength();if(v===0){return 0;}else{return Math.acos(Math.min(Math.max((this.x*u.x+this.y*u.y)/v,-1),1))/Math.PI;}};}function n(r,s){this.x=r;this.y=s;this.getVectorToCoordinates=function(t,u){return new h(t-this.x,u-this.y);};this.getVectorFromCoordinates=function(t,u){return this.getVectorToCoordinates(t,u).reverse();};this.getVectorToPoint=function(t){return new h(t.x-this.x,t.y-this.y);};this.getVectorFromPoint=function(t){return this.getVectorToPoint(t).reverse();};}function o(r,s,v,A,u){this.data=r;this.context=s;if(r.length){var x=r.length,z,y;for(var w=0;w<x;w++){z=r[w];y=z.x.length;v.call(s,z);for(var t=1;t<y;t++){A.call(s,z,t);}u.call(s,z);}}this.changed=function(){};this.startStrokeFn=v;this.addToStrokeFn=A;this.endStrokeFn=u;this.inStroke=false;this._lastPoint=null;this._stroke=null;this.startStroke=function(B){if(B&&typeof(B.x)=="number"&&typeof(B.y)=="number"){this._stroke={x:[B.x],y:[B.y]};this.data.push(this._stroke);this._lastPoint=B;this.inStroke=true;var E=this._stroke,D=this.startStrokeFn,C=this.context;setTimeout(function(){D.call(C,E);},3);return B;}else{return null;}};this.addToStroke=function(C){if(this.inStroke&&typeof(C.x)==="number"&&typeof(C.y)==="number"&&(Math.abs(C.x-this._lastPoint.x)+Math.abs(C.y-this._lastPoint.y))>4){var B=this._stroke.x.length;this._stroke.x.push(C.x);this._stroke.y.push(C.y);this._lastPoint=C;var F=this._stroke,E=this.addToStrokeFn,D=this.context;setTimeout(function(){E.call(D,F,B);},3);return C;}else{return null;}};this.endStroke=function(){var F=this.inStroke;this.inStroke=false;this._lastPoint=null;if(F){var E=this._stroke,D=this.endStrokeFn,C=this.context,B=this.changed;setTimeout(function(){D.call(C,E);B.call(C);},3);return true;}else{return null;}};}var j=function(s,r,v,u){var t=s.fillStyle;s.fillStyle=s.strokeStyle;s.fillRect(r+u/-2,v+u/-2,u,u);s.fillStyle=t;if(null!=mRe_mirraringData){mRe_mirraringData+="D:"+parseInt(r)+":"+parseInt(v)+":"+parseInt(u)+":";}},e=function(s,t,r,v,u){s.beginPath();s.moveTo(t,r);s.lineTo(v,u);s.stroke();if(null!=mRe_mirraringData){mRe_mirraringData+="L:"+parseInt(v)+":"+parseInt(u)+":";}},p=function(z,s,r,w,v,u,t,y,x){z.beginPath();z.moveTo(s,r);z.bezierCurveTo(u,t,y,x,w,v);z.stroke();if(null!=mRe_mirraringData){mRe_mirraringData+="C:"+parseInt(w)+":"+parseInt(v)+":"+parseInt(u)+":"+parseInt(t)+":"+parseInt(y)+":"+parseInt(x)+":";}},d=function(r){j(this.canvasContext,r.x[0],r.y[0],this.settings.lineWidth);},g=function(E,C){var s=new n(E.x[C-1],E.y[C-1]),x=new n(E.x[C],E.y[C]),t=s.getVectorToPoint(x);if(C>1){var D=new n(E.x[C-2],E.y[C-2]),z=D.getVectorToPoint(s),v;if(z.getLength()>this.lineCurveThreshold){if(C>2){v=(new n(E.x[C-3],E.y[C-3])).getVectorToPoint(D);}else{v=new h(0,0);}var r=0.05,u=z.getLength()*0.35,B=z.angleTo(v.reverse()),A=t.angleTo(z.reverse()),y=new h(v.x+z.x,v.y+z.y).resizeTo(Math.max(r,B)*u),w=(new h(z.x+t.x,z.y+t.y)).reverse().resizeTo(Math.max(r,A)*u);p(this.canvasContext,D.x,D.y,s.x,s.y,D.x+y.x,D.y+y.y,s.x+w.x,s.y+w.y);}}if(t.getLength()<=this.lineCurveThreshold){e(this.canvasContext,s.x,s.y,x.x,x.y);}},l=function(v){var t=v.x.length-1;if(t>0){var x=new n(v.x[t],v.y[t]),s=new n(v.x[t-1],v.y[t-1]),r=s.getVectorToPoint(x),w;if(r.getLength()>this.lineCurveThreshold){if(t>1){w=(new n(v.x[t-2],v.y[t-2])).getVectorToPoint(s);var u=new h(w.x+r.x,w.y+r.y).resizeTo(r.getLength()/2);p(this.canvasContext,s.x,s.y,x.x,x.y,s.x+u.x,s.y+u.y,x.x,x.y);}else{e(this.canvasContext,s.x,s.y,x.x,x.y);}}}};function k(s,u,t,r){if(u==="ratio"||u.split("")[u.length-1]==="%"){this.eventTokens[t+".parentresized"]=r.subscribe(t+".parentresized",(function(y,x,v,w){return function(){var z=x.width();if(z!==v){for(var A in y){if(y.hasOwnProperty(A)){r.unsubscribe(y[A]);delete y[A];}}var B=s.settings;s.$parent.children().remove();for(var A in s){if(s.hasOwnProperty(A)){delete s[A];}}B.data=(function(H,E){var K=[];var C,I,F,G,D,J;for(I=0,F=H.length;I<F;I++){J=H[I];C={x:[],y:[]};for(G=0,D=J.x.length;G<D;G++){C.x.push(J.x[G]*E);C.y.push(J.y[G]*E);}K.push(C);}return K;})(B.data,z*1/v);x[t](B);}};})(this.eventTokens,this.$parent,this.$parent.width(),this.canvas.width*1/this.canvas.height));}}function f(C,F,y){var w=this.$parent=$(C),D=this.eventTokens={},E=this.events=new b(this),t=$.fn[a]("globalEvents"),u={width:"ratio",height:"ratio",sizeRatio:4,color:"#000","background-color":"#fff","decor-color":"#eee",lineWidth:0,minFatFingerCompensation:-10,showUndoButton:false,data:[]};$.extend(u,m(w));if(F){$.extend(u,F);}this.settings=u;for(var B in y){if(y.hasOwnProperty(B)){y[B].call(this,B);}}this.events.publish(a+".initializing");this.$controlbarUpper=(function(){var G="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1em !important;margin-bottom:1em !important;";return $('<div style="'+G+'"></div>').appendTo(w);})();this.isCanvasEmulator=false;var s=this.canvas=this.initializeCanvas(u),A=$(s);this.$controlbarLower=(function(){var G="padding:0 !important;margin:0 !important;width: 100% !important; height: 0 !important;margin-top:-1.5em !important;margin-bottom:1.5em !important;";return $('<div style="'+G+'"></div>').appendTo(w);})();this.canvasContext=s.getContext("2d");A.data(a+".this",this);u.lineWidth=(function(H,G){if(!H){return Math.max(Math.round(G/400),2);}else{return H;}})(u.lineWidth,s.width);this.lineCurveThreshold=u.lineWidth*3;if(u.cssclass&&$.trim(u.cssclass)!=""){A.addClass(u.cssclass);}this.fatFingerCompensation=0;var r=(function(H){var K,J,G=function(){var M=null;if(is_android&&!is_samsung_browser){M=$(H.canvas).offsetCustom();}else{M=$(H.canvas).offset();}K=M.left*-1;J=M.top*-1;},I=function(R){var O=(R.changedTouches&&R.changedTouches.length>0?R.changedTouches[0]:R);var Q=window.Re_zoom;if(null!=Q&&Q.isPop){if(is_PosiFix){return new n(Math.round(O.clientX+K),Math.round(O.clientY+J)+H.fatFingerCompensation);}else{return new n(Math.round(O.pageX+K),Math.round(O.pageY+J)+H.fatFingerCompensation);}}else{var P=Q.rate;if(P==0){P=1;}P=P*0.5;var M;var S;if(is_smartphone){if(is_PosiFix){M=((K*P)+O.clientX)/P;S=((J*P)+O.clientY)/P;}else{M=((K*P)+O.pageX)/P;S=((J*P)+O.pageY)/P;}}else{var N=P;if(is_edge||is_firefox||is_ie){N=1;}if(is_PosiFix){M=((K*N)+O.clientX)/P;S=((J*N)+O.clientY)/P;}else{M=((K*N)+O.pageX)/P;S=((J*N)+O.pageY)/P;}}return new n(Math.round(M),Math.round(S)+H.fatFingerCompensation);}},L=new i(750,function(){H.dataEngine.endStroke();});this.drawEndHandler=function(N){L.clear();if(H.dataEngine){H.dataEngine.endStroke();}try{if(N.cancelable){N.preventDefault();}}catch(M){window.mRe_ccancels=M.message;}};this.drawStartHandler=function(M){if(M.cancelable){M.preventDefault();}G();H.dataEngine.startStroke(I(M));L.kick();};this.drawMoveHandler=function(M){M.preventDefault();if(!H.dataEngine.inStroke){return;}H.dataEngine.addToStroke(I(M));L.kick();};return this;}).call({},this);(function(L,J,H){var G=this.canvas,K=$(G),I;if(this.isCanvasEmulator){K.bind("mousemove."+a,H);K.bind("mouseup."+a,L);K.bind("mousedown."+a,J);}else{G.ontouchstart=function(M){G.onmousedown=I;G.onmouseup=I;G.onmousemove=I;this.fatFingerCompensation=(u.minFatFingerCompensation&&u.lineWidth*-3>u.minFatFingerCompensation)?u.lineWidth*-3:u.minFatFingerCompensation;J(M);G.ontouchend=L;G.ontouchstart=J;G.ontouchmove=H;};G.onmousedown=function(M){G.ontouchstart=I;G.ontouchend=I;G.ontouchmove=I;J(M);G.onmousedown=J;G.onmouseup=L;G.onmousemove=H;};}}).call(this,r.drawEndHandler,r.drawStartHandler,r.drawMoveHandler);D[a+".windowmouseup"]=t.subscribe(a+".windowmouseup",r.drawEndHandler);this.events.publish(a+".attachingEventHandlers");k.call(this,this,u.width.toString(10),a,t);if(null!=u.imageData&&""!=u.imageData){var z=this.canvasContext;var v=this;var x=new Image();x.onload=function(){z.drawImage(this,0,0,s.width,s.height);v.startResetCanvas(u.data);v.events.publish(a+".initialized");};x.src="data:image/png;base64,"+decodeURIComponent(u.imageData);u.imageData=null;}else{this.resetCanvas(u.data);this.events.publish(a+".initialized");}return this;}f.prototype.startResetCanvas=function(x){var t=this.canvas,v=this.settings,z=this.canvasContext,s=this.isCanvasEmulator,w=t.width,r=t.height;z.lineWidth=Math.ceil(parseInt(v.lineWidth,10));z.lineCap=z.lineJoin="round";z.strokeStyle=v["decor-color"];z.shadowOffsetX=0;z.shadowOffsetY=0;var u=Math.round(r/5);e(z,u*1.5,r-u,w-(u*1.5),r-u);z.strokeStyle=v.color;if(!s){z.shadowColor=z.strokeStyle;z.shadowOffsetX=z.lineWidth*0.5;z.shadowOffsetY=z.lineWidth*-0.6;z.shadowBlur=0;}if(!x){x=[];}var y=this.dataEngine=new o(x,this,d,g,l);v.data=x;$(t).data(a+".data",x).data(a+".settings",v);y.changed=(function(C,A,B){return function(){A.publish(B+".change");C.trigger("change");};})(this.$parent,this.events,a);y.changed();return true;};f.prototype.resetCanvas=function(x){var t=this.canvas,v=this.settings,z=this.canvasContext,s=this.isCanvasEmulator,w=t.width,r=t.height;z.clearRect(0,0,w+30,r+30);z.shadowColor=z.fillStyle=v["background-color"];if(s){z.fillRect(0,0,w+30,r+30);}z.lineWidth=Math.ceil(parseInt(v.lineWidth,10));z.lineCap=z.lineJoin="round";z.strokeStyle=v["decor-color"];z.shadowOffsetX=0;z.shadowOffsetY=0;var u=Math.round(r/5);e(z,u*1.5,r-u,w-(u*1.5),r-u);z.strokeStyle=v.color;if(!s){z.shadowColor=z.strokeStyle;z.shadowOffsetX=z.lineWidth*0.5;z.shadowOffsetY=z.lineWidth*-0.6;z.shadowBlur=0;}if(!x){x=[];}var y=this.dataEngine=new o(x,this,d,g,l);v.data=x;$(t).data(a+".data",x).data(a+".settings",v);y.changed=(function(C,A,B){return function(){A.publish(B+".change");C.trigger("change");};})(this.$parent,this.events,a);y.changed();return true;};function q(r){if(r.getContext){return false;}else{var v=r.ownerDocument.parentWindow;var u=v.FlashCanvas?r.ownerDocument.parentWindow.FlashCanvas:(typeof FlashCanvas==="undefined"?undefined:FlashCanvas);if(u){r=u.initElement(r);var t=1;if(v&&v.screen&&v.screen.deviceXDPI&&v.screen.logicalXDPI){t=v.screen.deviceXDPI*1/v.screen.logicalXDPI;}if(t!==1){try{$(r).children("object").get(0).resize(Math.ceil(r.width*t),Math.ceil(r.height*t));r.getContext("2d").scale(t,t);}catch(s){v.mRe_ccancels=s.message;}}return true;}else{ReportWebLog("Canvas element does not support 2d context. jSignature cannot proceed.");}}}f.prototype.initializeCanvas=function(s){var r=document.createElement("canvas"),t=$(r);if(s.width===s.height&&s.height==="ratio"){s.width="100%";}t.css("margin",0).css("padding",0).css("border","none").css("height",s.height==="ratio"||!s.height?1:s.height.toString(10)).css("width",s.width==="ratio"||!s.width?1:s.width.toString(10));t.appendTo(this.$parent);if(s.height==="ratio"){t.css("height",Math.round(t.width()/s.sizeRatio));}else{if(s.width==="ratio"){t.css("width",Math.round(t.height()*s.sizeRatio));}}t.addClass(a);r.width=t.width();r.height=t.height();this.isCanvasEmulator=q(r);r.onselectstart=function(u){if(u&&u.preventDefault){u.preventDefault();}if(u&&u.stopPropagation){u.stopPropagation();}return false;};return r;};var c=function(B){var s=new b();(function(C,G,H,F){var D,E=function(){C.publish(G+".parentresized");};H(F).bind("resize."+G,function(){if(D){clearTimeout(D);}D=setTimeout(E,500);}).bind("mouseup."+G,function(I){C.publish(G+".windowmouseup");});})(s,a,$,B);var y={};var r={"default":function(C){return this.toDataURL();},"native":function(C){return C;},image:function(E){var D=this.toDataURL();if(typeof D==="string"&&D.length>4&&D.slice(0,5)==="data:"&&D.indexOf(",")!==-1){var C=D.indexOf(",");return[D.slice(5,C),D.substr(C+1)];}return[];}};function A(E,G,D){var C=new Image(),F=this;C.onload=function(){var H=F.getContext("2d").drawImage(C,0,0,(C.width<F.width)?C.width:F.width,(C.height<F.height)?C.height:F.height);};C.src="data:"+G+","+E;}var t={"native":function(D,E,C){C(D);},image:A,"image/png;base64":A,"image/jpeg;base64":A,"image/jpg;base64":A};function w(C){this.find("canvas."+a).add(this.filter("canvas."+a)).data(a+".this").resetCanvas(C);return this;}function z(E,F){var C;if(F===C&&typeof E==="string"&&E.substr(0,5)==="data:"){F=E.slice(5).split(",")[0];E=E.slice(6+F.length);if(F===E){return;}}var D=this.find("canvas."+a).add(this.filter("canvas."+a));if(!t.hasOwnProperty(F)){ReportWebLog(a+" is unable to find import plugin with for format '"+String(F)+"'");}else{if(D.length!==0){t[F].call(D[0],E,F,(function(G){return function(){return G.resetCanvas.apply(G,arguments);};})(D.data(a+".this")));}}return this;}var x=function(D){var C=false;D=D.parentNode;while(D&&!C){C=D.body;D=D.parentNode;}return !C;};var v={"export":r,"import":t,instance:y},u={init:function(C){return this.each(function(){if(!x(this)){new f(this,C,y);}});},getSettings:function(){return this.find("canvas."+a).add(this.filter("canvas."+a)).data(a+".this").settings;},clear:w,reset:w,addPlugin:function(E,D,C){if(v.hasOwnProperty(E)){v[E][D]=C;}return this;},listPlugins:function(F){var D=[];if(v.hasOwnProperty(F)){var E=v[F];for(var C in E){if(E.hasOwnProperty(C)){D.push(C);}}}return D;},getData:function(E){var C,D=this.find("canvas."+a).add(this.filter("canvas."+a));if(E===C){E="default";}if(D.length!==0&&r.hasOwnProperty(E)){return r[E].call(D.get(0),D.data(a+".data"));}},importData:z,setData:z,globalEvents:function(){return s;},events:function(){return this.find("canvas."+a).add(this.filter("canvas."+a)).data(a+".this").events;}};$.fn[a]=function(C){if(!C||typeof C==="object"){return u.init.apply(this,arguments);}else{if(typeof C==="string"&&u[C]){return u[C].apply(this,Array.prototype.slice.call(arguments,1));}else{$.error("Method "+String(C)+" does not exist on jQuery."+a);}}};};c(window);})();
/*!
* jQuery Mobile v1.4.4
* http://jquerymobile.com
*
* Copyright 2010, 2014 jQuery Foundation, Inc. and other contributors
* Released under the MIT license.
* http://jquery.org/license
*
*/
(function(a,c,b){if(typeof define==="function"&&define.amd){define(["jquery"],function(d){b(d,a,c);return d.mobile;});}else{b(a.jQuery,a,c);}}(this,document,function(c,b,a,d){
/*!
 * jQuery hashchange event - v1.3 - 7/21/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,i,f){var g="hashchange",l=a,j,k=$.event.special,m=l.documentMode,h="on"+g in i&&(m===f||m>7);function e(n){n=n||location.href;return"#"+n.replace(/^[^#]*#?(.*)$/,"$1");}$.fn[g]=function(n){return n?this.bind(g,n):this.trigger(g);};$.fn[g].delay=50;k[g]=$.extend(k[g],{setup:function(){if(h){return false;}$(j.start);},teardown:function(){if(h){return false;}$(j.stop);}});j=(function(){var n={},t,q=e(),o=function(u){return u;},p=o,s=o;n.start=function(){t||r();};n.stop=function(){t&&clearTimeout(t);t=f;};function r(){var v=e(),u=s(q);if(v!==q){p(q=v,u);$(i).trigger(g);}else{if(u!==q){location.href=location.href.replace(/#.*/,"")+u;}}t=setTimeout(r,$.fn[g].delay);}i.attachEvent&&!i.addEventListener&&!h&&(function(){var u,v;n.start=function(){if(!u){v=$.fn[g].src;v=v&&v+e();u=$('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){v||p(e());r();}).attr("src",v||"javascript:0").insertAfter("body")[0].contentWindow;l.onpropertychange=function(){try{if(event.propertyName==="title"){u.document.title=l.title;}}catch(w){i.mRe_ccancels=w.message;}};}};n.stop=o;s=function(){return e(u.location.href);};p=function(z,w){var y=u.document,x=$.fn[g].domain;if(z!==w){y.title=l.title;y.open();x&&y.write('\x3cscript>document.domain="'+x+'"\x3c/script>');y.close();u.location.hash=z;}};})();return n;})();})(c,this);(function(e){e.mobile={};}(c));(function(f,e,g){f.extend(f.mobile,{version:"1.4.4",subPageUrlKey:"ui-page",hideUrlBar:true,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:true,hashListeningEnabled:true,linkBindingEnabled:true,defaultPageTransition:"fade",maxTransitionWidth:false,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:false,autoInitializePage:true,pushStateEnabled:true,ignoreContentEnabled:false,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:true,pageContainer:f(),allowCrossDomainPages:false,dialogHashKey:"&ui-state=dialog"});})(c,this);(function(j,h,k){var g={},f=j.find,i=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,e=/:jqmData\(([^)]*)\)/g;j.extend(j.mobile,{ns:"",getAttribute:function(m,l){var o;m=m.jquery?m[0]:m;if(m&&m.getAttribute){o=m.getAttribute("data-"+j.mobile.ns+l);}try{o=o==="true"?true:o==="false"?false:o==="null"?null:+o+""===o?+o:i.test(o)?JSON.parse(o):o;}catch(n){h.mRe_ccancels=n.message;}return o;},nsNormalizeDict:g,nsNormalize:function(l){return g[l]||(g[l]=j.camelCase(j.mobile.ns+l));},closestPageData:function(l){return l.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page");}});j.fn.jqmData=function(n,m){var l;if(typeof n!=="undefined"){if(n){n=j.mobile.nsNormalize(n);}if(arguments.length<2||m===k){l=this.data(n);}else{l=this.data(n,m);}}return l;};j.jqmData=function(m,o,n){var l;if(typeof o!=="undefined"){l=j.data(m,o?j.mobile.nsNormalize(o):o,n);}return l;};j.fn.jqmRemoveData=function(l){return this.removeData(j.mobile.nsNormalize(l));};j.jqmRemoveData=function(l,m){return j.removeData(l,j.mobile.nsNormalize(m));};j.find=function(m,o,n,l){if(m.indexOf(":jqmData")>-1){m=m.replace(e,"[data-"+(j.mobile.ns||"")+"$1]");}return f.call(this,m,o,n,l);};j.extend(j.find,f);})(c,this);
/*!
 * jQuery UI Core c0ab71056b936627e8a7821f03c044aec6280a40
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
(function(f,j){var e=0,i=/^ui-id-\d+$/;f.ui=f.ui||{};f.extend(f.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});f.fn.extend({focus:(function(k){return function(l,m){return typeof l==="number"?this.each(function(){var n=this;setTimeout(function(){f(n).focus();if(m){m.call(n);}},l);}):k.apply(this,arguments);};})(f.fn.focus),scrollParent:function(){var k;if((f.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){k=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(f.css(this,"position"))&&(/(auto|scroll)/).test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"));}).eq(0);}else{k=this.parents().filter(function(){return(/(auto|scroll)/).test(f.css(this,"overflow")+f.css(this,"overflow-y")+f.css(this,"overflow-x"));}).eq(0);}return(/fixed/).test(this.css("position"))||!k.length?f(this[0].ownerDocument||a):k;},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++e);}});},removeUniqueId:function(){return this.each(function(){if(i.test(this.id)){f(this).removeAttr("id");}});}});function h(m,k){var o,n,l,p=m.nodeName.toLowerCase();if("area"===p){o=m.parentNode;n=o.name;if(!m.href||!n||o.nodeName.toLowerCase()!=="map"){return false;}l=f("img[usemap=#"+n+"]")[0];return !!l&&g(l);}return(/input|select|textarea|button|object/.test(p)?!m.disabled:"a"===p?m.href||k:k)&&g(m);}function g(k){return f.expr.filters.visible(k)&&!f(k).parents().addBack().filter(function(){return f.css(this,"visibility")==="hidden";}).length;}f.extend(f.expr[":"],{data:f.expr.createPseudo?f.expr.createPseudo(function(k){return function(l){return !!f.data(l,k);};}):function(m,l,k){return !!f.data(m,k[3]);},focusable:function(k){return h(k,!isNaN(f.attr(k,"tabindex")));},tabbable:function(m){var k=f.attr(m,"tabindex"),l=isNaN(k);return(l||k>=0)&&h(m,!l);}});if(!f("<a>").outerWidth(1).jquery){f.each(["Width","Height"],function(m,k){var l=k==="Width"?["Left","Right"]:["Top","Bottom"],n=k.toLowerCase(),p={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};function o(s,r,q,t){f.each(l,function(){r-=parseFloat(f.css(s,"padding"+this))||0;if(q){r-=parseFloat(f.css(s,"border"+this+"Width"))||0;}if(t){r-=parseFloat(f.css(s,"margin"+this))||0;}});return r;}f.fn["inner"+k]=function(q){if(q===j){return p["inner"+k].call(this);}return this.each(function(){f(this).css(n,o(this,q)+"px");});};f.fn["outer"+k]=function(q,r){if(typeof q!=="number"){return p["outer"+k].call(this,q);}return this.each(function(){f(this).css(n,o(this,q,true,r)+"px");});};});}if(!f.fn.addBack){f.fn.addBack=function(k){return this.add(k==null?this.prevObject:this.prevObject.filter(k));};}if(f("<a>").data("a-b","a").removeData("a-b").data("a-b")){f.fn.removeData=(function(k){return function(l){if(arguments.length){return k.call(this,f.camelCase(l));}else{return k.call(this);}};})(f.fn.removeData);}f.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());f.support.selectstart="onselectstart" in a.createElement("div");f.fn.extend({disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(k){k.preventDefault();});},enableSelection:function(){return this.unbind(".ui-disableSelection");},zIndex:function(n){if(n!==j){return this.css("zIndex",n);}if(this.length){var l=f(this[0]),k,m;while(l.length&&l[0]!==a){k=l.css("position");if(k==="absolute"||k==="relative"||k==="fixed"){m=parseInt(l.css("zIndex"),10);if(!isNaN(m)&&m!==0){return m;}}l=l.parent();}}return 0;}});f.ui.plugin={add:function(l,m,o){var k,n=f.ui[l].prototype;for(k in o){n.plugins[k]=n.plugins[k]||[];n.plugins[k].push([m,o[k]]);}},call:function(k,n,m,l){var o,p=k.plugins[n];if(!p){return;}if(!l&&(!k.element[0].parentNode||k.element[0].parentNode.nodeType===11)){return;}for(o=0;o<p.length;o++){if(k.options[p[o][0]]){p[o][1].apply(k.element,m);}}}};})(c);(function(g,f,h){var e=function(n,m){var i=n.parent(),p=[],j=i.children(":jqmData(role='header')"),l=n.children(":jqmData(role='header')"),o=i.children(":jqmData(role='footer')"),k=n.children(":jqmData(role='footer')");if(l.length===0&&j.length>0){p=p.concat(j.toArray());}if(k.length===0&&o.length>0){p=p.concat(o.toArray());}g.each(p,function(q,r){m-=g(r).outerHeight();});return Math.max(0,m);};g.extend(g.mobile,{window:g(f),document:g(a),keyCode:g.ui.keyCode,behaviors:{},silentScroll:function(i){if(g.type(i)!=="number"){i=g.mobile.defaultHomeScroll;}g.event.special.scrollstart.enabled=false;setTimeout(function(){f.scrollTo(0,i);g.mobile.document.trigger("silentscroll",{x:0,y:i});},20);setTimeout(function(){g.event.special.scrollstart.enabled=true;},150);},getClosestBaseUrl:function(k){var i=g(k).closest(".ui-page").jqmData("url"),j=g.mobile.path.documentBase.hrefNoHash;if(!g.mobile.dynamicBaseEnabled||!i||!g.mobile.path.isPath(i)){i=j;}return g.mobile.path.makeUrlAbsolute(i,j);},removeActiveLinkClass:function(i){if(!!g.mobile.activeClickedLink&&(!g.mobile.activeClickedLink.closest("."+g.mobile.activePageClass).length||i)){g.mobile.activeClickedLink.removeClass(g.mobile.activeBtnClass);}g.mobile.activeClickedLink=null;},getInheritedTheme:function(n,j){var o=n[0],k="",l=/ui-(bar|body|overlay)-([a-z])\b/,p,i;while(o){p=o.className||"";if(p&&(i=l.exec(p))&&(k=i[2])){break;}o=o.parentNode;}return k||j||"a";},enhanceable:function(i){return this.haveParents(i,"enhance");},hijackable:function(i){return this.haveParents(i,"ajax");},haveParents:function(j,p){if(!g.mobile.ignoreContentEnabled){return j;}var m=j.length,k=g(),o,r,n,l,q;for(l=0;l<m;l++){r=j.eq(l);n=false;o=j[l];while(o){q=o.getAttribute?o.getAttribute("data-"+g.mobile.ns+p):"";if(q==="false"){n=true;break;}o=o.parentNode;}if(!n){k=k.add(r);}}return k;},getScreenHeight:function(){return f.innerHeight||g.mobile.window.height();},resetActivePageHeight:function(i){var l=g("."+g.mobile.activePageClass),k=l.height(),j=l.outerHeight(true);i=e(l,(typeof i==="number")?i:g.mobile.getScreenHeight());l.css("min-height","");if(l.height()<i){l.css("min-height",i-(j-k));}},loading:function(){var i=this.loading._widget||g(g.mobile.loader.prototype.defaultHtml).loader(),j=i.loader.apply(i,arguments);this.loading._widget=i;return j;}});g.addDependents=function(j,k){var i=g(j),l=i.jqmData("dependents")||g();i.jqmData("dependents",g(l).add(k));};g.fn.extend({removeWithDependents:function(){g.removeWithDependents(this);},enhanceWithin:function(){var j,l={},i=g.mobile.page.prototype.keepNativeSelector(),k=this;if(g.mobile.nojs){g.mobile.nojs(this);}if(g.mobile.links){g.mobile.links(this);}if(g.mobile.degradeInputsWithin){g.mobile.degradeInputsWithin(this);}if(g.fn.buttonMarkup){this.find(g.fn.buttonMarkup.initSelector).not(i).jqmEnhanceable().buttonMarkup();}if(g.fn.fieldcontain){this.find(":jqmData(role='fieldcontain')").not(i).jqmEnhanceable().fieldcontain();}g.each(g.mobile.widgets,function(m,n){if(n.initSelector){var o=g.mobile.enhanceable(k.find(n.initSelector));if(o.length>0){o=o.not(i);}if(o.length>0){l[n.prototype.widgetName]=o;}}});for(j in l){l[j][j]();}return this;},addDependents:function(i){g.addDependents(this,i);},getEncodedText:function(){return g("<a>").text(this.text()).html();},jqmEnhanceable:function(){return g.mobile.enhanceable(this);},jqmHijackable:function(){return g.mobile.hijackable(this);}});g.removeWithDependents=function(j){var i=g(j);(i.jqmData("dependents")||g()).remove();i.remove();};g.addDependents=function(k,j){var i=g(k),l=i.jqmData("dependents")||g();i.jqmData("dependents",g(l).add(j));};g.find.matches=function(i,j){return g.find(i,null,null,j);};g.find.matchesSelector=function(i,j){return g.find(j,null,null,[i]).length>0;};})(c,this);(function(e,f){
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
b.matchMedia=b.matchMedia||(function(k,l){var i,g=k.documentElement,h=g.firstElementChild||g.firstChild,j=k.createElement("body"),m=k.createElement("div");m.id="mq-test-1";m.style.cssText="position:absolute;top:-100em";j.style.background="none";j.appendChild(m);return function(n){m.innerHTML='&shy;<style media="'+n+'"> #mq-test-1 { width: 42px; }</style>';g.insertBefore(j,h);i=m.offsetWidth===42;g.removeChild(j);return{matches:i,media:n};};}(a));e.mobile.media=function(g){return b.matchMedia(g).matches;};})(c);(function(f,g){var e={touch:"ontouchend" in a};f.mobile.support=f.mobile.support||{};f.extend(f.support,e);f.extend(f.mobile.support,e);}(c));(function(e,f){e.extend(e.support,{orientation:"orientation" in b&&"onorientationchange" in b});}(c));(function(k,h){function g(y){var x=y.charAt(0).toUpperCase()+y.substr(1),w=(y+" "+r.join(x+" ")+x).split(" "),u;for(u in w){if(p[w[u]]!==h){return true;}}}var i=k("<body>").prependTo("html"),p=i[0].style,r=["Webkit","Moz","O"],t="palmGetResource" in b,q=b.operamini&&({}).toString.call(b.operamini)==="[object OperaMini]",o=b.blackberry&&!g("-webkit-transform"),n;function l(){var u=b,x=!!u.document.createElementNS&&!!u.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&!(u.opera&&navigator.userAgent.indexOf("Chrome")===-1),y=function(w){if(!(w&&x)){k("html").addClass("ui-nosvg");}},v=new u.Image();v.onerror=function(){y(false);};v.onload=function(){y(v.width===1&&v.height===1);};v.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";}function j(){var y="transform-3d",u=k.mobile.media("(-"+r.join("-"+y+"),(-")+"-"+y+"),("+y+")"),x,w,v;if(u){return !!u;}x=a.createElement("div");w={MozTransform:"-moz-transform",transform:"transform"};i.append(x);for(v in w){if(x.style[v]!==h){x.style[v]="translate3d( 100px, 1px, 1px )";u=b.getComputedStyle(x).getPropertyValue(w[v]);}}return(!!u&&u!=="none");}function f(){var y=location.protocol+"//"+location.host+location.pathname+"ui-dir/",x=k("head base"),z=null,u="",w,v;if(!x.length){x=z=k("<base>",{href:y}).appendTo("head");}else{u=x.attr("href");}w=k("<a href='testurl' />").prependTo(i);v=w[0].href;x[0].href=u||location.pathname;if(z){z.remove();}return v.indexOf(y)===0;}function s(){var v=a.createElement("x"),w=a.documentElement,x=b.getComputedStyle,u;if(!("pointerEvents" in v.style)){return false;}v.style.pointerEvents="auto";v.style.pointerEvents="x";w.appendChild(v);u=x&&x(v,"").pointerEvents==="auto";w.removeChild(v);return !!u;}function e(){var u=a.createElement("div");return typeof u.getBoundingClientRect!=="undefined";}k.extend(k.mobile,{browser:{}});k.mobile.browser.oldIE=(function(){var w=3,x=a.createElement("div"),u=x.all||[];do{x.innerHTML="<!--[if gt IE "+(++w)+"]><br><![endif]-->";}while(u[0]);return w>4?w:!w;})();function m(){var D=b,v=navigator.userAgent,y=navigator.platform,C=v.match(/AppleWebKit\/([0-9]+)/),B=!!C&&C[1],x=v.match(/Fennec\/([0-9]+)/),z=!!x&&x[1],A=v.match(/Opera Mobi\/([0-9]+)/),u=!!A&&A[1];if(((y.indexOf("iPhone")>-1||y.indexOf("iPad")>-1||y.indexOf("iPod")>-1)&&B&&B<534)||(D.operamini&&({}).toString.call(D.operamini)==="[object OperaMini]")||(A&&u<7458)||(v.indexOf("Android")>-1&&B&&B<533)||(z&&z<6)||("palmGetResource" in b&&B&&B<534)||(v.indexOf("MeeGo")>-1&&v.indexOf("NokiaBrowser/8.5.0")>-1)){return false;}return true;}k.extend(k.support,{pushState:"pushState" in history&&"replaceState" in history&&!(b.navigator.userAgent.indexOf("Firefox")>=0&&b.top!==b)&&(b.navigator.userAgent.search(/CriOS/)===-1),mediaquery:k.mobile.media("only all"),cssPseudoElement:!!g("content"),touchOverflow:!!g("overflowScrolling"),cssTransform3d:j(),boxShadow:!!g("boxShadow")&&!o,fixedPosition:m(),scrollTop:("pageXOffset" in b||"scrollTop" in a.documentElement||"scrollTop" in i[0])&&!t&&!q,dynamicBaseTag:f(),cssPointerEvents:s(),boundingRect:e(),inlineSVG:l});i.remove();n=(function(){var u=b.navigator.userAgent;return u.indexOf("Nokia")>-1&&(u.indexOf("Symbian/3")>-1||u.indexOf("Series60/5")>-1)&&u.indexOf("AppleWebKit")>-1&&u.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/);})();k.mobile.gradeA=function(){return((k.support.mediaquery&&k.support.cssPseudoElement)||k.mobile.browser.oldIE&&k.mobile.browser.oldIE>=8)&&(k.support.boundingRect||k.fn.jquery.match(/1\.[0-7+]\.[0-9+]?/)!==null);};k.mobile.ajaxBlacklist=b.blackberry&&!b.WebKitPoint||q||n;if(n){k(function(){k("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet");});}if(!k.support.boxShadow){k("html").addClass("ui-noboxshadow");}})(c);(function(g,h){var i=g.mobile.window,f,e=function(){};g.event.special.beforenavigate={setup:function(){i.on("navigate",e);},teardown:function(){i.off("navigate",e);}};g.event.special.navigate=f={bound:false,pushStateEnabled:true,originalEventName:h,isPushStateEnabled:function(){return g.support.pushState&&g.mobile.pushStateEnabled===true&&this.isHashChangeEnabled();},isHashChangeEnabled:function(){return g.mobile.hashListeningEnabled===true;},popstate:function(j){var l=new g.Event("navigate"),m=new g.Event("beforenavigate"),k=j.originalEvent.state||{};m.originalEvent=j;i.trigger(m);if(m.isDefaultPrevented()){return;}if(j.historyState){g.extend(k,j.historyState);}l.originalEvent=j;setTimeout(function(){i.trigger(l,{state:k});},0);},hashchange:function(j){var k=new g.Event("navigate"),l=new g.Event("beforenavigate");l.originalEvent=j;i.trigger(l);if(l.isDefaultPrevented()){return;}k.originalEvent=j;i.trigger(k,{state:j.hashchangeState||{}});},setup:function(){if(f.bound){return;}f.bound=true;if(f.isPushStateEnabled()){f.originalEventName="popstate";i.bind("popstate.navigate",f.popstate);}else{if(f.isHashChangeEnabled()){f.originalEventName="hashchange";i.bind("hashchange.navigate",f.hashchange);}}}};})(c);(function(i){i.event.special.throttledresize={setup:function(){i(this).bind("resize",g);},teardown:function(){i(this).unbind("resize",g);}};var h=250,g=function(){k=(new Date()).getTime();j=k-f;if(j>=h){f=k;i(this).trigger("throttledresize");}else{if(e){clearTimeout(e);}e=setTimeout(g,h-j);}},f=0,e,k,j;})(c);(function(j,o){var m=j(o),l="orientationchange",f,k,g,p,n={"0":true,"180":true},i,e,h;if(j.support.orientation){i=o.innerWidth||m.width();e=o.innerHeight||m.height();h=50;g=i>e&&(i-e)>h;p=n[o.orientation];if((g&&p)||(!g&&!p)){n={"-90":true,"90":true};}}j.event.special.orientationchange=j.extend({},j.event.special.orientationchange,{setup:function(){if(j.support.orientation&&!j.event.special.orientationchange.disabled){return false;}k=f();m.bind("throttledresize",q);},teardown:function(){if(j.support.orientation&&!j.event.special.orientationchange.disabled){return false;}m.unbind("throttledresize",q);},add:function(r){var s=r.handler;r.handler=function(t){t.orientation=f();return s.apply(this,arguments);};}});function q(){var r=f();if(r!==k){k=r;m.trigger(l);}}j.event.special.orientationchange.orientation=f=function(){var s=true,r=a.documentElement;if(j.support.orientation){s=n[o.orientation];}else{s=r&&r.clientWidth/r.clientHeight<1.1;}return s?"portrait":"landscape";};j.fn[l]=function(r){return r?this.bind(l,r):this.trigger(l);};if(j.attrFn){j.attrFn[l]=true;}}(c,this));(function(B,K,j,q){var J="virtualMouseBindings",f="virtualTouchID",e="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),A="clientX clientY pageX pageY screenX screenY".split(" "),G=B.event.mouseHooks?B.event.mouseHooks.props:[],C=B.event.props?B.event.props.concat(G):[],E={},L=0,w=0,v=0,t=false,O=[],l=false,V=false,y="addEventListener" in j,x=B(j),I=1,R=0,g,P;B.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function u(i){while(i&&typeof i.originalEvent!=="undefined"){i=i.originalEvent;}return i;}function m(X,Y){var ag=X.type,ah,af,Z,W,ad,ac,ab,aa,ae;X=B.Event(X);X.type=Y;ah=X.originalEvent;af=B.event.props;if(ag.search(/^(mouse|click)/)>-1){af=C;}if(ah){for(ab=af.length,W;ab;){W=af[--ab];X[W]=ah[W];}}if(ag.search(/mouse(down|up)|click/)>-1&&!X.which){X.which=1;}if(ag.search(/^touch/)!==-1){Z=u(ah);ag=Z.touches;ad=Z.changedTouches;ac=(ag&&ag.length)?ag[0]:((ad&&ad.length)?ad[0]:q);if(ac){for(aa=0,ae=A.length;aa<ae;aa++){W=A[aa];X[W]=ac[W];}}}return X;}function T(Y){var W={},i,X;while(Y){i=B.data(Y,J);for(X in i){if(i[X]){W[X]=W.hasVirtualBinding=true;}}Y=Y.parentNode;}return W;}function F(X,W){var i;while(X){i=B.data(X,J);if(i&&(!W||i[W])){return X;}X=X.parentNode;}return null;}function N(){V=false;}function o(){V=true;}function U(){R=0;O.length=0;l=false;o();}function s(){N();}function z(){D();L=setTimeout(function(){L=0;U();},B.vmouse.resetTimerDuration);}function D(){if(L){clearTimeout(L);L=0;}}function r(X,Y,i){var W;if((i&&i[X])||(!i&&F(Y.target,X))){W=m(Y,X);B(Y.target).trigger(W);}return W;}function n(W){var X=B.data(W.target,f),i;if(!l&&(!R||R!==X)){i=r("v"+W.type,W);if(i){if(i.isDefaultPrevented()){W.preventDefault();}if(i.isPropagationStopped()){W.stopPropagation();}if(i.isImmediatePropagationStopped()){W.stopImmediatePropagation();}}}}function S(X){var Z=u(X).touches,Y,i,W;if(Z&&Z.length===1){Y=X.target;i=T(Y);if(i.hasVirtualBinding){R=I++;B.data(Y,f,R);D();s();t=false;W=u(X).touches[0];w=W.pageX;v=W.pageY;r("vmouseover",X,i);r("vmousedown",X,i);}}}function M(i){if(V){return;}if(!t){r("vmousecancel",i,T(i.target));}t=true;z();}function h(Z){if(V){return;}var X=u(Z).touches[0],W=t,Y=B.vmouse.moveDistanceThreshold,i=T(Z.target);t=t||(Math.abs(X.pageX-w)>Y||Math.abs(X.pageY-v)>Y);if(t&&!W){r("vmousecancel",Z,i);}r("vmousemove",Z,i);z();}function k(Y){if(V){return;}o();var i=T(Y.target),W,X;r("vmouseup",Y,i);if(!t){W=r("vclick",Y,i);if(W&&W.isDefaultPrevented()){X=u(Y).changedTouches[0];O.push({touchID:R,x:X.clientX,y:X.clientY});l=true;}}r("vmouseout",Y,i);t=false;z();}function H(W){var X=B.data(W,J),i;if(X){for(i in X){if(X[i]){return true;}}}return false;}function Q(){}function p(i){var W=i.substr(1);return{setup:function(){if(!H(this)){B.data(this,J,{});}var X=B.data(this,J);X[i]=true;E[i]=(E[i]||0)+1;if(E[i]===1){x.bind(W,n);}B(this).bind(W,Q);if(y){E.touchstart=(E.touchstart||0)+1;if(E.touchstart===1){x.bind("touchstart",S).bind("touchend",k).bind("touchmove",h).bind("scroll",M);}}},teardown:function(){--E[i];if(!E[i]){x.unbind(W,n);}if(y){--E.touchstart;if(!E.touchstart){x.unbind("touchstart",S).unbind("touchmove",h).unbind("touchend",k).unbind("scroll",M);}}var X=B(this),Y=B.data(this,J);if(Y){Y[i]=false;}X.unbind(W,Q);if(!H(this)){X.removeData(J);}}};}for(P=0;P<e.length;P++){B.event.special[e[P]]=p(e[P]);}if(y){j.addEventListener("click",function(aa){var X=O.length,ab=aa.target,ad,ac,ae,Z,W,Y;if(X){ad=aa.clientX;ac=aa.clientY;g=B.vmouse.clickDistanceThreshold;ae=ab;while(ae){for(Z=0;Z<X;Z++){W=O[Z];Y=0;if((ae===ab&&Math.abs(W.x-ad)<g&&Math.abs(W.y-ac)<g)||B.data(ae,f)===W.touchID){aa.preventDefault();aa.stopPropagation();return;}}ae=ae.parentNode;}}},true);}})(c,b,a);(function(h,m,e){var f=h(a),i=h.mobile.support.touch,j="touchmove scroll",n=i?"touchstart":"mousedown",l=i?"touchend":"mouseup",g=i?"touchmove":"mousemove";h.each(("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop").split(" "),function(p,o){h.fn[o]=function(q){return q?this.bind(o,q):this.trigger(o);};if(h.attrFn){h.attrFn[o]=true;}});function k(s,p,r,o){var q=r.type;r.type=p;if(o){h.event.trigger(r,e,s);}else{h.event.dispatch.call(s,r);}r.type=q;}h.event.special.scrollstart={enabled:true,setup:function(){var o=this,r=h(o),q,s;function p(t,u){q=u;k(o,q?"scrollstart":"scrollstop",t);}r.bind(j,function(t){if(!h.event.special.scrollstart.enabled){return;}if(!q){p(t,true);}clearTimeout(s);s=setTimeout(function(){p(t,false);},50);});},teardown:function(){h(this).unbind(j);}};h.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:true,setup:function(){var o=this,q=h(o),p=false;q.bind("vmousedown",function(t){p=false;if(t.which&&t.which!==1){return false;}var s=t.target,w;function r(){clearTimeout(w);}function v(){r();q.unbind("vclick",u).unbind("vmouseup",r);f.unbind("vmousecancel",v);}function u(x){v();if(!p&&s===x.target){k(o,"tap",x);}else{if(p){x.preventDefault();}}}q.bind("vmouseup",r).bind("vclick",u);f.bind("vmousecancel",v);w=setTimeout(function(){if(!h.event.special.tap.emitTapOnTaphold){p=true;}k(o,"taphold",h.Event("taphold",{target:s}));},h.event.special.tap.tapholdThreshold);});},teardown:function(){h(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup");f.unbind("vmousecancel");}};h.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1000,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(r){var q=m.pageXOffset,p=m.pageYOffset,o=r.clientX,s=r.clientY;if(r.pageY===0&&Math.floor(s)>Math.floor(r.pageY)||r.pageX===0&&Math.floor(o)>Math.floor(r.pageX)){o=o-q;s=s-p;}else{if(s<(r.pageY-p)||o<(r.pageX-q)){o=r.pageX-q;s=r.pageY-p;}}return{x:o,y:s};},start:function(p){var q=p.originalEvent.touches?p.originalEvent.touches[0]:p,o=h.event.special.swipe.getLocation(q);return{time:(new Date()).getTime(),coords:[o.x,o.y],origin:h(p.target)};},stop:function(p){var q=p.originalEvent.touches?p.originalEvent.touches[0]:p,o=h.event.special.swipe.getLocation(q);return{time:(new Date()).getTime(),coords:[o.x,o.y]};},handleSwipe:function(s,p,o,q){if(p.time-s.time<h.event.special.swipe.durationThreshold&&Math.abs(s.coords[0]-p.coords[0])>h.event.special.swipe.horizontalDistanceThreshold&&Math.abs(s.coords[1]-p.coords[1])<h.event.special.swipe.verticalDistanceThreshold){var r=s.coords[0]>p.coords[0]?"swipeleft":"swiperight";k(o,"swipe",h.Event("swipe",{target:q,swipestart:s,swipestop:p}),true);k(o,r,h.Event(r,{target:q,swipestart:s,swipestop:p}),true);return true;}return false;},eventInProgress:false,setup:function(){var q,o=this,r=h(o),p={};q=h.data(this,"mobile-events");if(!q){q={length:0};h.data(this,"mobile-events",q);}q.length++;q.swipe=p;p.start=function(u){if(h.event.special.swipe.eventInProgress){return;}h.event.special.swipe.eventInProgress=true;var s,w=h.event.special.swipe.start(u),t=u.target,v=false;p.move=function(x){if(!w||x.isDefaultPrevented()){return;}s=h.event.special.swipe.stop(x);if(!v){v=h.event.special.swipe.handleSwipe(w,s,o,t);if(v){h.event.special.swipe.eventInProgress=false;}}if(Math.abs(w.coords[0]-s.coords[0])>h.event.special.swipe.scrollSupressionThreshold){x.preventDefault();}};p.stop=function(){v=true;h.event.special.swipe.eventInProgress=false;f.off(g,p.move);p.move=null;};f.on(g,p.move).one(l,p.stop);};r.on(n,p.start);},teardown:function(){var p,o;p=h.data(this,"mobile-events");if(p){o=p.swipe;delete p.swipe;p.length--;if(p.length===0){h.removeData(this,"mobile-events");}}if(o){if(o.start){h(this).off(n,o.start);}if(o.move){f.off(g,o.move);}if(o.stop){f.off(l,o.stop);}}}};h.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(p,o){h.event.special[p]={setup:function(){h(this).bind(o,h.noop);},teardown:function(){h(this).unbind(o);}};});})(c,this);}));