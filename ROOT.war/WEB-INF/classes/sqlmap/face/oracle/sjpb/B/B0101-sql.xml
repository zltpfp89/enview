<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">
	
<sqlMap namespace="face">
	
	<!-- Query for [ SJPB_INC_MAST : 사건 ] Table -->
	
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.selectList">
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rcptOrdNum" column="RCPT_ORD_NUM"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="poIncNum" column="PO_INC_NUM"/>
		<result property="rcptTpCd" column="RCPT_TP_CD"/>
		<result property="criStatCd" column="CRI_STAT_CD"/>
		<result property="fdCd" column="FD_CD"/>
		<result property="criTmId" column="CRI_TM_ID"/>
		<result property="dvForm" column="DV_FORM"/>
		<result property="beDt" column="BE_DT"/>
		<result property="edDt" column="ED_DT"/>
		<result property="pareRcptNum" column="PARE_RCPT_NUM"/>
		<result property="combIncYn" column="COMB_INC_YN"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>    
		
		<result property="criStatDesc" column="CRI_STAT_DESC"/>
		<result property="rcptTpDesc" column="RCPT_TP_DESC"/>
		<result property="fdDesc" column="FD_DESC"/>
		<result property="dvFormDesc" column="DV_FORM_DESC"/>
		<result property="trfNum" column="TRF_NUM"/>
		
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="vioCont" column="VIO_CONT"/>
		<result property="spNm" column="SP_NM"/>
		
		<result property="criTmNm" column="CRI_TM_NM"/>
		<result property="nmKor" column="NM_KOR"/>
		<result property="criMbMainUserId" column="CRI_MB_MAIN_USER_ID"/>
		
		<result property="incNum" column="INC_NUM"/>
		<result property="pareIncNum" column="PARE_INC_NUM"/>
		<result property="sortIncNum" column="SORT_INC_NUM"/>
		
		<result property="baseYear" column="BASE_YEAR"/>
		<result property="acptDt" column="ACPT_DT"/>
	</resultMap>
	
	<!-- 사건 리스트(수사관) -->
	<select id="B0101.selectList" resultMap="B0101VO.selectList"> /* B0101.selectList */
	
	SELECT *
	FROM (
        SELECT 
        		AA.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/	 
        		 ,AA.RCPT_ORD_NUM	 /*접수번호*/	 
                 ,AA.RCPT_INC_NUM	 /*접수사건번호*/
		         ,AA.PO_INC_NUM	/*검찰번호*/
                 ,AA.RCPT_TP_CD	 /*접수유형코드*/	
                 ,AA.CRI_STAT_CD	 /*수사상태코드*/	
                 ,AA.FD_CD	 /*사건분야코드*/
                 ,AA.CRI_TM_ID	 /*수사팀계정*/	 
                 ,AA.DV_FORM	 /*발각형태*/	 
                 ,TO_CHAR(AA.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
                 ,TO_CHAR(AA.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
                 ,TO_CHAR(AA.ACPT_DT,'YYYY-MM-DD') AS  ACPT_DT        /*수리일자*/
                 ,AA.PARE_RCPT_NUM	 /*부모접수번호*/	 
                 ,AA.COMB_INC_YN		/*병합사건여부*/
                 ,AA.REG_USER_ID	 /*등록자*/	 
                 ,AA.REG_DATE	 /*등록일자*/	 
                 ,AA.UPD_USER_ID	 /*수정자*/	 
                 ,AA.UPD_DATE	 /*수정일자*/	 
                 ,CC.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
                 ,DD.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
                 ,EE.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
                 ,FF.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
                 ,BB.TRF_NUM AS TRF_NUM  /*송치번호*/
                 ,AA0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     		 	 ,AA0.VIO_CONT AS VIO_CONT   /*위반내용*/
     		 	 ,AA0.SP_NM AS SP_NM   /*피의자이름*/
                 ,II.CRI_TM_NM
                 ,LL.NM_KOR AS NM_KOR
                 ,LL.USER_ID AS CRI_MB_MAIN_USER_ID
                 ,BB.INC_NUM
                 ,DECODE(AA.COMB_INC_YN, 'Y', DECODE(AA.PARE_RCPT_NUM, NULL, BB.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = AA.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        		,NVL(TO_NUMBER(REGEXP_REPLACE(BB.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        		,DECODE(BB.INC_NUM, '', TO_CHAR(AA.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(BB.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
            FROM SJPB_INC_MAST AA
            JOIN SJPB_INC_DTS BB ON AA.RCPT_NUM = BB.RCPT_NUM
            LEFT OUTER JOIN CODEBASE CC ON AA.CRI_STAT_CD = CC.CODE AND CC.CODE_ID = 'SJPB_00001'
            LEFT OUTER JOIN CODEBASE DD ON AA.RCPT_TP_CD = DD.CODE AND DD.CODE_ID = 'SJPB_00003'
            LEFT OUTER JOIN CODEBASE EE ON AA.FD_CD = EE.CODE AND EE.CODE_ID = 'SJPB_00002'
            LEFT OUTER JOIN CODEBASE FF ON AA.DV_FORM = FF.CODE AND FF.CODE_ID = 'SJPB_00004'
            LEFT OUTER JOIN SJPB_CRI_TM II ON AA.CRI_TM_ID = II.CRI_TM_ID 
            LEFT OUTER JOIN SJPB_INC_CRI_MB JJ ON AA.RCPT_NUM = JJ.RCPT_NUM AND JJ.CRI_LV_CD = '01'
            LEFT OUTER JOIN USERPASS LL ON JJ.CRI_MB_ID = LL.USER_ID
            LEFT OUTER JOIN 
			(
				SELECT
				 AA6.GRUP_NUM           
				 ,LISTAGG(AA6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM) AS CODE_NAME  
				 ,LISTAGG(AA6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM) AS VIO_CONT 
				 ,LISTAGG(AA6.SP_NM,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM) AS SP_NM
				FROM
				( 
					SELECT 
						 AA2.LV
						,AA2.GRUP_NUM
						,AA3.SP_NM
						,AA4.CODE_NAME 
						,AA4.VIO_CONT
					FROM 
					(
					SELECT 
					   LEVEL AS LV
					  ,AA1.RCPT_NUM
					  ,(CASE WHEN LEVEL = 1 THEN AA1.RCPT_NUM ELSE AA1.PARE_RCPT_NUM END) AS GRUP_NUM
						FROM SJPB_INC_MAST AA1 
						WHERE AA1.RCPT_TP_CD = '2' 
						START WITH AA1.PARE_RCPT_NUM IS NULL        
						CONNECT BY  PRIOR AA1.RCPT_NUM =  AA1.PARE_RCPT_NUM) AA2 
					JOIN SJPB_INC_SP AA3 ON AA2.RCPT_NUM = AA3.RCPT_NUM AND AA3.SP_STAT_CD = '1'  
					JOIN (
							SELECT A.INC_SP_NUM
                          		   ,REGEXP_REPLACE(LISTAGG(B.CODE_NAME,', ') WITHIN GROUP(ORDER BY A.INC_SP_NUM),'([^,]+)(,\1)+','\1') AS CODE_NAME  
                          		   , REGEXP_REPLACE(LISTAGG(A.VIO_CONT,', ') WITHIN GROUP(ORDER BY A.INC_SP_NUM),'([^,]+)(,\1)+','\1') AS VIO_CONT  
                            FROM SJPB_ACT_VIO A 
                            LEFT OUTER JOIN CODEBASE B ON A.RLT_ACT_CRI_NM_CD = B.CODE AND B.CODE_ID = 'SJPB_00012'  
                            WHERE A.ACT_VIO_STAT_CD = '1'
                            GROUP BY A.INC_SP_NUM
					) AA4 ON AA3.INC_SP_NUM = AA4.INC_SP_NUM 
				) AA6
				GROUP BY AA6.GRUP_NUM
			)  AA0 ON AA.RCPT_NUM = AA0.GRUP_NUM
            
            WHERE
                AA.RCPT_TP_CD='2'
                <!-- AND AA.RCPT_STAT_CD = '1' -->
                <!-- AND AA.PARE_RCPT_NUM IS NULL -->               
	 		    <isNotEmpty  prepend=" AND " property="rcptOrdNumSc">AA.RCPT_ORD_NUM = #rcptOrdNumSc#</isNotEmpty>
                <isNotEmpty  prepend=" AND " property="fdCdSc">AA.FD_CD = #fdCdSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criTmSc">AA.CRI_TM_ID = #criTmSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">BB.INC_NUM = #rcptIncNumSc# </isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criStatSc">AA.CRI_STAT_CD = #criStatSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="dvFormSc">AA.DV_FORM = #dvFormSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="sDateSc">AA.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="eDateSc">AA.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">BB.TRF_NUM = #trfNumSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="spNmSc">AA0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">LL.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="infwDivSc">AA.INFW_DIV = #infwDivSc#</isNotEmpty>
    	) 
	WHERE 1=1 
		<isNotEmpty  prepend=" AND " property="rltActCriNmSc">RLT_ACT_CRI_NM_CD_DESC LIKE '%'||#rltActCriNmSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="vioContSc">VIO_CONT LIKE '%'||#vioContSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="yearSc">BASE_YEAR = #yearSc#</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="rcptNumSc">RCPT_NUM = #rcptNumSc#</isNotEmpty>
		 <isNotEmpty property="srchStartDateSc" prepend="AND">
	   		  		<isEqual property="dateDivSc" compareValue="T">
					(	ACPT_DT BETWEEN #srchStartDateSc# AND #srchEndDateSc# )
		   	 	   </isEqual>
		    	   <isEqual property="dateDivSc" compareValue="C">
		    	 	(	BE_DT BETWEEN #srchStartDateSc# AND #srchEndDateSc# )
		    	   </isEqual>
	   		   </isNotEmpty>
	ORDER BY RCPT_NUM DESC
		
	</select>
	
	
	<!-- 사건 리스트(송치관) -->
	<select id="B0101.selectListForTrf" resultMap="B0101VO.selectList"> /* B0101.selectListForTrf */
	SELECT * FROM
	(
	SELECT 
	    A.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/	
	     ,A.RCPT_ORD_NUM	 /*접수번호*/	
	     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
	     ,A.PO_INC_NUM	/*검찰번호*/
	     ,A.RCPT_TP_CD	 /*접수유형코드*/	
	     ,A.CRI_STAT_CD	 /*수사상태코드*/	
	     ,A.FD_CD	 /*사건분야코드*/	 
	     ,A.CRI_TM_ID	 /*수사팀계정*/	 
	     ,A.DV_FORM	 /*발각형태*/	 
	     ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
         ,TO_CHAR(A.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
         ,TO_CHAR(A.ACPT_DT,'YYYY-MM-DD') AS  ACPT_DT        /*수리일자*/
	     ,A.PARE_RCPT_NUM	 /*부모접수번호*/
	     ,A.COMB_INC_YN		/*병합사건여부*/	 
	     ,A.REG_USER_ID	 /*등록자*/	 
	     ,A.REG_DATE	 /*등록일자*/	 
	     ,A.UPD_USER_ID	 /*수정자*/	 
	     ,A.UPD_DATE	 /*수정일자*/	 
	     ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
	     ,D.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
	     ,E.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
	     ,F.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
	     ,B.TRF_NUM AS TRF_NUM  /*송치번호*/
	     ,A0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     	 ,A0.VIO_CONT AS VIO_CONT   /*위반내용*/
     	 ,A0.SP_NM AS SP_NM   /*피의자이름*/
	     ,I.CRI_TM_NM
	     ,L.NM_KOR AS NM_KOR
	     ,L.USER_ID AS CRI_MB_MAIN_USER_ID
	     ,B.INC_NUM
	     , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        ,NVL(TO_NUMBER(REGEXP_REPLACE(B.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        ,DECODE(B.INC_NUM, '', TO_CHAR(A.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(B.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
	FROM SJPB_INC_MAST A
	JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
	LEFT OUTER JOIN CODEBASE C ON A.CRI_STAT_CD = C.CODE AND C.CODE_ID = 'SJPB_00001'
	LEFT OUTER JOIN CODEBASE D ON A.RCPT_TP_CD = D.CODE AND D.CODE_ID = 'SJPB_00003'
	LEFT OUTER JOIN CODEBASE E ON A.FD_CD = E.CODE AND E.CODE_ID = 'SJPB_00002'
	LEFT OUTER JOIN CODEBASE F ON A.DV_FORM = F.CODE AND F.CODE_ID = 'SJPB_00004'
	JOIN SJPB_CRI_TM I ON A.CRI_TM_ID = I.CRI_TM_ID 
	LEFT OUTER JOIN SJPB_INC_CRI_MB J ON A.RCPT_NUM = J.RCPT_NUM AND J.CRI_LV_CD = '01'
	LEFT OUTER JOIN USERPASS L ON J.CRI_MB_ID = L.USER_ID
	LEFT OUTER JOIN 
	(
		SELECT
		 A6.GRUP_NUM           
		 ,REGEXP_REPLACE(LISTAGG(A6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
		 ,REGEXP_REPLACE(LISTAGG(A6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
		 ,REGEXP_REPLACE(LISTAGG(A6.SP_NM,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS SP_NM
		FROM
		( 
			SELECT 
				 A2.LV
				,A2.GRUP_NUM
				,A3.SP_NM
				,A5.CODE_NAME 
				,A4.VIO_CONT
			FROM 
			(
			SELECT 
			   LEVEL AS LV
			  ,A1.RCPT_NUM
			  ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
				FROM SJPB_INC_MAST A1 
				WHERE A1.RCPT_TP_CD = '2' 
				START WITH A1.PARE_RCPT_NUM IS NULL        
				CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
			JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
			JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
			LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
		) A6
		GROUP BY A6.GRUP_NUM
	)  A0 ON A.RCPT_NUM = A0.GRUP_NUM 
	WHERE
	    A.RCPT_TP_CD='2'
	    <!-- AND A.RCPT_STAT_CD = '1' -->
	    <!-- AND A.PARE_RCPT_NUM IS NULL -->
	    AND A.REG_USER_ID = DECODE(A.CRI_STAT_CD , '21', #criMbId#, A.REG_USER_ID)
	    <isNotEmpty  prepend=" AND " property="fdCdSc">A.FD_CD = #fdCdSc#</isNotEmpty>
	    <isNotEmpty  prepend=" AND " property="criTmSc">A.CRI_TM_ID = #criTmSc#</isNotEmpty>
	    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">B.INC_NUM = #rcptIncNumSc# </isNotEmpty>
	    <isNotEmpty  prepend=" AND " property="criStatSc">A.CRI_STAT_CD = #criStatSc#</isNotEmpty>
	    <isNotEmpty  prepend=" AND " property="dvFormSc">A.DV_FORM = #dvFormSc#</isNotEmpty>
	    <isNotEmpty  prepend=" AND " property="sDateSc">A.REG_DATE &gt;= #sDateSc#</isNotEmpty>
   	 	<isNotEmpty  prepend=" AND " property="eDateSc">A.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">B.TRF_NUM = #trfNumSc#</isNotEmpty>
   	 	<isNotEmpty  prepend=" AND " property="spNmSc">A0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">L.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
   	 	<isNotEmpty  prepend=" AND " property="infwDivSc">A.INFW_DIV = #infwDivSc#</isNotEmpty>
	
	)
	WHERE 1=1 
		<isNotEmpty  prepend=" AND " property="rltActCriNmSc">RLT_ACT_CRI_NM_CD_DESC LIKE '%'||#rltActCriNmSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="vioContSc">VIO_CONT LIKE '%'||#vioContSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="yearSc">BASE_YEAR = #yearSc#</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="rcptNumSc">RCPT_NUM = #rcptNumSc#</isNotEmpty>
	ORDER BY RCPT_NUM DESC
	</select>
	
	
	<!-- 사건 리스트(팀장) -->
	<select id="B0101.selectListForTeamLeader" resultMap="B0101VO.selectList"> /* B0101.selectListForTeamLeader */
	SELECT *
	FROM (
		SELECT 
		    A.RCPT_NUM AS RCPT_NUM /*시스템번호*/
		     ,A.RCPT_ORD_NUM	/*접수번호*/	 
		     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
		     ,A.PO_INC_NUM	/*검찰번호*/
		     ,A.RCPT_TP_CD	 /*접수유형코드*/	
		     ,A.CRI_STAT_CD	 /*수사상태코드*/	
		     ,A.FD_CD	 /*사건분야코드*/	 
		     ,A.CRI_TM_ID	 /*수사팀계정*/	 
		     ,A.DV_FORM	 /*발각형태*/	 
		     ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
             ,TO_CHAR(A.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
             ,TO_CHAR(A.ACPT_DT,'YYYY-MM-DD') AS  ACPT_DT        /*수리일자*/
		     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	
		     ,A.COMB_INC_YN		/*병합사건여부*/ 
		     ,A.REG_USER_ID	 /*등록자*/	 
		     ,A.REG_DATE	 /*등록일자*/	 
		     ,A.UPD_USER_ID	 /*수정자*/	 
		     ,A.UPD_DATE	 /*수정일자*/	 
		     ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		     ,D.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
		     ,E.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
		     ,F.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		     ,B.TRF_NUM AS TRF_NUM  /*송치번호*/
		     ,A0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     		 ,A0.VIO_CONT AS VIO_CONT   /*위반내용*/
     		 ,A0.SP_NM AS SP_NM   /*피의자이름*/
             ,I.CRI_TM_NM
             ,L.NM_KOR AS NM_KOR
             ,L.USER_ID AS CRI_MB_MAIN_USER_ID
             ,B.INC_NUM
             , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        	,NVL(TO_NUMBER(REGEXP_REPLACE(B.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        	,DECODE(B.INC_NUM, '', TO_CHAR(A.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(B.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
		FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			LEFT OUTER JOIN CODEBASE C ON A.CRI_STAT_CD = C.CODE AND C.CODE_ID = 'SJPB_00001'
			LEFT OUTER JOIN CODEBASE D ON A.RCPT_TP_CD = D.CODE AND D.CODE_ID = 'SJPB_00003'
			LEFT OUTER JOIN CODEBASE E ON A.FD_CD = E.CODE AND E.CODE_ID = 'SJPB_00002'
			LEFT OUTER JOIN CODEBASE F ON A.DV_FORM = F.CODE AND F.CODE_ID = 'SJPB_00004'
			JOIN SJPB_CRI_TM I ON A.CRI_TM_ID = I.CRI_TM_ID 
			LEFT OUTER JOIN SJPB_INC_CRI_MB J ON A.RCPT_NUM = J.RCPT_NUM AND J.CRI_LV_CD = '01'
			LEFT OUTER JOIN USERPASS L ON J.CRI_MB_ID = L.USER_ID
			LEFT OUTER JOIN 
			(
				SELECT
				 A6.GRUP_NUM           
				 ,REGEXP_REPLACE(LISTAGG(A6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
				 ,REGEXP_REPLACE(LISTAGG(A6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
				 ,REGEXP_REPLACE(LISTAGG(A6.SP_NM,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS SP_NM
				FROM
				( 
					SELECT 
						 A2.LV
						,A2.GRUP_NUM
						,A3.SP_NM
						,A5.CODE_NAME 
						,A4.VIO_CONT
					FROM 
					(
					SELECT 
					   LEVEL AS LV
					  ,A1.RCPT_NUM
					  ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
						FROM SJPB_INC_MAST A1 
						WHERE A1.RCPT_TP_CD = '2' 
						START WITH A1.PARE_RCPT_NUM IS NULL        
						CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
					JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'
					JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
					LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
				) A6
				GROUP BY A6.GRUP_NUM
			)  A0 ON A.RCPT_NUM = A0.GRUP_NUM 
		WHERE
		    <!-- AND A.RCPT_STAT_CD = '1' -->
		    A.RCPT_TP_CD='2'
		    <!-- AND A.PARE_RCPT_NUM IS NULL -->
		    AND A.CRI_STAT_CD NOT IN ('21','31')
            AND A.REG_USER_ID = DECODE(A.CRI_STAT_CD , '21', #criMbId#, A.REG_USER_ID)
            AND A.FD_CD IN 
            <isNotEmpty property="fdCdCodeList">
			  	<iterate property="fdCdCodeList" open="(" close=")" conjunction=",">
			  		#fdCdCodeList[].code#
			  	</iterate>
		  	</isNotEmpty>
		  	<isEmpty property="fdCdCodeList">
		  		('')
		  	</isEmpty>
		    <isNotEmpty  prepend=" AND " property="fdCdSc">A.FD_CD = #fdCdSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criTmSc">A.CRI_TM_ID = #criTmSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">B.INC_NUM = #rcptIncNumSc# </isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criStatSc">A.CRI_STAT_CD = #criStatSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="dvFormSc">A.DV_FORM = #dvFormSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="sDateSc">A.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="eDateSc">A.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="trfNumSc">B.TRF_NUM = #trfNumSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="spNmSc">A0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criMbNmSc">L.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="infwDivSc">A.INFW_DIV = #infwDivSc#</isNotEmpty>
		    
    UNION (
        SELECT 
                AA.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/	 
                 ,AA.RCPT_ORD_NUM	 /*접수번호*/
                 ,AA.RCPT_INC_NUM	 /*접수사건번호*/
                 ,AA.PO_INC_NUM		/*검찰번호*/	
                 ,AA.RCPT_TP_CD	 /*접수유형코드*/	
                 ,AA.CRI_STAT_CD	 /*수사상태코드*/	
                 ,AA.FD_CD	 /*사건분야코드*/	 
                 ,AA.CRI_TM_ID	 /*수사팀계정*/	 
                 ,AA.DV_FORM	 /*발각형태*/	 
                 ,TO_CHAR(AA.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
                 ,TO_CHAR(AA.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
                 ,TO_CHAR(AA.ACPT_DT,'YYYY-MM-DD') AS  ACPT_DT        /*수리일자*/
                 ,AA.PARE_RCPT_NUM	 /*부모접수번호*/
                 ,AA.COMB_INC_YN		/*병합사건여부*/	 
                 ,AA.REG_USER_ID	 /*등록자*/	 
                 ,AA.REG_DATE	 /*등록일자*/	 
                 ,AA.UPD_USER_ID	 /*수정자*/	 
                 ,AA.UPD_DATE	 /*수정일자*/	 
                 ,CC.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
                 ,DD.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
                 ,EE.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
                 ,FF.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
                 ,BB.TRF_NUM AS TRF_NUM  /*송치번호*/
                 ,AA0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     		 	 ,AA0.VIO_CONT AS VIO_CONT   /*위반내용*/
     		 	 ,AA0.SP_NM AS SP_NM   /*피의자이름*/
                 ,II.CRI_TM_NM
                 ,LL.NM_KOR AS NM_KOR
                 ,LL.USER_ID AS CRI_MB_MAIN_USER_ID
                 ,BB.INC_NUM
                 , DECODE(AA.COMB_INC_YN, 'Y', DECODE(AA.PARE_RCPT_NUM, NULL, BB.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = AA.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        		,NVL(TO_NUMBER(REGEXP_REPLACE(BB.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        		,DECODE(BB.INC_NUM, '', TO_CHAR(AA.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(BB.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
            FROM SJPB_INC_MAST AA
            JOIN SJPB_INC_DTS BB ON AA.RCPT_NUM = BB.RCPT_NUM
            LEFT OUTER JOIN CODEBASE CC ON AA.CRI_STAT_CD = CC.CODE AND CC.CODE_ID = 'SJPB_00001'
            LEFT OUTER JOIN CODEBASE DD ON AA.RCPT_TP_CD = DD.CODE AND DD.CODE_ID = 'SJPB_00003'
            LEFT OUTER JOIN CODEBASE EE ON AA.FD_CD = EE.CODE AND EE.CODE_ID = 'SJPB_00002'
            LEFT OUTER JOIN CODEBASE FF ON AA.DV_FORM = FF.CODE AND FF.CODE_ID = 'SJPB_00004'
            JOIN SJPB_CRI_TM II ON AA.CRI_TM_ID = II.CRI_TM_ID 
            LEFT OUTER JOIN SJPB_INC_CRI_MB JJ ON AA.RCPT_NUM = JJ.RCPT_NUM AND JJ.CRI_LV_CD = '01'
            JOIN SJPB_CRI_MB KK ON JJ.CRI_MB_ID = KK.CRI_MB_ID AND KK.CRI_MB_STAT = '1'
            JOIN USERPASS LL ON JJ.CRI_MB_ID = LL.USER_ID
            JOIN SJPB_INC_CRI_MB ZZ ON AA.RCPT_NUM = ZZ.RCPT_NUM AND ZZ.CRI_MB_ID = #criMbId#
            LEFT OUTER JOIN 
			(
				SELECT
				 AA6.GRUP_NUM           
				 ,REGEXP_REPLACE(LISTAGG(AA6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
				 ,REGEXP_REPLACE(LISTAGG(AA6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
				 ,REGEXP_REPLACE(LISTAGG(AA6.SP_NM,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS SP_NM
				FROM
				( 
					SELECT 
						 AA2.LV
						,AA2.GRUP_NUM
						,AA3.SP_NM
						,AA5.CODE_NAME 
						,AA4.VIO_CONT
					FROM 
					(
					SELECT 
					   LEVEL AS LV
					  ,AA1.RCPT_NUM
					  ,(CASE WHEN LEVEL = 1 THEN AA1.RCPT_NUM ELSE AA1.PARE_RCPT_NUM END) AS GRUP_NUM
						FROM SJPB_INC_MAST AA1 
						WHERE AA1.RCPT_TP_CD = '2' 
						START WITH AA1.PARE_RCPT_NUM IS NULL        
						CONNECT BY  PRIOR AA1.RCPT_NUM =  AA1.PARE_RCPT_NUM) AA2 
					JOIN SJPB_INC_SP AA3 ON AA2.RCPT_NUM = AA3.RCPT_NUM AND AA3.SP_STAT_CD = '1'
					JOIN SJPB_ACT_VIO AA4 ON AA3.INC_SP_NUM = AA4.INC_SP_NUM AND AA4.ACT_VIO_STAT_CD = '1'
					LEFT OUTER JOIN CODEBASE AA5 ON AA4.RLT_ACT_CRI_NM_CD = AA5.CODE AND AA5.CODE_ID = 'SJPB_00012'
				) AA6
				GROUP BY AA6.GRUP_NUM
			)  AA0 ON AA.RCPT_NUM = AA0.GRUP_NUM
            
            WHERE
                AA.RCPT_TP_CD='2'
                <!-- AND AA.RCPT_STAT_CD = '1' -->
                <!-- AND AA.PARE_RCPT_NUM IS NULL -->
                <isNotEmpty  prepend=" AND " property="fdCdSc">AA.FD_CD = #fdCdSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criTmSc">AA.CRI_TM_ID = #criTmSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">BB.INC_NUM = #rcptIncNumSc# </isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criStatSc">AA.CRI_STAT_CD = #criStatSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="dvFormSc">AA.DV_FORM = #dvFormSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="sDateSc">AA.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="eDateSc">AA.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">BB.TRF_NUM = #trfNumSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="spNmSc">AA0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">LL.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="infwDivSc">AA.INFW_DIV = #infwDivSc#</isNotEmpty>
			    
    	)
	) 
	WHERE 1=1 
		<isNotEmpty  prepend=" AND " property="rltActCriNmSc">RLT_ACT_CRI_NM_CD_DESC LIKE '%'||#rltActCriNmSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="vioContSc">VIO_CONT LIKE '%'||#vioContSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="yearSc">BASE_YEAR = #yearSc#</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="rcptNumSc">RCPT_NUM = #rcptNumSc#</isNotEmpty>
	ORDER BY RCPT_NUM DESC
	
	</select>
	
	
	<!-- 사건 리스트(과장) -->
	<select id="B0101.selectListForDeptLeader" resultMap="B0101VO.selectList"> /* B0101.selectListForDeptLeader */
	
	SELECT *
	FROM (
		SELECT 
		    A.RCPT_NUM AS RCPT_NUM /*시스템번호*/	
		     ,A.RCPT_ORD_NUM	 /*접수번호*/ 
		     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
		     ,A.PO_INC_NUM		/*검찰번호*/
		     ,A.RCPT_TP_CD	 /*접수유형코드*/	
		     ,A.CRI_STAT_CD	 /*수사상태코드*/	
		     ,A.FD_CD	 /*사건분야코드*/	 
		     ,A.CRI_TM_ID	 /*수사팀계정*/	 
		     ,A.DV_FORM	 /*발각형태*/	 
		     ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
             ,TO_CHAR(A.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
             ,TO_CHAR(A.ACPT_DT,'YYYY-MM-DD') AS  ACPT_DT        /*수리일자*/
		     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	
		     ,A.COMB_INC_YN		/*병합사건여부*/ 
		     ,A.REG_USER_ID	 /*등록자*/	 
		     ,A.REG_DATE	 /*등록일자*/	 
		     ,A.UPD_USER_ID	 /*수정자*/	 
		     ,A.UPD_DATE	 /*수정일자*/	 
		     ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		     ,D.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
		     ,E.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
		     ,F.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		     ,B.TRF_NUM AS TRF_NUM  /*송치번호*/
		     ,A0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     		 ,A0.VIO_CONT AS VIO_CONT   /*위반내용*/
     		 ,A0.SP_NM AS SP_NM   /*피의자이름*/
             ,I.CRI_TM_NM
             ,L.NM_KOR AS NM_KOR
             ,L.USER_ID AS CRI_MB_MAIN_USER_ID
             ,B.INC_NUM
             , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        	,NVL(TO_NUMBER(REGEXP_REPLACE(B.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        	,DECODE(B.INC_NUM, '', TO_CHAR(A.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(B.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
		FROM SJPB_INC_MAST A
		JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
		LEFT OUTER JOIN CODEBASE C ON A.CRI_STAT_CD = C.CODE AND C.CODE_ID = 'SJPB_00001'
		LEFT OUTER JOIN CODEBASE D ON A.RCPT_TP_CD = D.CODE AND D.CODE_ID = 'SJPB_00003'
		LEFT OUTER JOIN CODEBASE E ON A.FD_CD = E.CODE AND E.CODE_ID = 'SJPB_00002'
		LEFT OUTER JOIN CODEBASE F ON A.DV_FORM = F.CODE AND F.CODE_ID = 'SJPB_00004'
        JOIN SJPB_CRI_TM I ON A.CRI_TM_ID = I.CRI_TM_ID 
        LEFT OUTER JOIN SJPB_INC_CRI_MB J ON A.RCPT_NUM = J.RCPT_NUM AND J.CRI_LV_CD = '01'
        <!--  JOIN SJPB_CRI_MB K ON J.CRI_MB_ID = K.CRI_MB_ID AND K.CRI_MB_STAT = '1' -->
        LEFT OUTER JOIN USERPASS L ON J.CRI_MB_ID = L.USER_ID
    	LEFT OUTER JOIN 
			(
				SELECT
				 A6.GRUP_NUM           
				 ,REGEXP_REPLACE(LISTAGG(A6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
				 ,REGEXP_REPLACE(LISTAGG(A6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
				 ,REGEXP_REPLACE(LISTAGG(A6.SP_NM,  ', ') WITHIN GROUP(ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS SP_NM
				FROM
				( 
					SELECT 
						 A2.LV
						,A2.GRUP_NUM
						,A3.SP_NM
						,A5.CODE_NAME 
						,A4.VIO_CONT
					FROM 
					(
					SELECT 
					   LEVEL AS LV
					  ,A1.RCPT_NUM
					  ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
						FROM SJPB_INC_MAST A1 
						WHERE A1.RCPT_TP_CD = '2' 
						START WITH A1.PARE_RCPT_NUM IS NULL        
						CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
					JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
					JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
					LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
				) A6
				GROUP BY A6.GRUP_NUM
			)  A0 ON A.RCPT_NUM = A0.GRUP_NUM 
		WHERE
		    A.RCPT_TP_CD='2'
		    <!-- AND A.RCPT_STAT_CD = '1' -->
		    <!-- AND A.PARE_RCPT_NUM IS NULL -->
		    AND A.CRI_STAT_CD NOT IN ('21','31')
            AND A.REG_USER_ID = DECODE(A.CRI_STAT_CD , '21', #criMbId#, A.REG_USER_ID)
            AND A.FD_CD IN 
            <isNotEmpty property="fdCdCodeList">
			  	<iterate property="fdCdCodeList" open="(" close=")" conjunction=",">
			  		#fdCdCodeList[].code#
			  	</iterate>
		  	</isNotEmpty>
		  	<isEmpty property="fdCdCodeList">
		  		('')
		  	</isEmpty>
		    <isNotEmpty  prepend=" AND " property="fdCdSc">A.FD_CD = #fdCdSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criTmSc">A.CRI_TM_ID = #criTmSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">B.INC_NUM = #rcptIncNumSc# </isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criStatSc">A.CRI_STAT_CD = #criStatSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="dvFormSc">A.DV_FORM = #dvFormSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="sDateSc">A.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="eDateSc">A.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="trfNumSc">B.TRF_NUM = #trfNumSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="spNmSc">A0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="criMbNmSc">L.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
    UNION (
        SELECT 
                AA.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/	 
                 ,AA.RCPT_ORD_NUM	 /*접수번호*/ 
                 ,AA.RCPT_INC_NUM	 /*접수사건번호*/	
                 ,AA.PO_INC_NUM		/*검찰번호*/
                 ,AA.RCPT_TP_CD	 /*접수유형코드*/	
                 ,AA.CRI_STAT_CD	 /*수사상태코드*/	
                 ,AA.FD_CD	 /*사건분야코드*/	 
                 ,AA.CRI_TM_ID	 /*수사팀계정*/	 
                 ,AA.DV_FORM	 /*발각형태*/	 
                 ,TO_CHAR(AA.BE_DT,'YYYY-MM-DD') AS  BE_DT        /*착수일자*/
                 ,TO_CHAR(AA.ED_DT,'YYYY-MM-DD') AS  ED_DT        /*종결일자*/
                 ,AA.PARE_RCPT_NUM	 /*부모접수번호*/	
                 ,AA.COMB_INC_YN		/*병합사건여부*/ 
                 ,AA.REG_USER_ID	 /*등록자*/	 
                 ,AA.REG_DATE	 /*등록일자*/	 
                 ,AA.UPD_USER_ID	 /*수정자*/	 
                 ,AA.UPD_DATE	 /*수정일자*/	 
                 ,CC.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
                 ,DD.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
                 ,EE.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
                 ,FF.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
                 ,BB.TRF_NUM AS TRF_NUM  /*송치번호*/
                 ,AA0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
     		 	 ,AA0.VIO_CONT AS VIO_CONT   /*위반내용*/
     		 	 ,AA0.SP_NM AS SP_NM   /*피의자이름*/
                 ,II.CRI_TM_NM
                 ,LL.NM_KOR AS NM_KOR
                 ,LL.USER_ID AS CRI_MB_MAIN_USER_ID
                 ,BB.INC_NUM
                 , DECODE(AA.COMB_INC_YN, 'Y', DECODE(AA.PARE_RCPT_NUM, NULL, BB.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = AA.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        		,NVL(TO_NUMBER(REGEXP_REPLACE(BB.INC_NUM, '[^0-9]')),0) AS SORT_INC_NUM
        		,DECODE(BB.INC_NUM, '', TO_CHAR(AA.REG_DATE,'YYYY'), TO_NUMBER(SUBSTR(BB.INC_NUM, 1, 4))) AS BASE_YEAR	/*년도(사건번호기준, 없으면 등록작업중을 위해 등록년도)*/
            FROM SJPB_INC_MAST AA
            JOIN SJPB_INC_DTS BB ON AA.RCPT_NUM = BB.RCPT_NUM
            LEFT OUTER JOIN CODEBASE CC ON AA.CRI_STAT_CD = CC.CODE AND CC.CODE_ID = 'SJPB_00001'
            LEFT OUTER JOIN CODEBASE DD ON AA.RCPT_TP_CD = DD.CODE AND DD.CODE_ID = 'SJPB_00003'
            LEFT OUTER JOIN CODEBASE EE ON AA.FD_CD = EE.CODE AND EE.CODE_ID = 'SJPB_00002'
            LEFT OUTER JOIN CODEBASE FF ON AA.DV_FORM = FF.CODE AND FF.CODE_ID = 'SJPB_00004'
            JOIN SJPB_CRI_TM II ON AA.CRI_TM_ID = II.CRI_TM_ID 
            LEFT OUTER JOIN SJPB_INC_CRI_MB JJ ON AA.RCPT_NUM = JJ.RCPT_NUM AND JJ.CRI_LV_CD = '01'
            JOIN SJPB_CRI_MB KK ON JJ.CRI_MB_ID = KK.CRI_MB_ID AND KK.CRI_MB_STAT = '1' 
            JOIN USERPASS LL ON JJ.CRI_MB_ID = LL.USER_ID
            JOIN SJPB_INC_CRI_MB ZZ ON AA.RCPT_NUM = ZZ.RCPT_NUM AND ZZ.CRI_MB_ID = #criMbId#
            LEFT OUTER JOIN 
			(
				SELECT
				 AA6.GRUP_NUM           
				 ,REGEXP_REPLACE(LISTAGG(AA6.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
				 ,REGEXP_REPLACE(LISTAGG(AA6.VIO_CONT,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
				 ,REGEXP_REPLACE(LISTAGG(AA6.SP_NM,  ', ') WITHIN GROUP(ORDER BY AA6.GRUP_NUM), '([^,]+)(,\1)+', '\1') AS SP_NM
				FROM
				( 
					SELECT 
						 AA2.LV
						,AA2.GRUP_NUM
						,AA3.SP_NM
						,AA5.CODE_NAME 
						,AA4.VIO_CONT
					FROM 
					(
					SELECT 
					   LEVEL AS LV
					  ,AA1.RCPT_NUM
					  ,(CASE WHEN LEVEL = 1 THEN AA1.RCPT_NUM ELSE AA1.PARE_RCPT_NUM END) AS GRUP_NUM
						FROM SJPB_INC_MAST AA1 
						WHERE AA1.RCPT_TP_CD = '2' 
						START WITH AA1.PARE_RCPT_NUM IS NULL        
						CONNECT BY  PRIOR AA1.RCPT_NUM =  AA1.PARE_RCPT_NUM) AA2 
					JOIN SJPB_INC_SP AA3 ON AA2.RCPT_NUM = AA3.RCPT_NUM AND AA3.SP_STAT_CD = '1'  
					JOIN SJPB_ACT_VIO AA4 ON AA3.INC_SP_NUM = AA4.INC_SP_NUM AND AA4.ACT_VIO_STAT_CD = '1'
					LEFT OUTER JOIN CODEBASE AA5 ON AA4.RLT_ACT_CRI_NM_CD = AA5.CODE AND AA5.CODE_ID = 'SJPB_00012'
				) AA6
				GROUP BY AA6.GRUP_NUM
			)  AA0 ON AA.RCPT_NUM = AA0.GRUP_NUM
            
            WHERE
                AA.RCPT_TP_CD='2'
                <!-- AND AA.RCPT_STAT_CD = '1' -->
                <!-- AND AA.PARE_RCPT_NUM IS NULL -->
                <isNotEmpty  prepend=" AND " property="fdCdSc">AA.FD_CD = #fdCdSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criTmSc">AA.CRI_TM_ID = #criTmSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">BB.INC_NUM = #rcptIncNumSc# </isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criStatSc">AA.CRI_STAT_CD = #criStatSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="dvFormSc">AA.DV_FORM = #dvFormSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="sDateSc">AA.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="eDateSc">AA.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">BB.TRF_NUM = #trfNumSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="spNmSc">AA0.SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">LL.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
			    
    	)
	) 
	WHERE 1=1 
		<isNotEmpty  prepend=" AND " property="rltActCriNmSc">RLT_ACT_CRI_NM_CD_DESC LIKE '%'||#rltActCriNmSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="vioContSc">VIO_CONT LIKE '%'||#vioContSc#||'%'</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="yearSc">BASE_YEAR = #yearSc#</isNotEmpty>
		<isNotEmpty  prepend=" AND " property="rcptNumSc">RCPT_NUM = #rcptNumSc#</isNotEmpty>
	ORDER BY RCPT_NUM DESC
	
	</select>
	
	
	<!-- 사건마스터 추가 -->
	<insert id="B0101.SJPB_INC_MAST.insert"> /* B0101.SJPB_INC_MAST.insert */
		
		INSERT INTO SJPB_INC_MAST
			(
			RCPT_NUM			/*시스템번호*/
			,PO_INC_NUM			/*검찰사건번호*/
			,RCPT_INC_NUM		/*접수사건번호*/
			,RCPT_ORD_NUM		/*접수번호*/ 
			,RCPT_TP_CD			/*접수유형코드*/
			,CRI_STAT_CD		/*수사상태코드*/
			,FD_CD				/*사건분야코드*/
			,CRI_TM_ID			/*수사팀계정*/
			,DV_FORM			/*발각형태*/
			,BE_DT				/*착수일자*/
			,ED_DT				/*종결일자*/
			,DIR_NM				/*지휘자*/
			,ACPT_DT			/*수리일자*/
			,PRO_DT				/*처리일자*/
			,RCPT_DT			/*접수일자*/
			,PARE_RCPT_NUM		/*부모접수번호*/
			,COMB_INC_YN		/*병합사건여부*/
			,INFW_DIV			/*유입구분*/
			,RCPT_STAT_CD		/*접수상태코드*/
			,MF_CD				/*변경코드*/
			,MF_CONT			/*변경이력*/
			,INC_MF_NUM			/*사건수정번호*/
			,REG_USER_ID		/*등록자*/
			,REG_DATE			/*등록일자*/
			,UPD_USER_ID		/*수정자*/
			,UPD_DATE			/*수정일자*/
			,STOCK
			)
		VALUES (
			#rcptNum#
			,#poIncNum#
			,null
			,null
			,#rcptTpCd#
			,#criStatCd#
			,#fdCd#
			,#criTmId#
			,#dvForm#
			,TO_DATE(#beDt#,'YYYY-MM-DD')
			,TO_DATE(#edDt#,'YYYY-MM-DD')
			,#dirNm#
			,TO_DATE(#acptDt#,'YYYY-MM-DD') 
			,TO_DATE(#proDt#,'YYYY-MM-DD')
			,TO_DATE(#rcptDt#,'YYYY-MM-DD')
			,#pareRcptNum#
			,#combIncYn#
			,#infwDiv#
			,'1'
			,null
			,#mfCont#
			,#incMfNum#
			,#regUserId#
			,sysdate
			,#updUserId#
			,sysdate
			,#stock#
			)
		
	</insert>
	
	<!-- 사건상세 추가 -->
	<insert id="B0101.SJPB_INC_DTS.insert"> /* B0101.SJPB_INC_DTS.insert */
		INSERT INTO SJPB_INC_DTS
			(
			RCPT_NUM        /*시스템번호*/
               ,INC_NUM        /*사건번호*/
               ,CHA_DT         /*입건일자*/
               ,CHA_ITT        /*고발기관*/
               ,INC_CONT       /*사건내용*/
               ,CRI_CONT       /*수사내용*/
               ,TRF_NUM        /*송치번호*/
               ,INC_OCCR_AREA_ADDR	/*사건발생지역주소*/
               ,INC_OCCR_AREA_XCD	/*사건발생지역X좌표*/
               ,INC_OCCR_AREA_YCD	/*사건발생지역Y좌표*/
               ,VICM_NM			/*피해자성명*/
               ,DAMG_DEGR		/*피해정도*/
               ,SEIZ_NUM		/*압수번호*/
               ,CRI_PEND_INC_FILE_NUM	/*수사미결사건철번호*/
               ,CRI_DT			/*범죄일시*/
               ,REG_USER_ID    /*등록자*/
               ,REG_DATE       /*등록일자*/
               ,UPD_USER_ID    /*수정자*/
               ,UPD_DATE       /*수정일자*/
			)
		VALUES (
			#rcptNum#
			,null
			,sysdate
			,#chaItt#
			,#incCont#
			,#criCont#
			,null
			,#incOccrAreaAddr#
			,#incOccrAreaXcd#
			,#incOccrAreaYcd#
			,#vicmNm#
			,#damgDegr#
			,#seizNum#
			,#criPendIncFileNum#
			,#criDt#
			,#regUserId#
			,sysdate
			,#updUserId#
			,sysdate
			)
	</insert>
	
	<!-- 발생 통계원표 추가 -->
	<insert id="B0101.SJPB_OCCR_STS_GRAP.insert"> /* B0101.SJPB_OCCR_STS_GRAP.insert */
		INSERT INTO SJPB_OCCR_STS_GRAP (
		    OCCR_STS_GRAP_NUM,
		    STS_GRAP_PUBL_YRMH,
		    FAMY_VIO_YN_CD,
		    SCHL_VIO_YN_CD,
		    FORG_SP_YN_CD,
		    OCCR_YRMH_DT_DIV_CD,
		    OCCR_YRMH_DT,
		    OCCR_DOTW,
		    RECG_YRMH_DT,
		    RECG_DOTW,
		    OCCR_TO_RECG_PI,
		    CRI_METH,
		    OCCR_DT_SPEL_SITU,
		    CRI_TIME_WETH,
		    CRI_CLUE,
		    UNDC_RSN,
		    VICM,
		    AGE_DIV_CD,
		    AGE,
		    FORG_CD_NATY,
		    FORG_CD_POSI,
		    VICM_DAMG_TIME_SITU,
		    OCCR_AREA_DIV,
		    OCCR_AREA,
		    OCCR_PLA,
		    PROP_DAMG_DEGR,
		    DAMG_AMT_MONY,
		    DAMG_AMT_CAR,
		    DAMG_AMT_MARK_SECU,
		    DAMG_AMT_JEWY,
		    DAMG_AMT_ELEC_ELEN_PROD,
		    DAMG_AMT_MOCY_BIKE,
		    DAMG_AMT_FURN_ARTC,
		    DAMG_AMT_CLOT,
		    DAMG_AMT_MACH,
		    DAMG_AMT_FARM_FORT_PROD,
		    DAMG_AMT_AMHB_PROD,
		    DAMG_AMT_MARN_PROD,
		    DAMG_AMT_MCGD,
		    DAMG_AMT_ETC,
		    DAMG_AMT_TOT,
		    BODY_DAMG_ZERO,
		    BODY_DAMG_INJY,
		    BODY_DAMG_DETH,
		    BODY_DAMG_INJY_MAN,
		    BODY_DAMG_INJY_WOMN,
		    BODY_DAMG_DETH_MAN,
		    BODY_DAMG_DETH_WOMN,
		    BODY_DAMG_INJY_DEGR,
		    ACT_VIO_NUM,
		    REG_USER_ID,
		    REG_DATE,
		    UPD_USER_ID,
		    UPD_DATE
		) VALUES (
		     #occrStsGrapNum# 
			, TO_CHAR(SYSDATE,'YYYYMM')
			, #famyVioYnCd# 
			, #schlVioYnCd# 
			, #forgSpYnCd# 
			, #occrYrmhDtDivCd# 
			, #occrYrmhDt# 
			, #occrDotw# 
			, #recgYrmhDt#
			, #recgDotw# 
			, #occrToRecgPi# 
			, #criMeth# 
			, #occrDtSpelSitu# 
			, #criTimeWeth# 
			, #criClue# 
			, #undcRsn# 
			, #vicm# 
			, #ageDivCd# 
			, #age# 
			, #forgCdNaty# 
			, #forgCdPosi# 
			, #vicmDamgTimeSitu# 
			, #occrAreaDiv# 
			, #occrArea# 
			, #occrPla# 
			, #propDamgDegr# 
			, #damgAmtMony# 
			, #damgAmtCar# 
			, #damgAmtMarkSecu# 
			, #damgAmtJewy# 
			, #damgAmtElecElenProd# 
			, #damgAmtMocyBike# 
			, #damgAmtFurnArtc# 
			, #damgAmtClot# 
			, #damgAmtMach# 
			, #damgAmtFarmFortProd# 
			, #damgAmtAmhbProd# 
			, #damgAmtMarnProd# 
			, #damgAmtMcgd# 
			, #damgAmtEtc# 
			, #damgAmtTot# 
			, #bodyDamgZero# 
			, #bodyDamgInjy# 
			, #bodyDamgDeth# 
			, #bodyDamgInjyMan# 
			, #bodyDamgInjyWomn# 
			, #bodyDamgDethMan# 
			, #bodyDamgDethWomn# 
			, #bodyDamgInjyDegr# 
			, #actVioNum# 
			, #regUserId# 
			, SYSDATE
			, #updUserId# 
			, SYSDATE
		)
	</insert>
	
	<!-- 발생 통계원표 수정 -->
	<update id="B0101.SJPB_OCCR_STS_GRAP.update">	/* B0101.SJPB_OCCR_STS_GRAP.update */
		UPDATE SJPB_OCCR_STS_GRAP
		SET FAMY_VIO_YN_CD=#famyVioYnCd# 
		    ,SCHL_VIO_YN_CD=#schlVioYnCd# 
		    ,FORG_SP_YN_CD=#forgSpYnCd# 
		    ,OCCR_YRMH_DT_DIV_CD=#occrYrmhDtDivCd# 
		    ,OCCR_YRMH_DT=#occrYrmhDt# 
		    ,OCCR_DOTW=#occrDotw# 
		    ,RECG_YRMH_DT=#recgYrmhDt# 
		    ,RECG_DOTW=#recgDotw# 
		    ,OCCR_TO_RECG_PI=#occrToRecgPi# 
		    ,CRI_METH=#criMeth# 
		    ,OCCR_DT_SPEL_SITU=#occrDtSpelSitu# 
		    ,CRI_TIME_WETH=#criTimeWeth# 
		    ,CRI_CLUE=#criClue# 
		    ,UNDC_RSN=#undcRsn# 
		    ,VICM=#vicm# 
		    ,AGE_DIV_CD=#ageDivCd# 
		    ,AGE=#age# 
		    ,FORG_CD_NATY=#forgCdNaty#
		    ,FORG_CD_POSI=#forgCdPosi# 
		    ,VICM_DAMG_TIME_SITU=#vicmDamgTimeSitu#
		    ,OCCR_AREA_DIV=#occrAreaDiv# 
		    ,OCCR_AREA=#occrArea# 
		    ,OCCR_PLA=#occrPla# 
		    ,PROP_DAMG_DEGR=#propDamgDegr# 
		    ,DAMG_AMT_MONY=#damgAmtMony# 
		    ,DAMG_AMT_CAR=#damgAmtCar# 
		    ,DAMG_AMT_MARK_SECU=#damgAmtMarkSecu# 
		    ,DAMG_AMT_JEWY=#damgAmtJewy# 
		    ,DAMG_AMT_ELEC_ELEN_PROD=#damgAmtElecElenProd# 
		    ,DAMG_AMT_MOCY_BIKE=#damgAmtMocyBike# 
		    ,DAMG_AMT_FURN_ARTC=#damgAmtFurnArtc# 
		    ,DAMG_AMT_CLOT=#damgAmtClot# 
		    ,DAMG_AMT_MACH=#damgAmtMach# 
		    ,DAMG_AMT_FARM_FORT_PROD=#damgAmtFarmFortProd# 
		    ,DAMG_AMT_AMHB_PROD=#damgAmtAmhbProd# 
		    ,DAMG_AMT_MARN_PROD=#damgAmtMarnProd# 
		    ,DAMG_AMT_MCGD=#damgAmtMcgd# 
		    ,DAMG_AMT_ETC=#damgAmtEtc# 
		    ,DAMG_AMT_TOT=#damgAmtTot# 
		    ,BODY_DAMG_ZERO=#bodyDamgZero# 
		    ,BODY_DAMG_INJY=#bodyDamgInjy# 
		    ,BODY_DAMG_DETH=#bodyDamgDeth# 
		    ,BODY_DAMG_INJY_MAN=#bodyDamgInjyMan# 
		    ,BODY_DAMG_INJY_WOMN=#bodyDamgInjyWomn# 
		    ,BODY_DAMG_DETH_MAN=#bodyDamgDethMan# 
		    ,BODY_DAMG_DETH_WOMN=#bodyDamgDethWomn# 
		    ,BODY_DAMG_INJY_DEGR=#bodyDamgInjyDegr# 
		    ,UPD_USER_ID=#updUserId# 
		    ,UPD_DATE=SYSDATE
		WHERE OCCR_STS_GRAP_NUM=#occrStsGrapNum#
	</update>	
	
	<!-- 검거 통계원표 추가 -->
	<insert id="B0101.SJPB_ARST_STS_GRAP.insert"> /* B0101.SJPB_ARST_STS_GRAP.insert */
		INSERT INTO SJPB_ARST_STS_GRAP (
		    ARST_STS_GRAP_NUM
			,STS_GRAP_PUBL_YRMH
			,FAMY_VIO_YN
			,SCHL_VIO_YN
			,ARST_YEAR_MONT_DT
			,OCCR_YEAR_MONT_DT
			,OCCR_TO_ARST_PI
			,CRI_METH
			,TRPS_ENTY
			,TRPS_WAY
			,ARST_KORN_MAN
			,ARST_KORN_WOMN
			,ARST_KORN_CORP
			,ARST_FORG_MAN
			,ARST_FORG_WOMN
			,ARST_FORG_CORP
			,CMTD_UNCT_CLSF
			,ACMP_NUM
			,CRI_TOOL_TYPE
			,CRI_TOOL_ACTN
			,CRI_TOOL_ACQR_WAY
			,ARST_CLUE
			,STGD_DIP_WAY
			,STGD_MONY_COSP_USE
			,COLL_AMT_MONY
			,COLL_AMT_CAR
			,COLL_AMT_MARK_SECU
			,COLL_AMT_JEWY
			,COLL_AMT_ELEC_ELEN_PROD
			,COLL_AMT_MOCY_BIKE
			,COLL_AMT_FURN_ARTC
			,COLL_AMT_CLOT
			,COLL_AMT_MACH
			,COLL_AMT_FARM_FORT_PROD
			,COLL_AMT_AMHB_PROD
			,COLL_AMT_MARN_PROD
			,COLL_AMT_MCGD
			,COLL_AMT_ETC
			,COLL_AMT_TOT
			,COLL_DEGR_CD
			,ACT_VIO_NUM
			,REG_USER_ID
			,REG_DATE
			,UPD_USER_ID
			,UPD_DATE
		) VALUES (
		    #arstStsGrapNum#
			,TO_CHAR(SYSDATE,'YYYYMM')
			,#famyVioYn#
			,#schlVioYn#
			,#arstYearMontDt#
			,#occrYearMontDt#
			,#occrToArstPi#
			,#criMeth#
			,#trpsEnty#
			,#trpsWay#
			,#arstKornMan#
			,#arstKornWomn#
			,#arstKornCorp#
			,#arstForgMan#
			,#arstForgWomn#
			,#arstForgCorp#
			,#cmtdUnctClsf#
			,#acmpNum#
			,#criToolType#
			,#criToolActn#
			,#criToolAcqrWay#
			,#arstClue#
			,#stgdDipWay#
			,#stgdMonyCospUse#
			,#collAmtMony#
			,#collAmtCar#
			,#collAmtMarkSecu#
			,#collAmtJewy#
			,#collAmtElecElenProd#
			,#collAmtMocyBike#
			,#collAmtFurnArtc#
			,#collAmtClot#
			,#collAmtMach#
			,#collAmtFarmFortProd#
			,#collAmtAmhbProd#
			,#collAmtMarnProd#
			,#collAmtMcgd#
			,#collAmtEtc#
			,#collAmtTot#
			,#collDegrCd#
			,#actVioNum#
			,#regUserId#
			,SYSDATE
			,#updUserId#
			,SYSDATE
		)
	</insert>
	
	<!-- 검거 통계원표 수정 -->
	<update id="B0101.SJPB_ARST_STS_GRAP.update">	/* B0101.SJPB_ARST_STS_GRAP.update */
		UPDATE SJPB_ARST_STS_GRAP
		SET FAMY_VIO_YN=#famyVioYn#
			,SCHL_VIO_YN=#schlVioYn#
			,ARST_YEAR_MONT_DT=#arstYearMontDt#
			,OCCR_YEAR_MONT_DT=#occrYearMontDt#
			,OCCR_TO_ARST_PI=#occrToArstPi#
			,CRI_METH=#criMeth#
			,TRPS_ENTY=#trpsEnty#
			,TRPS_WAY=#trpsWay#
			,ARST_KORN_MAN=#arstKornMan#
			,ARST_KORN_WOMN=#arstKornWomn#
			,ARST_KORN_CORP=#arstKornCorp#
			,ARST_FORG_MAN=#arstForgMan#
			,ARST_FORG_WOMN=#arstForgWomn#
			,ARST_FORG_CORP=#arstForgCorp#
			,CMTD_UNCT_CLSF=#cmtdUnctClsf#
			,ACMP_NUM=#acmpNum#
			,CRI_TOOL_TYPE=#criToolType#
			,CRI_TOOL_ACTN=#criToolActn#
			,CRI_TOOL_ACQR_WAY=#criToolAcqrWay#
			,ARST_CLUE=#arstClue#
			,STGD_DIP_WAY=#stgdDipWay#
			,STGD_MONY_COSP_USE=#stgdMonyCospUse#
			,COLL_AMT_MONY=#collAmtMony#
			,COLL_AMT_CAR=#collAmtCar#
			,COLL_AMT_MARK_SECU=#collAmtMarkSecu#
			,COLL_AMT_JEWY=#collAmtJewy#
			,COLL_AMT_ELEC_ELEN_PROD=#collAmtElecElenProd#
			,COLL_AMT_MOCY_BIKE=#collAmtMocyBike#
			,COLL_AMT_FURN_ARTC=#collAmtFurnArtc#
			,COLL_AMT_CLOT=#collAmtClot#
			,COLL_AMT_MACH=#collAmtMach#
			,COLL_AMT_FARM_FORT_PROD=#collAmtFarmFortProd#
			,COLL_AMT_AMHB_PROD=#collAmtAmhbProd#
			,COLL_AMT_MARN_PROD=#collAmtMarnProd#
			,COLL_AMT_MCGD=#collAmtMcgd#
			,COLL_AMT_ETC=#collAmtEtc#
			,COLL_AMT_TOT=#collAmtTot#
			,COLL_DEGR_CD=#collDegrCd#
			,UPD_USER_ID=#updUserId#
			,UPD_DATE=SYSDATE
		WHERE ARST_STS_GRAP_NUM=#arstStsGrapNum#
	</update>	
	
	<!-- 피의자 통계원표 추가 -->
	<insert id="B0101.SJPB_SP_STS_GRAP.insert"> /* B0101.SJPB_SP_STS_GRAP.insert */
		INSERT INTO SJPB_SP_STS_GRAP (
		    SP_STS_GRAP_NUM
			,STS_GRAP_PUBL_YRMH
			,FAMY_VIO_YN
			,SCHL_VIO_YN
			,FORG_CD_NATY
			,FORG_CD_POSI
			,CRI_TIME_AGE
			,JOB_CD
			,PUOF_BELG_CD
			,PUOF_CLAS_CD
			,PUOF_DUTY_RELV
			,CRRD_CD
			,SECV_SITU_LAST_DIP_CONT
			,SECV_SITU_PROT_DIP
			,SECV_SITU_SECV_PI
			,SECV_SITU_SECV_TYPE
			,ACMP_RELT
			,VICM_RELT
			,CRI_AFTR_HDOT
			,DRUG_CMUS_YN
			,CRI_TIME_MIND_STAT
			,CRI_MOTV
			,ACAB
			,LIVG_DEGR
			,RELG
			,MARG_RELT
			,PARE_RELT
			,ARST_POLF
			,ACTN
			,CONF_YN
			,ARRT_CLSF
			,NON_ARRT_CLSF
			,TRF_OP
			,INC_HAND_PI
			,ACT_VIO_NUM
			,REG_USER_ID
			,REG_DATE
			,UPD_USER_ID
			,UPD_DATE
		) VALUES (
			#spStsGrapNum#
			,TO_CHAR(SYSDATE,'YYYYMM')
			,#famyVioYn#
			,#schlVioYn#
			,#forgCdNaty#
			,#forgCdPosi#
			,#criTimeAge#
			,#jobCd#
			,#puofBelgCd#
			,#puofClasCd#
			,#puofDutyRelv#
			,#crrdCd#
			,#secvSituLastDipCont#
			,#secvSituProtDip#
			,#secvSituSecvPi#
			,#secvSituSecvType#
			,#acmpRelt#
			,#vicmRelt#
			,#criAftrHdot#
			,#drugCmusYn#
			,#criTimeMindStat#
			,#criMotv#
			,#acab#
			,#livgDegr#
			,#relg#
			,#margRelt#
			,#pareRelt#
			,#arstPolf#
			,#actn#
			,#confYn#
			,#arrtClsf#
			,#nonArrtClsf#
			,#trfOp#
			,#incHandPi#
			,#actVioNum#
			,#regUserId#
			,SYSDATE
			,#updUserId#
			,SYSDATE
		)
	</insert>
	
	<!-- 피의자 통계원표 수정 -->
	<update id="B0101.SJPB_SP_STS_GRAP.update">	/* B0101.SJPB_SP_STS_GRAP.update */
		UPDATE SJPB_SP_STS_GRAP
		SET FAMY_VIO_YN=#famyVioYn#
			,SCHL_VIO_YN=#schlVioYn#
			,FORG_CD_NATY=#forgCdNaty#
			,FORG_CD_POSI=#forgCdPosi#
			,CRI_TIME_AGE=#criTimeAge#
			,JOB_CD=#jobCd#
			,PUOF_BELG_CD=#puofBelgCd#
			,PUOF_CLAS_CD=#puofClasCd#
			,PUOF_DUTY_RELV=#puofDutyRelv#
			,CRRD_CD=#crrdCd#
			,SECV_SITU_LAST_DIP_CONT=#secvSituLastDipCont#
			,SECV_SITU_PROT_DIP=#secvSituProtDip#
			,SECV_SITU_SECV_PI=#secvSituSecvPi#
			,SECV_SITU_SECV_TYPE=#secvSituSecvType#
			,ACMP_RELT=#acmpRelt#
			,VICM_RELT=#vicmRelt#
			,CRI_AFTR_HDOT=#criAftrHdot#
			,DRUG_CMUS_YN=#drugCmusYn#
			,CRI_TIME_MIND_STAT=#criTimeMindStat#
			,CRI_MOTV=#criMotv#
			,ACAB=#acab#
			,LIVG_DEGR=#livgDegr#
			,RELG=#relg#
			,MARG_RELT=#margRelt#
			,PARE_RELT=#pareRelt#
			,ARST_POLF=#arstPolf#
			,ACTN=#actn#
			,CONF_YN=#confYn#
			,ARRT_CLSF=#arrtClsf#
			,NON_ARRT_CLSF=#nonArrtClsf#
			,TRF_OP=#trfOp#
			,INC_HAND_PI=#incHandPi#
			,ACT_VIO_NUM=#actVioNum#
			,UPD_USER_ID=#updUserId#
			,UPD_DATE=SYSDATE
		WHERE SP_STS_GRAP_NUM=#spStsGrapNum#
	</update>	
	
	<!-- 발생 통계원표 수정 (FK값 업데이트, INC_SP_NUM(사건피의자번호), ACT_VIO_NUM(법률위반번호)) -->	 		
	<update id="B0101.SJPB_OCCR_STS_GRAP.FK.update"> /* B0101.SJPB_OCCR_STS_GRAP.FK.update */			
		UPDATE SJPB_OCCR_STS_GRAP
		SET ACT_VIO_NUM=#actVioNum#
		WHERE ACT_VIO_NUM=#actVioNumPrev#
	</update>
	
	<!-- 검거 통계원표 수정 (FK값 업데이트, INC_SP_NUM(사건피의자번호), ACT_VIO_NUM(법률위반번호)) -->	 		
	<update id="B0101.SJPB_ARST_STS_GRAP.FK.update"> /* B0101.SJPB_ARST_STS_GRAP.FK.update */			
		UPDATE SJPB_ARST_STS_GRAP
		SET ACT_VIO_NUM=#actVioNum#
		WHERE ACT_VIO_NUM=#actVioNumPrev#
	</update>
	
	<!-- 피의자 통계원표 수정 (FK값 업데이트, INC_SP_NUM(사건피의자번호), ACT_VIO_NUM(법률위반번호)) -->	 		
	<update id="B0101.SJPB_SP_STS_GRAP.FK.update"> /* B0101.SJPB_SP_STS_GRAP.FK.update */			
		UPDATE SJPB_SP_STS_GRAP
		SET ACT_VIO_NUM=#actVioNum#
		WHERE ACT_VIO_NUM=#actVioNumPrev#
	</update>
	
	<!-- 수사상태코드 업데이트 -->	 		
	<update id="B0101.SJPB_INC_MAST.CRI_STAT_CD.update"> /* B0101.SJPB_INC_MAST.CRI_STAT_CD.update */				
			UPDATE SJPB_INC_MAST
			SET CRI_STAT_CD = #criStatCd#
				,MF_CD = null
				,MF_CONT = #mfCont#
			    ,UPD_USER_ID = #updUserId#
			    ,UPD_DATE = SYSDATE
			WHERE RCPT_NUM = #rcptNum#		
	</update>
	
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.SJPB_INC_MAST.RCPT_INC_NUM.select">
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="incNum" column="INC_NUM"/>
	</resultMap>
	<!-- 접수사건번호 조회 (사건테이블) -->	 		
	<select id="B0101.SJPB_INC_MAST.RCPT_INC_NUM.select" resultMap="B0101VO.SJPB_INC_MAST.RCPT_INC_NUM.select"> /* B0101.SJPB_INC_MAST.RCPT_INC_NUM.select */				
			SELECT
			    A.RCPT_INC_NUM
			    ,B.INC_NUM
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			WHERE A.RCPT_NUM = #rcptNum#
	</select>
	
	<!-- 접수사건번호, 착수일자 업데이트 (사건테이블) -->	 		
	<update id="B0101.SJPB_INC_MAST.RCPT_INC_NUM.update"> /* B0101.SJPB_INC_MAST.RCPT_INC_NUM.update */				
			UPDATE SJPB_INC_MAST
			SET RCPT_INC_NUM = TO_CHAR(SYSDATE,'YYYY') || '년 범죄 제' || (SELECT SEQ+1 FROM KEYGEN WHERE entity_name = 'SJPB_INC_DTS.INC_NUM') ||'호'
				,BE_DT = SYSDATE
				,MF_CD = #mfCd#
				,MF_CONT = #mfCont#
			    ,UPD_USER_ID = #updUserId#
			    ,UPD_DATE = SYSDATE
			WHERE RCPT_NUM = #rcptNum#		
	</update>
	
	<!-- 접수번호 업데이트  (사건테이블) -->	 		
	<update id="B0101.SJPB_INC_MAST.RCPT_ORD_NUM.update"> /* B0101.SJPB_INC_MAST.RCPT_ORD_NUM.update */				
			UPDATE SJPB_INC_MAST
			SET RCPT_ORD_NUM = TO_CHAR(SYSDATE,'YYYY') || '-' || (SELECT SEQ+1 FROM KEYGEN WHERE entity_name = 'SJPB_INC_MAST.RCPT_ORD_NUM')
				,MF_CD = #mfCd#
				,MF_CONT = #mfCont#
			    ,UPD_USER_ID = #updUserId#
			    ,UPD_DATE = SYSDATE
			WHERE RCPT_NUM = #rcptNum#		
	</update>
	
	<!-- 접수사건번호 업데이트 (사건상세테이블) -->	 		
	<update id="B0101.SJPB_INC_DTS.INC_NUM.update"> /* B0101.SJPB_INC_DTS.INC_NUM.update */				
			UPDATE SJPB_INC_DTS
			SET INC_NUM = TO_CHAR(SYSDATE,'YYYY') || '년 범죄 제' || (SELECT SEQ+1 FROM KEYGEN WHERE entity_name = 'SJPB_INC_DTS.INC_NUM') ||'호'
			    ,UPD_USER_ID = #updUserId#
			    ,UPD_DATE = SYSDATE
			WHERE RCPT_NUM = #rcptNum#		
	</update>
	
	<!-- 사건 수정 -->
	<update id="B0101.SJPB_INC_MAST.update">	/* B0101.SJPB_INC_MAST.update */
		UPDATE SJPB_INC_MAST
		SET PO_INC_NUM = #poIncNum#
			,DIR_NM=#dirNm#
			,BE_DT=TO_DATE(#beDt#,'YYYY-MM-DD')
			,ACPT_DT=TO_DATE(#acptDt#,'YYYY-MM-DD')
			,PRO_DT=TO_DATE(#proDt#,'YYYY-MM-DD')
			,STOCK=#stock#
			,FD_CD=#fdCd#
			,CRI_TM_ID=#criTmId#
			,DV_FORM=#dvForm#
			,INFW_DIV=#infwDiv#
			,MF_CD=#mfCd#
			,MF_CONT=#mfCont#
			<isNotEqual prepend="," property="incMfNum" compareValue="">INC_MF_NUM=#incMfNum#</isNotEqual>
			,UPD_USER_ID=#updUserId#
			,UPD_DATE=SYSDATE
			,RCPT_DT=TO_DATE(#rcptDt#,'YYYY-MM-DD')
		WHERE RCPT_NUM=#rcptNum#
	</update>	
	
	<!-- 사건 상세 수정 -->
	<update id="B0101.SJPB_INC_DTS.update">	/* B0101.SJPB_INC_DTS.update */
		UPDATE SJPB_INC_DTS
		SET CHA_ITT=#chaItt#
			,INC_CONT=#incCont#
			,CRI_CONT=#criCont#
			,INC_OCCR_AREA_ADDR=#incOccrAreaAddr#	
            ,INC_OCCR_AREA_XCD=#incOccrAreaXcd#	
            ,INC_OCCR_AREA_YCD=#incOccrAreaYcd#	
            ,VICM_NM=#vicmNm#
			,DAMG_DEGR=#damgDegr#
			,SEIZ_NUM=#seizNum#
			,CRI_PEND_INC_FILE_NUM=#criPendIncFileNum#
			,CRI_DT=#criDt#
			,UPD_USER_ID=#updUserId#
			,UPD_DATE=SYSDATE
		WHERE RCPT_NUM=#rcptNum#
	</update>	
	
	<!-- 사건 상세 수정, [사건내용]  -->
	<update id="B0101.updateInvestigation">	/* B0101.updateInvestigation */
		<![CDATA[	
			UPDATE SJPB_INC_DTS
			SET CRI_CONT=#criCont#
				,UPD_USER_ID=#updUserId#
				,UPD_DATE=SYSDATE
			WHERE RCPT_NUM=#rcptNum#
		]]>
	</update>	
	
	<!-- 피의자 수정, [형제번호, 검찰처분일시]  -->
	<update id="B0101.updateIncDipRstDts">	/* B0101.updateIncDipRstDts */
		<![CDATA[	
			UPDATE SJPB_INC_SP
			SET CRLW_NUM=#crlwNum#
				,PO_DIP_DT=TO_DATE(#poDipDt#,'YYYY-MM-DD')
				,UPD_USER_ID=#updUserId#
				,UPD_DATE=SYSDATE
			WHERE INC_SP_NUM=#incSpNum#
		]]>
	</update>	
	
	<!-- 피의자 수정, [검찰판결확정일시]  -->
	<update id="B0101.updateIncJdtRstDts">	/* B0101.updateIncJdtRstDts */
		<![CDATA[	
			UPDATE SJPB_INC_SP
			SET JDT_FI_DT=TO_DATE(#jdtFiDt#,'YYYY-MM-DD')
				,UPD_USER_ID=#updUserId#
				,UPD_DATE=SYSDATE
			WHERE INC_SP_NUM=#incSpNum#
		]]>
	</update>	
	
	
	<!-- 법률위반 수정 -->
	<update id="B0101.SJPB_ACT_VIO.update">	/* B0101.SJPB_ACT_VIO.update */
		<![CDATA[	
			UPDATE SJPB_ACT_VIO
			SET RLT_ACT_CRI_NM_CD=#rltActCriNmCd#,VIO_CONT=#vioCont#,INQ_ORD=#inqOrd#,ACT_VIO_CLA_NM=#actVioClaNm#,UPD_USER_ID=#updUserId#,UPD_DATE=SYSDATE
			WHERE INC_SP_NUM=#incSpNum#
				AND ACT_VIO_NUM=#actVioNum#
		]]>
	</update>	
	
	<!-- 법률위반 상태 수정 -->
	<update id="B0101.SJPB_ACT_VIO.stat.update">	/* B0101.SJPB_ACT_VIO.stat.update */
		<![CDATA[	
			UPDATE SJPB_ACT_VIO
			SET ACT_VIO_STAT_CD=#actVioStatCd#,UPD_USER_ID=#updUserId#,UPD_DATE=SYSDATE
			WHERE INC_SP_NUM=#incSpNum#
				AND ACT_VIO_NUM=#actVioNum#
		]]>
	</update>	
	
	<!--  법률위반 추가 -->
	<insert id="B0101.SJPB_ACT_VIO.insert"> /* B0101.SJPB_ACT_VIO.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO (INC_SP_NUM,ACT_VIO_NUM,RLT_ACT_CRI_NM_CD,VIO_CONT,ACT_VIO_CLA_NM,ACT_VIO_STAT_CD,INQ_ORD,REG_USER_ID,REG_DATE,UPD_USER_ID,UPD_DATE) VALUES 
			(#incSpNum#,#actVioNum#,#rltActCriNmCd#,#vioCont#,#actVioClaNm#,#actVioStatCd#,#inqOrd#,#regUserId#,SYSDATE,#updUserId#,SYSDATE)
		]]>
	</insert>
	
	<!--  법률위반수정 추가 -->
	<insert id="B0101.SJPB_ACT_VIO_MF.copy.insert"> /* B0101.SJPB_ACT_VIO_MF.copy.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO_MF 
			(
				INC_MF_NUM
                ,INC_SP_NUM
                ,ACT_VIO_NUM
                ,RLT_ACT_CRI_NM_CD
                ,VIO_CONT
                ,ACT_VIO_STAT_CD
                ,INQ_ORD
                ,REG_USER_ID
                ,REG_DATE
                ,UPD_USER_ID
                ,UPD_DATE
                ,UPD_CD
			)
			SELECT 
			        #incMfNum#
                    ,INC_SP_NUM
                    ,ACT_VIO_NUM
                    ,RLT_ACT_CRI_NM_CD
                    ,VIO_CONT
                    ,ACT_VIO_STAT_CD
                    ,INQ_ORD
                    ,REG_USER_ID
                    ,REG_DATE
                    ,UPD_USER_ID
                    ,UPD_DATE
                    ,#updateCd#
			    FROM SJPB_ACT_VIO
			    WHERE ACT_VIO_NUM = #actVioNum#
		]]>
	</insert>
	
	<!--  법률위반수정 추가 -->
	<insert id="B0101.SJPB_ACT_VIO_MF.insert"> /* B0101.SJPB_ACT_VIO_MF.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO_MF (INC_MF_NUM,INC_SP_NUM,ACT_VIO_NUM,RLT_ACT_CRI_NM_CD,VIO_CONT,ACT_VIO_STAT_CD,INQ_ORD,REG_USER_ID,REG_DATE,UPD_USER_ID,UPD_DATE,UPD_CD) VALUES 
			(#incMfNum#,#incSpNum#,#actVioNum#,#rltActCriNmCd#,#vioCont#,#actVioStatCd#,#inqOrd#,#regUserId#,SYSDATE,#updUserId#,SYSDATE,#updateCd#)
		]]>
	</insert>
	
	<!--  법률위반조항 추가 -->
	<insert id="B0101.SJPB_ACT_VIO_TYPE.insert"> /* B0101.SJPB_ACT_VIO_TYPE.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO_TYPE (ACT_VIO_NUM,INQ_ORD,ACT_VIO_TYPE_CODE,REG_USER_ID,REG_DATE,UPD_USER_ID,UPD_DATE) VALUES 
			(#actVioNum#,#inqOrd#,#actVioTypeCode#,#regUserId#,SYSDATE,#updUserId#,SYSDATE)
		]]>
	</insert>
	
	<!--  법률위반조항수정 추가 COPY -->
	<insert id="B0101.SJPB_ACT_VIO_CLA_MF.copy.insert"> /* B0101.SJPB_ACT_VIO_CLA_MF.copy.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO_CLA_MF
			(
				INC_MF_NUM
                ,ACT_VIO_NUM
                ,INQ_ORD
                ,ACT_VIO_CLA_NM
                ,REG_USER_ID
                ,REG_DATE
                ,UPD_USER_ID
                ,UPD_DATE
			)
			SELECT 
			        #incMfNum#
                    ,ACT_VIO_NUM
                    ,INQ_ORD
                    ,ACT_VIO_CLA_NM
                    ,REG_USER_ID
                    ,REG_DATE
                    ,UPD_USER_ID
                    ,UPD_DATE
			    FROM SJPB_ACT_VIO_CLA
			    WHERE ACT_VIO_NUM = #actVioNum#
                AND INQ_ORD = #inqOrd#
		]]>
	</insert>
	
	<!--  법률위반조항수정 추가 -->
	<insert id="B0101.SJPB_ACT_VIO_CLA_MF.insert"> /* B0101.SJPB_ACT_VIO_CLA_MF.insert */
		<![CDATA[
			INSERT INTO SJPB_ACT_VIO_CLA_MF (INC_MF_NUM,ACT_VIO_NUM,INQ_ORD,ACT_VIO_CLA_NM,REG_USER_ID,REG_DATE,UPD_USER_ID,UPD_DATE) VALUES 
			(#incMfNum#,#actVioNum#,#inqOrd#,#actVioClaNm#,#regUserId#,SYSDATE,#updUserId#,SYSDATE)
		]]>
	</insert>
	
	<!-- 법률위반조항 수정 -->
	<update id="B0101.SJPB_ACT_VIO_TYPE.update">	/* B0101.SJPB_ACT_VIO_TYPE.update */
		<![CDATA[	
			UPDATE SJPB_ACT_VIO_TYPE
			SET ACT_VIO_TYPE_CODE=#actVioTypeCode#,UPD_USER_ID=#updUserId#,UPD_DATE=SYSDATE
			WHERE ACT_VIO_NUM=#actVioNum#
				AND INQ_ORD=#inqOrd#
		]]>
	</update>	

	<!-- 사건병합, 분리 (자식사건) -->
	<update id="B0101.combIncMastChid.update"> /* B0101.combIncMastChid.update */
		UPDATE SJPB_INC_MAST 
		SET PARE_RCPT_NUM = #pareRcptNum#
			, COMB_INC_YN=#combIncYn#
			,MF_CD = #mfCd#
			,MF_CONT = #mfCont#
		 	,UPD_USER_ID=#updUserId#
		 	,UPD_DATE=SYSDATE
		WHERE RCPT_NUM=#rcptNum#
	</update>
	
	<!-- 사건병합 (부모사건) -->
	<update id="B0101.combIncMastPare.update"> /* B0101.combIncMastPare.update */
		UPDATE SJPB_INC_MAST 
		SET COMB_INC_YN=#combIncYn# , RCPT_INC_NUM = (
			SELECT 
				( B.INC_NUM || ',' || (SELECT LISTAGG(AAA.RCPT_INC_NUM, ',') WITHIN GROUP (ORDER BY '') FROM SJPB_INC_MAST AAA WHERE PARE_RCPT_NUM = #rcptNum#)) RCPT_INC_NUM
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			WHERE A.RCPT_NUM = #rcptNum#
		)
			,MF_CD = #mfCd#
			,MF_CONT = #mfCont#
			,UPD_USER_ID=#updUserId#
		 	,UPD_DATE=SYSDATE
		WHERE RCPT_NUM=#rcptNum#
	</update>
	
	<!-- 사건분리 (부모사건) -->
	<update id="B0101.unCombIncMastPare.update"> /* B0101.unCombIncMastPare.update */
		UPDATE SJPB_INC_MAST 
		SET COMB_INC_YN=#combIncYn# , RCPT_INC_NUM = (
			SELECT 
			    B.INC_NUM
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			WHERE A.RCPT_NUM = #rcptNum#
		)
			,MF_CD = #mfCd#
			,MF_CONT = #mfCont#
			,UPD_USER_ID=#updUserId#
		 	,UPD_DATE=SYSDATE
		WHERE RCPT_NUM=#rcptNum#
	</update>
	
	<!-- 
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.selectStsGrapList">
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="incNum" column="INC_NUM"/>
		<result property="spNm" column="SP_NM"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
	</resultMap>
	사건 통계원표 리스트
	<select id="B0101.selectStsGrapList" resultMap="B0101VO.selectStsGrapList"> /* B0101.selectStsGrapList */  
	<![CDATA[
		SELECT DISTINCT
		    A.RCPT_NUM
		    ,B.INC_NUM
		    ,C.SP_NM
		    ,C.INC_SP_NUM
		    ,(
		    	SELECT 
		    		REGEXP_REPLACE(LISTAGG(AA.CODE_NAME, ',') WITHIN GROUP (ORDER BY ''), '([^,]+)(,\1)+', '\1')  
		    	FROM SJPB_ACT_VIO GG 
		    	LEFT OUTER JOIN CODEBASE AA ON GG.RLT_ACT_CRI_NM_CD = AA.CODE AND AA.CODE_ID = 'SJPB_00012'
		    	WHERE 
		    		GG.RCPT_NUM = A.RCPT_NUM 
		    		AND GG.INC_SP_NUM = C.INC_SP_NUM
		    	) AS RLT_ACT_CRI_NM_CD_DESC
		FROM SJPB_INC_MAST A
		JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
		LEFT OUTER JOIN SJPB_INC_SP C ON A.RCPT_NUM = C.RCPT_NUM 
		START WITH A.RCPT_NUM = #rcptNum#
		CONNECT BY PRIOR A.RCPT_NUM = A.PARE_RCPT_NUM  
		ORDER BY B.INC_NUM ASC
		]]>
	</select>
	 -->
	
	<resultMap class="com.saltware.enface.sjpb.B.service.OccrStsGrapVO" id="OccrStsGrapVO.SJPB_OCCR_STS_GRAP.select">
		<result property="occrStsGrapNum" column="OCCR_STS_GRAP_NUM"/>
		<result property="stsGrapPublYrmh" column="STS_GRAP_PUBL_YRMH"/>
		<result property="famyVioYnCd" column="FAMY_VIO_YN_CD"/>
		<result property="schlVioYnCd" column="SCHL_VIO_YN_CD"/>
		<result property="forgSpYnCd" column="FORG_SP_YN_CD"/>
		<result property="occrYrmhDtDivCd" column="OCCR_YRMH_DT_DIV_CD"/>
		<result property="occrYrmhDt" column="OCCR_YRMH_DT"/>
		<result property="occrDotw" column="OCCR_DOTW"/>
		<result property="recgYrmhDt" column="RECG_YRMH_DT"/>
		<result property="recgDotw" column="RECG_DOTW"/>
		<result property="occrToRecgPi" column="OCCR_TO_RECG_PI"/>
		<result property="criMeth" column="CRI_METH"/>
		<result property="occrDtSpelSitu" column="OCCR_DT_SPEL_SITU"/>
		<result property="criTimeWeth" column="CRI_TIME_WETH"/>
		<result property="criClue" column="CRI_CLUE"/>
		<result property="undcRsn" column="UNDC_RSN"/>
		<result property="vicm" column="VICM"/>
		<result property="ageDivCd" column="AGE_DIV_CD"/>
		<result property="age" column="AGE"/>
		<result property="forgCdNaty" column="FORG_CD_NATY"/>
		<result property="forgCdPosi" column="FORG_CD_POSI"/>
		<result property="vicmDamgTimeSitu" column="VICM_DAMG_TIME_SITU"/>
		<result property="occrAreaDiv" column="OCCR_AREA_DIV"/>
		<result property="occrArea" column="OCCR_AREA"/>
		<result property="occrPla" column="OCCR_PLA"/>
		<result property="propDamgDegr" column="PROP_DAMG_DEGR"/>
		<result property="damgAmtMony" column="DAMG_AMT_MONY"/>
		<result property="damgAmtCar" column="DAMG_AMT_CAR"/>
		<result property="damgAmtMarkSecu" column="DAMG_AMT_MARK_SECU"/>
		<result property="damgAmtJewy" column="DAMG_AMT_JEWY"/>
		<result property="damgAmtElecElenProd" column="DAMG_AMT_ELEC_ELEN_PROD"/>
		<result property="damgAmtMocyBike" column="DAMG_AMT_MOCY_BIKE"/>
		<result property="damgAmtFurnArtc" column="DAMG_AMT_FURN_ARTC"/>
		<result property="damgAmtClot" column="DAMG_AMT_CLOT"/>
		<result property="damgAmtMach" column="DAMG_AMT_MACH"/>
		<result property="damgAmtFarmFortProd" column="DAMG_AMT_FARM_FORT_PROD"/>
		<result property="damgAmtAmhbProd" column="DAMG_AMT_AMHB_PROD"/>
		<result property="damgAmtMarnProd" column="DAMG_AMT_MARN_PROD"/>
		<result property="damgAmtMcgd" column="DAMG_AMT_MCGD"/>
		<result property="damgAmtEtc" column="DAMG_AMT_ETC"/>
		<result property="damgAmtTot" column="DAMG_AMT_TOT"/>
		<result property="bodyDamgZero" column="BODY_DAMG_ZERO"/>
		<result property="bodyDamgInjy" column="BODY_DAMG_INJY"/>
		<result property="bodyDamgDeth" column="BODY_DAMG_DETH"/>
		<result property="bodyDamgInjyMan" column="BODY_DAMG_INJY_MAN"/>
		<result property="bodyDamgInjyWomn" column="BODY_DAMG_INJY_WOMN"/>
		<result property="bodyDamgDethMan" column="BODY_DAMG_DETH_MAN"/>
		<result property="bodyDamgDethWomn" column="BODY_DAMG_DETH_WOMN"/>
		<result property="bodyDamgInjyDegr" column="BODY_DAMG_INJY_DEGR"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="actVioClaNm" column="ACT_VIO_CLA_NM"/>
	</resultMap>
	<!-- 발생 통계원표 가져오기 -->
	<select id="B0101.SJPB_OCCR_STS_GRAP.fk.select" resultMap="OccrStsGrapVO.SJPB_OCCR_STS_GRAP.select"> /* B0101.SJPB_OCCR_STS_GRAP.fk.select */  
		SELECT 
		    A.OCCR_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN_CD
		    ,A.SCHL_VIO_YN_CD
		    ,A.FORG_SP_YN_CD
		    ,A.OCCR_YRMH_DT_DIV_CD
		    ,A.OCCR_YRMH_DT
		    ,A.OCCR_DOTW
		    ,A.RECG_YRMH_DT
		    ,A.RECG_DOTW
		    ,A.OCCR_TO_RECG_PI
		    ,A.CRI_METH
		    ,A.OCCR_DT_SPEL_SITU
		    ,A.CRI_TIME_WETH
		    ,A.CRI_CLUE
		    ,A.UNDC_RSN
		    ,A.VICM
		    ,A.AGE_DIV_CD
		    ,A.AGE
		    ,A.FORG_CD_NATY
		    ,A.FORG_CD_POSI
		    ,A.VICM_DAMG_TIME_SITU
		    ,A.OCCR_AREA_DIV
		    ,A.OCCR_AREA
		    ,A.OCCR_PLA
		    ,A.PROP_DAMG_DEGR
		    ,A.DAMG_AMT_MONY
		    ,A.DAMG_AMT_CAR
		    ,A.DAMG_AMT_MARK_SECU
		    ,A.DAMG_AMT_JEWY
		    ,A.DAMG_AMT_ELEC_ELEN_PROD
		    ,A.DAMG_AMT_MOCY_BIKE
		    ,A.DAMG_AMT_FURN_ARTC
		    ,A.DAMG_AMT_CLOT
		    ,A.DAMG_AMT_MACH
		    ,A.DAMG_AMT_FARM_FORT_PROD
		    ,A.DAMG_AMT_AMHB_PROD
		    ,A.DAMG_AMT_MARN_PROD
		    ,A.DAMG_AMT_MCGD
		    ,A.DAMG_AMT_ETC
		    ,A.DAMG_AMT_TOT
		    ,A.BODY_DAMG_ZERO
		    ,A.BODY_DAMG_INJY
		    ,A.BODY_DAMG_DETH
		    ,A.BODY_DAMG_INJY_MAN
		    ,A.BODY_DAMG_INJY_WOMN
		    ,A.BODY_DAMG_DETH_MAN
		    ,A.BODY_DAMG_DETH_WOMN
		    ,A.BODY_DAMG_INJY_DEGR
		    ,B.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
		    ,B.ACT_VIO_CLA_NM
		FROM SJPB_OCCR_STS_GRAP A
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
		WHERE A.ACT_VIO_NUM =  #actVioNum# 
		GROUP BY A.OCCR_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN_CD, A.SCHL_VIO_YN_CD, A.FORG_SP_YN_CD, 
		A.OCCR_YRMH_DT_DIV_CD, A.OCCR_YRMH_DT, A.OCCR_DOTW, A.RECG_YRMH_DT, A.RECG_DOTW, 
		A.OCCR_TO_RECG_PI, A.CRI_METH, A.OCCR_DT_SPEL_SITU, A.CRI_TIME_WETH, A.CRI_CLUE, 
		A.UNDC_RSN, A.VICM, A.AGE_DIV_CD, A.AGE, A.FORG_CD_NATY, 
		A.FORG_CD_POSI, A.VICM_DAMG_TIME_SITU, A.OCCR_AREA_DIV, A.OCCR_AREA, A.OCCR_PLA, 
		A.PROP_DAMG_DEGR, A.DAMG_AMT_MONY, A.DAMG_AMT_CAR, A.DAMG_AMT_MARK_SECU, A.DAMG_AMT_JEWY, 
		A.DAMG_AMT_ELEC_ELEN_PROD, A.DAMG_AMT_MOCY_BIKE, A.DAMG_AMT_FURN_ARTC, A.DAMG_AMT_CLOT, A.DAMG_AMT_MACH, 
		A.DAMG_AMT_FARM_FORT_PROD, A.DAMG_AMT_AMHB_PROD, A.DAMG_AMT_MARN_PROD, A.DAMG_AMT_MCGD, A.DAMG_AMT_ETC, 
		A.DAMG_AMT_TOT, A.BODY_DAMG_ZERO, A.BODY_DAMG_INJY, A.BODY_DAMG_DETH, A.BODY_DAMG_INJY_MAN, 
		A.BODY_DAMG_INJY_WOMN, A.BODY_DAMG_DETH_MAN, A.BODY_DAMG_DETH_WOMN, A.BODY_DAMG_INJY_DEGR, B.INC_SP_NUM, 
		A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, A.UPD_DATE, 
		E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	<!-- 발생 통계원표 가져오기(pk) -->
	<select id="B0101.SJPB_OCCR_STS_GRAP.pk.select" resultMap="OccrStsGrapVO.SJPB_OCCR_STS_GRAP.select"> /* B0101.SJPB_OCCR_STS_GRAP.pk.select */  
		SELECT 
		    A.OCCR_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN_CD
		    ,A.SCHL_VIO_YN_CD
		    ,A.FORG_SP_YN_CD
		    ,A.OCCR_YRMH_DT_DIV_CD
		    ,A.OCCR_YRMH_DT
		    ,A.OCCR_DOTW
		    ,A.RECG_YRMH_DT
		    ,A.RECG_DOTW
		    ,A.OCCR_TO_RECG_PI
		    ,A.CRI_METH
		    ,A.OCCR_DT_SPEL_SITU
		    ,A.CRI_TIME_WETH
		    ,A.CRI_CLUE
		    ,A.UNDC_RSN
		    ,A.VICM
		    ,A.AGE_DIV_CD
		    ,A.AGE
		    ,A.FORG_CD_NATY
		    ,A.FORG_CD_POSI
		    ,A.VICM_DAMG_TIME_SITU
		    ,A.OCCR_AREA_DIV
		    ,A.OCCR_AREA
		    ,A.OCCR_PLA
		    ,A.PROP_DAMG_DEGR
		    ,A.DAMG_AMT_MONY
		    ,A.DAMG_AMT_CAR
		    ,A.DAMG_AMT_MARK_SECU
		    ,A.DAMG_AMT_JEWY
		    ,A.DAMG_AMT_ELEC_ELEN_PROD
		    ,A.DAMG_AMT_MOCY_BIKE
		    ,A.DAMG_AMT_FURN_ARTC
		    ,A.DAMG_AMT_CLOT
		    ,A.DAMG_AMT_MACH
		    ,A.DAMG_AMT_FARM_FORT_PROD
		    ,A.DAMG_AMT_AMHB_PROD
		    ,A.DAMG_AMT_MARN_PROD
		    ,A.DAMG_AMT_MCGD
		    ,A.DAMG_AMT_ETC
		    ,A.DAMG_AMT_TOT
		    ,A.BODY_DAMG_ZERO
		    ,A.BODY_DAMG_INJY
		    ,A.BODY_DAMG_DETH
		    ,A.BODY_DAMG_INJY_MAN
		    ,A.BODY_DAMG_INJY_WOMN
		    ,A.BODY_DAMG_DETH_MAN
		    ,A.BODY_DAMG_DETH_WOMN
		    ,A.BODY_DAMG_INJY_DEGR
		    ,E.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
<!-- 		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM -->
			,B.ACT_VIO_CLA_NM
		FROM SJPB_OCCR_STS_GRAP A
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
<!-- 		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM  -->
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
        WHERE A.OCCR_STS_GRAP_NUM=#occrStsGrapNum#
        GROUP BY A.OCCR_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN_CD, A.SCHL_VIO_YN_CD, A.FORG_SP_YN_CD, 
        A.OCCR_YRMH_DT_DIV_CD, A.OCCR_YRMH_DT, A.OCCR_DOTW, A.RECG_YRMH_DT, A.RECG_DOTW, 
        A.OCCR_TO_RECG_PI, A.CRI_METH, A.OCCR_DT_SPEL_SITU, A.CRI_TIME_WETH, A.CRI_CLUE, 
        A.UNDC_RSN, A.VICM, A.AGE_DIV_CD, A.AGE, A.FORG_CD_NATY, 
        A.FORG_CD_POSI, A.VICM_DAMG_TIME_SITU, A.OCCR_AREA_DIV, A.OCCR_AREA, A.OCCR_PLA, 
        A.PROP_DAMG_DEGR, A.DAMG_AMT_MONY, A.DAMG_AMT_CAR, A.DAMG_AMT_MARK_SECU, A.DAMG_AMT_JEWY, 
        A.DAMG_AMT_ELEC_ELEN_PROD, A.DAMG_AMT_MOCY_BIKE, A.DAMG_AMT_FURN_ARTC, A.DAMG_AMT_CLOT, A.DAMG_AMT_MACH, 
        A.DAMG_AMT_FARM_FORT_PROD, A.DAMG_AMT_AMHB_PROD, A.DAMG_AMT_MARN_PROD, A.DAMG_AMT_MCGD, A.DAMG_AMT_ETC, 
        A.DAMG_AMT_TOT, A.BODY_DAMG_ZERO, A.BODY_DAMG_INJY, A.BODY_DAMG_DETH, A.BODY_DAMG_INJY_MAN, 
        A.BODY_DAMG_INJY_WOMN, A.BODY_DAMG_DETH_MAN, A.BODY_DAMG_DETH_WOMN, A.BODY_DAMG_INJY_DEGR, E.INC_SP_NUM, 
        A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, A.UPD_DATE, 
        E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	
	<resultMap class="com.saltware.enface.sjpb.B.service.ArstStsGrapVO" id="ArstStsGrapVO.SJPB_ARST_STS_GRAP.select">
		<result property="arstStsGrapNum" column="ARST_STS_GRAP_NUM"/>
		<result property="stsGrapPublYrmh" column="STS_GRAP_PUBL_YRMH"/>
		<result property="famyVioYn" column="FAMY_VIO_YN"/>
		<result property="schlVioYn" column="SCHL_VIO_YN"/>
		<result property="arstYearMontDt" column="ARST_YEAR_MONT_DT"/>
		<result property="occrYearMontDt" column="OCCR_YEAR_MONT_DT"/>
		<result property="occrToArstPi" column="OCCR_TO_ARST_PI"/>
		<result property="criMeth" column="CRI_METH"/>
		<result property="trpsEnty" column="TRPS_ENTY"/>
		<result property="trpsWay" column="TRPS_WAY"/>
		<result property="arstKornMan" column="ARST_KORN_MAN"/>
		<result property="arstKornWomn" column="ARST_KORN_WOMN"/>
		<result property="arstKornCorp" column="ARST_KORN_CORP"/>
		<result property="arstForgMan" column="ARST_FORG_MAN"/>
		<result property="arstForgWomn" column="ARST_FORG_WOMN"/>
		<result property="arstForgCorp" column="ARST_FORG_CORP"/>
		<result property="cmtdUnctClsf" column="CMTD_UNCT_CLSF"/>
		<result property="acmpNum" column="ACMP_NUM"/>
		<result property="criToolType" column="CRI_TOOL_TYPE"/>
		<result property="criToolActn" column="CRI_TOOL_ACTN"/>
		<result property="criToolAcqrWay" column="CRI_TOOL_ACQR_WAY"/>
		<result property="arstClue" column="ARST_CLUE"/>
		<result property="stgdDipWay" column="STGD_DIP_WAY"/>
		<result property="stgdMonyCospUse" column="STGD_MONY_COSP_USE"/>
		<result property="collAmtMony" column="COLL_AMT_MONY"/>
		<result property="collAmtCar" column="COLL_AMT_CAR"/>
		<result property="collAmtMarkSecu" column="COLL_AMT_MARK_SECU"/>
		<result property="collAmtJewy" column="COLL_AMT_JEWY"/>
		<result property="collAmtElecElenProd" column="COLL_AMT_ELEC_ELEN_PROD"/>
		<result property="collAmtMocyBike" column="COLL_AMT_MOCY_BIKE"/>
		<result property="collAmtFurnArtc" column="COLL_AMT_FURN_ARTC"/>
		<result property="collAmtClot" column="COLL_AMT_CLOT"/>
		<result property="collAmtMach" column="COLL_AMT_MACH"/>
		<result property="collAmtFarmFortProd" column="COLL_AMT_FARM_FORT_PROD"/>
		<result property="collAmtAmhbProd" column="COLL_AMT_AMHB_PROD"/>
		<result property="collAmtMarnProd" column="COLL_AMT_MARN_PROD"/>
		<result property="collAmtMcgd" column="COLL_AMT_MCGD"/>
		<result property="collAmtEtc" column="COLL_AMT_ETC"/>
		<result property="collAmtTot" column="COLL_AMT_TOT"/>
		<result property="collDegrCd" column="COLL_DEGR_CD"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="actVioClaNm" column="ACT_VIO_CLA_NM"/>
	</resultMap>
	<!-- 검거 통계원표 가져오기(fk) -->
	<select id="B0101.SJPB_ARST_STS_GRAP.fk.select" resultMap="ArstStsGrapVO.SJPB_ARST_STS_GRAP.select"> /* B0101.SJPB_ARST_STS_GRAP.fk.select */  
		SELECT 
		    A.ARST_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN
		    ,A.SCHL_VIO_YN
		    ,A.ARST_YEAR_MONT_DT
		    ,A.OCCR_YEAR_MONT_DT
		    ,A.OCCR_TO_ARST_PI
		    ,A.CRI_METH
		    ,A.TRPS_ENTY
		    ,A.TRPS_WAY
		    ,A.ARST_KORN_MAN
		    ,A.ARST_KORN_WOMN
		    ,A.ARST_KORN_CORP
		    ,A.ARST_FORG_MAN
		    ,A.ARST_FORG_WOMN
		    ,A.ARST_FORG_CORP
		    ,A.CMTD_UNCT_CLSF
		    ,A.ACMP_NUM
		    ,A.CRI_TOOL_TYPE
		    ,A.CRI_TOOL_ACTN
		    ,A.CRI_TOOL_ACQR_WAY
		    ,A.ARST_CLUE
		    ,A.STGD_DIP_WAY
		    ,A.STGD_MONY_COSP_USE
		    ,A.COLL_AMT_MONY
		    ,A.COLL_AMT_CAR
		    ,A.COLL_AMT_MARK_SECU
		    ,A.COLL_AMT_JEWY
		    ,A.COLL_AMT_ELEC_ELEN_PROD
		    ,A.COLL_AMT_MOCY_BIKE
		    ,A.COLL_AMT_FURN_ARTC
		    ,A.COLL_AMT_CLOT
		    ,A.COLL_AMT_MACH
		    ,A.COLL_AMT_FARM_FORT_PROD
		    ,A.COLL_AMT_AMHB_PROD
		    ,A.COLL_AMT_MARN_PROD
		    ,A.COLL_AMT_MCGD
		    ,A.COLL_AMT_ETC
		    ,A.COLL_AMT_TOT
		    ,A.COLL_DEGR_CD
		    ,E.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
<!-- 		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM -->
			,B.ACT_VIO_CLA_NM
		FROM SJPB_ARST_STS_GRAP A 
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
<!-- 		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM  -->
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
		WHERE A.ACT_VIO_NUM = #actVioNum#  
        GROUP BY A.ARST_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN, A.SCHL_VIO_YN, A.ARST_YEAR_MONT_DT, 
        A.OCCR_YEAR_MONT_DT, A.OCCR_TO_ARST_PI, A.CRI_METH, A.TRPS_ENTY, A.TRPS_WAY, 
        A.ARST_KORN_MAN, A.ARST_KORN_WOMN, A.ARST_KORN_CORP, A.ARST_FORG_MAN, A.ARST_FORG_WOMN, 
        A.ARST_FORG_CORP, A.CMTD_UNCT_CLSF, A.ACMP_NUM, A.CRI_TOOL_TYPE, A.CRI_TOOL_ACTN, 
        A.CRI_TOOL_ACQR_WAY, A.ARST_CLUE, A.STGD_DIP_WAY, A.STGD_MONY_COSP_USE, A.COLL_AMT_MONY, 
        A.COLL_AMT_CAR, A.COLL_AMT_MARK_SECU, A.COLL_AMT_JEWY, A.COLL_AMT_ELEC_ELEN_PROD, A.COLL_AMT_MOCY_BIKE, 
        A.COLL_AMT_FURN_ARTC, A.COLL_AMT_CLOT, A.COLL_AMT_MACH, A.COLL_AMT_FARM_FORT_PROD, A.COLL_AMT_AMHB_PROD, 
        A.COLL_AMT_MARN_PROD, A.COLL_AMT_MCGD, A.COLL_AMT_ETC, A.COLL_AMT_TOT, A.COLL_DEGR_CD, 
        E.INC_SP_NUM, A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, 
        A.UPD_DATE, E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	<!-- 검거 통계원표 가져오기(pk) -->
	<select id="B0101.SJPB_ARST_STS_GRAP.pk.select" resultMap="ArstStsGrapVO.SJPB_ARST_STS_GRAP.select"> /* B0101.SJPB_ARST_STS_GRAP.pk.select */  
		SELECT 
		    A.ARST_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN
		    ,A.SCHL_VIO_YN
		    ,A.ARST_YEAR_MONT_DT
		    ,A.OCCR_YEAR_MONT_DT
		    ,A.OCCR_TO_ARST_PI
		    ,A.CRI_METH
		    ,A.TRPS_ENTY
		    ,A.TRPS_WAY
		    ,A.ARST_KORN_MAN
		    ,A.ARST_KORN_WOMN
		    ,A.ARST_KORN_CORP
		    ,A.ARST_FORG_MAN
		    ,A.ARST_FORG_WOMN
		    ,A.ARST_FORG_CORP
		    ,A.CMTD_UNCT_CLSF
		    ,A.ACMP_NUM
		    ,A.CRI_TOOL_TYPE
		    ,A.CRI_TOOL_ACTN
		    ,A.CRI_TOOL_ACQR_WAY
		    ,A.ARST_CLUE
		    ,A.STGD_DIP_WAY
		    ,A.STGD_MONY_COSP_USE
		    ,A.COLL_AMT_MONY
		    ,A.COLL_AMT_CAR
		    ,A.COLL_AMT_MARK_SECU
		    ,A.COLL_AMT_JEWY
		    ,A.COLL_AMT_ELEC_ELEN_PROD
		    ,A.COLL_AMT_MOCY_BIKE
		    ,A.COLL_AMT_FURN_ARTC
		    ,A.COLL_AMT_CLOT
		    ,A.COLL_AMT_MACH
		    ,A.COLL_AMT_FARM_FORT_PROD
		    ,A.COLL_AMT_AMHB_PROD
		    ,A.COLL_AMT_MARN_PROD
		    ,A.COLL_AMT_MCGD
		    ,A.COLL_AMT_ETC
		    ,A.COLL_AMT_TOT
		    ,A.COLL_DEGR_CD
		    ,E.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
<!-- 		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM -->
			,B.ACT_VIO_CLA_NM
		FROM SJPB_ARST_STS_GRAP A 
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
<!-- 		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM  -->
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
		WHERE A.ARST_STS_GRAP_NUM = #arstStsGrapNum#
        GROUP BY A.ARST_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN, A.SCHL_VIO_YN, A.ARST_YEAR_MONT_DT, 
        A.OCCR_YEAR_MONT_DT, A.OCCR_TO_ARST_PI, A.CRI_METH, A.TRPS_ENTY, A.TRPS_WAY, 
        A.ARST_KORN_MAN, A.ARST_KORN_WOMN, A.ARST_KORN_CORP, A.ARST_FORG_MAN, A.ARST_FORG_WOMN, 
        A.ARST_FORG_CORP, A.CMTD_UNCT_CLSF, A.ACMP_NUM, A.CRI_TOOL_TYPE, A.CRI_TOOL_ACTN, 
        A.CRI_TOOL_ACQR_WAY, A.ARST_CLUE, A.STGD_DIP_WAY, A.STGD_MONY_COSP_USE, A.COLL_AMT_MONY, 
        A.COLL_AMT_CAR, A.COLL_AMT_MARK_SECU, A.COLL_AMT_JEWY, A.COLL_AMT_ELEC_ELEN_PROD, A.COLL_AMT_MOCY_BIKE, 
        A.COLL_AMT_FURN_ARTC, A.COLL_AMT_CLOT, A.COLL_AMT_MACH, A.COLL_AMT_FARM_FORT_PROD, A.COLL_AMT_AMHB_PROD, 
        A.COLL_AMT_MARN_PROD, A.COLL_AMT_MCGD, A.COLL_AMT_ETC, A.COLL_AMT_TOT, A.COLL_DEGR_CD, 
        E.INC_SP_NUM, A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, 
        A.UPD_DATE, E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	<resultMap class="com.saltware.enface.sjpb.B.service.SpStsGrapVO" id="SpStsGrapVO.SJPB_SP_STS_GRAP.select">
		<result property="spStsGrapNum" column="SP_STS_GRAP_NUM"/>
		<result property="stsGrapPublYrmh" column="STS_GRAP_PUBL_YRMH"/>
		<result property="famyVioYn" column="FAMY_VIO_YN"/>
		<result property="schlVioYn" column="SCHL_VIO_YN"/>
		<result property="forgCdNaty" column="FORG_CD_NATY"/>
		<result property="forgCdPosi" column="FORG_CD_POSI"/>
		<result property="criTimeAge" column="CRI_TIME_AGE"/>
		<result property="jobCd" column="JOB_CD"/>
		<result property="puofBelgCd" column="PUOF_BELG_CD"/>
		<result property="puofClasCd" column="PUOF_CLAS_CD"/>
		<result property="puofDutyRelv" column="PUOF_DUTY_RELV"/>
		<result property="crrdCd" column="CRRD_CD"/>
		<result property="secvSituLastDipCont" column="SECV_SITU_LAST_DIP_CONT"/>
		<result property="secvSituProtDip" column="SECV_SITU_PROT_DIP"/>
		<result property="secvSituSecvPi" column="SECV_SITU_SECV_PI"/>
		<result property="secvSituSecvType" column="SECV_SITU_SECV_TYPE"/>
		<result property="acmpRelt" column="ACMP_RELT"/>
		<result property="vicmRelt" column="VICM_RELT"/>
		<result property="criAftrHdot" column="CRI_AFTR_HDOT"/>
		<result property="drugCmusYn" column="DRUG_CMUS_YN"/>
		<result property="criTimeMindStat" column="CRI_TIME_MIND_STAT"/>
		<result property="criMotv" column="CRI_MOTV"/>
		<result property="acab" column="ACAB"/>
		<result property="livgDegr" column="LIVG_DEGR"/>
		<result property="relg" column="RELG"/>
		<result property="margRelt" column="MARG_RELT"/>
		<result property="pareRelt" column="PARE_RELT"/>
		<result property="arstPolf" column="ARST_POLF"/>
		<result property="actn" column="ACTN"/>
		<result property="confYn" column="CONF_YN"/>
		<result property="arrtClsf" column="ARRT_CLSF"/>
		<result property="nonArrtClsf" column="NON_ARRT_CLSF"/>
		<result property="trfOp" column="TRF_OP"/>
		<result property="incHandPi" column="INC_HAND_PI"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="actVioClaNm" column="ACT_VIO_CLA_NM"/>
	</resultMap>
	<!-- 피의자 통계원표 가져오기(fk) -->
	<select id="B0101.SJPB_SP_STS_GRAP.fk.select" resultMap="SpStsGrapVO.SJPB_SP_STS_GRAP.select"> /* B0101.SJPB_SP_STS_GRAP.fk.select */  
		SELECT 
		    A.SP_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN
		    ,A.SCHL_VIO_YN
		    ,A.FORG_CD_NATY
		    ,A.FORG_CD_POSI
		    ,A.CRI_TIME_AGE
		    ,A.JOB_CD
		    ,A.PUOF_BELG_CD
		    ,A.PUOF_CLAS_CD
		    ,A.PUOF_DUTY_RELV
		    ,A.CRRD_CD
		    ,A.SECV_SITU_LAST_DIP_CONT
		    ,A.SECV_SITU_PROT_DIP
		    ,A.SECV_SITU_SECV_PI
		    ,A.SECV_SITU_SECV_TYPE
		    ,A.ACMP_RELT
		    ,A.VICM_RELT
		    ,A.CRI_AFTR_HDOT
		    ,A.DRUG_CMUS_YN
		    ,A.CRI_TIME_MIND_STAT
		    ,A.CRI_MOTV
		    ,A.ACAB
		    ,A.LIVG_DEGR
		    ,A.RELG
		    ,A.MARG_RELT
		    ,A.PARE_RELT
		    ,A.ARST_POLF
		    ,A.ACTN
		    ,A.CONF_YN
		    ,A.ARRT_CLSF
		    ,A.NON_ARRT_CLSF
		    ,A.TRF_OP
		    ,A.INC_HAND_PI
		    ,E.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
<!-- 		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM -->
			,B.ACT_VIO_CLA_NM
		FROM SJPB_SP_STS_GRAP A 
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
<!-- 		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM  -->
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
		WHERE A.ACT_VIO_NUM = #actVioNum# 
        GROUP BY A.SP_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN, A.SCHL_VIO_YN, A.FORG_CD_NATY, 
        A.FORG_CD_POSI, A.CRI_TIME_AGE, A.JOB_CD, A.PUOF_BELG_CD, A.PUOF_CLAS_CD, 
        A.PUOF_DUTY_RELV, A.CRRD_CD, A.SECV_SITU_LAST_DIP_CONT, A.SECV_SITU_PROT_DIP, A.SECV_SITU_SECV_PI, 
        A.SECV_SITU_SECV_TYPE, A.ACMP_RELT, A.VICM_RELT, A.CRI_AFTR_HDOT, A.DRUG_CMUS_YN, 
        A.CRI_TIME_MIND_STAT, A.CRI_MOTV, A.ACAB, A.LIVG_DEGR, A.RELG, 
        A.MARG_RELT, A.PARE_RELT, A.ARST_POLF, A.ACTN, A.CONF_YN, 
        A.ARRT_CLSF, A.NON_ARRT_CLSF, A.TRF_OP, A.INC_HAND_PI, E.INC_SP_NUM, 
        A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, A.UPD_DATE, 
        E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	<!-- 피의자 통계원표 가져오기(fk)
	<select id="B0101.SJPB_SP_STS_GRAP.fk.SpNum.select" resultMap="SpStsGrapVO.SJPB_SP_STS_GRAP.select"> /* B0101.SJPB_SP_STS_GRAP.fk.SpNum.select */  
		SELECT 
		    A.SP_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN
		    ,A.SCHL_VIO_YN
		    ,A.FORG_CD_NATY
		    ,A.FORG_CD_POSI
		    ,A.CRI_TIME_AGE
		    ,A.JOB_CD
		    ,A.PUOF_BELG_CD
		    ,A.PUOF_CLAS_CD
		    ,A.PUOF_DUTY_RELV
		    ,A.CRRD_CD
		    ,A.SECV_SITU_LAST_DIP_CONT
		    ,A.SECV_SITU_PROT_DIP
		    ,A.SECV_SITU_SECV_PI
		    ,A.SECV_SITU_SECV_TYPE
		    ,A.ACMP_RELT
		    ,A.VICM_RELT
		    ,A.CRI_AFTR_HDOT
		    ,A.DRUG_CMUS_YN
		    ,A.CRI_TIME_MIND_STAT
		    ,A.CRI_MOTV
		    ,A.ACAB
		    ,A.LIVG_DEGR
		    ,A.RELG
		    ,A.MARG_RELT
		    ,A.PARE_RELT
		    ,A.ARST_POLF
		    ,A.ACTN
		    ,A.CONF_YN
		    ,A.ARRT_CLSF
		    ,A.NON_ARRT_CLSF
		    ,A.TRF_OP
		    ,A.INC_HAND_PI
		    ,A.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM
		FROM SJPB_SP_STS_GRAP A 
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.INC_SP_NUM = A.INC_SP_NUM
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM AND B.INC_SP_NUM = D.INC_SP_NUM
		LEFT OUTER JOIN SJPB_INC_SP E ON A.INC_SP_NUM = E.INC_SP_NUM
		WHERE A.INC_SP_NUM = #incSpNum#
		GROUP BY A.SP_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN, A.SCHL_VIO_YN, A.FORG_CD_NATY, 
		A.FORG_CD_POSI, A.CRI_TIME_AGE, A.JOB_CD, A.PUOF_BELG_CD, A.PUOF_CLAS_CD, 
		A.PUOF_DUTY_RELV, A.CRRD_CD, A.SECV_SITU_LAST_DIP_CONT, A.SECV_SITU_PROT_DIP, A.SECV_SITU_SECV_PI, 
		A.SECV_SITU_SECV_TYPE, A.ACMP_RELT, A.VICM_RELT, A.CRI_AFTR_HDOT, A.DRUG_CMUS_YN, 
		A.CRI_TIME_MIND_STAT, A.CRI_MOTV, A.ACAB, A.LIVG_DEGR, A.RELG, 
		A.MARG_RELT, A.PARE_RELT, A.ARST_POLF, A.ACTN, A.CONF_YN, 
		A.ARRT_CLSF, A.NON_ARRT_CLSF, A.TRF_OP, A.INC_HAND_PI, A.INC_SP_NUM, 
		A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, 
		A.UPD_DATE, E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME
	</select>
	 -->
	
	<!-- 피의자 통계원표 가져오기(pk) -->
	<select id="B0101.SJPB_SP_STS_GRAP.pk.select" resultMap="SpStsGrapVO.SJPB_SP_STS_GRAP.select"> /* B0101.SJPB_SP_STS_GRAP.pk.select */  
		
		SELECT 
		    A.SP_STS_GRAP_NUM
		    ,A.STS_GRAP_PUBL_YRMH
		    ,A.FAMY_VIO_YN
		    ,A.SCHL_VIO_YN
		    ,A.FORG_CD_NATY
		    ,A.FORG_CD_POSI
		    ,A.CRI_TIME_AGE
		    ,A.JOB_CD
		    ,A.PUOF_BELG_CD
		    ,A.PUOF_CLAS_CD
		    ,A.PUOF_DUTY_RELV
		    ,A.CRRD_CD
		    ,A.SECV_SITU_LAST_DIP_CONT
		    ,A.SECV_SITU_PROT_DIP
		    ,A.SECV_SITU_SECV_PI
		    ,A.SECV_SITU_SECV_TYPE
		    ,A.ACMP_RELT
		    ,A.VICM_RELT
		    ,A.CRI_AFTR_HDOT
		    ,A.DRUG_CMUS_YN
		    ,A.CRI_TIME_MIND_STAT
		    ,A.CRI_MOTV
		    ,A.ACAB
		    ,A.LIVG_DEGR
		    ,A.RELG
		    ,A.MARG_RELT
		    ,A.PARE_RELT
		    ,A.ARST_POLF
		    ,A.ACTN
		    ,A.CONF_YN
		    ,A.ARRT_CLSF
		    ,A.NON_ARRT_CLSF
		    ,A.TRF_OP
		    ,A.INC_HAND_PI
		    ,E.INC_SP_NUM
		    ,A.ACT_VIO_NUM
		    ,A.REG_USER_ID
		    ,A.REG_DATE
		    ,A.UPD_USER_ID
		    ,A.UPD_DATE
		    ,E.RCPT_NUM
		    ,B.RLT_ACT_CRI_NM_CD
		    ,C.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
<!-- 		    ,REGEXP_REPLACE(LISTAGG(D.ACT_VIO_CLA_NM,  ' 및 ') WITHIN GROUP(ORDER BY D.INQ_ORD), '([^,]+)(,\1)+', '\1') AS ACT_VIO_CLA_NM -->
			,B.ACT_VIO_CLA_NM
		FROM SJPB_SP_STS_GRAP A 
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		LEFT OUTER JOIN CODEBASE C ON B.RLT_ACT_CRI_NM_CD = C.CODE AND C.CODE_ID = 'SJPB_00012'
<!-- 		LEFT OUTER JOIN SJPB_ACT_VIO_CLA D ON B.ACT_VIO_NUM = D.ACT_VIO_NUM  -->
		LEFT OUTER JOIN SJPB_INC_SP E ON E.INC_SP_NUM = B.INC_SP_NUM AND E.SP_STAT_CD = '1'
		WHERE A.SP_STS_GRAP_NUM = #spStsGrapNum# 
        GROUP BY A.SP_STS_GRAP_NUM, A.STS_GRAP_PUBL_YRMH, A.FAMY_VIO_YN, A.SCHL_VIO_YN, A.FORG_CD_NATY, 
        A.FORG_CD_POSI, A.CRI_TIME_AGE, A.JOB_CD, A.PUOF_BELG_CD, A.PUOF_CLAS_CD, 
        A.PUOF_DUTY_RELV, A.CRRD_CD, A.SECV_SITU_LAST_DIP_CONT, A.SECV_SITU_PROT_DIP, A.SECV_SITU_SECV_PI, 
        A.SECV_SITU_SECV_TYPE, A.ACMP_RELT, A.VICM_RELT, A.CRI_AFTR_HDOT, A.DRUG_CMUS_YN, 
        A.CRI_TIME_MIND_STAT, A.CRI_MOTV, A.ACAB, A.LIVG_DEGR, A.RELG, 
        A.MARG_RELT, A.PARE_RELT, A.ARST_POLF, A.ACTN, A.CONF_YN, 
        A.ARRT_CLSF, A.NON_ARRT_CLSF, A.TRF_OP, A.INC_HAND_PI, E.INC_SP_NUM, 
        A.ACT_VIO_NUM, A.REG_USER_ID, A.REG_DATE, A.UPD_USER_ID, A.UPD_DATE, 
        E.RCPT_NUM, B.RLT_ACT_CRI_NM_CD, C.CODE_NAME, B.ACT_VIO_CLA_NM
	</select>
	
	
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.selectIncident">
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="poIncNum" column="PO_INC_NUM"/>
		<result property="rcptOrdNum" column="RCPT_ORD_NUM"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="rcptTpCd" column="RCPT_TP_CD"/>
		<result property="criStatCd" column="CRI_STAT_CD"/>
		<result property="stock" column="STOCK"/>
		<result property="fdCd" column="FD_CD"/>
		<result property="criTmId" column="CRI_TM_ID"/>
		<result property="dvForm" column="DV_FORM"/>
		<result property="beDt" column="BE_DT"/>
		<result property="edDt" column="ED_DT"/>
		<result property="dirNm" column="DIR_NM"/>
		<result property="acptDt" column="ACPT_DT"/>
		<result property="proDt" column="PRO_DT"/>
		<result property="pareRcptNum" column="PARE_RCPT_NUM"/>
		<result property="combIncYn" column="COMB_INC_YN"/>
		<result property="infwDiv" column="INFW_DIV"/>
		<result property="incMfNum" column="INC_MF_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		
		<result property="chaIttDesc" column="CHA_ITT_DESC"/>
		<result property="dvFormDesc" column="DV_FORM_DESC"/>
		
		<result property="incNum" column="INC_NUM"/>
		<result property="chaDt" column="CHA_DT"/>
		<result property="chaItt" column="CHA_ITT"/>
		<result property="incCont" column="INC_CONT"/>
		<result property="criCont" column="CRI_CONT"/>
		<result property="trfNum" column="TRF_NUM"/>
		
		<result property="criTmNm" column="CRI_TM_NM"/>
		
		<result property="incOccrAreaAddr" column="INC_OCCR_AREA_ADDR"/>
		<result property="incOccrAreaXcd" column="INC_OCCR_AREA_XCD"/>
		<result property="incOccrAreaYcd" column="INC_OCCR_AREA_YCD"/>
		
		<result property="vicmNm" column="VICM_NM"/>
		<result property="damgDegr" column="DAMG_DEGR"/>
		<result property="seizNum" column="SEIZ_NUM"/>
		<result property="criPendIncFileNum" column="CRI_PEND_INC_FILE_NUM"/>
		<result property="criDt" column="CRI_DT"/>
		
		<result property="taskNum" column="TASK_NUM"/>
		<result property="taskRoleCd" column="TASK_ROLE_CD"/>
		<result property="taskNm" column="TASK_NM"/>
		<result property="wfNum" column="WF_NUM"/>
		
		<result property="pareIncNum" column="PARE_INC_NUM"/>
		<result property="rcptDt" column="RCPT_DT"/>
	</resultMap>
	<!-- 사건정보 가져오기 --> 	
	<select id="B0101.selectIncident" resultMap="B0101VO.selectIncident">	/* B0101.selectIncident */
		<![CDATA[		
			SELECT
			    A.RCPT_NUM	 /*시스템번호*/	 
			     ,A.PO_INC_NUM		/*검찰사건번호*/
			     ,A.RCPT_ORD_NUM 	/*접수번호*/
			     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
			     ,A.RCPT_TP_CD	 /*접수유형코드*/	
			     ,A.STOCK		/*종목*/
			     ,A.CRI_STAT_CD	 /*수사상태코드*/	
			     ,A.FD_CD	 /*사건분야코드*/	 
			     ,E.CRI_TM_NM
			     ,A.CRI_TM_ID	 /*수사팀계정*/	 
			     ,A.DV_FORM	 /*발각형태*/	 
			     ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS BE_DT	 /*착수일자*/	 
			     ,TO_CHAR(A.ED_DT,'YYYY-MM-DD') AS ED_DT	 /*종결일자*/	 
			     ,A.DIR_NM		/*지휘자*/
			     ,TO_CHAR(A.ACPT_DT,'YYYY-MM-DD') AS ACPT_DT		/*수리일자*/
			     ,TO_CHAR(A.PRO_DT,'YYYY-MM-DD') AS PRO_DT		/*처리일자*/
			     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
			     ,A.COMB_INC_YN		/*병합사건여부*/
			     ,A.INFW_DIV		/*유입구분*/
			     ,A.INC_MF_NUM		/*사건수정번호*/
			     ,A.REG_USER_ID	 /*등록자*/	 
			     ,A.REG_DATE	 /*등록일자*/	 
			     ,A.UPD_USER_ID	 /*수정자*/	 
			     ,A.UPD_DATE	 /*수정일자*/	 
			     ,B.INC_NUM        /*상세사건번호*/
			     ,B.CHA_DT         /*입건일자*/
			     ,B.CHA_ITT        /*이첩기관*/
			     ,B.INC_CONT       /*사건내용*/
			     ,B.CRI_CONT       /*수사내용*/
			     ,B.TRF_NUM        /*송치번호*/
			     ,C.CODE_NAME AS CHA_ITT_DESC   /*이첩기관설명*/
		     	 ,D.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		     	 ,E.CRI_TM_NM		/*수사팀명*/
		     	 ,B.INC_OCCR_AREA_ADDR	/*사건발생지역주소*/
		     	 ,B.INC_OCCR_AREA_XCD	/*사건발생지역X좌표*/
		     	 ,B.INC_OCCR_AREA_YCD	/*사건발생지역Y좌표*/
		     	 ,B.VICM_NM					/*피해자성명*/
		     	 ,B.DAMG_DEGR				/*피해정도*/
		     	 ,B.SEIZ_NUM				/*압수번호*/
		     	 ,B.CRI_PEND_INC_FILE_NUM	/*수사미결사건철번호*/
		     	 ,B.CRI_DT					/*범죄일시*/
			     ,F.TASK_NUM /*활성타스크번호*/
			     ,F.TASK_ROLE_CD /*타스크소유코드*/
			     ,F.TASK_NM /*타스크명*/
			     ,F.WF_NUM /*워크플로우번호*/
			     , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM
        		,TO_CHAR(A.RCPT_DT,'YYYY-MM-DD') AS	RCPT_DT	/* 접수일자 */
        		
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			LEFT OUTER JOIN SJPB_CRI_TM E ON A.CRI_TM_ID = E.CRI_TM_ID
			LEFT OUTER JOIN CODEBASE C ON A.FD_CD = C.CODE AND C.CODE_ID = 'SJPB_00010'
			LEFT OUTER JOIN CODEBASE D ON A.DV_FORM = D.CODE AND D.CODE_ID = 'SJPB_00004'
			JOIN (SELECT F1.RCPT_NUM, F1.WF_NUM, F2.TASK_NUM, F2.TASK_NM, F2.TASK_ROLE_CD 
			 FROM SJPB_INC_WF F1 JOIN SJPB_TASK F2  
			 ON F1.WF_NUM = F2.WF_NUM AND F1.ACTV_TASK_NUM = F2.TASK_NUM
			  WHERE F1.WF_NUM NOT IN ('9')) F
			ON A.RCPT_NUM = F.RCPT_NUM 
			WHERE 
			    A.RCPT_NUM = #rcptNum#
			AND A.RCPT_TP_CD = '2'	
		]]>
	</select>
	
		<!-- 사건정보 가져오기 --> 	
	<select id="B0101.selectIncidentChild" resultMap="B0101VO.selectIncident">	/* B0101.selectIncidentChlid */
		<![CDATA[		
			SELECT
			    A.RCPT_NUM	 /*시스템번호*/	 
			     ,A.RCPT_ORD_NUM	 /*접수번호*/ 
			     ,A.PO_INC_NUM		/*검찰사건번호*/
			     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
			     ,A.STOCK		/*종목*/
			     ,A.RCPT_TP_CD	 /*접수유형코드*/	
			     ,A.CRI_STAT_CD	 /*수사상태코드*/	
			     ,A.FD_CD	 /*사건분야코드*/	 
			     ,A.CRI_TM_ID	 /*수사팀계정*/	 
			     ,A.DV_FORM	 /*발각형태*/	 
			     ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS 	 /*착수일자*/	 
			     ,TO_CHAR(A.ED_DT,'YYYY-MM-DD') AS 	 /*종결일자*/	 
			     ,A.DIR_NM		/*지휘자*/
			     ,TO_CHAR(A.ACPT_DT,'YYYY-MM-DD') AS 		/*수리일자*/
			     ,TO_CHAR(A.PRO_DT,'YYYY-MM-DD') AS 		/*처리일자*/
			     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
			     ,A.COMB_INC_YN		/*병합사건여부*/
			     ,A.INFW_DIV		/*유입구분*/
			     ,A.INC_MF_NUM		/*사건수정번호*/
			     ,A.REG_USER_ID	 /*등록자*/	 
			     ,A.REG_DATE	 /*등록일자*/	 
			     ,A.UPD_USER_ID	 /*수정자*/	 
			     ,A.UPD_DATE	 /*수정일자*/	 
			     ,B.INC_NUM        /*상세사건번호*/
			     ,B.CHA_DT         /*입건일자*/
			     ,B.CHA_ITT        /*고발기관*/
			     ,B.INC_CONT       /*사건내용*/
			     ,B.CRI_CONT       /*수사내용*/
			     ,B.TRF_NUM        /*송치번호*/
			     ,C.CODE_NAME AS CHA_ITT_DESC   /*고발기관설명*/
		     	 ,D.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		     	 ,E.CRI_TM_NM		/*수사팀명*/
		     	 ,B.INC_OCCR_AREA_ADDR	/*사건발생지역주소*/
		     	 ,B.INC_OCCR_AREA_XCD	/*사건발생지역X좌표*/
		     	 ,B.INC_OCCR_AREA_YCD	/*사건발생지역Y좌표*/
		     	 ,B.VICM_NM					/*피해자성명*/
		     	 ,B.DAMG_DEGR				/*피해정도*/
		     	 ,B.SEIZ_NUM				/*압수번호*/
		     	 ,B.CRI_PEND_INC_FILE_NUM	/*수사미결사건철번호*/
		     	 ,B.CRI_DT					/*범죄일시*/
			     ,F.TASK_NUM /*활성타스크번호*/
			     ,F.TASK_ROLE_CD /*타스크소유코드*/
			     ,F.TASK_NM /*타스크명*/
			     ,F.WF_NUM /*워크플로우번호*/
			     , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
        		), '') AS PARE_INC_NUM\
        		,TO_CHAR(A.RCPT_DT,'YYYY-MM-DD') AS	RCPT_DT			/*접수일자*/
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			JOIN SJPB_CRI_TM E ON A.CRI_TM_ID = E.CRI_TM_ID
			LEFT OUTER JOIN CODEBASE C ON A.FD_CD = C.CODE AND C.CODE_ID = 'SJPB_00010'
			LEFT OUTER JOIN CODEBASE D ON A.DV_FORM = D.CODE AND D.CODE_ID = 'SJPB_00004'
			JOIN (SELECT F1.RCPT_NUM, F1.WF_NUM, F2.TASK_NUM, F2.TASK_NM, F2.TASK_ROLE_CD 
				 FROM SJPB_INC_WF F1 JOIN SJPB_TASK F2  
				 ON F1.WF_NUM = F2.WF_NUM AND F1.ACTV_TASK_NUM = F2.TASK_NUM
				 WHERE F1.WF_NUM NOT IN ('9')
				 ) F
			ON A.RCPT_NUM = F.RCPT_NUM 
			WHERE A.RCPT_NUM IN (
                    	WITH AA AS (SELECT LEVEL AS LV
							    	   ,AA1.RCPT_NUM 
							    	   ,BB1.INC_NUM
								FROM SJPB_INC_MAST AA1
								JOIN SJPB_INC_DTS BB1 ON AA1.RCPT_NUM = BB1.RCPT_NUM
								START WITH AA1.RCPT_NUM = #rcptNum#
								CONNECT BY PRIOR AA1.RCPT_NUM = AA1.PARE_RCPT_NUM
								)
						SELECT 
						    LISTAGG(AA.RCPT_NUM,',') WITHIN GROUP (ORDER BY AA.RCPT_NUM )
						FROM AA
						WHERE LV >= 2
                				)  
                  AND A.RCPT_TP_CD = '2'	
		]]>
	</select>
	
	
	<!-- 사건분야 + 수사팀 조회 (전체) -->
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.listFdCd">
		<result property="code" column="CODE"/>
		<result property="codeName" column="CODE_NAME"/>
		<result property="criTmId" column="CRI_TM_ID"/>
		<result property="criTmNm" column="CRI_TM_NM"/>
	</resultMap>
	<select id="B0101.listAllFdCd" resultMap="B0101VO.listFdCd">	/* B0101.listAllFdCd */
		SELECT 
		    B.CODE 
		    ,B.CODE_NAME
		    ,A.CRI_TM_ID
		    ,A.CRI_TM_NM
		FROM SJPB_CRI_TM A
		LEFT OUTER JOIN CODEBASE B ON B.CODE_TAG1 = TO_CHAR(A.CRI_TM_ID) AND B.CODE_ID = 'SJPB_00002'
		WHERE A.CRI_TM_STAT = '1'
		AND A.CRI_TM_DIV = 'T'
		AND B.CODE_NAME IS NOT NULL
	</select>
	
	<!-- 사건분야 + 수사팀 조회 (본인해당) -->
	<select id="B0101.listMyFdCd" resultMap="B0101VO.listFdCd">	/* B0101.listMyFdCd */
		SELECT 
		    B.CODE 
		    ,B.CODE_NAME
		    ,A.CRI_TM_ID
		    ,A.CRI_TM_NM
		FROM SJPB_CRI_TM A
		LEFT OUTER JOIN CODEBASE B ON B.CODE_TAG1 = TO_CHAR(A.CRI_TM_ID) AND B.CODE_ID = 'SJPB_00002'
		WHERE A.CRI_TM_STAT = '1'
		AND A.CRI_TM_DIV = 'T'
		AND B.CODE_NAME IS NOT NULL
		START WITH A.CRI_TM_ID = #orgCd#
		CONNECT BY PRIOR A.CRI_TM_ID = A.PARE_TM_ID
	</select>
	
	
	
	<!-- 코드값 -->
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101CD" id="B0101VO.getIncFd">
		<result property="code" column="CODE"/>
		<result property="codeName" column="CODE_NAME"/>
		<result property="codeTag1" column="CODE_TAG1"/>
	</resultMap>
	<!-- 로그인 계정과 관련된 사건분야리스트를 가져온다. (일반, 팀조회)-->
	<select id="B0101.getMyIncFd" resultMap="B0101VO.getIncFd">	/* B0101.getMyIncFd */
		SELECT 
            B.CODE
            ,B.CODE_NAME
            ,B.CODE_TAG1
        FROM SJPB_CRI_TM A
        JOIN CODEBASE B ON B.CODE_TAG1 LIKE A.CRI_TM_ID AND B.CODE_ID = 'SJPB_00002' 
        WHERE A.CRI_TM_ID = #criTmId#
	</select>
	
	<!-- 로그인 계정과 관련된 사건분야리스트를 가져온다. (과장, 과조회)-->
	<select id="B0101.getMyDeptIncFd" resultMap="B0101VO.getIncFd">	/* B0101.getMyDeptIncFd */
		SELECT 
            B.CODE
            ,B.CODE_NAME
            ,B.CODE_TAG1
        FROM SJPB_CRI_TM A
        JOIN CODEBASE B ON B.CODE_TAG1 LIKE A.CRI_TM_ID AND B.CODE_ID = 'SJPB_00002' 
        START WITH A.PARE_TM_ID = #criTmId#
        CONNECT BY PRIOR A.CRI_TM_ID = A.PARE_TM_ID
	</select>
	
	<!-- 법률위반 조회 (본인해당) -->
	<select id="B0101.listMyRltAct" resultMap="B0101VO.getIncFd">	/* B0101.listMyRltAct */
		SELECT 
		    A.CODE 
		    ,A.CODE_NAME
		    ,A.CODE_TAG1
        FROM CODEBASE A
        WHERE A.CODE_ID = 'SJPB_00012'
        <isNotEmpty property="b0101CDVOListTmp" prepend="AND">
	        <iterate property="b0101CDVOListTmp" open="(" close=")" conjunction="OR">
		  		A.CODE_TAG1 LIKE '%'||#b0101CDVOListTmp[].code#||'%'
		  	</iterate>
		</isNotEmpty>
        AND A.CODE != '0000000000'
	</select>
	
	<!-- 사건수사단원 상세정보 VO -->
	<resultMap class="com.saltware.enface.sjpb.Z.service.IncCriMbVO" id="B0101.getIncCriMbListVO">
		<result property="criMbId" column="CRI_MB_ID"/>
		<result property="nmKor" column="NM_KOR"/>
		<result property="criLvCd" column="CRI_LV_CD"/>
		<result property="criTmId" column="CRI_TM_ID"/>
	</resultMap>	
	<select id="B0101.getIncCriMbList" resultMap="B0101.getIncCriMbListVO">	/* B0101.getIncCriMbList */
		<![CDATA[		
		SELECT
			C.USER_ID AS CRI_MB_ID
		    ,C.NM_KOR
		    ,A.CRI_LV_CD
		    ,C.ORG_CD AS CRI_TM_ID
		FROM SJPB_INC_CRI_MB A
		LEFT OUTER JOIN SJPB_CRI_MB B ON A.CRI_MB_ID = B.CRI_MB_ID AND B.CRI_MB_STAT = '1'
		JOIN USERPASS C ON A.CRI_MB_ID = C.USER_ID
		WHERE RCPT_NUM = #rcptNum#
		]]>
	</select>
	
	<!-- 사건번호 조회(자식사건) VO -->
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101.getRcptNumListVO">
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="incNum" column="INC_NUM"/>
	</resultMap>	
	<select id="B0101.getRcptNumList" resultMap="B0101.getRcptNumListVO">	/* B0101.getRcptNumList */
		<![CDATA[		
		SELECT 
		    A.RCPT_NUM 
		    , B.INC_NUM
		FROM SJPB_INC_MAST A
		JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
		START WITH A.RCPT_NUM = #rcptNum#
		CONNECT BY PRIOR A.RCPT_NUM = A.PARE_RCPT_NUM
		ORDER BY RCPT_NUM
		]]>
	</select>
	
	<select id="B0101.getRcptNumChildList" resultMap="B0101.getRcptNumListVO">   /* B0101.getRcptNumChildList */
		<![CDATA[		
		WITH AA AS (
		SELECT
		    LEVEL AS LV
		    ,AA1.RCPT_NUM 
		    ,BB1.INC_NUM
		FROM 
		    SJPB_INC_MAST AA1
		JOIN SJPB_INC_DTS BB1 ON AA1.RCPT_NUM = BB1.RCPT_NUM
		START WITH AA1.RCPT_NUM = #rcptNum#
		CONNECT BY PRIOR AA1.RCPT_NUM = AA1.PARE_RCPT_NUM
		)
		SELECT 
		    AA.RCPT_NUM AS RCPT_NUM
		    , AA.INC_NUM AS INC_NUM
		FROM AA
		WHERE LV >= 2
		]]>
	</select>
	
	<!-- 법률위반 -->
	<resultMap id="B0101VO.getDeleteVioList" class="com.saltware.enface.sjpb.Z.service.ActVioVO">
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="vioCont" column="VIO_CONT"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
	</resultMap>
	<!-- 삭제대상 법률위반정보 가져오기 --> 	
	<select id="B0101.getDeleteVioList" resultMap="B0101VO.getDeleteVioList">	/* B0101.getDeleteVioList */
		<![CDATA[	
			SELECT 
			     B.INC_SP_NUM							/*사건피의자번호*/
			    ,A.RCPT_NUM								/*접수번호*/
			    ,B.ACT_VIO_NUM							/*법률위반번호*/
			    ,B.RLT_ACT_CRI_NM_CD					/*관련법률및죄명코드*/
			    ,B.VIO_CONT								/*위반내용*/
			    ,B.REG_USER_ID							/*등록자*/
			    ,B.REG_DATE								/*등록일자*/
			    ,B.UPD_USER_ID							/*수정자*/
			    ,B.UPD_DATE								/*수정일자*/
			FROM SJPB_INC_SP A 
			LEFT OUTER JOIN SJPB_ACT_VIO B ON B.INC_SP_NUM = A.INC_SP_NUM AND B.ACT_VIO_STAT_CD = '1'
			WHERE A.RCPT_NUM = #rcptNum#
			AND A.SP_STAT_CD = '1'
		]]>
	</select>
	
	
	<!--  법률위반조항 삭제 -->
	<delete id="B0101.SJPB_ACT_VIO_TYPE.delete">  /* B0101.SJPB_ACT_VIO_TYPE.delete */
		<![CDATA[	
			DELETE FROM SJPB_ACT_VIO_TYPE WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!--  법률위반 삭제 -->
	<delete id="B0101.SJPB_ACT_VIO.delete">  /* B0101.SJPB_ACT_VIO.delete */
		<![CDATA[	
			DELETE FROM SJPB_ACT_VIO WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!--  발생통계원표 삭제 -->
	<delete id="B0101.SJPB_OCCR_STS_GRAP.delete">  /* B0101.SJPB_OCCR_STS_GRAP.delete */
		<![CDATA[	
			DELETE FROM SJPB_OCCR_STS_GRAP WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!--  검거통계원표 삭제 -->
	<delete id="B0101.SJPB_ARST_STS_GRAP.delete">  /* B0101.SJPB_ARST_STS_GRAP.delete */
		<![CDATA[	
			DELETE FROM SJPB_ARST_STS_GRAP WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!--  피의자통계원표 삭제 -->
	<delete id="B0101.SJPB_SP_STS_GRAP.delete">  /* B0101.SJPB_SP_STS_GRAP.delete */
		<![CDATA[	
			DELETE FROM SJPB_SP_STS_GRAP WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!--  사건수사단원 삭제 -->
	<delete id="B0101.SJPB_INC_CRI_MB.delete">  /* B0101.SJPB_INC_CRI_MB.delete */
		<![CDATA[	
			DELETE FROM SJPB_INC_CRI_MB WHERE RCPT_NUM=#rcptNum#
		]]>
	</delete>
	
	<!-- 피의자 조회 -->	
	<resultMap id="B0101.inquirySpVO" class="com.saltware.enface.sjpb.Z.service.IncSpVO">
		<result property="spIdNum" column="SP_ID_NUM"/>
		<result property="spNm" column="SP_NM"/>
		<result property="indvCorpDiv" column="INDV_CORP_DIV"/>
	</resultMap>	
	<!-- 피의자정보 가져오기 --> 	
	<select id="B0101.inquirySp" resultMap="B0101.inquirySpVO">	/* B0101.inquirySp */
		SELECT DISTINCT A.SP_ID_NUM	/*피의자식별번호*/
               ,A.SP_NM				/*피의자명*/
               ,A.INDV_CORP_DIV        /*개인법인구분*/
		FROM SJPB_INC_SP A 		
		WHERE (A.SP_ID_NUM, A.SP_NM, A.INDV_CORP_DIV) IN 
		<iterate property="incSpVOList" open="(" close=")" conjunction=" , ">
			(#incSpVOList[].spIdNum# , #incSpVOList[].spNm# , #incSpVOList[].indvCorpDiv#)
		</iterate>
		<isNotEqual prepend=" AND " property="rcptNum" compareValue="">A.RCPT_NUM NOT IN(#rcptNum#)</isNotEqual>
	</select>
	
	<!--  피의자 삭제 -->
	<delete id="B0101.SJPB_INC_SP.delete">  /* B0101.SJPB_INC_SP.delete */
		<![CDATA[	
			DELETE FROM SJPB_INC_SP	WHERE RCPT_NUM=#rcptNum#
		]]>
	</delete>
	
	<!--  사건워크플로우 생성 -->	
	<insert id="B0101.SJPB_INC_TASK.insert"> /* B0101.SJPB_INC_TASK.insert */
		<![CDATA[		
			INSERT INTO SJPB_INC_TASK (RCPT_NUM, WF_NUM, TASK_NUM, TASK_ROLE_CD, TASK_COMN, ACTV_YN, REG_USER_ID,REG_DATE,UPD_USER_ID,UPD_DATE)
			SELECT  #rcptNum#,WF_NUM,TASK_NUM,TASK_ROLE_CD,'',BE_TASK_YN,#regUserId#,SYSDATE,#regUserId#,SYSDATE	FROM SJPB_TASK WHERE WF_NUM = #wfNum#
		]]>
	</insert>
	
	<!-- 법률위반(통계원표 피의자관련) -->
	<resultMap id="B0101VO.SJPB_ACT_VIO.STS.SP.list" class="com.saltware.enface.sjpb.Z.service.ActVioVO">
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="actVioClaNm" column="ACT_VIO_CLA_NM"/>
	</resultMap>
	<!-- 법률위반정보 가져오기(통계원표 피의자관련) --> 	
	<select id="B0101.SJPB_ACT_VIO.STS.SP.list" resultMap="B0101VO.SJPB_ACT_VIO.STS.SP.list">	/* B0101.SJPB_ACT_VIO.STS.SP.list */
		<![CDATA[		
			SELECT
			    A.INC_SP_NUM
			    ,A.ACT_VIO_NUM
			    ,D.RCPT_NUM
			    ,A.RLT_ACT_CRI_NM_CD
			    ,B.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
			    ,A.ACT_VIO_CLA_NM
			FROM SJPB_ACT_VIO A 
			LEFT OUTER JOIN CODEBASE B ON A.RLT_ACT_CRI_NM_CD = B.CODE AND B.CODE_ID = 'SJPB_00012'
			JOIN SJPB_INC_SP D ON D.INC_SP_NUM = A.INC_SP_NUM AND D.SP_STAT_CD = '1'
			WHERE A.INC_SP_NUM = #incSpNum#
				AND A.ACT_VIO_STAT_CD = '1'
			GROUP BY B.CODE_NAME, A.INC_SP_NUM, A.ACT_VIO_NUM, D.RCPT_NUM, A.RLT_ACT_CRI_NM_CD,A.ACT_VIO_CLA_NM
		]]>
	</select>
	
	
	<!-- 상세 사건 지휘내역 결과맵 -->	
	<resultMap id="B0101.IncCriCmdItemVO.details" class="com.saltware.enface.sjpb.Z.service.IncCriCmdItemVO">
		<result property="incCriCmdItemNum" column="INC_CRI_CMD_ITEM_NUM"/>
		<result property="incCriCmdBkNum" column="INC_CRI_CMD_BK_NUM"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="incCriCmdItemStatCd" column="INC_CRI_CMD_ITEM_STAT_CD"/>
		<result property="incCriCmdBkStatCd" column="INC_CRI_CMD_BK_STAT_CD"/>
		<result property="criCmdTranDt" column="CRI_CMD_TRAN_DT"/>
		<result property="criCmdReqDt" column="CRI_CMD_REQ_DT"/>
		<result property="criCmdRcptDt" column="CRI_CMD_RCPT_DT"/>
		<result property="reCmdYn" column="RE_CMD_YN"/>
		<result property="criCmdRst" column="CRI_CMD_RST"/>
		<result property="criCmdComn" column="CRI_CMD_COMN"/>
		<!-- <result property="incCriNm" column="INC_CRI_NM"/> -->
		<!-- <result property="incSp" column="INC_SP"/> -->
		<result property="incArrtClsf" column="INC_ARRT_CLSF"/>
		<result property="evidArtcYn" column="EVID_ARTC_YN"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="criCmdProDt" column="CRI_CMD_PRO_DT"/>		
		<result property="respDppoCd" column="RESP_DPPO_CD"/>
		<result property="respDppoDesc" column="RESP_DPPO_DESC"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
	</resultMap>	
		
		
	<!-- 상세 사건 지휘내역 --> 
	<select id="B0101.SJPB_INC_CRI_CMD_ITEM.details" resultMap="B0101.IncCriCmdItemVO.details">  /* B0101.SJPB_INC_CRI_CMD_ITEM.details */
		
		SELECT
			 B.INC_CRI_CMD_ITEM_NUM   /*사건수사지휘건번호*/
			,B.INC_CRI_CMD_BK_NUM     /*사건수사지휘부번호*/
			,B.RCPT_NUM               /*접수번호*/
			,TO_CHAR(B.CRI_CMD_TRAN_DT,'YYYY-MM-DD') AS  CRI_CMD_TRAN_DT        /*수사지휘인계일*/      
			,TO_CHAR(B.CRI_CMD_REQ_DT,'YYYY-MM-DD') AS  CRI_CMD_REQ_DT         /*수사지휘접수일*/
			,TO_CHAR(B.CRI_CMD_RCPT_DT,'YYYY-MM-DD') AS  CRI_CMD_RCPT_DT        /*수사지휘수령일*/
			,B.RE_CMD_YN              /*재지휘여부*/
			,B.CRI_CMD_RST            /*수사지휘결과*/
			,B.CRI_CMD_COMN           /*수사지휘의견*/
			,B.INC_ARRT_CLSF          /*사건구속별*/
			,B.EVID_ARTC_YN           /*증거품유무*/
			,B.INC_CRI_CMD_ITEM_STAT_CD  /*사건수사지휘건상태코드*/
			,A.INC_CRI_CMD_BK_STAT_CD  /*사건수사지휘부구분코드*/
			,B.REG_USER_ID
			,B.REG_DATE
			,B.UPD_USER_ID
			,B.UPD_DATE
			,TO_CHAR(A.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS  CRI_CMD_PRO_DT         /*수사지휘건의일*/
			,A.RESP_DPPO_CD           /*담당지검코드*/
			,C.RCPT_INC_NUM           /*접수사건번호*/						
			,D.CODE_NAME AS RESP_DPPO_DESC /*담당지검명*/			
		FROM SJPB_INC_CRI_CMD_BK A
		JOIN SJPB_INC_CRI_CMD_ITEM B ON A.INC_CRI_CMD_BK_NUM = B.INC_CRI_CMD_BK_NUM
		JOIN SJPB_INC_MAST C ON B.RCPT_NUM = C.RCPT_NUM
		LEFT OUTER JOIN CODEBASE D ON A.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'  /*담당지검코드*/
		WHERE B.RCPT_NUM=#rcptNum#
		ORDER BY B.INC_CRI_CMD_ITEM_NUM			
		
		<!-- 부모사건, 자식사건고려 
		SELECT
			 B.INC_CRI_CMD_ITEM_NUM   /*사건수사지휘건번호*/
			,B.INC_CRI_CMD_BK_NUM     /*사건수사지휘부번호*/
			,B.RCPT_NUM               /*접수번호*/
			,TO_CHAR(B.CRI_CMD_TRAN_DT,'YYYY-MM-DD') AS  CRI_CMD_TRAN_DT        /*수사지휘인계일*/      
			,TO_CHAR(B.CRI_CMD_REQ_DT,'YYYY-MM-DD') AS  CRI_CMD_REQ_DT         /*수사지휘접수일*/
			,TO_CHAR(B.CRI_CMD_RCPT_DT,'YYYY-MM-DD') AS  CRI_CMD_RCPT_DT        /*수사지휘수령일*/
			,B.RE_CMD_YN              /*재지휘여부*/
			,B.CRI_CMD_RST            /*수사지휘결과*/
			,B.CRI_CMD_COMN           /*수사지휘의견*/
			,E.INC_CRI_NM AS INC_CRI_NM             /*사건죄명*/
			,F.SP_NM AS INC_SP                 /*사건피의자*/
			,B.INC_ARRT_CLSF          /*사건구속별*/
			,B.EVID_ARTC_YN           /*증거품유무*/
			,B.INC_CRI_CMD_ITEM_STAT_CD  /*사건수사지휘건상태코드*/
			,A.INC_CRI_CMD_BK_STAT_CD  /*사건수사지휘부구분코드*/
			,B.REG_USER_ID
			,B.REG_DATE
			,B.UPD_USER_ID
			,B.UPD_DATE
			,TO_CHAR(A.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS  CRI_CMD_PRO_DT         /*수사지휘건의일*/
			,A.RESP_DPPO_CD           /*담당지검코드*/
			,C.RCPT_INC_NUM           /*접수사건번호*/						
			,D.CODE_NAME AS RESP_DPPO_DESC /*담당지검명*/			
		FROM SJPB_INC_CRI_CMD_BK A
		JOIN SJPB_INC_CRI_CMD_ITEM B ON A.INC_CRI_CMD_BK_NUM = B.INC_CRI_CMD_BK_NUM
		JOIN SJPB_INC_MAST C ON B.RCPT_NUM = C.RCPT_NUM
		LEFT OUTER JOIN CODEBASE D ON A.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'  /*담당지검코드*/
	    JOIN (SELECT 
         A6.GRUP_NUM AS RCPT_NUM           
         ,REGEXP_REPLACE(LISTAGG(A6.CODE_NAME, ',') WITHIN GROUP (ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1')  AS INC_CRI_NM
        FROM
       ( SELECT 
         A2.LV
        ,A2.GRUP_NUM
        ,A3.SP_NM AS SP_NM
        ,A5.CODE_NAME 
        FROM 
        (SELECT 
           LEVEL AS LV
          ,A1.RCPT_NUM
          ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
        FROM SJPB_INC_MAST A1 
        WHERE A1.RCPT_TP_CD = '2' 
        START WITH A1.PARE_RCPT_NUM IS NULL        
        CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
        JOIN 
        SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1' 
        JOIN 
        SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
        LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
        ) A6
        GROUP BY A6.GRUP_NUM) E ON B.RCPT_NUM = E.RCPT_NUM           
	    JOIN ( SELECT 
         A4.GRUP_NUM AS RCPT_NUM           
         ,REGEXP_REPLACE(LISTAGG(A4.SP_NM, ',') WITHIN GROUP (ORDER BY A4.GRUP_NUM), '([^,]+)(,\1)+', '\1')  AS SP_NM
        FROM
       ( SELECT 
         A2.LV
        ,A2.GRUP_NUM
        ,CRYPTO.DEC('normal', A3.SP_NM) AS SP_NM
        FROM 
        (SELECT 
           LEVEL AS LV
          ,A1.RCPT_NUM
          ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
        FROM SJPB_INC_MAST A1 
        WHERE A1.RCPT_TP_CD = '2' 
        START WITH A1.PARE_RCPT_NUM IS NULL        
        CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
        JOIN 
        SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1' ) A4   
         GROUP BY A4.GRUP_NUM) F ON B.RCPT_NUM = F.RCPT_NUM				
		WHERE B.RCPT_NUM=#rcptNum#
		ORDER BY B.INC_CRI_CMD_ITEM_NUM			
		 -->
	
	</select>	
	
	<!-- 상세 사건송치건 결과맵 -->	
	<resultMap id="B0101.IncTrfItemVO.details" class="com.saltware.enface.sjpb.Z.service.IncTrfItemVO">
		<result property="incTrfItemNum" column="INC_TRF_ITEM_NUM"/>
<!-- 		<result property="incTrfBkNum" column="INC_TRF_BK_NUM"/> -->
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="incTrfItemStatCd" column="INC_TRF_ITEM_STAT_CD"/>
		<result property="trfTranDt" column="TRF_TRAN_DT"/>
		<result property="trfReqDt" column="TRF_REQ_DT"/>
		<result property="trfRcptDt" column="TRF_RCPT_DT"/>
		<result property="reTrfYn" column="RE_TRF_YN"/>
		<result property="trfRst" column="TRF_RST"/>
		<result property="trfComn" column="TRF_COMN"/>
		<!-- <result property="incCriNm" column="INC_CRI_NM"/> -->
		<!-- <result property="incSp" column="INC_SP"/> -->
		<result property="incArrtClsf" column="INC_ARRT_CLSF"/>
		<result property="evidArtcYn" column="EVID_ARTC_YN"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="trfProDt" column="TRF_PRO_DT"/>		
		<result property="respDppoCd" column="RESP_DPPO_CD"/>
		<result property="respDppoDesc" column="RESP_DPPO_DESC"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="trfNum" column="TRF_NUM"/>
	</resultMap>	
	<!-- 상세 사건송치건 내역 --> 
	<select id="B0101.SJPB_INC_TRF_ITEM.details" resultMap="B0101.IncTrfItemVO.details">  /* B0101.SJPB_INC_TRF_ITEM.details */
		
		SELECT
			 A.INC_TRF_ITEM_NUM   /*사건송치건번호*/
			,A.RCPT_NUM               /*접수번호*/     
			,TO_CHAR(A.TRF_TRAN_DT,'YYYY-MM-DD') AS  TRF_TRAN_DT        /*송치인계일*/      
			,TO_CHAR(A.TRF_REQ_DT,'YYYY-MM-DD') AS  TRF_REQ_DT         /*송치접수일*/
			,TO_CHAR(A.TRF_RCPT_DT,'YYYY-MM-DD') AS  TRF_RCPT_DT        /*송치수령일*/
			,A.RE_TRF_YN              /*재지휘여부*/
			,A.TRF_RST            /*송치결과*/
			,A.TRF_COMN           /*송치의견*/
			,A.INC_ARRT_CLSF          /*사건구속별*/
			,A.EVID_ARTC_YN           /*증거품유무*/
			,A.INC_TRF_ITEM_STAT_CD  /*사건송치건상태코드*/
			,A.REG_USER_ID
			,A.REG_DATE
			,A.UPD_USER_ID
			,A.UPD_DATE
			,TO_CHAR(A.TRF_PRO_DT,'YYYY-MM-DD') AS  TRF_PRO_DT         /*송치건의일*/
			,A.RESP_DPPO_CD           /*담당지검코드*/
			,C.RCPT_INC_NUM           /*접수사건번호*/						
			,D.CODE_NAME AS RESP_DPPO_DESC /*담당지검명*/	
			,A.TRF_NUM					/* 송치번호 */		
		FROM SJPB_INC_TRF_ITEM A
		JOIN SJPB_INC_MAST C ON A.RCPT_NUM = C.RCPT_NUM
		LEFT OUTER JOIN CODEBASE D ON A.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'  /*담당지검코드*/
		WHERE A.RCPT_NUM=#rcptNum#
		ORDER BY A.INC_TRF_ITEM_NUM		
		
		<!-- 부모사건, 자식사건고려 
		SELECT
			 B.INC_TRF_ITEM_NUM   /*사건송치건번호*/
			,B.INC_TRF_BK_NUM     /*사건송치부번호*/
			,B.RCPT_NUM               /*접수번호*/
			,TO_CHAR(B.TRF_TRAN_DT,'YYYY-MM-DD') AS  TRF_TRAN_DT        /*송치인계일*/      
			,TO_CHAR(B.TRF_REQ_DT,'YYYY-MM-DD') AS  TRF_REQ_DT         /*송치접수일*/
			,TO_CHAR(B.TRF_RCPT_DT,'YYYY-MM-DD') AS  TRF_RCPT_DT        /*송치수령일*/
			,B.RE_TRF_YN              /*재지휘여부*/
			,B.TRF_RST            /*송치결과*/
			,B.TRF_COMN           /*송치의견*/
			,E.INC_CRI_NM AS INC_CRI_NM             /*사건죄명*/
			,F.SP_NM AS INC_SP                 /*사건피의자*/
			,B.INC_ARRT_CLSF          /*사건구속별*/
			,B.EVID_ARTC_YN           /*증거품유무*/
			,B.INC_TRF_ITEM_STAT_CD  /*사건송치건상태코드*/
			,B.REG_USER_ID
			,B.REG_DATE
			,B.UPD_USER_ID
			,B.UPD_DATE
			,TO_CHAR(A.TRF_PRO_DT,'YYYY-MM-DD') AS  TRF_PRO_DT         /*송치건의일*/
			,A.RESP_DPPO_CD           /*담당지검코드*/
			,C.RCPT_INC_NUM           /*접수사건번호*/						
			,D.CODE_NAME AS RESP_DPPO_DESC /*담당지검명*/			
		FROM SJPB_INC_TRF_BK A
		JOIN SJPB_INC_TRF_ITEM B ON A.INC_TRF_BK_NUM = B.INC_TRF_BK_NUM
		JOIN SJPB_INC_MAST C ON B.RCPT_NUM = C.RCPT_NUM
		LEFT OUTER JOIN CODEBASE D ON A.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'  /*담당지검코드*/
	    JOIN (SELECT 
         A6.GRUP_NUM AS RCPT_NUM           
         ,REGEXP_REPLACE(LISTAGG(A6.CODE_NAME, ',') WITHIN GROUP (ORDER BY A6.GRUP_NUM), '([^,]+)(,\1)+', '\1')  AS INC_CRI_NM
        FROM
       ( SELECT 
         A2.LV
        ,A2.GRUP_NUM
        ,CRYPTO.DEC('normal', A3.SP_NM) AS SP_NM
        ,A5.CODE_NAME 
        FROM 
        (SELECT 
           LEVEL AS LV
          ,A1.RCPT_NUM
          ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
        FROM SJPB_INC_MAST A1 
        WHERE A1.RCPT_TP_CD = '2' 
        START WITH A1.PARE_RCPT_NUM IS NULL        
        CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
        JOIN 
        SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'
        JOIN 
        SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
        LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
        ) A6
        GROUP BY A6.GRUP_NUM) E ON B.RCPT_NUM = E.RCPT_NUM           
	    JOIN ( SELECT 
         A4.GRUP_NUM AS RCPT_NUM           
         ,REGEXP_REPLACE(LISTAGG(A4.SP_NM, ',') WITHIN GROUP (ORDER BY A4.GRUP_NUM), '([^,]+)(,\1)+', '\1')  AS SP_NM
        FROM
       ( SELECT 
         A2.LV
        ,A2.GRUP_NUM
        ,CRYPTO.DEC('normal', A3.SP_NM) AS SP_NM
        FROM 
        (SELECT 
           LEVEL AS LV
          ,A1.RCPT_NUM
          ,(CASE WHEN LEVEL = 1 THEN A1.RCPT_NUM ELSE A1.PARE_RCPT_NUM END) AS GRUP_NUM
        FROM SJPB_INC_MAST A1 
        WHERE A1.RCPT_TP_CD = '2' 
        START WITH A1.PARE_RCPT_NUM IS NULL        
        CONNECT BY  PRIOR A1.RCPT_NUM =  A1.PARE_RCPT_NUM) A2 
        JOIN 
        SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1' ) A4   
         GROUP BY A4.GRUP_NUM) F ON B.RCPT_NUM = F.RCPT_NUM				
		WHERE B.RCPT_NUM=#rcptNum#
		ORDER BY B.INC_TRF_ITEM_NUM		
		-->	
	</select>	
	
	<!-- 상세 사건처분결과 결과맵 -->	
	<resultMap id="B0101.IncDipRstVO.details" class="com.saltware.enface.sjpb.Z.service.IncDipRstVO">
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="poContCd" column="PO_CONT_CD"/>
		<result property="poContCdDesc" column="PO_CONT_CD_DESC"/>
		<result property="dipCont" column="DIP_CONT"/>
		<result property="fnAmt" column="FN_AMT"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
	</resultMap>	
	<!-- 상세 사건처분결과 내역 --> 
	<select id="B0101.SJPB_INC_DIP_RST.details" resultMap="B0101.IncDipRstVO.details">  /* B0101.SJPB_INC_DIP_RST.details */
		SELECT
			 A.ACT_VIO_NUM
			,C.INC_SP_NUM
			,A.PO_CONT_CD
			,A.DIP_CONT
			,A.FN_AMT
			,A.REG_USER_ID
			,A.REG_DATE
			,A.UPD_USER_ID
			,A.UPD_DATE
			,B.CODE_NAME AS PO_CONT_CD_DESC
		FROM SJPB_INC_DIP_RST A
		LEFT OUTER JOIN CODEBASE B ON A.PO_CONT_CD = B.CODE AND B.CODE_ID = 'SJPB_00022'  /*검찰내용코드*/
		JOIN SJPB_ACT_VIO C ON C.ACT_VIO_NUM = A.ACT_VIO_NUM AND C.ACT_VIO_STAT_CD = '1'
		WHERE A.ACT_VIO_NUM=#actVioNum#
	</select>	
	
	<!-- 상세 사건판결결과 결과맵 -->	
	<resultMap id="B0101.IncJdtRstVO.details" class="com.saltware.enface.sjpb.Z.service.IncJdtRstVO">
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="jdtCont" column="JDT_CONT"/>
		<result property="jdtOp" column="JDT_OP"/>
		<result property="cortNum" column="CORT_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
	</resultMap>	
	<!-- 상세 사건판결결과 내역 --> 
	<select id="B0101.SJPB_INC_JDT_RST.details" resultMap="B0101.IncJdtRstVO.details">  /* B0101.SJPB_INC_JDT_RST.details */
		SELECT
			A.ACT_VIO_NUM
			,B.INC_SP_NUM
			,A.JDT_CONT
			,A.JDT_OP
			,A.CORT_NUM
			,A.REG_USER_ID
			,A.REG_DATE
			,A.UPD_USER_ID
			,A.UPD_DATE
		FROM SJPB_INC_JDT_RST A
		JOIN SJPB_ACT_VIO B ON B.ACT_VIO_NUM = A.ACT_VIO_NUM AND B.ACT_VIO_STAT_CD = '1'
		WHERE A.ACT_VIO_NUM=#actVioNum#
	</select>	
	
	<resultMap class="com.saltware.enface.sjpb.Z.service.IncSpVO" id="B0101VO.selectIncDipRstDtsDetails">
		<result property="crlwNum" column="CRLW_NUM"/>
		<result property="poDipDt" column="PO_DIP_DT"/>
	</resultMap>
	<!-- 피의자정보_ 형제번호, 검찰처분일시 가져오기 --> 	
	<select id="B0101.selectIncDipRstDtsDetails" resultMap="B0101VO.selectIncDipRstDtsDetails">	/* B0101.selectIncDipRstDtsDetails */
		<![CDATA[		
			SELECT 
			     CRLW_NUM		/*형제번호*/
				,TO_CHAR(PO_DIP_DT,'YYYY-MM-DD') AS PO_DIP_DT		/*검찰처분일시*/
			FROM SJPB_INC_SP
			WHERE SP_STAT_CD = '1'
			    AND INC_SP_NUM = #incSpNum#
		]]>
	</select>
	
	<resultMap class="com.saltware.enface.sjpb.Z.service.IncSpVO" id="B0101VO.selectIncJdtRstDtsDetails">
		<result property="jdtFiDt" column="JDT_FI_DT"/>
	</resultMap>
	<!-- 피의자정보_ 판결확정일시 가져오기 --> 	
	<select id="B0101.selectIncJdtRstDtsDetails" resultMap="B0101VO.selectIncJdtRstDtsDetails">	/* B0101.selectIncJdtRstDtsDetails */
		<![CDATA[		
			SELECT 
			     TO_CHAR(JDT_FI_DT,'YYYY-MM-DD') AS JDT_FI_DT		/*판결확정일시*/
			FROM SJPB_INC_SP
			WHERE SP_STAT_CD = '1'
			    AND INC_SP_NUM = #incSpNum#
		]]>
	</select>
	
	<!-- 사건처분결과 추가 -->
	<insert id="B0101.SJPB_INC_DIP_RST.insert"> /* B0101.SJPB_INC_DIP_RST.insert */	
		INSERT INTO SJPB_INC_DIP_RST
			(
			ACT_VIO_NUM		/*법률위반번호*/
			,PO_CONT_CD		/*검찰내용*/
			,DIP_CONT		/*처분내용*/
			,FN_AMT			/*벌금액*/
			,REG_USER_ID	/*등록자*/
			,REG_DATE		/*등록일자*/
			,UPD_USER_ID	/*수정자*/
			,UPD_DATE		/*수정일자*/
			)
		VALUES (
			#actVioNum#
			,#poContCd#
			,#dipCont#
			,#fnAmt#
			,#regUserId#
			,SYSDATE
			,#updUserId#
			,SYSDATE	
			)
	</insert>
	
	<!--  사건처분결과 삭제 -->
	<delete id="B0101.SJPB_INC_DIP_RST.delete">  /* B0101.SJPB_INC_DIP_RST.delete */
		<![CDATA[	
			DELETE FROM SJPB_INC_DIP_RST WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<!-- 사건판결결과 추가 -->
	<insert id="B0101.SJPB_INC_JDT_RST.insert"> /* B0101.SJPB_INC_JDT_RST.insert */
		
		INSERT INTO SJPB_INC_JDT_RST
			(
			ACT_VIO_NUM		/*법률위반번호*/
			,JDT_CONT		/*판결내용*/
			,JDT_OP			/*판결의견*/
			,CORT_NUM		/*법원번호*/
			,REG_USER_ID	/*등록자*/
			,REG_DATE		/*등록일자*/
			,UPD_USER_ID	/*수정자*/
			,UPD_DATE		/*수정일자*/
			)
		VALUES (
			#actVioNum#
			,#jdtCont#
			,#jdtOp#
			,#cortNum#
			,#regUserId#
			,SYSDATE
			,#updUserId#
			,SYSDATE	
			)
		
	</insert>
	
	<select id="B0101.getIncNum" resultClass="java.lang.String"> /* B0101.getIncNum */
		SELECT 
		    C.INC_NUM 
		FROM SJPB_INC_SP A 
		JOIN SJPB_INC_MAST B ON A.RCPT_NUM = B.RCPT_NUM 
		JOIN SJPB_INC_DTS C ON B.RCPT_NUM = C.RCPT_NUM
		WHERE A.INC_SP_NUM = #incSpNum#
	</select>
	
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.incMastHistList">
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="rcptTpCd" column="RCPT_TP_CD"/>
		<result property="criStatCd" column="CRI_STAT_CD"/>
		<result property="fdCd" column="FD_CD"/>
		<result property="criTmId" column="CRI_TM_ID"/>
		<result property="dvForm" column="DV_FORM"/>
		<result property="beDt" column="BE_DT"/>
		<result property="edDt" column="ED_DT"/>
		<result property="pareRcptNum" column="PARE_RCPT_NUM"/>
		<result property="combIncYn" column="COMB_INC_YN"/>
		<result property="infwDiv" column="INFW_DIV"/>
		<result property="rcptStatCd" column="RCPT_STAT_CD"/>
		<result property="mfCd" column="MF_CD"/>
		<result property="mfCont" column="MF_CONT"/>
		<result property="incMfNum" column="INC_MF_NUM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		
		<result property="nmKor" column="NM_KOR"/>
		<result property="updUserIdNm" column="UPD_USER_ID_NM"/>
		
	</resultMap>
	<!-- 사건이력 리스트 -->
	<select id="B0101.incMastHistList" resultMap="B0101VO.incMastHistList"> /* B0101.incMastHistList */
		    SELECT DISTINCT *
    FROM (    
        SELECT 
                A.RCPT_NUM AS RCPT_NUM /*접수번호*/	 
                 ,A.RCPT_INC_NUM	 /*접수사건번호*/	
                 ,A.RCPT_TP_CD	 /*접수유형코드*/	
                 ,A.CRI_STAT_CD	 /*수사상태코드*/	
                 ,A.FD_CD	 /*사건분야코드*/	 
                 ,A.CRI_TM_ID	 /*수사팀계정*/	 
                 ,A.DV_FORM	 /*발각형태*/	 
                 ,A.BE_DT	 /*착수일자*/	 
                 ,A.ED_DT	 /*종결일자*/	 
                 ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
                 ,A.COMB_INC_YN     /*병합사건여부*/
                 ,A.INFW_DIV        /*유입구분*/
                 ,A.RCPT_STAT_CD    /*접수상태코드*/
                 ,A.MF_CD           /*변경코드*/
                 ,A.MF_CONT         /*변경내용*/
                 ,A.INC_MF_NUM    /*사건수정번호*/
                 ,A.REG_USER_ID	 /*등록자*/	 
                 ,A.REG_DATE	 /*등록일자*/	 
                 ,A.UPD_USER_ID	 /*수정자*/	 
                 ,TO_CHAR(A.UPD_DATE,'YYYY-MM-DD HH24:mi:ss') AS UPD_DATE	 /*수정일자*/ 
                 ,C.NM_KOR      /*수정자*/
                 ,(CASE 
		            WHEN C.NM_KOR IS NOT NULL THEN C.NM_KOR||' ('||A.UPD_USER_ID||')'
		            ELSE  A.UPD_USER_ID END) AS UPD_USER_ID_NM   /*수정자설명*/
                 
            FROM SJPB_INC_MAST_HIST A
            JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
            LEFT OUTER JOIN USERPASS C ON A.UPD_USER_ID = C.USER_ID
            WHERE A.RCPT_NUM = #rcptNum#
            AND A.CRI_STAT_CD NOT IN ('21','22')  AND MF_CONT IS NOT NULL
            
           
<!--         UNION  -->
<!--             SELECT  -->
<!--                 AA.RCPT_NUM AS RCPT_NUM /*접수번호*/	  -->
<!--                  ,AA.RCPT_INC_NUM	 /*접수사건번호*/	 -->
<!--                  ,AA.RCPT_TP_CD	 /*접수유형코드*/	 -->
<!--                  ,AA.CRI_STAT_CD	 /*수사상태코드*/	 -->
<!--                  ,AA.FD_CD	 /*사건분야코드*/	  -->
<!--                  ,AA.CRI_TM_ID	 /*수사팀계정*/	  -->
<!--                  ,AA.DV_FORM	 /*발각형태*/	  -->
<!--                  ,AA.BE_DT	 /*착수일자*/	  -->
<!--                  ,AA.ED_DT	 /*종결일자*/	  -->
<!--                  ,AA.PARE_RCPT_NUM	 /*부모접수번호*/	  -->
<!--                  ,AA.COMB_INC_YN     /*병합사건여부*/ -->
<!--                  ,AA.INFW_DIV        /*유입구분*/ -->
<!--                  ,AA.RCPT_STAT_CD    /*접수상태코드*/ -->
<!--                  ,AA.MF_CD           /*변경코드*/ -->
<!--                  ,AA.MF_CONT         /*변경내용*/ -->
<!--                  ,AA.INC_MF_NUM    /*사건수정번호*/ -->
<!--                  ,AA.REG_USER_ID	 /*등록자*/	  -->
<!--                  ,AA.REG_DATE	 /*등록일자*/	  -->
<!--                  ,AA.UPD_USER_ID	 /*수정자*/	  -->
<!--                  ,TO_CHAR(AA.UPD_DATE,'YYYY-MM-DD HH24:mi:ss') AS UPD_DATE	 /*수정일자*/ -->
<!--                  ,CC.NM_KOR      /*수정자*/ -->
<!--                  ,(CASE  -->
<!--                  	WHEN CC.NM_KOR IS NOT NULL THEN CC.NM_KOR||' ('||AA.UPD_USER_ID||')' -->
<!-- 		            ELSE  AA.UPD_USER_ID END) AS UPD_USER_ID_NM   /*수정자설명*/ -->
<!--             FROM SJPB_INC_MAST AA -->
<!--             JOIN SJPB_INC_DTS BB ON AA.RCPT_NUM = BB.RCPT_NUM -->
<!--             LEFT OUTER JOIN USERPASS CC ON AA.UPD_USER_ID = CC.USER_ID -->
<!--             WHERE AA.RCPT_NUM = #rcptNum# -->
<!--             AND AA.RCPT_INC_NUM IS NOT NULL -->
<!--             AND AA.CRI_STAT_CD &gt;= 40 -->
        )
    ORDER BY UPD_DATE ASC
	</select>
	
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.getMfCdDescStr">
		<result property="mfCdDesc" column="MF_CD_DESC"/>
	</resultMap>
	<!-- 변경이력 코드값을 문자열로 가져오기 -->
	<select id="B0101.getMfCdDescStr" resultMap="B0101VO.getMfCdDescStr"> /* B0101.getMfCdDescStr */
		SELECT
            REGEXP_REPLACE(
                LISTAGG((SELECT CODE_NAME FROM CODEBASE WHERE CODE_ID = 'SJPB_00032' AND CODE = TXT),  ', ') 
                WITHIN GROUP(ORDER BY (SELECT CODE_NAME FROM CODEBASE WHERE CODE_ID = 'SJPB_00032' AND CODE = TXT)), '([^,]+)(,\1)+', '\1'
                ) AS MF_CD_DESC
        FROM (
            SELECT 
                TRIM (REGEXP_SUBSTR(#mfCd#,'[^' || ':' || ']+', 1, LEVEL)) AS TXT 
                ,LEVEL 
                FROM DUAL
                CONNECT BY INSTR (#mfCd#, ':', 1, LEVEL - 1) > 0
        )
	</select>
	
	<!--  사건판결결과 삭제 -->
	<delete id="B0101.SJPB_INC_JDT_RST.delete">  /* B0101.SJPB_INC_JDT_RST.delete */
		<![CDATA[	
			DELETE FROM SJPB_INC_JDT_RST WHERE ACT_VIO_NUM=#actVioNum#
		]]>
	</delete>
	
	<select id="B0101.test" resultClass="int">
			SELECT '1' FROM DUAL
	</select>
	
	<select id="B0101.now" resultClass="java.lang.String"> /* b0101.now */
		SELECT TO_CHAR(SYSDATE, 'YYYY-MM-DD') FROM DUAL
	</select>
	
	
	<!-- 범죄사건부 excel 다운로드   -->
	<resultMap class="com.saltware.enface.sjpb.B.service.B0101VO" id="B0101VO.selectBkList">
		<result property="indx" column="INDX"/>
		<result property="baseYear" column="BASE_YEAR"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rcptOrdNum" column="RCPT_ORD_NUM"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="fdDesc" column="FD_DESC"/>
		<result property="infwDesc" column="INFW_DESC"/>
		<result property="sortIncNum" column="SORT_INC_NUM"/>
		<result property="beDt" column="BE_DT"/>
		<result property="criTmNm" column="CRI_TM_NM"/>
		<result property="nmKor" column="NM_KOR"/>
		<result property="spNm" column="SP_NM"/>
		<result property="spIdNum" column="SP_ID_NUM"/>
		<result property="spAddr" column="SP_ADDR"/>
		<result property="spBsnsNm" column="SP_BSNS_NM"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="vioCont" column="VIO_CONT"/>
		<result property="vioCla" column="VIO_CLA"/>
		<result property="criDt" column="CRI_DT"/>
		<result property="incOccrAreaAddr" column="INC_OCCR_AREA_ADDR"/>
		<result property="dvFormDesc" column="DV_FORM_DESC"/>
		<result property="chaIttDesc" column="CHA_ITT_DESC"/>
		<result property="poDipDt" column="PO_DIP_DT"/>
		<result property="dipCont" column="DIP_CONT"/>
		<result property="fnAmt" column="FN_AMT"/>
		<result property="crlwNum" column="CRLW_NUM"/>
		<result property="jdtCont" column="JDT_CONT"/>
		<result property="jdtFiDt" column="JDT_FI_DT"/>
		<result property="criStatDesc" column="CRI_STAT_DESC"/>
		<result property="criCmdProDt1" column="CRI_CMD_PRO_DT1"/>
		<result property="cmdRespDppoCdDesc1" column="CMD_RESP_DPPO_CD_DESC1"/>
		<result property="criCmdProDt2" column="CRI_CMD_PRO_DT2"/>
		<result property="cmdRespDppoCdDesc2" column="CMD_RESP_DPPO_CD_DESC2"/>
		<result property="criCmdProDt3" column="CRI_CMD_PRO_DT3"/>
		<result property="cmdRespDppoCdDesc3" column="CMD_RESP_DPPO_CD_DESC3"/>
		<result property="criCmdProDt4" column="CRI_CMD_PRO_DT4"/>
		<result property="cmdRespDppoCdDesc4" column="CMD_RESP_DPPO_CD_DESC4"/>
		<result property="criCmdProDt5" column="CRI_CMD_PRO_DT5"/>
		<result property="cmdRespDppoCdDesc5" column="CMD_RESP_DPPO_CD_DESC5"/>
		<result property="trfProDt1" column="TRF_PRO_DT1"/>
		<result property="trfRespDppoCdDesc1" column="TRF_RESP_DPPO_CD_DESC1"/>
		<result property="incTrfBkStatCdDesc1" column="INC_TRF_BK_STAT_CD_DESC1"/>
		<result property="trfProDt2" column="TRF_PRO_DT2"/>
		<result property="trfRespDppoCdDesc2" column="TRF_RESP_DPPO_CD_DESC2"/>
		<result property="incTrfBkStatCdDesc2" column="INC_TRF_BK_STAT_CD_DESC2"/>
		<result property="trfProDt3" column="TRF_PRO_DT3"/>
		<result property="trfRespDppoCdDesc3" column="TRF_RESP_DPPO_CD_DESC3"/>
		<result property="incTrfBkStatCdDesc3" column="INC_TRF_BK_STAT_CD_DESC3"/>
		<result property="trfProDt4" column="TRF_PRO_DT4"/>
		<result property="trfRespDppoCdDesc4" column="TRF_RESP_DPPO_CD_DESC4"/>
		<result property="incTrfBkStatCdDesc4" column="INC_TRF_BK_STAT_CD_DESC4"/>
		<result property="trfProDt5" column="TRF_PRO_DT5"/>
		<result property="trfRespDppoCdDesc5" column="TRF_RESP_DPPO_CD_DESC5"/>
		<result property="incTrfBkStatCdDesc5" column="INC_TRF_BK_STAT_CD_DESC5"/>
				
	</resultMap>
	
	<!-- 사건 리스트(범죄사건부 엑셀다운로드) -->
	<select id="B0101.selectBkList" resultMap="B0101VO.selectBkList"> /* B0101.selectBkList */
	
	SELECT 
	    ROWNUM AS INDX
        ,FI.*
	FROM
			(
			SELECT
		        DECODE(A.RCPT_ORD_NUM, '', '', TO_NUMBER(SUBSTR(A.RCPT_ORD_NUM, 1, 4))) AS BASE_YEAR
		        ,A.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/
		        ,A.RCPT_ORD_NUM	 /* 접수번호 */
		        ,M.INC_SP_NUM           /*사건피의자번호*/ 
		        ,E.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
		        ,H.CODE_NAME AS INFW_DESC /*사건유입구분코드설명*/
		        ,NVL(TO_NUMBER(SUBSTR(A.RCPT_ORD_NUM, 6)),0) AS SORT_INC_NUM
		        ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS BE_DT	 /*착수일자*/	 
		        ,I.CRI_TM_NM    /*수사팀*/
		        ,L.NM_KOR AS NM_KOR /*담당수사관*/
		        ,M.SP_NM				/*피의자명*/
		        ,M.SP_ID_NUM	/*피의자식별번호*/
		        ,M.SP_ADDR			/*주소*/
		        ,M.SP_BSNS_NM			/*업소명*/
		        ,A0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
		     	 ,A0.VIO_CONT AS VIO_CONT   /*위반내용*/
		         ,AA0.VIO_CLA AS VIO_CLA   /*위반조항*/
		         ,B.CRI_DT AS CRI_DT      /*범죄일시*/
		         ,B.INC_OCCR_AREA_ADDR  /*범죄장소*/
		         ,F.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		        ,G.CODE_NAME AS CHA_ITT_DESC      /*고발기관*/
	            
	            ,TO_CHAR(CMD1.CRI_CMD_PRO_DT,'YYYY-MM-DD')  AS CRI_CMD_PRO_DT1   /*수사지휘건의일1*/
	            ,CMD1.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC1   /*담당지검설명1*/
	            ,TO_CHAR(CMD2.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT2    /*수사지휘건의일2*/
	            ,CMD2.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC2   /*담당지검설명2*/
	            ,TO_CHAR(CMD3.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT3    /*수사지휘건의일3*/
	            ,CMD3.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC3   /*담당지검설명3*/
	            ,TO_CHAR(CMD4.CRI_CMD_PRO_DT,'YYYY-MM-DD')  AS CRI_CMD_PRO_DT4    /*수사지휘건의일4*/
	            ,CMD4.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC4   /*담당지검설명4*/
	            ,TO_CHAR(CMD5.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT5    /*수사지휘건의일5*/
	            ,CMD5.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC5   /*담당지검설명5*/
	            
	            ,TO_CHAR(TRF1.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT1    /*송치건의일1*/
	            ,TRF1.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC1   /*담당지검설명1*/
	            ,TRF1.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC1 /*송치완료설명1*/
	            ,TO_CHAR(TRF2.TRF_PRO_DT,'YYYY-MM-DD')AS TRF_PRO_DT2   /*송치건의일2*/
	            ,TRF2.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC2   /*담당지검설명2*/
	            ,TRF2.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC2 /*송치완료설명2*/
	            ,TO_CHAR(TRF3.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT3    /*송치건의일3*/
	            ,TRF3.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC3   /*담당지검설명3*/
	            ,TRF3.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC3 /*송치완료설명3*/
	            ,TO_CHAR(TRF4.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT4    /*송치건의일4*/
	            ,TRF4.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC4   /*담당지검설명4*/
	            ,TRF4.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC4 /*송치완료설명4*/
	            ,TO_CHAR(TRF5.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT5   /*송치건의일5*/
	            ,TRF5.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC5   /*담당지검설명5*/
	            ,TRF5.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC5 /*송치완료설명5*/
	            
		        ,TO_CHAR(M.PO_DIP_DT,'YYYY-MM-DD')  AS PO_DIP_DT /*검찰처분일시*/
		        ,AAA0.DIP_CONT  /*처분내용*/
		        ,AAA0.FN_AMT    /*벌금액*/
		        ,M.CRLW_NUM     /*형제번호*/
		        ,TO_CHAR(M.JDT_FI_DT,'YYYY-MM-DD') AS JDT_FI_DT /*판결확정일시*/
		        ,AAAA0.JDT_CONT /*판결내용*/
		        ,M.INQ_ORD  /*피의자 정렬 순서*/
		        ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		        <!-- 필요하지않지만, 나중에 .. 
		     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
		     ,A.RCPT_TP_CD	 /*접수유형코드*/	
		     ,A.CRI_STAT_CD	 /*수사상태코드*/	
		     ,A.CRI_TM_ID	 /*수사팀계정*/	 
		     ,A.DV_FORM	 /*발각형태*/	 
		     ,A.ED_DT	 /*종결일자*/	 
		     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
		     ,A.REG_USER_ID	 /*등록자*/	 
		     ,A.REG_DATE	 /*등록일자*/	 
		     ,A.UPD_USER_ID	 /*수정자*/	 
		     ,A.UPD_DATE	 /*수정일자*/	 
		     ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		     ,D.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
		     ,B.TRF_NUM AS TRF_NUM  /*송치번호*/
		     ,L.USER_ID AS CRI_MB_MAIN_USER_ID
		     ,B.INC_NUM
		     , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
	           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
	        		), '') AS PARE_INC_NUM
	        		 -->
		        
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			LEFT OUTER JOIN CODEBASE C ON A.CRI_STAT_CD = C.CODE AND C.CODE_ID = 'SJPB_00001'
			LEFT OUTER JOIN CODEBASE D ON A.RCPT_TP_CD = D.CODE AND D.CODE_ID = 'SJPB_00003'
			LEFT OUTER JOIN CODEBASE E ON A.FD_CD = E.CODE AND E.CODE_ID = 'SJPB_00002'
			LEFT OUTER JOIN CODEBASE F ON A.DV_FORM = F.CODE AND F.CODE_ID = 'SJPB_00004'
		    LEFT OUTER JOIN CODEBASE G ON B.CHA_ITT = G.CODE AND G.CODE_ID = 'SJPB_00010'
		    LEFT OUTER JOIN CODEBASE H ON A.INFW_DIV = H.CODE AND H.CODE_ID = 'SJPB_00025'
			LEFT OUTER JOIN SJPB_CRI_TM I ON A.CRI_TM_ID = I.CRI_TM_ID 
			LEFT OUTER JOIN SJPB_INC_CRI_MB J ON A.RCPT_NUM = J.RCPT_NUM AND J.CRI_LV_CD = '01'
			LEFT OUTER JOIN USERPASS L ON J.CRI_MB_ID = L.USER_ID
			LEFT OUTER JOIN 
			(
		            SELECT
		                 A6.RCPT_NUM       
		                 ,A6.INC_SP_NUM        
		                 ,REGEXP_REPLACE(LISTAGG(DECODE(A6.CODE_NAME, '', ' ',A6.CODE_NAME) ,  '\r\n') WITHIN GROUP(ORDER BY A6.INC_SP_NUM,A6.INQ_ORD), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
		                 ,REGEXP_REPLACE(LISTAGG(DECODE(A6.VIO_CONT, '', ' ',A6.VIO_CONT),  '\r\n') WITHIN GROUP(ORDER BY A6.INC_SP_NUM,A6.INQ_ORD), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
		                FROM
		                ( 
		                    SELECT 
		                        A2.RCPT_NUM
		                        ,A5.CODE_NAME 
		                        ,A4.VIO_CONT
		                        ,A3.INC_SP_NUM
		                        ,A4.INQ_ORD
		                    FROM 
		                        SJPB_INC_MAST A2
		                    JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
		                    JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
		                    LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
		                    group by A2.RCPT_NUM, A5.CODE_NAME, A4.VIO_CONT, A3.INC_SP_NUM, A4.INQ_ORD
		                ) A6
		                
		                GROUP BY A6.INC_SP_NUM, A6.RCPT_NUM
			)  A0 ON A.RCPT_NUM = A0.RCPT_NUM 
		    LEFT OUTER JOIN SJPB_INC_SP M ON M.INC_SP_NUM = A0.INC_SP_NUM
		    LEFT OUTER JOIN 
		    (
		        SELECT
		             AA6.RCPT_NUM       
		             ,AA6.INC_SP_NUM        
		             ,AA6.VIO_CLA
		            FROM
		            ( 
		                SELECT 
		                    A2.RCPT_NUM
		                    ,A3.INC_SP_NUM
		                    ,A4.ACT_VIO_CLA_NM AS VIO_CLA
		                FROM 
		                    SJPB_INC_MAST A2
		                JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
		                JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
		                group by A2.RCPT_NUM, A3.INC_SP_NUM, A4.ACT_VIO_CLA_NM
		            ) AA6
		    ) AA0 ON M.INC_SP_NUM = AA0.INC_SP_NUM
		    
		    LEFT OUTER JOIN 
		    (
		       SELECT
		            BB1.INC_SP_NUM
		            ,BB1.DIP_CONT
		            ,BB1.FN_AMT
		        FROM 
		            (
		                SELECT
		                    BBB1.INC_SP_NUM 
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.DIP_CONT, '', ' ',BBB2.DIP_CONT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS DIP_CONT
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.FN_AMT, '', ' ',BBB2.FN_AMT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS FN_AMT
		                FROM 
		                    SJPB_ACT_VIO BBB1
		                LEFT OUTER JOIN SJPB_INC_DIP_RST BBB2 ON BBB1.ACT_VIO_NUM = BBB2.ACT_VIO_NUM
		                GROUP BY BBB1.INC_SP_NUM
		            ) BB1
		    ) AAA0 ON M.INC_SP_NUM = AAA0.INC_SP_NUM
		    
		    LEFT OUTER JOIN 
		    (
		       SELECT
		            BB1.INC_SP_NUM
		            ,BB1.JDT_CONT
		        FROM 
		            (
		                SELECT
		                    BBB1.INC_SP_NUM 
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.JDT_CONT, '', ' ',BBB2.JDT_CONT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS JDT_CONT
		                FROM 
		                    SJPB_ACT_VIO BBB1
		                LEFT OUTER JOIN SJPB_INC_JDT_RST BBB2 ON BBB1.ACT_VIO_NUM = BBB2.ACT_VIO_NUM
		                GROUP BY BBB1.INC_SP_NUM
		            ) BB1
		    ) AAAA0 ON M.INC_SP_NUM = AAAA0.INC_SP_NUM
	        
	        
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_ITEM_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,B.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,B.INC_CRI_CMD_ITEM_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN CODEBASE D ON B.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY B.INC_CRI_CMD_ITEM_NUM ASC
	            ) Z
	        )Z0
	    ) CMD1 ON CMD1.RCPT_NUM = A.RCPT_NUM AND CMD1.RN = 1
	        
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_ITEM_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,B.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,B.INC_CRI_CMD_ITEM_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN CODEBASE D ON B.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY B.INC_CRI_CMD_ITEM_NUM ASC
	            ) Z
	        )Z0
	    ) CMD2 ON CMD2.RCPT_NUM = A.RCPT_NUM AND CMD2.RN = 2
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_ITEM_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,B.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,B.INC_CRI_CMD_ITEM_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN CODEBASE D ON B.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY B.INC_CRI_CMD_ITEM_NUM ASC
	            ) Z
	        )Z0
	    ) CMD3 ON CMD3.RCPT_NUM = A.RCPT_NUM AND CMD3.RN = 3
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_ITEM_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,B.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,B.INC_CRI_CMD_ITEM_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN CODEBASE D ON B.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY B.INC_CRI_CMD_ITEM_NUM ASC
	            ) Z
	        )Z0
	    ) CMD4 ON CMD4.RCPT_NUM = A.RCPT_NUM AND CMD4.RN = 4
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_ITEM_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,B.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,B.INC_CRI_CMD_ITEM_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN CODEBASE D ON B.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY B.INC_CRI_CMD_ITEM_NUM ASC
	            ) Z
	        )Z0
	    ) CMD5 ON CMD5.RCPT_NUM = A.RCPT_NUM AND CMD5.RN = 5
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF1 ON TRF1.RCPT_NUM = A.RCPT_NUM AND TRF1.RN = 1
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF2 ON TRF2.RCPT_NUM = A.RCPT_NUM AND TRF2.RN = 2
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF3 ON TRF3.RCPT_NUM = A.RCPT_NUM AND TRF3.RN = 3
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF4 ON TRF4.RCPT_NUM = A.RCPT_NUM AND TRF4.RN = 4
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF5 ON TRF5.RCPT_NUM = A.RCPT_NUM AND TRF5.RN = 5
	        
			WHERE
			    A.RCPT_TP_CD='2'
			    AND A.REG_USER_ID = DECODE(A.CRI_STAT_CD , '21', #criMbId#, '31', #criMbId#, A.REG_USER_ID)
			    <!-- AND AA.RCPT_STAT_CD = '1' -->
	            <!-- AND AA.PARE_RCPT_NUM IS NULL -->
			    <isNotEmpty  prepend=" AND " property="criTmSc">A.CRI_TM_ID = #criTmSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">A.RCPT_INC_NUM = #rcptIncNumSc# </isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criStatSc">A.CRI_STAT_CD = #criStatSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="sDateSc">A.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="eDateSc">A.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">B.TRF_NUM = #trfNumSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">L.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
		   	 	
		    ) FI
		    WHERE 1=1
		    <isNotEmpty  prepend=" AND " property="yearSc">FI.BASE_YEAR = #yearSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="spNmSc">SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		    ORDER BY FI.BASE_YEAR ASC, FI.SORT_INC_NUM ASC, FI.INQ_ORD ASC
	
	</select>
	
	
	<!-- 사건 리스트(범죄사건부 엑셀다운로드 , 팀장/서무) -->
	<select id="B0101.selectBkListForTeamLeader" resultMap="B0101VO.selectBkList"> /* B0101.selectBkListForTeamLeader */
	
	SELECT 
	    ROWNUM AS INDX
        ,FI.*
	FROM
			(
			SELECT
		        DECODE(B.INC_NUM, '', '', TO_NUMBER(SUBSTR(B.INC_NUM, 1, 4))) AS BASE_YEAR
		        ,A.RCPT_NUM AS RCPT_NUM	 /*시스템번호*/	
		        ,M.INC_SP_NUM           /*사건피의자번호*/ 
		        ,E.CODE_NAME AS FD_DESC   /*사건분야코드설명*/
		        ,H.CODE_NAME AS INFW_DESC /*사건유입구분코드설명*/
		        ,NVL(TO_NUMBER(SUBSTR(B.INC_NUM, 6)),0) AS SORT_INC_NUM
		        ,TO_CHAR(A.BE_DT,'YYYY-MM-DD') AS BE_DT	 /*착수일자*/	 
		        ,I.CRI_TM_NM    /*수사팀*/
		        ,L.NM_KOR AS NM_KOR /*담당수사관*/
		        ,M.SP_NM				/*피의자명*/
		        ,M.SP_ID_NUM	/*피의자식별번호*/
		        ,M.SP_ADDR			/*주소*/
		        ,M.SP_BSNS_NM			/*업소명*/
		        ,A0.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC   /*관련법률및죄명*/
		     	 ,A0.VIO_CONT AS VIO_CONT   /*위반내용*/
		         ,AA0.VIO_CLA AS VIO_CLA   /*위반조항*/
		         ,B.CRI_DT AS CRI_DT      /*범죄일시*/
		         ,B.INC_OCCR_AREA_ADDR  /*범죄장소*/
		         ,F.CODE_NAME AS DV_FORM_DESC    /*발각형태설명*/
		        ,G.CODE_NAME AS CHA_ITT_DESC      /*고발기관*/
	            
	            ,TO_CHAR(CMD1.CRI_CMD_PRO_DT,'YYYY-MM-DD')  AS CRI_CMD_PRO_DT1   /*수사지휘건의일1*/
	            ,CMD1.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC1   /*담당지검설명1*/
	            ,TO_CHAR(CMD2.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT2    /*수사지휘건의일2*/
	            ,CMD2.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC2   /*담당지검설명2*/
	            ,TO_CHAR(CMD3.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT3    /*수사지휘건의일3*/
	            ,CMD3.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC3   /*담당지검설명3*/
	            ,TO_CHAR(CMD4.CRI_CMD_PRO_DT,'YYYY-MM-DD')  AS CRI_CMD_PRO_DT4    /*수사지휘건의일4*/
	            ,CMD4.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC4   /*담당지검설명4*/
	            ,TO_CHAR(CMD5.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS CRI_CMD_PRO_DT5    /*수사지휘건의일5*/
	            ,CMD5.RESP_DPPO_CD_DESC AS CMD_RESP_DPPO_CD_DESC5   /*담당지검설명5*/
	            
	            ,TO_CHAR(TRF1.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT1    /*송치건의일1*/
	            ,TRF1.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC1   /*담당지검설명1*/
	            ,TRF1.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC1 /*송치완료설명1*/
	            ,TO_CHAR(TRF2.TRF_PRO_DT,'YYYY-MM-DD')AS TRF_PRO_DT2   /*송치건의일2*/
	            ,TRF2.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC2   /*담당지검설명2*/
	            ,TRF2.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC2 /*송치완료설명2*/
	            ,TO_CHAR(TRF3.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT3    /*송치건의일3*/
	            ,TRF3.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC3   /*담당지검설명3*/
	            ,TRF3.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC3 /*송치완료설명3*/
	            ,TO_CHAR(TRF4.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT4    /*송치건의일4*/
	            ,TRF4.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC4   /*담당지검설명4*/
	            ,TRF4.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC4 /*송치완료설명4*/
	            ,TO_CHAR(TRF5.TRF_PRO_DT,'YYYY-MM-DD') AS TRF_PRO_DT5   /*송치건의일5*/
	            ,TRF5.RESP_DPPO_CD_DESC AS TRF_RESP_DPPO_CD_DESC5   /*담당지검설명5*/
	            ,TRF5.INC_TRF_BK_STAT_CD AS INC_TRF_BK_STAT_CD_DESC5 /*송치완료설명5*/
	            
		        ,TO_CHAR(M.PO_DIP_DT,'YYYY-MM-DD')  AS PO_DIP_DT /*검찰처분일시*/
		        ,AAA0.DIP_CONT  /*처분내용*/
		        ,AAA0.FN_AMT    /*벌금액*/
		        ,M.CRLW_NUM     /*형제번호*/
		        ,TO_CHAR(M.JDT_FI_DT,'YYYY-MM-DD') AS JDT_FI_DT /*판결확정일시*/
		        ,AAAA0.JDT_CONT /*판결내용*/
		        ,M.INQ_ORD  /*피의자 정렬 순서*/
		        ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		        <!-- 필요하지않지만, 나중에 .. 
		     ,A.RCPT_INC_NUM	 /*접수사건번호*/	
		     ,A.RCPT_TP_CD	 /*접수유형코드*/	
		     ,A.CRI_STAT_CD	 /*수사상태코드*/	
		     ,A.CRI_TM_ID	 /*수사팀계정*/	 
		     ,A.DV_FORM	 /*발각형태*/	 
		     ,A.ED_DT	 /*종결일자*/	 
		     ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
		     ,A.REG_USER_ID	 /*등록자*/	 
		     ,A.REG_DATE	 /*등록일자*/	 
		     ,A.UPD_USER_ID	 /*수정자*/	 
		     ,A.UPD_DATE	 /*수정일자*/	 
		     ,C.CODE_NAME AS CRI_STAT_DESC   /*수사상태설명*/
		     ,D.CODE_NAME AS RCPT_TP_DESC   /*접수유형코드설명*/
		     ,B.TRF_NUM AS TRF_NUM  /*송치번호*/
		     ,L.USER_ID AS CRI_MB_MAIN_USER_ID
		     ,B.INC_NUM
		     , DECODE(A.COMB_INC_YN, 'Y', DECODE(A.PARE_RCPT_NUM, NULL, B.INC_NUM, 
	           		( SELECT INC_NUM FROM SJPB_INC_DTS WHERE RCPT_NUM = A.PARE_RCPT_NUM)
	        		), '') AS PARE_INC_NUM
	        		 -->
		        
			FROM SJPB_INC_MAST A
			JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
			LEFT OUTER JOIN CODEBASE C ON A.CRI_STAT_CD = C.CODE AND C.CODE_ID = 'SJPB_00001'
			LEFT OUTER JOIN CODEBASE D ON A.RCPT_TP_CD = D.CODE AND D.CODE_ID = 'SJPB_00003'
			LEFT OUTER JOIN CODEBASE E ON A.FD_CD = E.CODE AND E.CODE_ID = 'SJPB_00002'
			LEFT OUTER JOIN CODEBASE F ON A.DV_FORM = F.CODE AND F.CODE_ID = 'SJPB_00004'
		    LEFT OUTER JOIN CODEBASE G ON B.CHA_ITT = G.CODE AND G.CODE_ID = 'SJPB_00010'
		    LEFT OUTER JOIN CODEBASE H ON A.INFW_DIV = H.CODE AND H.CODE_ID = 'SJPB_00025'
			LEFT OUTER JOIN SJPB_CRI_TM I ON A.CRI_TM_ID = I.CRI_TM_ID 
			LEFT OUTER JOIN SJPB_INC_CRI_MB J ON A.RCPT_NUM = J.RCPT_NUM AND J.CRI_LV_CD = '01'
			LEFT OUTER JOIN USERPASS L ON J.CRI_MB_ID = L.USER_ID
			LEFT OUTER JOIN 
			(
		            SELECT
		                 A6.RCPT_NUM       
		                 ,A6.INC_SP_NUM        
		                 ,REGEXP_REPLACE(LISTAGG(DECODE(A6.CODE_NAME, '', ' ',A6.CODE_NAME) ,  '\r\n') WITHIN GROUP(ORDER BY A6.INC_SP_NUM,A6.INQ_ORD), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
		                 ,REGEXP_REPLACE(LISTAGG(DECODE(A6.VIO_CONT, '', ' ',A6.VIO_CONT),  '\r\n') WITHIN GROUP(ORDER BY A6.INC_SP_NUM,A6.INQ_ORD), '([^,]+)(,\1)+', '\1') AS VIO_CONT 
		                FROM
		                ( 
		                    SELECT 
		                        A2.RCPT_NUM
		                        ,A5.CODE_NAME 
		                        ,A4.VIO_CONT
		                        ,A3.INC_SP_NUM
		                        ,A4.INQ_ORD
		                    FROM 
		                        SJPB_INC_MAST A2
		                    JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
		                    JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
		                    LEFT OUTER JOIN CODEBASE A5 ON A4.RLT_ACT_CRI_NM_CD = A5.CODE AND A5.CODE_ID = 'SJPB_00012'
		                    group by A2.RCPT_NUM, A5.CODE_NAME, A4.VIO_CONT, A3.INC_SP_NUM, A4.INQ_ORD
		                ) A6
		                
		                GROUP BY A6.INC_SP_NUM, A6.RCPT_NUM
			)  A0 ON A.RCPT_NUM = A0.RCPT_NUM 
		    LEFT OUTER JOIN SJPB_INC_SP M ON M.INC_SP_NUM = A0.INC_SP_NUM
		    LEFT OUTER JOIN 
		    (
		        SELECT
		             AA6.RCPT_NUM       
		             ,AA6.INC_SP_NUM        
		             ,AA6.VIO_CLA
		            FROM
		            ( 
		                SELECT 
		                    A2.RCPT_NUM
		                    ,A3.INC_SP_NUM
		                    ,A4.ACT_VIO_CLA_NM AS VIO_CLA
		                FROM 
		                    SJPB_INC_MAST A2
		                JOIN SJPB_INC_SP A3 ON A2.RCPT_NUM = A3.RCPT_NUM AND A3.SP_STAT_CD = '1'  
		                JOIN SJPB_ACT_VIO A4 ON A3.INC_SP_NUM = A4.INC_SP_NUM AND A4.ACT_VIO_STAT_CD = '1'
		                
		                group by A2.RCPT_NUM, A3.INC_SP_NUM
		            ) AA6
		    ) AA0 ON M.INC_SP_NUM = AA0.INC_SP_NUM
		    
		    LEFT OUTER JOIN 
		    (
		       SELECT
		            BB1.INC_SP_NUM
		            ,BB1.DIP_CONT
		            ,BB1.FN_AMT
		        FROM 
		            (
		                SELECT
		                    BBB1.INC_SP_NUM 
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.DIP_CONT, '', ' ',BBB2.DIP_CONT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS DIP_CONT
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.FN_AMT, '', ' ',BBB2.FN_AMT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS FN_AMT
		                FROM 
		                    SJPB_ACT_VIO BBB1
		                LEFT OUTER JOIN SJPB_INC_DIP_RST BBB2 ON BBB1.ACT_VIO_NUM = BBB2.ACT_VIO_NUM
		                GROUP BY BBB1.INC_SP_NUM
		            ) BB1
		    ) AAA0 ON M.INC_SP_NUM = AAA0.INC_SP_NUM
		    
		    LEFT OUTER JOIN 
		    (
		       SELECT
		            BB1.INC_SP_NUM
		            ,BB1.JDT_CONT
		        FROM 
		            (
		                SELECT
		                    BBB1.INC_SP_NUM 
		                    ,REGEXP_REPLACE(LISTAGG(DECODE(BBB2.JDT_CONT, '', ' ',BBB2.JDT_CONT) ,  '\r\n ') WITHIN GROUP(ORDER BY BBB2.ACT_VIO_NUM), '([^,]+)(, \1)+', '\1') AS JDT_CONT
		                FROM 
		                    SJPB_ACT_VIO BBB1
		                LEFT OUTER JOIN SJPB_INC_JDT_RST BBB2 ON BBB1.ACT_VIO_NUM = BBB2.ACT_VIO_NUM
		                GROUP BY BBB1.INC_SP_NUM
		            ) BB1
		    ) AAAA0 ON M.INC_SP_NUM = AAAA0.INC_SP_NUM
	        
	        
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_CRI_CMD_BK_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_BK C ON B.INC_CRI_CMD_BK_NUM = C.INC_CRI_CMD_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_CRI_CMD_BK_NUM ASC
	            ) Z
	        )Z0
	    ) CMD1 ON CMD1.RCPT_NUM = A.RCPT_NUM AND CMD1.RN = 1
	        
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_CRI_CMD_BK_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_BK C ON B.INC_CRI_CMD_BK_NUM = C.INC_CRI_CMD_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_CRI_CMD_BK_NUM ASC
	            ) Z
	        )Z0
	    ) CMD2 ON CMD2.RCPT_NUM = A.RCPT_NUM AND CMD2.RN = 2
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_CRI_CMD_BK_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_BK C ON B.INC_CRI_CMD_BK_NUM = C.INC_CRI_CMD_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_CRI_CMD_BK_NUM ASC
	            ) Z
	        )Z0
	    ) CMD3 ON CMD3.RCPT_NUM = A.RCPT_NUM AND CMD3.RN = 3
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_CRI_CMD_BK_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_BK C ON B.INC_CRI_CMD_BK_NUM = C.INC_CRI_CMD_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_CRI_CMD_BK_NUM ASC
	            ) Z
	        )Z0
	    ) CMD4 ON CMD4.RCPT_NUM = A.RCPT_NUM AND CMD4.RN = 4
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_CRI_CMD_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.CRI_CMD_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_CRI_CMD_BK_NUM
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_CRI_CMD_BK C ON B.INC_CRI_CMD_BK_NUM = C.INC_CRI_CMD_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_CRI_CMD_BK_NUM ASC
	            ) Z
	        )Z0
	    ) CMD5 ON CMD5.RCPT_NUM = A.RCPT_NUM AND CMD5.RN = 5
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF1 ON TRF1.RCPT_NUM = A.RCPT_NUM AND TRF1.RN = 1
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF2 ON TRF2.RCPT_NUM = A.RCPT_NUM AND TRF2.RN = 2
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF3 ON TRF3.RCPT_NUM = A.RCPT_NUM AND TRF3.RN = 3
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF4 ON TRF4.RCPT_NUM = A.RCPT_NUM AND TRF4.RN = 4
	    
	    LEFT OUTER JOIN 
	    (
	        SELECT
	            *
	        FROM 
	        (
	            SELECT 
	                ROW_NUMBER() OVER(PARTITION BY Z.RCPT_NUM ORDER BY Z.RCPT_NUM, Z.INC_TRF_BK_NUM) RN
	                ,Z.*
	            FROM 
	            (
	                SELECT
	                    A.RCPT_NUM
	                    ,C.TRF_PRO_DT
	                    ,D.CODE_NAME AS RESP_DPPO_CD_DESC
	                    ,C.INC_TRF_BK_NUM
	                    ,DECODE(C.INC_TRF_BK_STAT_CD, '02', '완료', '') AS INC_TRF_BK_STAT_CD
	                FROM SJPB_INC_MAST A 
	                LEFT OUTER JOIN SJPB_INC_TRF_ITEM B ON A.RCPT_NUM = B.RCPT_NUM
	                LEFT OUTER JOIN SJPB_INC_TRF_BK C ON B.INC_TRF_BK_NUM = C.INC_TRF_BK_NUM
	                LEFT OUTER JOIN CODEBASE D ON C.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'
	                ORDER BY C.INC_TRF_BK_NUM ASC
	            ) Z
	        )Z0
	    ) TRF5 ON TRF5.RCPT_NUM = A.RCPT_NUM AND TRF5.RN = 5
	        
			WHERE
			    A.RCPT_TP_CD='2'
	            AND A.FD_CD IN 
	            <isNotEmpty property="fdCdCodeList">
				  	<iterate property="fdCdCodeList" open="(" close=")" conjunction=",">
				  		#fdCdCodeList[].code#
				  	</iterate>
			  	</isNotEmpty>
			  	<isEmpty property="fdCdCodeList">
			  		('')
			  	</isEmpty>
			    AND A.REG_USER_ID = DECODE(A.CRI_STAT_CD , '21', #criMbId#, '31', #criMbId#, A.REG_USER_ID)
			    <!-- AND AA.RCPT_STAT_CD = '1' -->
	            <!-- AND AA.PARE_RCPT_NUM IS NULL -->
	            <isNotEmpty  prepend=" AND " property="fdCdSc">A.FD_CD = #fdCdSc#</isNotEmpty>
	            <isNotEmpty  prepend=" AND " property="infwDivSc">A.INFW_DIV = #infwDivSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criTmSc">A.CRI_TM_ID = #criTmSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="rcptIncNumSc">A.RCPT_INC_NUM = #rcptIncNumSc# </isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="criStatSc">A.CRI_STAT_CD = #criStatSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="dvFormSc">A.DV_FORM = #dvFormSc#</isNotEmpty>
			    <isNotEmpty  prepend=" AND " property="sDateSc">A.REG_DATE &gt;= #sDateSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="eDateSc">A.REG_DATE &lt;= TO_DATE(#eDateSc#, 'YYYY-MM-DD')+1</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="trfNumSc">B.TRF_NUM = #trfNumSc#</isNotEmpty>
		   	 	<isNotEmpty  prepend=" AND " property="criMbNmSc">L.NM_KOR LIKE '%'||#criMbNmSc#||'%'</isNotEmpty>
		   	 	
		    ) FI
		    WHERE 1=1
		    <isNotEmpty  prepend=" AND " property="yearSc">FI.BASE_YEAR = #yearSc#</isNotEmpty>
		    <isNotEmpty  prepend=" AND " property="spNmSc">SP_NM LIKE '%'||#spNmSc#||'%'</isNotEmpty>
		    ORDER BY FI.BASE_YEAR ASC, FI.SORT_INC_NUM ASC, FI.INQ_ORD ASC
	
	</select>
	
	
	
	<resultMap class="com.saltware.enface.sjpb.Z.service.CodeBaseVO" id="B0101VO.getMyFdCdList">
		<result property="code" column="CODE"/>
	</resultMap>
	<!-- 관련 분야코드 리스트 가져오기(팀장) -->
	<select id="B0101.getMyTeamFdCdList" resultMap="B0101VO.getMyFdCdList"> /* B0101.getMyTeamFdCdList */
		SELECT DISTINCT
		    B.CODE
		FROM SJPB_CRI_TM A
		LEFT OUTER JOIN CODEBASE B ON A.CRI_TM_ID = B.CODE_TAG1 AND B.CODE_ID = 'SJPB_00002'
		WHERE CRI_TM_ID = #criTmId#
		ORDER BY CODE ASC
	</select>
	
	<!-- 관련 분야코드 리스트 가져오기(과장) -->
	<select id="B0101.getMyDeptFdCdList" resultMap="B0101VO.getMyFdCdList"> /* B0101.getMyDeptFdCdList */
		SELECT DISTINCT
		    B.CODE
		FROM SJPB_CRI_TM A
		LEFT OUTER JOIN CODEBASE B ON A.CRI_TM_ID = B.CODE_TAG1 AND B.CODE_ID = 'SJPB_00002'
		WHERE CRI_TM_ID IN (
		    SELECT 
		        CRI_TM_ID
		    FROM SJPB_CRI_TM A
		    START WITH A.PARE_TM_ID = #criTmId#
		    CONNECT BY PRIOR A.CRI_TM_ID = A.PARE_TM_ID
		)
		AND CODE IS NOT NULL
		ORDER BY CODE ASC
	</select>

	<!-- 관련 분야코드 리스트 가져오기(과장대직) -->
	<select id="B0101.getMySubDeptFdCdList" resultMap="B0101VO.getMyFdCdList"> /* B0101.getMySubDeptFdCdList */
		SELECT DISTINCT
		    B.CODE
		FROM SJPB_CRI_TM A
		LEFT OUTER JOIN CODEBASE B ON A.CRI_TM_ID = B.CODE_TAG1 AND B.CODE_ID = 'SJPB_00002'
		WHERE CRI_TM_ID IN (
		    SELECT 
		        CRI_TM_ID
		    FROM SJPB_CRI_TM A
		    START WITH A.PARE_TM_ID = (SELECT PARE_TM_ID FROM SJPB_CRI_TM WHERE CRI_TM_ID = #criTmId#)
		    CONNECT BY PRIOR A.CRI_TM_ID = A.PARE_TM_ID
		)
		AND CODE IS NOT NULL
		ORDER BY CODE ASC
	</select>
	
	<!-- 사건이이력 상세내용 조회(팝업용) -->
	<select id="B0101.selectIncidentHistMfCont" resultMap="B0101VO.incMastHistList"> /* B0101.selectIncidentHistMfCont */
		    SELECT DISTINCT *
    FROM (    
        SELECT 
                A.RCPT_NUM AS RCPT_NUM /*접수번호*/	 
                 ,A.RCPT_INC_NUM	 /*접수사건번호*/	
                 ,A.RCPT_TP_CD	 /*접수유형코드*/	
                 ,A.CRI_STAT_CD	 /*수사상태코드*/	
                 ,A.FD_CD	 /*사건분야코드*/	 
                 ,A.CRI_TM_ID	 /*수사팀계정*/	 
                 ,A.DV_FORM	 /*발각형태*/	 
                 ,A.BE_DT	 /*착수일자*/	 
                 ,A.ED_DT	 /*종결일자*/	 
                 ,A.PARE_RCPT_NUM	 /*부모접수번호*/	 
                 ,A.COMB_INC_YN     /*병합사건여부*/
                 ,A.INFW_DIV        /*유입구분*/
                 ,A.RCPT_STAT_CD    /*접수상태코드*/
                 ,A.MF_CD           /*변경코드*/
                 ,A.MF_CONT         /*변경내용*/
                 ,A.INC_MF_NUM    /*사건수정번호*/
                 ,A.REG_USER_ID	 /*등록자*/	 
                 ,A.REG_DATE	 /*등록일자*/	 
                 ,A.UPD_USER_ID	 /*수정자*/	 
                 ,TO_CHAR(A.UPD_DATE,'YYYY-MM-DD HH24:mi:ss') AS UPD_DATE	 /*수정일자*/ 
                 ,C.NM_KOR      /*수정자*/
                 ,(CASE 
		            WHEN C.NM_KOR IS NOT NULL THEN C.NM_KOR||' ('||A.UPD_USER_ID||')'
		            ELSE  A.UPD_USER_ID END) AS UPD_USER_ID_NM   /*수정자설명*/
                 
            FROM SJPB_INC_MAST_HIST A
            JOIN SJPB_INC_DTS B ON A.RCPT_NUM = B.RCPT_NUM
            LEFT OUTER JOIN USERPASS C ON A.UPD_USER_ID = C.USER_ID
            WHERE A.RCPT_NUM = #rcptNum#
            AND A.RCPT_INC_NUM IS NOT NULL
            AND A.CRI_STAT_CD &gt;= 40
            AND A.CRI_STAT_CD NOT IN ('31')
            
           
        UNION 
            SELECT 
                AA.RCPT_NUM AS RCPT_NUM /*접수번호*/	 
                 ,AA.RCPT_INC_NUM	 /*접수사건번호*/	
                 ,AA.RCPT_TP_CD	 /*접수유형코드*/	
                 ,AA.CRI_STAT_CD	 /*수사상태코드*/	
                 ,AA.FD_CD	 /*사건분야코드*/	 
                 ,AA.CRI_TM_ID	 /*수사팀계정*/	 
                 ,AA.DV_FORM	 /*발각형태*/	 
                 ,AA.BE_DT	 /*착수일자*/	 
                 ,AA.ED_DT	 /*종결일자*/	 
                 ,AA.PARE_RCPT_NUM	 /*부모접수번호*/	 
                 ,AA.COMB_INC_YN     /*병합사건여부*/
                 ,AA.INFW_DIV        /*유입구분*/
                 ,AA.RCPT_STAT_CD    /*접수상태코드*/
                 ,AA.MF_CD           /*변경코드*/
                 ,AA.MF_CONT         /*변경내용*/
                 ,AA.INC_MF_NUM    /*사건수정번호*/
                 ,AA.REG_USER_ID	 /*등록자*/	 
                 ,AA.REG_DATE	 /*등록일자*/	 
                 ,AA.UPD_USER_ID	 /*수정자*/	 
                 ,TO_CHAR(AA.UPD_DATE,'YYYY-MM-DD HH24:mi:ss') AS UPD_DATE	 /*수정일자*/
                 ,CC.NM_KOR      /*수정자*/
                 ,(CASE 
                 	WHEN CC.NM_KOR IS NOT NULL THEN CC.NM_KOR||' ('||AA.UPD_USER_ID||')'
		            ELSE  AA.UPD_USER_ID END) AS UPD_USER_ID_NM   /*수정자설명*/
            FROM SJPB_INC_MAST AA
            JOIN SJPB_INC_DTS BB ON AA.RCPT_NUM = BB.RCPT_NUM
            LEFT OUTER JOIN USERPASS CC ON AA.UPD_USER_ID = CC.USER_ID
            WHERE AA.RCPT_NUM = #rcptNum#
            AND AA.RCPT_INC_NUM IS NOT NULL
            AND AA.CRI_STAT_CD &gt;= 40
        )
        WHERE INC_MF_NUM =#incMfNum#
    	AND MF_CD='02' AND ROWNUM = 1
    ORDER BY UPD_DATE ASC
	</select>
	
	<!-- 조회 이력 테이블 등록 -->
	<insert id="B0101.SJPB_INC_INQ_HIST.insert">
		INSERT INTO SJPB_INC_INQ_HIST(
			INQ_HIST_SI_NUM,
			HIST_DIV,
			RCPT_NUM,
			INC_SP_NUM,
			INQ_USER_ID,
			INQ_DT
		)
		VALUES(
			(SELECT SEQ+1 FROM KEYGEN WHERE entity_name = 'SJPB_INC_INQ_HIST.INQ_HIST_SI_NUM'),
			#histDiv#,
			#rcptNum#,
			NULL,
			#userId#,
		    SYSDATE
		)
	</insert>
	

	<!-- 피의자 -->
	<resultMap id="B0101.IncSpVO" class="com.saltware.enface.sjpb.Z.service.IncSpVO">
		<result property="incSpNum" column="INC_SP_NUM" />
		<result property="rcptNum" column="RCPT_NUM" />
		<result property="spTpCd" column="SP_TP_CD" />
		<result property="spIdNum" column="SP_ID_NUM" />
		<result property="indvCorpDiv" column="INDV_CORP_DIV" />
		<result property="homcForcPernDiv" column="HOMC_FORC_PERN_DIV" />
		<result property="gendDiv" column="GEND_DIV" />
		<result property="spNm" column="SP_NM" />
		<result property="spAddr" column="SP_ADDR" />
		<result property="spCnttNum" column="SP_CNTT_NUM" />
		<result property="incSpComn" column="INC_SP_COMN" />
		<result property="inqOrd" column="INQ_ORD" />
		
		<result property="spInqCd" column="SP_INQ_CD"/>
		<result property="cathWrnt" column="CATH_WRNT"/>
		<result property="emgyCath" column="EMGY_CATH"/>
		<result property="flgtOfdrCath" column="FLGT_OFDR_CATH"/>
		<result property="arstWrnt" column="ARST_WRNT"/>
		<result property="inchDetn" column="INCH_DETN"/>
		
		<result property="spJob" column="SP_JOB" />
		<result property="spBsnsNm" column="SP_BSNS_NM" />
		
		<result property="regUserId" column="REG_USER_ID" />
		<result property="regDate" column="REG_DATE" />
		<result property="updUserId" column="UPD_USER_ID" />
		<result property="updDate" column="UPD_DATE" />

		<result property="spTpCdDesc" column="SP_TP_CD_DESC" />
		<result property="indvCorpDivDesc" column="INDV_CORP_DIV_DESC" />
		<result property="homcForcPernDivDesc" column="HOMC_FORC_PERN_DIV_DESC" />
		<result property="gendDivDesc" column="GEND_DIV_DESC" />

		<result property="incNum" column="INC_NUM" />
		
		<result property="crlwNum" column="CRLW_NUM"/>
		<result property="poDipDt" column="PO_DIP_DT"/>
		<result property="jdtFiDt" column="JDT_FI_DT"/>
		
		<result property="actVioClaNmList" column="ACT_VIO_CLA_NM_LIST"/>
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD"/>
		<result property="actVioNum" column="ACT_VIO_NUM"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
	</resultMap>
	<!-- 사건정보 가져오기 --> 	
	<select id="B0101.selectSuspectStat" resultMap="B0101.IncSpVO">	/* B0101.selectSuspectStat */
		<![CDATA[			
			SELECT 
				DISTINCT Q.ACT_VIO_NUM
			 	,A.INC_SP_NUM              /*사건피의자번호*/
                ,A.RCPT_NUM               /*접수번호*/
                ,A.SP_TP_CD               /*피의자유형코드*/
                ,A.SP_ID_NUM	/*피의자식별번호*/
                ,A.INDV_CORP_DIV          /*법인개인구분*/
                ,A.HOMC_FORC_PERN_DIV     /*내외국인구분*/
                ,A.GEND_DIV               /*성별구분*/
                ,A.SP_NM				/*피의자명*/
                ,A.SP_ADDR			/*주소*/
                ,A.SP_CNTT_NUM 	/*연락처*/
                ,A.INC_SP_COMN            /*사건피의자참고사항*/
                ,A.INQ_ORD                /*조회순서*/
                ,A.SP_JOB				/*직업*/
                ,A.SP_BSNS_NM		/*업소명*/
                ,A.SP_INQ_CD	/*피의자조회코드*/
                ,A.CATH_WRNT	/*체포영장*/
                ,A.EMGY_CATH	/*긴급체포*/
                ,A.FLGT_OFDR_CATH	/*현행범인체포*/
                ,A.ARST_WRNT	/*구속영장*/
                ,A.INCH_DETN	/*인치구금*/
                ,A.CRLW_NUM		/*형제번호*/
                ,A.PO_DIP_DT	/*검사처분일시*/
                ,A.JDT_FI_DT	/*판결확정일시*/
                ,A.REG_USER_ID            /*등록자*/
                ,A.REG_DATE               /*등록일자*/
                ,A.UPD_USER_ID            /*수정자*/
                ,A.UPD_DATE               /*수정일자*/
                ,B.CODE_NAME AS SP_TP_CD_DESC   /*피의자유형코드설명*/
                ,C.CODE_NAME AS INDV_CORP_DIV_DESC   /*피의자유형코드설명*/
                ,D.CODE_NAME AS HOMC_FORC_PERN_DIV_DESC   /*내외국인설명*/
                ,E.CODE_NAME AS GEND_DIV_DESC   /*성별설명*/
                ,G.INC_NUM					/*사건번호*/
                ,X.ACT_VIO_CLA_NM_LIST AS ACT_VIO_CLA_NM_LIST
                
                ,Q.RLT_ACT_CRI_NM_CD
                ,R.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC
			FROM SJPB_INC_SP A		
			LEFT OUTER JOIN CODEBASE B ON A.SP_TP_CD = B.CODE AND B.CODE_ID = 'SJPB_00006'	
			LEFT OUTER JOIN CODEBASE C ON A.INDV_CORP_DIV = C.CODE AND C.CODE_ID = 'SJPB_00007'	
			LEFT OUTER JOIN CODEBASE D ON A.HOMC_FORC_PERN_DIV = D.CODE AND D.CODE_ID = 'SJPB_00008'	
			LEFT OUTER JOIN CODEBASE E ON A.GEND_DIV = E.CODE AND E.CODE_ID = 'SJPB_00009'
			LEFT OUTER JOIN SJPB_INC_MAST F ON A.RCPT_NUM = F.RCPT_NUM
			JOIN SJPB_INC_DTS G ON A.RCPT_NUM = G.RCPT_NUM
			LEFT JOIN SJPB_ACT_VIO Q ON A.INC_SP_NUM = Q.INC_SP_NUM AND Q.ACT_VIO_STAT_CD = '1'
            LEFT OUTER JOIN CODEBASE M ON Q.RLT_ACT_CRI_NM_CD = M.CODE AND M.CODE_ID = 'SJPB_00012'  
            LEFT JOIN (SELECT B.ACT_VIO_CLA_NM AS ACT_VIO_CLA_NM_LIST,B.ACT_VIO_NUM 
                       FROM SJPB_ACT_VIO B 
                       )X ON X.ACT_VIO_NUM  = Q.ACT_VIO_NUM 
            LEFT OUTER JOIN CODEBASE R ON Q.RLT_ACT_CRI_NM_CD = R.CODE AND R.CODE_ID = 'SJPB_00012'
			WHERE 
				A.SP_TP_CD = '2'
				AND A.SP_STAT_CD = '1' AND Q.ACT_VIO_NUM IS NOT NULL
			START WITH F.RCPT_NUM = #rcptNum#
            CONNECT BY PRIOR F.RCPT_NUM = F.PARE_RCPT_NUM  
			ORDER BY A.RCPT_NUM ,
			         Q.RLT_ACT_CRI_NM_CD,
			         A.INC_SP_NUM,
			         A.INQ_ORD ASC  
		]]>
	</select>
	
	<!-- 법률위반 -->
	<resultMap id="B0101.ActVioVO" class="com.saltware.enface.sjpb.Z.service.ActVioVO">
		<result property="incSpNum" column="INC_SP_NUM" />
		<result property="rcptNum" column="RCPT_NUM" />
		<result property="actVioNum" column="ACT_VIO_NUM" />
		<result property="rltActCriNmCd" column="RLT_ACT_CRI_NM_CD" />
		<result property="vioCont" column="VIO_CONT" />
		<result property="regUserId" column="REG_USER_ID" />
		<result property="regDate" column="REG_DATE" />
		<result property="updUserId" column="UPD_USER_ID" />
		<result property="updDate" column="UPD_DATE" />

		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC" />
	</resultMap>
	<!-- 법률위반정보 가져오기 -->
	<select id="B0101.SJPB_ACT_VIO.list" resultMap="B0101.ActVioVO">
		/* B0101.SJPB_ACT_VIO.list */
		<![CDATA[		
			SELECT 
			    A.INC_SP_NUM							/*사건피의자번호*/
			    ,C.RCPT_NUM								/*접수번호*/
			    ,A.ACT_VIO_NUM							/*법률위반번호*/
			    ,A.RLT_ACT_CRI_NM_CD					/*관련법률및죄명코드*/
			    ,A.VIO_CONT								/*위반내용*/
			    ,A.INQ_ORD								/*조회순서*/
			    ,A.REG_USER_ID							/*등록자*/
			    ,A.REG_DATE								/*등록일자*/
			    ,A.UPD_USER_ID							/*수정자*/
			    ,A.UPD_DATE								/*수정일자*/
			    ,B.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC	/*관련법률및죄명코드설명*/
			FROM SJPB_ACT_VIO A
			LEFT OUTER JOIN CODEBASE B ON A.RLT_ACT_CRI_NM_CD = B.CODE AND B.CODE_ID = 'SJPB_00012'
			JOIN SJPB_INC_SP C ON C.INC_SP_NUM = A.INC_SP_NUM AND C.SP_STAT_CD = '1'
			WHERE A.ACT_VIO_NUM = #actVioNum#
				AND A.ACT_VIO_STAT_CD = '1'
			ORDER BY A.INQ_ORD ASC
		]]>
	</select>
	<resultMap id="code.name" class="com.saltware.enface.sjpb.Z.service.CodeBaseVO">
		<result property="code" column="CODE" />
		<result property="codeName" column="CODE_NAME" />
	</resultMap>
	<select id="B0101.mfCdCodeList" resultMap="code.name">
		SELECT CODE,CODE_NAME
    	FROM CODEBASE
    	WHERE CODE_ID='SJPB_00032' AND CODE NOT IN('0000000000','02')
	</select>
	
	<!-- 상세 사건 지휘부 아이템 (아이템단위) -->	
	<resultMap id="B0101.IncCriCmdItemVO.criCmdItemDetails" class="com.saltware.enface.sjpb.Z.service.IncCriCmdItemVO">
		<result property="incCriCmdItemNum" column="INC_CRI_CMD_ITEM_NUM"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="respDppoCd" column="RESP_DPPO_CD"/>
		<result property="respDppoDesc" column="RESP_DPPO_DESC"/>
		<result property="incCriCmdItemStatCd" column="INC_CRI_CMD_ITEM_STAT_CD"/>
		<result property="incCriCmdItemDesc" column="INC_CRI_CMD_ITEM_DESC"/>
		<result property="reCmdYn" column="RE_CMD_YN"/>
		<result property="criCmdProDt" column="CRI_CMD_PRO_DT"/>
		<result property="criCmdTranDt" column="CRI_CMD_TRAN_DT"/>
		<result property="criCmdReqDt" column="CRI_CMD_REQ_DT"/>
		<result property="criCmdRcptDt" column="CRI_CMD_RCPT_DT"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
		<result property="criCmdRst" column="CRI_CMD_RST"/>
		<result property="criCmdComn" column="CRI_CMD_COMN"/>
		<result property="criCmdReqComn" column="CRI_CMD_REQ_COMN"/>
	</resultMap>	
	
 	<select id="B0101.SJPB_INC_CRI_CMD_ITEM.selectCriItemList" resultMap="B0101.IncCriCmdItemVO.criCmdItemDetails">		/* B0101.SJPB_INC_CRI_CMD_ITEM.selectCriItemList */
		SELECT
		    A.INC_CRI_CMD_ITEM_NUM   					/*사건수사지휘건번호*/
			,A.RCPT_NUM               					/*접수번호*/
			,C.RCPT_INC_NUM          					/*접수사건번호*/
			,A.RESP_DPPO_CD           					/*담당지검코드*/
			,D.CODE_NAME AS RESP_DPPO_DESC 				/*담당지검명*/	
			,A.INC_CRI_CMD_ITEM_STAT_CD  					/*사건수사지휘건구분코드*/
			,E.CODE_NAME AS INC_CRI_CMD_ITEM_DESC			/*지휘건구분코드설명*/
			,A.RE_CMD_YN              					/*재지휘여부*/
			,A.CRI_CMD_RST								/* 지휘결과 */
			,A.CRI_CMD_COMN								/* 지휘의견 */
			,TO_CHAR(A.CRI_CMD_PRO_DT,'YYYY-MM-DD') AS  CRI_CMD_PRO_DT         /*수사지휘건의일*/
			,TO_CHAR(A.CRI_CMD_TRAN_DT,'YYYY-MM-DD') AS  CRI_CMD_TRAN_DT        /*수사지휘인계일*/      
			,TO_CHAR(A.CRI_CMD_REQ_DT,'YYYY-MM-DD') AS  CRI_CMD_REQ_DT         /*수사지휘접수일*/
			,TO_CHAR(A.CRI_CMD_RCPT_DT,'YYYY-MM-DD') AS  CRI_CMD_RCPT_DT        /*수사지휘수령일*/
			,A.REG_USER_ID
			,A.REG_DATE
			,A.UPD_USER_ID
			,A.UPD_DATE		
			,A.CRI_CMD_REQ_COMN
		FROM SJPB_INC_CRI_CMD_ITEM A
		JOIN SJPB_INC_MAST C ON A.RCPT_NUM = C.RCPT_NUM
		LEFT OUTER JOIN CODEBASE D ON A.RESP_DPPO_CD = D.CODE AND D.CODE_ID = 'SJPB_00005'  /*담당지검코드*/
		JOIN CODEBASE E ON E.CODE = A.INC_CRI_CMD_ITEM_STAT_CD AND E.CODE_ID='SJPB_00084'	
		WHERE A.RCPT_NUM=#rcptNum#
		ORDER BY A.INC_CRI_CMD_ITEM_NUM	
	</select>
	
	<!-- 상세 사건 지휘내역 (피의자 단위) -->	
	<resultMap id="B0101.IncCriCmdItemVO.spDetails" class="com.saltware.enface.sjpb.Z.service.IncCriCmdItemVO">
		<result property="incCriCmdItemNum" column="INC_CRI_CMD_ITEM_NUM"/>
		<result property="incCriCmdBkNum" column="INC_CRI_CMD_BK_NUM"/>
		<result property="rcptNum" column="RCPT_NUM"/>
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="incCriCmdItemStatCd" column="INC_CRI_CMD_ITEM_STAT_CD"/>
		<result property="incCriCmdBkStatCd" column="INC_CRI_CMD_BK_STAT_CD"/>
		<result property="incCriCmdItemDesc" column="INC_CRI_CMD_ITEM_DESC"/>
		<result property="criCmdTranDt" column="CRI_CMD_TRAN_DT"/>
		<result property="criCmdReqDt" column="CRI_CMD_REQ_DT"/>
		<result property="criCmdRcptDt" column="CRI_CMD_RCPT_DT"/>
		<result property="reCmdYn" column="RE_CMD_YN"/>
		<result property="criCmdRst" column="CRI_CMD_RST"/>
		<result property="criCmdComn" column="CRI_CMD_COMN"/>
		<result property="incSpNum" column="INC_SP_NUM"/>
		<result property="spNm" column="SP_NM"/>
		<result property="incCriNm" column="INC_CRI_NM"/>
		<result property="regUserId" column="REG_USER_ID"/>
		<result property="regDate" column="REG_DATE"/>
		<result property="updUserId" column="UPD_USER_ID"/>
		<result property="updDate" column="UPD_DATE"/>
	</resultMap>
		
	<select id="B0101.SJPB_INC_CRI_CMD_BK.selectSpDetails" resultMap="B0101.IncCriCmdItemVO.spDetails"> 	/* B0101.SJPB_INC_CRI_CMD_BK.selectSpDetails */
		SELECT
			 B.INC_CRI_CMD_ITEM_NUM   /*사건수사지휘건번호*/
			,A.INC_CRI_CMD_BK_NUM     /*사건수사지휘부번호*/
			,B.RCPT_NUM               /*접수번호*/
			,C.RCPT_INC_NUM           /*접수사건번호*/	
			,B.INC_CRI_CMD_ITEM_STAT_CD  /*사건수사지휘건상태코드*/
			,A.INC_CRI_CMD_BK_STAT_CD		/*지휘부 구분코드*/
			,D.CODE_NAME AS INC_CRI_CMD_ITEM_DESC	/*지휘건구분코드설명*/
			,TO_CHAR(B.CRI_CMD_TRAN_DT,'YYYY-MM-DD') AS  CRI_CMD_TRAN_DT        /*수사지휘인계일*/      
			,TO_CHAR(B.CRI_CMD_REQ_DT,'YYYY-MM-DD') AS  CRI_CMD_REQ_DT         /*수사지휘접수일*/
			,TO_CHAR(B.CRI_CMD_RCPT_DT,'YYYY-MM-DD') AS  CRI_CMD_RCPT_DT        /*수사지휘수령일*/
			,B.RE_CMD_YN              /*재지휘여부*/
			,A.CRI_CMD_RST            /*수사지휘결과*/
			,A.CRI_CMD_COMN           /*수사지휘의견*/
			,A.INC_SP_NUM			/*피의자번호*/
			,E.SP_NM             /*사건피의자*/
			,F.INC_CRI_NM AS INC_CRI_NM                 /*사건죄명*/
			,B.REG_USER_ID
			,B.REG_DATE
			,B.UPD_USER_ID
			,B.UPD_DATE			
		FROM SJPB_INC_CRI_CMD_BK A
		JOIN SJPB_INC_CRI_CMD_ITEM B ON A.INC_CRI_CMD_ITEM_NUM = B.INC_CRI_CMD_ITEM_NUM
		JOIN SJPB_INC_MAST C ON B.RCPT_NUM = C.RCPT_NUM
		JOIN CODEBASE D ON D.CODE = B.INC_CRI_CMD_ITEM_STAT_CD AND D.CODE_ID='SJPB_00084'
	  	LEFT OUTER JOIN(	
	  						SELECT A.INC_SP_NUM
					              ,REGEXP_REPLACE(LISTAGG(C.CODE_NAME,',') WITHIN GROUP (ORDER BY A.INC_SP_NUM),'([^,]+)(,\1)+','\1')  AS INC_CRI_NM
					        FROM SJPB_INC_SP A
					        JOIN SJPB_ACT_VIO B ON A.INC_SP_NUM = B.INC_SP_NUM
					        JOIN CODEBASE C ON C.CODE = B.RLT_ACT_CRI_NM_CD AND C.CODE_ID = 'SJPB_00012' 
					        GROUP BY A.INC_SP_NUM
		     	 		) F ON F.INC_SP_NUM = A.INC_SP_NUM  
   		LEFT JOIN SJPB_INC_SP E ON E.INC_SP_NUM = F.INC_SP_NUM	
   		WHERE A.INC_CRI_CMD_ITEM_NUM = #incCriCmdItemNum#
		ORDER BY A.INC_CRI_CMD_BK_NUM	
	</select>
	
	<update id="B0101.SJPB_INC_CRI_CMD_BK.insert">	/* B0101.SJPB_INC_CRI_CMD_BK.insert */
		INSERT INTO SJPB_INC_CRI_CMD_BK (
		    INC_CRI_CMD_BK_NUM,
		    INC_CRI_CMD_ITEM_NUM,
		    INC_SP_NUM,
		    INC_CRI_CMD_BK_PUBL_YR,
		    INC_CRI_CMD_BK_STAT_CD,
		    RESP_TRF_OFFI,
		    REG_USER_ID,
		    REG_DATE,
		    UPD_USER_ID,
		    UPD_DATE,
		    CRI_CMD_TRAN_DT,
		    CRI_CMD_REQ_DT,
		    CRI_CMD_RCPT_DT,
		    RE_CMD_YN
		) VALUES (
		    #incCriCmdBkNum#,
		    #incCriCmdItemNum#,
		    #incSpNum#,
		    TO_CHAR(SYSDATE,'YYYY'),
		    #incCriCmdBkStatCd#,	    
		    '',  
		    #regUserId#,
		    SYSDATE,
		    #regUserId#,
		    SYSDATE,
		    TO_DATE(#criCmdTranDt#,'YYYY-MM-DD'),
		    TO_DATE(#criCmdReqDt#,'YYYY-MM-DD'),
		    TO_DATE(#criCmdRcptDt#,'YYYY-MM-DD'),
		    #reCmdYn#
		)
	</update>
	
	<update id="B0101.SJPB_INC_CRI_CMD_ITEM.insert">		/* B0101.SJPB_INC_CRI_CMD_ITEM.insert */
		INSERT INTO SJPB_INC_CRI_CMD_ITEM (
		    INC_CRI_CMD_ITEM_NUM,
		    RCPT_NUM,
		    INC_CRI_CMD_ITEM_STAT_CD,
		    RESP_DPPO_CD,
		    CRI_CMD_PRO_DT,
		    CRI_CMD_TRAN_DT,
		    CRI_CMD_REQ_DT,
		    CRI_CMD_RCPT_DT,
		    RE_CMD_YN,
		    CRI_CMD_RST,
		    CRI_CMD_COMN,
		    INC_ARRT_CLSF,
		    EVID_ARTC_YN,
		    REG_USER_ID,
		    REG_DATE,
		    UPD_USER_ID,
		    UPD_DATE,
		    CRI_CMD_REQ_COMN
		) VALUES (
		    #incCriCmdItemNum#,
		    #rcptNum#,
		    #incCriCmdItemStatCd#,
		    #respDppoCd#,
		    TO_DATE(#criCmdProDt#,'YYYY-MM-DD'),
		    TO_DATE(#criCmdTranDt#,'YYYY-MM-DD'),
		    TO_DATE(#criCmdReqDt#,'YYYY-MM-DD'),
		    TO_DATE(#criCmdRcptDt#,'YYYY-MM-DD'),
		    #reCmdYn#,
		    '',
		    '',
		    '',
		    '',
		    #regUserId#,
		    SYSDATE,
		    #regUserId#,
		    SYSDATE,
		    #criCmdReqComn#
		)
	</update>
	
	<update id="B0101.SJPB_INC_CRI_CMD_BK.update">	/* B0101.SJPB_INC_CRI_CMD_BK.update */
		UPDATE SJPB_INC_CRI_CMD_BK 
		SET CRI_CMD_RST = #criCmdRst#
			,CRI_CMD_COMN = #criCmdComn#
			,CRI_CMD_TRAN_DT = TO_DATE(#criCmdTranDt#,'YYYY-MM-DD')
		    ,CRI_CMD_REQ_DT = TO_DATE(#criCmdReqDt#,'YYYY-MM-DD')
		    ,CRI_CMD_RCPT_DT = TO_DATE(#criCmdRcptDt#,'YYYY-MM-DD')
			,UPD_USER_ID = #updUserId#
		    ,UPD_DATE = SYSDATE
		WHERE INC_CRI_CMD_BK_NUM = #incCriCmdBkNum#
	</update>
	
	<update id="B0101.SJPB_INC_CRI_CMD_ITEM.update">		/* B0101.SJPB_INC_CRI_CMD_ITEM.update */
		UPDATE SJPB_INC_CRI_CMD_ITEM 
		SET CRI_CMD_PRO_DT = TO_DATE(#criCmdProDt#,'YYYY-MM-DD')
		    ,CRI_CMD_TRAN_DT = TO_DATE(#criCmdTranDt#,'YYYY-MM-DD')
		    ,CRI_CMD_REQ_DT = TO_DATE(#criCmdReqDt#,'YYYY-MM-DD')
		    ,CRI_CMD_RCPT_DT = TO_DATE(#criCmdRcptDt#,'YYYY-MM-DD')
		    ,CRI_CMD_COMN = #criCmdComn#
		    ,CRI_CMD_REQ_COMN = #criCmdReqComn#
		    ,UPD_USER_ID = #updUserId#
		    ,UPD_DATE = SYSDATE
		WHERE INC_CRI_CMD_ITEM_NUM = #incCriCmdItemNum#
	</update>
	<update id="B0101.SJPB_INC_CRI_CMD_ITEM.updateTask">		/* B0101.SJPB_INC_CRI_CMD_ITEM.updateTask */
		UPDATE SJPB_INC_CRI_CMD_ITEM 
		SET CRI_CMD_PRO_DT = TO_DATE(#criCmdProDt#,'YYYY-MM-DD')
		    ,CRI_CMD_TRAN_DT = TO_DATE(#criCmdTranDt#,'YYYY-MM-DD')
		    ,CRI_CMD_REQ_DT = TO_DATE(#criCmdReqDt#,'YYYY-MM-DD')
		    ,CRI_CMD_RCPT_DT = TO_DATE(#criCmdRcptDt#,'YYYY-MM-DD')
		    ,CRI_CMD_RST = #criCmdRst#
		    ,CRI_CMD_COMN = #criCmdComn#
		    ,CRI_CMD_REQ_COMN = #criCmdReqComn#
		    ,UPD_USER_ID = #updUserId#
		    ,UPD_DATE = SYSDATE
		WHERE INC_CRI_CMD_ITEM_NUM = #incCriCmdItemNum#
	</update>
	
	<!-- 사건송치부  마스터  추가 -->
	<insert id="B0101.SJPB_INC_TRF_ITEM.insert">  /* B0101.SJPB_INC_TRF_ITEM.insert */
		<![CDATA[		
			INSERT INTO SJPB_INC_TRF_ITEM (
				INC_TRF_ITEM_NUM
				,INC_TRF_BK_NUM
				,RCPT_NUM
				,RESP_DPPO_CD
    			,TRF_PRO_DT
				,TRF_TRAN_DT
				,TRF_REQ_DT
				,TRF_RCPT_DT
				,RE_TRF_YN
				,TRF_RST
				,TRF_COMN
				,INC_ARRT_CLSF
				,EVID_ARTC_YN
				,REG_USER_ID
				,REG_DATE
				,UPD_USER_ID
				,UPD_DATE
				,TRF_NUM
				) 
			VALUES 	(
		 		#incTrfItemNum#
				, #incTrfBkNum#
				, #rcptNum#
				, #respDppoCd#
				, TO_DATE(#trfProDt#,'YYYY-MM-DD')
				, TO_DATE(#trfTranDt#,'YYYY-MM-DD')
				, TO_DATE(#trfReqDt#,'YYYY-MM-DD')
				, TO_DATE(#trfRcptDt#,'YYYY-MM-DD')
				, #reTrfYn#
				, #trfRst#
				, #trfComn#
				, ''
				, ''
			    , #regUserId#
			    , SYSDATE
			    , #regUserId#
			    , SYSDATE
			    ,TO_CHAR(SYSDATE,'YYYY') || '-' || (SELECT SEQ+1 FROM KEYGEN WHERE entity_name = 'SJPB_INC_TRF_ITEM.TRF_NUM')
			    )			
		]]>
	</insert>	
	<!-- 사건송치부  아이템 갱신 -->
	<update id="B0101.SJPB_INC_TRF_ITEM.updateTask">  /* B0101.SJPB_INC_TRF_ITEM.updateTask */
		<![CDATA[		
			UPDATE SJPB_INC_TRF_ITEM 
			SET
			    INC_TRF_ITEM_STAT_CD = #incTrfItemStatCd#
				,TRF_PRO_DT = TO_DATE(#trfProDt#,'YYYY-MM-DD')
				,TRF_TRAN_DT = TO_DATE(#trfTranDt#,'YYYY-MM-DD')
				,TRF_REQ_DT = TO_DATE(#trfReqDt#,'YYYY-MM-DD')
				,TRF_RCPT_DT = TO_DATE(#trfRcptDt#	,'YYYY-MM-DD')		
				,TRF_RST = #trfRst#
				,TRF_COMN = #trfComn#
				,INC_ARRT_CLSF = #incArrtClsf#
				,EVID_ARTC_YN = #evidArtcYn#	
				,UPD_USER_ID = #updUserId#
				,UPD_DATE = SYSDATE
		 	WHERE INC_TRF_ITEM_NUM = #incTrfItemNum#			
		]]>
	</update>	
	<update id="B0101.SJPB_INC_TRF_ITEM.update">  /* B0101.SJPB_INC_TRF_ITEM.update */
		<![CDATA[		
			UPDATE SJPB_INC_TRF_ITEM 
			SET
			    INC_TRF_ITEM_STAT_CD = #incTrfItemStatCd#
				,TRF_PRO_DT = TO_DATE(#trfProDt#,'YYYY-MM-DD')
				,TRF_TRAN_DT = TO_DATE(#trfTranDt#,'YYYY-MM-DD')
				,TRF_REQ_DT = TO_DATE(#trfReqDt#,'YYYY-MM-DD')
				,TRF_RCPT_DT = TO_DATE(#trfRcptDt#	,'YYYY-MM-DD')	
				,TRF_COMN = #trfComn#	
				,INC_ARRT_CLSF = #incArrtClsf#
				,EVID_ARTC_YN = #evidArtcYn#
				,UPD_USER_ID = #updUserId#
				,UPD_DATE = SYSDATE
		 	WHERE INC_TRF_ITEM_NUM = #incTrfItemNum#			
		]]>
	</update>	
	
	<resultMap id="B0101.B0101RC" class="com.saltware.enface.sjpb.B.service.B0101RC">
		<result property="rcptNum" column="RCPT_NUM" />
		<result property="orderNum" column="ORDER_NUM" />
		<result property="rcdTitle" column="REC_TITLE" />
		<result property="dictator" column="DICTATOR" />
		<result property="rcdDate" column="REC_DATE" />
		<result property="rcdPage" column="REC_PAGE" />
	</resultMap>
	
	<!-- 수사기록철 목록을 가져온다. -->
	<select id="B0101.selectIncRecordsList" resultMap="B0101.B0101RC"> /* B0101.selectIncRecordsList */
		SELECT 
			RCPT_NUM,
			ORDER_NUM,
			REC_TITLE,
			DICTATOR,
			TO_CHAR(REC_DATE, 'YYYY-MM-DD') REC_DATE,
			REC_PAGE
    	FROM SJPB_INC_RECORD
    	WHERE RCPT_NUM = #rcptNum#
    	<isNotEmpty property="orderNum" prepend="AND">
    		ORDER_NUM=#orderNum#
    	</isNotEmpty>
    	ORDER BY ORDER_NUM
	</select>
	
	<!-- 기록물 순서를 업데이트한다. -->
	<update id="B0101.updateRecordOrder"> /* B0101.updateRecordOrder */
		UPDATE
			SJPB_INC_RECORD
		SET ORDER_NUM=ORDER_NUM+1
		WHERE RCPT_NUM=#rcptNum#
		  AND ORDER_NUM <![CDATA[>]]> #rowNum#
	</update>
	
	<!-- 기록물을 저장한다. -->
	<insert id="B0101.saveRecordInsert"> /* B0101.saveRecordInsert */
		INSERT INTO
			SJPB_INC_RECORD
		VALUES(
			#rcptNum#,
			#rowNum#+1,
			#rcdTitle#,
			#dictator#,
			TO_DATE(#rcdDate#, 'YYYYMMDD'),
			#rcdPage#,
			#sessUserId#,
			SYSDATE,
			#sessUserId#,
			SYSDATE
		)
	</insert>
	
	<!-- 기록물을 수정한다. -->
	<update id="B0101.saveRecordUpdate"> /* B0101.saveRecordUpdate */
		UPDATE 
			SJPB_INC_RECORD
		SET
			REC_TITLE=#rcdTitle#,
			DICTATOR=#dictator#,
			REC_DATE=TO_DATE(#rcdDate#,'YYYYMMDD'),
			REC_PAGE=#rcdPage#,
			UPD_USER_ID=#sessUserId#,
			UPD_DATE=SYSDATE
		WHERE RCPT_NUM=#rcptNum#
		  AND ORDER_NUM=#orderNum#
	</update>
	
	<!-- 기록물 목록을 삭제한다. -->
	<delete id="B0101.deleteRecordList">	/* B0101.deleteRecordList */
		<isNotEmpty property="rcptNum">
			<isNotEmpty property="orderNum">
				DELETE FROM
					SJPB_INC_RECORD
				WHERE 1=1
				  AND RCPT_NUM=#rcptNum#
				  AND ORDER_NUM=#orderNum#
			</isNotEmpty>
		</isNotEmpty>
		<isEmpty property="rcptNum">
			DELETE FROM
				SJPB_INC_RECORD
			WHERE RCPT_NUM IS NULL
		</isEmpty>
	</delete>
	
	<resultMap id="B0101.SusaBkList" class="com.saltware.enface.sjpb.B.service.B0101VO">
		<result property="dvFormDesc" column="DV_FORM_DESC"/>
		<result property="poIncNum" column="PO_INC_NUM"/>
		<result property="rcptOrdNum" column="RCPT_ORD_NUM"/>
		<result property="rcptDt" column="RCPT_DT"/>
		<result property="chaIttDesc" column="CHA_ITT_DESC"/>
		<result property="spNm" column="SP_NM"/>
		<result property="spIdNum" column="SP_ID_NUM"/>
		<result property="spAddr" column="SP_ADDR"/>
		<result property="incText" column="INC_TEXT"/>
		<result property="beDt" column="BE_DT"/>
		<result property="proDt" column="PRO_DT"/>
		<result property="proRst" column="PRO_RST"/>
		<result property="nmKor" column="NM_KOR"/>
		<result property="dirNm" column="DIR_NM"/>
		<result property="incComn" column="INC_COMN"/>
	</resultMap>

	<!-- 수사사건부 출력	 -->
	<select id="B0101.prnCheckSusaBkList" resultMap="B0101.SusaBkList" >	/* B0101.prnCheckSusaBkList */
		SELECT D.CODE_NAME AS DV_FORM_DESC  					/* 구분  */
		       ,A.PO_INC_NUM									/* 검찰사건번호 */
		       ,A.RCPT_ORD_NUM  								/* 접수번호  */
		       ,TO_CHAR(A.RCPT_DT,'YYYY.MM.DD') AS RCPT_DT 		/* 접수일시  */
		       ,C.CODE_NAME AS  CHA_ITT_DESC  					/* 이첩기관  */
		       ,E.SP_NM   		/* 피의자 성명 */
		       ,E.SP_ID_NUM   /* 피의자 주민번호 */
		       ,E.SP_ADDR   	/* 피의자 주소*/
			   ,E.INC_TEXT										/* 내사할사항  */
			   ,TO_CHAR(A.BE_DT,'YYYY.MM.DD') AS BE_DT 			/* 착수일시 */
			   ,TO_CHAR(A.PRO_DT,'YYYY.MM.DD') AS PRO_DT		/* 처리일시 */
			   ,E.PRO_RST										/* 처리결과 */
			   ,G.NM_KOR										/* 담당자 */
			   ,DECODE(A.DIR_NM,null,'') AS DIR_NM										/* 지휘자 */
			   ,E.INC_COMN										/* 비고  */
		FROM SJPB_INC_MAST A
		JOIN SJPB_INC_DTS B ON B.RCPT_NUM = A.RCPT_NUM
		JOIN CODEBASE C ON C.CODE_ID = 'SJPB_00010' AND C.CODE = B.CHA_ITT
		JOIN CODEBASE D ON D.CODE_ID = 'SJPB_00004' AND D.CODE = A.DV_FORM
		JOIN SJPB_INC_SP E ON E.RCPT_NUM = A.RCPT_NUM 
		JOIN SJPB_INC_CRI_MB F ON F.RCPT_NUM = A.RCPT_NUM AND F.CRI_LV_CD='01'
		JOIN USERPASS G ON G.USER_ID = F.CRI_MB_ID
		WHERE A.RCPT_ORD_NUM IS NOT NULL
		<dynamic prepend="AND">
			<iterate property="rcptNumList" open="A.RCPT_NUM IN(" close=")" conjunction=",">
				 #rcptNumList[]#
			</iterate>
		</dynamic>
	</select>
	<resultMap id="B0101.IncBkList" class="com.saltware.enface.sjpb.Z.service.IncSpVO">
		<result property="rcptIncNum" column="RCPT_INC_NUM"/>
		<result property="acptDt" column="ACPT_DT"/>
		<result property="dvFormDesc" column="DV_FORM_DESC"/>
		<result property="nmKor" column="NM_KOR"/>
		<result property="spNm" column="SP_NM"/>
		<result property="spIdNum" column="SP_ID_NUM"/>
		<result property="spJob" column="SP_JOB"/>
		<result property="spAddr" column="SP_ADDR"/>
		<result property="spAddr" column="SP_ADDR"/>
		<result property="gendDivDesc" column="GEND_DIV_DESC"/>
		<result property="rltActCriNmCdDesc" column="RLT_ACT_CRI_NM_CD_DESC"/>
		<result property="unprofit" column="UNPROFIT"/>
		<result property="cathWrnt" column="CATH_WRNT"/>
		<result property="emgyCath" column="EMGY_CATH"/>
		<result property="flgtOfdrCath" column="FLGT_OFDR_CATH"/>
		<result property="arstWrnt" column="ARST_WRNT"/>
		<result property="inchDetn" column="INCH_DETN"/>
		<result property="trfNum" column="TRF_NUM"/>
		<result property="trfProDt" column="TRF_PRO_DT"/>
	</resultMap>

	<!-- 범죄사건부 출력 -->
	<select id="B0101.prnCheckIncBkList" resultMap="B0101.IncBkList" >	/* B0101.prnCheckIncBkList */
		SELECT B.RCPT_INC_NUM     /* 사건번호 */
		      ,TO_CHAR(B.ACPT_DT,'YYYY.MM.DD') AS ACPT_DT      /* 수리일시 */
		      ,C.CODE_NAME AS DV_FORM_DESC
		      ,E.NM_KOR
		      ,A.SP_NM
		      ,A.SP_ID_NUM
		      ,A.SP_JOB
		      ,A.SP_ADDR
		      ,I.CODE_NAME AS GEND_DIV_DESC
		      ,F.CODE_NAME AS SP_STAT_CD_DESC /* 조회 */
		      ,G.CODE_NAME AS RLT_ACT_CRI_NM_CD_DESC  /* 죄명 */
		      ,A.UNPROFIT   /* 부당이득 */
		      ,A.CATH_WRNT
		      ,A.EMGY_CATH
		      ,A.FLGT_OFDR_CATH
		      ,A.ARST_WRNT
		      ,A.INCH_DETN
		      ,H.TRF_NUM
		      ,H.TRF_PRO_DT   /*송치연월일*/
		FROM SJPB_INC_SP A
		JOIN SJPB_INC_MAST B ON B.RCPT_NUM = A.RCPT_NUM
		JOIN CODEBASE C ON C.CODE = B.DV_FORM AND C.CODE_ID ='SJPB_00004'
		LEFT JOIN SJPB_INC_CRI_MB D ON D.RCPT_NUM = A.RCPT_NUM AND D.CRI_LV_CD ='01'
		JOIN USERPASS E ON E.USER_ID = D.CRI_MB_ID
		LEFT JOIN CODEBASE F ON C.CODE = A.SP_STAT_CD AND C.CODE_ID ='SJPB_00029'
		LEFT JOIN (
					SELECT       
		             A1.INC_SP_NUM
					 ,REGEXP_REPLACE(LISTAGG(A3.CODE_NAME,  ', ') WITHIN GROUP(ORDER BY A1.INC_SP_NUM), '([^,]+)(,\1)+', '\1') AS CODE_NAME  
					FROM SJPB_INC_SP A1
		            JOIN SJPB_ACT_VIO A2 ON A1.INC_SP_NUM = A2.INC_SP_NUM AND A2.ACT_VIO_STAT_CD = '1'
		            LEFT OUTER JOIN CODEBASE A3 ON A2.RLT_ACT_CRI_NM_CD = A3.CODE AND A3.CODE_ID = 'SJPB_00012'
		            AND A1.SP_STAT_CD = '1'
					GROUP BY A1.INC_SP_NUM
				) G ON G.INC_SP_NUM = A.INC_SP_NUM
		LEFT JOIN (
		          SELECT       
		             A1.RCPT_NUM
		            ,REGEXP_REPLACE(LISTAGG('제 '||SUBSTR(TRF_NUM,6)||' 호',  ', ') WITHIN GROUP(ORDER BY A1.RCPT_NUM), '([^,]+)(,\1)+', '\1') AS TRF_NUM 
		            ,REGEXP_REPLACE(LISTAGG(TO_CHAR(A2.TRF_PRO_DT,'YYYY.MM.DD'),  ', ') WITHIN GROUP(ORDER BY A1.RCPT_NUM), '([^,]+)(,\1)+', '\1') AS TRF_PRO_DT 
		            FROM SJPB_INC_MAST A1
		            LEFT OUTER JOIN SJPB_INC_TRF_ITEM A2 ON A1.RCPT_NUM = A2.RCPT_NUM 
		            
					GROUP BY A1.RCPT_NUM
		) H ON H.RCPT_NUM = B.RCPT_NUM 
		LEFT JOIN CODEBASE I ON I.CODE = A.GEND_DIV AND I.CODE_ID ='SJPB_00009'
		WHERE B.RCPT_INC_NUM IS NOT NULL
		<dynamic prepend="AND">
			<iterate property="rcptNumList" open="B.RCPT_NUM IN(" close=")" conjunction=",">
				 #rcptNumList[]#
			</iterate>
		</dynamic>
	</select>
	
</sqlMap>

